var vC=Object.defineProperty;var yC=(t,e,n)=>e in t?vC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ma=(t,e,n)=>yC(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function o1(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Qn={},Sc=[],bs=()=>{},_C=()=>!1,op=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),l1=t=>t.startsWith("onUpdate:"),Or=Object.assign,u1=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},bC=Object.prototype.hasOwnProperty,Yn=(t,e)=>bC.call(t,e),an=Array.isArray,Mc=t=>lp(t)==="[object Map]",_S=t=>lp(t)==="[object Set]",fn=t=>typeof t=="function",_r=t=>typeof t=="string",ao=t=>typeof t=="symbol",ar=t=>t!==null&&typeof t=="object",bS=t=>(ar(t)||fn(t))&&fn(t.then)&&fn(t.catch),xS=Object.prototype.toString,lp=t=>xS.call(t),xC=t=>lp(t).slice(8,-1),wS=t=>lp(t)==="[object Object]",c1=t=>_r(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Jd=o1(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),up=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},wC=/-(\w)/g,Vi=up(t=>t.replace(wC,(e,n)=>n?n.toUpperCase():"")),SC=/\B([A-Z])/g,gu=up(t=>t.replace(SC,"-$1").toLowerCase()),so=up(t=>t.charAt(0).toUpperCase()+t.slice(1)),Jp=up(t=>t?`on${so(t)}`:""),Jo=(t,e)=>!Object.is(t,e),Qp=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},ov=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:n})},MC=t=>{const e=parseFloat(t);return isNaN(e)?t:e},EC=t=>{const e=_r(t)?Number(t):NaN;return isNaN(e)?t:e};let Jy;const cp=()=>Jy||(Jy=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function yn(t){if(an(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],i=_r(r)?kC(r):yn(r);if(i)for(const a in i)e[a]=i[a]}return e}else if(_r(t)||ar(t))return t}const TC=/;(?![^(]*\))/g,CC=/:([^]+)/,AC=/\/\*[^]*?\*\//g;function kC(t){const e={};return t.replace(AC,"").split(TC).forEach(n=>{if(n){const r=n.split(CC);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Wt(t){let e="";if(_r(t))e=t;else if(an(t))for(let n=0;n<t.length;n++){const r=Wt(t[n]);r&&(e+=r+" ")}else if(ar(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const IC="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",$C=o1(IC);function SS(t){return!!t||t===""}const MS=t=>!!(t&&t.__v_isRef===!0),fr=t=>_r(t)?t:t==null?"":an(t)||ar(t)&&(t.toString===xS||!fn(t.toString))?MS(t)?fr(t.value):JSON.stringify(t,ES,2):String(t),ES=(t,e)=>MS(e)?ES(t,e.value):Mc(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,i],a)=>(n[em(r,a)+" =>"]=i,n),{})}:_S(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>em(n))}:ao(e)?em(e):ar(e)&&!an(e)&&!wS(e)?String(e):e,em=(t,e="")=>{var n;return ao(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ui;class TS{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ui,!e&&ui&&(this.index=(ui.scopes||(ui.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=ui;try{return ui=this,e()}finally{ui=n}}}on(){++this._on===1&&(this.prevScope=ui,ui=this)}off(){this._on>0&&--this._on===0&&(ui=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function hf(t){return new TS(t)}function CS(){return ui}function Pi(t,e=!1){ui&&ui.cleanups.push(t)}let ir;const tm=new WeakSet;class AS{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ui&&ui.active&&ui.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,tm.has(this)&&(tm.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||IS(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Qy(this),$S(this);const e=ir,n=Fa;ir=this,Fa=!0;try{return this.fn()}finally{PS(this),ir=e,Fa=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)h1(e);this.deps=this.depsTail=void 0,Qy(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?tm.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){lv(this)&&this.run()}get dirty(){return lv(this)}}let kS=0,Qd,ef;function IS(t,e=!1){if(t.flags|=8,e){t.next=ef,ef=t;return}t.next=Qd,Qd=t}function d1(){kS++}function f1(){if(--kS>0)return;if(ef){let e=ef;for(ef=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Qd;){let e=Qd;for(Qd=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=n}}if(t)throw t}function $S(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function PS(t){let e,n=t.depsTail,r=n;for(;r;){const i=r.prevDep;r.version===-1?(r===n&&(n=i),h1(r),PC(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}t.deps=e,t.depsTail=n}function lv(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(RS(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function RS(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===pf)||(t.globalVersion=pf,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!lv(t))))return;t.flags|=2;const e=t.dep,n=ir,r=Fa;ir=t,Fa=!0;try{$S(t);const i=t.fn(t._value);(e.version===0||Jo(i,t._value))&&(t.flags|=128,t._value=i,e.version++)}catch(i){throw e.version++,i}finally{ir=n,Fa=r,PS(t),t.flags&=-3}}function h1(t,e=!1){const{dep:n,prevSub:r,nextSub:i}=t;if(r&&(r.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=r,t.nextSub=void 0),n.subs===t&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let a=n.computed.deps;a;a=a.nextDep)h1(a,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function PC(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let Fa=!0;const DS=[];function no(){DS.push(Fa),Fa=!1}function ro(){const t=DS.pop();Fa=t===void 0?!0:t}function Qy(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=ir;ir=void 0;try{e()}finally{ir=n}}}let pf=0;class RC{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class p1{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!ir||!Fa||ir===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==ir)n=this.activeLink=new RC(ir,this),ir.deps?(n.prevDep=ir.depsTail,ir.depsTail.nextDep=n,ir.depsTail=n):ir.deps=ir.depsTail=n,LS(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=ir.depsTail,n.nextDep=void 0,ir.depsTail.nextDep=n,ir.depsTail=n,ir.deps===n&&(ir.deps=r)}return n}trigger(e){this.version++,pf++,this.notify(e)}notify(e){d1();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{f1()}}}function LS(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)LS(r)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const I0=new WeakMap,ru=Symbol(""),uv=Symbol(""),mf=Symbol("");function di(t,e,n){if(Fa&&ir){let r=I0.get(t);r||I0.set(t,r=new Map);let i=r.get(n);i||(r.set(n,i=new p1),i.map=r,i.key=n),i.track()}}function Js(t,e,n,r,i,a){const s=I0.get(t);if(!s){pf++;return}const o=l=>{l&&l.trigger()};if(d1(),e==="clear")s.forEach(o);else{const l=an(t),u=l&&c1(n);if(l&&n==="length"){const c=Number(r);s.forEach((d,h)=>{(h==="length"||h===mf||!ao(h)&&h>=c)&&o(d)})}else switch((n!==void 0||s.has(void 0))&&o(s.get(n)),u&&o(s.get(mf)),e){case"add":l?u&&o(s.get("length")):(o(s.get(ru)),Mc(t)&&o(s.get(uv)));break;case"delete":l||(o(s.get(ru)),Mc(t)&&o(s.get(uv)));break;case"set":Mc(t)&&o(s.get(ru));break}}f1()}function DC(t,e){const n=I0.get(t);return n&&n.get(e)}function ju(t){const e=en(t);return e===t?e:(di(e,"iterate",mf),wa(t)?e:e.map(ni))}function dp(t){return di(t=en(t),"iterate",mf),t}const LC={__proto__:null,[Symbol.iterator](){return nm(this,Symbol.iterator,ni)},concat(...t){return ju(this).concat(...t.map(e=>an(e)?ju(e):e))},entries(){return nm(this,"entries",t=>(t[1]=ni(t[1]),t))},every(t,e){return Vs(this,"every",t,e,void 0,arguments)},filter(t,e){return Vs(this,"filter",t,e,n=>n.map(ni),arguments)},find(t,e){return Vs(this,"find",t,e,ni,arguments)},findIndex(t,e){return Vs(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Vs(this,"findLast",t,e,ni,arguments)},findLastIndex(t,e){return Vs(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Vs(this,"forEach",t,e,void 0,arguments)},includes(...t){return rm(this,"includes",t)},indexOf(...t){return rm(this,"indexOf",t)},join(t){return ju(this).join(t)},lastIndexOf(...t){return rm(this,"lastIndexOf",t)},map(t,e){return Vs(this,"map",t,e,void 0,arguments)},pop(){return xd(this,"pop")},push(...t){return xd(this,"push",t)},reduce(t,...e){return e2(this,"reduce",t,e)},reduceRight(t,...e){return e2(this,"reduceRight",t,e)},shift(){return xd(this,"shift")},some(t,e){return Vs(this,"some",t,e,void 0,arguments)},splice(...t){return xd(this,"splice",t)},toReversed(){return ju(this).toReversed()},toSorted(t){return ju(this).toSorted(t)},toSpliced(...t){return ju(this).toSpliced(...t)},unshift(...t){return xd(this,"unshift",t)},values(){return nm(this,"values",ni)}};function nm(t,e,n){const r=dp(t),i=r[e]();return r!==t&&!wa(t)&&(i._next=i.next,i.next=()=>{const a=i._next();return a.value&&(a.value=n(a.value)),a}),i}const zC=Array.prototype;function Vs(t,e,n,r,i,a){const s=dp(t),o=s!==t&&!wa(t),l=s[e];if(l!==zC[e]){const d=l.apply(t,a);return o?ni(d):d}let u=n;s!==t&&(o?u=function(d,h){return n.call(this,ni(d),h,t)}:n.length>2&&(u=function(d,h){return n.call(this,d,h,t)}));const c=l.call(s,u,r);return o&&i?i(c):c}function e2(t,e,n,r){const i=dp(t);let a=n;return i!==t&&(wa(t)?n.length>3&&(a=function(s,o,l){return n.call(this,s,o,l,t)}):a=function(s,o,l){return n.call(this,s,ni(o),l,t)}),i[e](a,...r)}function rm(t,e,n){const r=en(t);di(r,"iterate",mf);const i=r[e](...n);return(i===-1||i===!1)&&v1(n[0])?(n[0]=en(n[0]),r[e](...n)):i}function xd(t,e,n=[]){no(),d1();const r=en(t)[e].apply(t,n);return f1(),ro(),r}const OC=o1("__proto__,__v_isRef,__isVue"),zS=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ao));function NC(t){ao(t)||(t=String(t));const e=en(this);return di(e,"has",t),e.hasOwnProperty(t)}class OS{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){if(n==="__v_skip")return e.__v_skip;const i=this._isReadonly,a=this._isShallow;if(n==="__v_isReactive")return!i;if(n==="__v_isReadonly")return i;if(n==="__v_isShallow")return a;if(n==="__v_raw")return r===(i?a?XC:US:a?FS:BS).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const s=an(e);if(!i){let l;if(s&&(l=LC[n]))return l;if(n==="hasOwnProperty")return NC}const o=Reflect.get(e,n,lr(e)?e:r);return(ao(n)?zS.has(n):OC(n))||(i||di(e,"get",n),a)?o:lr(o)?s&&c1(n)?o:o.value:ar(o)?i?Lf(o):qr(o):o}}class NS extends OS{constructor(e=!1){super(!1,e)}set(e,n,r,i){let a=e[n];if(!this._isShallow){const l=el(a);if(!wa(r)&&!el(r)&&(a=en(a),r=en(r)),!an(e)&&lr(a)&&!lr(r))return l?!1:(a.value=r,!0)}const s=an(e)&&c1(n)?Number(n)<e.length:Yn(e,n),o=Reflect.set(e,n,r,lr(e)?e:i);return e===en(i)&&(s?Jo(r,a)&&Js(e,"set",n,r):Js(e,"add",n,r)),o}deleteProperty(e,n){const r=Yn(e,n);e[n];const i=Reflect.deleteProperty(e,n);return i&&r&&Js(e,"delete",n,void 0),i}has(e,n){const r=Reflect.has(e,n);return(!ao(n)||!zS.has(n))&&di(e,"has",n),r}ownKeys(e){return di(e,"iterate",an(e)?"length":ru),Reflect.ownKeys(e)}}class BC extends OS{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const FC=new NS,UC=new BC,VC=new NS(!0);const cv=t=>t,Ch=t=>Reflect.getPrototypeOf(t);function HC(t,e,n){return function(...r){const i=this.__v_raw,a=en(i),s=Mc(a),o=t==="entries"||t===Symbol.iterator&&s,l=t==="keys"&&s,u=i[t](...r),c=n?cv:e?$0:ni;return!e&&di(a,"iterate",l?uv:ru),{next(){const{value:d,done:h}=u.next();return h?{value:d,done:h}:{value:o?[c(d[0]),c(d[1])]:c(d),done:h}},[Symbol.iterator](){return this}}}}function Ah(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function WC(t,e){const n={get(i){const a=this.__v_raw,s=en(a),o=en(i);t||(Jo(i,o)&&di(s,"get",i),di(s,"get",o));const{has:l}=Ch(s),u=e?cv:t?$0:ni;if(l.call(s,i))return u(a.get(i));if(l.call(s,o))return u(a.get(o));a!==s&&a.get(i)},get size(){const i=this.__v_raw;return!t&&di(en(i),"iterate",ru),Reflect.get(i,"size",i)},has(i){const a=this.__v_raw,s=en(a),o=en(i);return t||(Jo(i,o)&&di(s,"has",i),di(s,"has",o)),i===o?a.has(i):a.has(i)||a.has(o)},forEach(i,a){const s=this,o=s.__v_raw,l=en(o),u=e?cv:t?$0:ni;return!t&&di(l,"iterate",ru),o.forEach((c,d)=>i.call(a,u(c),u(d),s))}};return Or(n,t?{add:Ah("add"),set:Ah("set"),delete:Ah("delete"),clear:Ah("clear")}:{add(i){!e&&!wa(i)&&!el(i)&&(i=en(i));const a=en(this);return Ch(a).has.call(a,i)||(a.add(i),Js(a,"add",i,i)),this},set(i,a){!e&&!wa(a)&&!el(a)&&(a=en(a));const s=en(this),{has:o,get:l}=Ch(s);let u=o.call(s,i);u||(i=en(i),u=o.call(s,i));const c=l.call(s,i);return s.set(i,a),u?Jo(a,c)&&Js(s,"set",i,a):Js(s,"add",i,a),this},delete(i){const a=en(this),{has:s,get:o}=Ch(a);let l=s.call(a,i);l||(i=en(i),l=s.call(a,i)),o&&o.call(a,i);const u=a.delete(i);return l&&Js(a,"delete",i,void 0),u},clear(){const i=en(this),a=i.size!==0,s=i.clear();return a&&Js(i,"clear",void 0,void 0),s}}),["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=HC(i,t,e)}),n}function m1(t,e){const n=WC(t,e);return(r,i,a)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?r:Reflect.get(Yn(n,i)&&i in r?n:r,i,a)}const GC={get:m1(!1,!1)},qC={get:m1(!1,!0)},jC={get:m1(!0,!1)};const BS=new WeakMap,FS=new WeakMap,US=new WeakMap,XC=new WeakMap;function KC(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function YC(t){return t.__v_skip||!Object.isExtensible(t)?0:KC(xC(t))}function qr(t){return el(t)?t:g1(t,!1,FC,GC,BS)}function VS(t){return g1(t,!1,VC,qC,FS)}function Lf(t){return g1(t,!0,UC,jC,US)}function g1(t,e,n,r,i){if(!ar(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const a=YC(t);if(a===0)return t;const s=i.get(t);if(s)return s;const o=new Proxy(t,a===2?r:n);return i.set(t,o),o}function Ec(t){return el(t)?Ec(t.__v_raw):!!(t&&t.__v_isReactive)}function el(t){return!!(t&&t.__v_isReadonly)}function wa(t){return!!(t&&t.__v_isShallow)}function v1(t){return t?!!t.__v_raw:!1}function en(t){const e=t&&t.__v_raw;return e?en(e):t}function ZC(t){return!Yn(t,"__v_skip")&&Object.isExtensible(t)&&ov(t,"__v_skip",!0),t}const ni=t=>ar(t)?qr(t):t,$0=t=>ar(t)?Lf(t):t;function lr(t){return t?t.__v_isRef===!0:!1}function cn(t){return HS(t,!1)}function rn(t){return HS(t,!0)}function HS(t,e){return lr(t)?t:new JC(t,e)}class JC{constructor(e,n){this.dep=new p1,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:en(e),this._value=n?e:ni(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,r=this.__v_isShallow||wa(e)||el(e);e=r?e:en(e),Jo(e,n)&&(this._rawValue=e,this._value=r?e:ni(e),this.dep.trigger())}}function ki(t){return lr(t)?t.value:t}function Ms(t){return fn(t)?t():ki(t)}const QC={get:(t,e,n)=>e==="__v_raw"?t:ki(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const i=t[e];return lr(i)&&!lr(n)?(i.value=n,!0):Reflect.set(t,e,n,r)}};function WS(t){return Ec(t)?t:new Proxy(t,QC)}function GS(t){const e=an(t)?new Array(t.length):{};for(const n in t)e[n]=qS(t,n);return e}class eA{constructor(e,n,r){this._object=e,this._key=n,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return DC(en(this._object),this._key)}}class tA{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function dt(t,e,n){return lr(t)?t:fn(t)?new tA(t):ar(t)&&arguments.length>1?qS(t,e,n):cn(t)}function qS(t,e,n){const r=t[e];return lr(r)?r:new eA(t,e,n)}class nA{constructor(e,n,r){this.fn=e,this.setter=n,this._value=void 0,this.dep=new p1(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=pf-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&ir!==this)return IS(this,!0),!0}get value(){const e=this.dep.track();return RS(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function rA(t,e,n=!1){let r,i;return fn(t)?r=t:(r=t.get,i=t.set),new nA(r,i,n)}const kh={},P0=new WeakMap;let Gl;function iA(t,e=!1,n=Gl){if(n){let r=P0.get(n);r||P0.set(n,r=[]),r.push(t)}}function aA(t,e,n=Qn){const{immediate:r,deep:i,once:a,scheduler:s,augmentJob:o,call:l}=n,u=A=>i?A:wa(A)||i===!1||i===0?Qs(A,1):Qs(A);let c,d,h,v,x=!1,_=!1;if(lr(t)?(d=()=>t.value,x=wa(t)):Ec(t)?(d=()=>u(t),x=!0):an(t)?(_=!0,x=t.some(A=>Ec(A)||wa(A)),d=()=>t.map(A=>{if(lr(A))return A.value;if(Ec(A))return u(A);if(fn(A))return l?l(A,2):A()})):fn(t)?e?d=l?()=>l(t,2):t:d=()=>{if(h){no();try{h()}finally{ro()}}const A=Gl;Gl=c;try{return l?l(t,3,[v]):t(v)}finally{Gl=A}}:d=bs,e&&i){const A=d,D=i===!0?1/0:i;d=()=>Qs(A(),D)}const b=CS(),S=()=>{c.stop(),b&&b.active&&u1(b.effects,c)};if(a&&e){const A=e;e=(...D)=>{A(...D),S()}}let E=_?new Array(t.length).fill(kh):kh;const C=A=>{if(!(!(c.flags&1)||!c.dirty&&!A))if(e){const D=c.run();if(i||x||(_?D.some((O,V)=>Jo(O,E[V])):Jo(D,E))){h&&h();const O=Gl;Gl=c;try{const V=[D,E===kh?void 0:_&&E[0]===kh?[]:E,v];E=D,l?l(e,3,V):e(...V)}finally{Gl=O}}}else c.run()};return o&&o(C),c=new AS(d),c.scheduler=s?()=>s(C,!1):C,v=A=>iA(A,!1,c),h=c.onStop=()=>{const A=P0.get(c);if(A){if(l)l(A,4);else for(const D of A)D();P0.delete(c)}},e?r?C(!0):E=c.run():s?s(C.bind(null,!0),!0):c.run(),S.pause=c.pause.bind(c),S.resume=c.resume.bind(c),S.stop=S,S}function Qs(t,e=1/0,n){if(e<=0||!ar(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,lr(t))Qs(t.value,e,n);else if(an(t))for(let r=0;r<t.length;r++)Qs(t[r],e,n);else if(_S(t)||Mc(t))t.forEach(r=>{Qs(r,e,n)});else if(wS(t)){for(const r in t)Qs(t[r],e,n);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&Qs(t[r],e,n)}return t}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function zf(t,e,n,r){try{return r?t(...r):t()}catch(i){fp(i,e,n)}}function Ha(t,e,n,r){if(fn(t)){const i=zf(t,e,n,r);return i&&bS(i)&&i.catch(a=>{fp(a,e,n)}),i}if(an(t)){const i=[];for(let a=0;a<t.length;a++)i.push(Ha(t[a],e,n,r));return i}}function fp(t,e,n,r=!0){const i=e?e.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:s}=e&&e.appContext.config||Qn;if(e){let o=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;o;){const c=o.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](t,l,u)===!1)return}o=o.parent}if(a){no(),zf(a,null,10,[t,l,u]),ro();return}}sA(t,n,i,r,s)}function sA(t,e,n,r=!0,i=!1){if(i)throw t;console.error(t)}const Ti=[];let ms=-1;const Tc=[];let Wo=null,pc=0;const jS=Promise.resolve();let R0=null;function Wi(t){const e=R0||jS;return t?e.then(this?t.bind(this):t):e}function oA(t){let e=ms+1,n=Ti.length;for(;e<n;){const r=e+n>>>1,i=Ti[r],a=gf(i);a<t||a===t&&i.flags&2?e=r+1:n=r}return e}function y1(t){if(!(t.flags&1)){const e=gf(t),n=Ti[Ti.length-1];!n||!(t.flags&2)&&e>=gf(n)?Ti.push(t):Ti.splice(oA(e),0,t),t.flags|=1,XS()}}function XS(){R0||(R0=jS.then(YS))}function lA(t){an(t)?Tc.push(...t):Wo&&t.id===-1?Wo.splice(pc+1,0,t):t.flags&1||(Tc.push(t),t.flags|=1),XS()}function t2(t,e,n=ms+1){for(;n<Ti.length;n++){const r=Ti[n];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;Ti.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function KS(t){if(Tc.length){const e=[...new Set(Tc)].sort((n,r)=>gf(n)-gf(r));if(Tc.length=0,Wo){Wo.push(...e);return}for(Wo=e,pc=0;pc<Wo.length;pc++){const n=Wo[pc];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Wo=null,pc=0}}const gf=t=>t.id==null?t.flags&2?-1:1/0:t.id;function YS(t){try{for(ms=0;ms<Ti.length;ms++){const e=Ti[ms];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),zf(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ms<Ti.length;ms++){const e=Ti[ms];e&&(e.flags&=-2)}ms=-1,Ti.length=0,KS(),R0=null,(Ti.length||Tc.length)&&YS()}}let ri=null,ZS=null;function D0(t){const e=ri;return ri=t,ZS=t&&t.type.__scopeId||null,e}function Ne(t,e=ri,n){if(!e||t._n)return t;const r=(...i)=>{r._d&&m2(-1);const a=D0(e);let s;try{s=t(...i)}finally{D0(a),r._d&&m2(1)}return s};return r._n=!0,r._c=!0,r._d=!0,r}function Hi(t,e){if(ri===null)return t;const n=vp(ri),r=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[a,s,o,l=Qn]=e[i];a&&(fn(a)&&(a={mounted:a,updated:a}),a.deep&&Qs(s),r.push({dir:a,instance:n,value:s,oldValue:void 0,arg:o,modifiers:l}))}return t}function Rl(t,e,n,r){const i=t.dirs,a=e&&e.dirs;for(let s=0;s<i.length;s++){const o=i[s];a&&(o.oldValue=a[s].value);let l=o.dir[r];l&&(no(),Ha(l,n,8,[t.el,o,t,e]),ro())}}const JS=Symbol("_vte"),QS=t=>t.__isTeleport,tf=t=>t&&(t.disabled||t.disabled===""),n2=t=>t&&(t.defer||t.defer===""),r2=t=>typeof SVGElement<"u"&&t instanceof SVGElement,i2=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,dv=(t,e)=>{const n=t&&t.to;return _r(n)?e?e(n):null:n},e5={name:"Teleport",__isTeleport:!0,process(t,e,n,r,i,a,s,o,l,u){const{mc:c,pc:d,pbc:h,o:{insert:v,querySelector:x,createText:_,createComment:b}}=u,S=tf(e.props);let{shapeFlag:E,children:C,dynamicChildren:A}=e;if(t==null){const D=e.el=_(""),O=e.anchor=_("");v(D,n,r),v(O,n,r);const V=(U,Y)=>{E&16&&(i&&i.isCE&&(i.ce._teleportTarget=U),c(C,U,Y,i,a,s,o,l))},P=()=>{const U=e.target=dv(e.props,x),Y=t5(U,e,_,v);U&&(s!=="svg"&&r2(U)?s="svg":s!=="mathml"&&i2(U)&&(s="mathml"),S||(V(U,Y),y0(e,!1)))};S&&(V(n,O),y0(e,!0)),n2(e.props)?(e.el.__isMounted=!1,Ei(()=>{P(),delete e.el.__isMounted},a)):P()}else{if(n2(e.props)&&t.el.__isMounted===!1){Ei(()=>{e5.process(t,e,n,r,i,a,s,o,l,u)},a);return}e.el=t.el,e.targetStart=t.targetStart;const D=e.anchor=t.anchor,O=e.target=t.target,V=e.targetAnchor=t.targetAnchor,P=tf(t.props),U=P?n:O,Y=P?D:V;if(s==="svg"||r2(O)?s="svg":(s==="mathml"||i2(O))&&(s="mathml"),A?(h(t.dynamicChildren,A,U,i,a,s,o),S1(t,e,!0)):l||d(t,e,U,Y,i,a,s,o,!1),S)P?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):Ih(e,n,D,u,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const fe=e.target=dv(e.props,x);fe&&Ih(e,fe,null,u,0)}else P&&Ih(e,O,V,u,1);y0(e,S)}},remove(t,e,n,{um:r,o:{remove:i}},a){const{shapeFlag:s,children:o,anchor:l,targetStart:u,targetAnchor:c,target:d,props:h}=t;if(d&&(i(u),i(c)),a&&i(l),s&16){const v=a||!tf(h);for(let x=0;x<o.length;x++){const _=o[x];r(_,e,n,v,!!_.dynamicChildren)}}},move:Ih,hydrate:uA};function Ih(t,e,n,{o:{insert:r},m:i},a=2){a===0&&r(t.targetAnchor,e,n);const{el:s,anchor:o,shapeFlag:l,children:u,props:c}=t,d=a===2;if(d&&r(s,e,n),(!d||tf(c))&&l&16)for(let h=0;h<u.length;h++)i(u[h],e,n,2);d&&r(o,e,n)}function uA(t,e,n,r,i,a,{o:{nextSibling:s,parentNode:o,querySelector:l,insert:u,createText:c}},d){const h=e.target=dv(e.props,l);if(h){const v=tf(e.props),x=h._lpa||h.firstChild;if(e.shapeFlag&16)if(v)e.anchor=d(s(t),e,o(t),n,r,i,a),e.targetStart=x,e.targetAnchor=x&&s(x);else{e.anchor=s(t);let _=x;for(;_;){if(_&&_.nodeType===8){if(_.data==="teleport start anchor")e.targetStart=_;else if(_.data==="teleport anchor"){e.targetAnchor=_,h._lpa=e.targetAnchor&&s(e.targetAnchor);break}}_=s(_)}e.targetAnchor||t5(h,e,c,u),d(x&&s(x),e,h,n,r,i,a)}y0(e,v)}return e.anchor&&s(e.anchor)}const cA=e5;function y0(t,e){const n=t.ctx;if(n&&n.ut){let r,i;for(e?(r=t.el,i=t.anchor):(r=t.targetStart,i=t.targetAnchor);r&&r!==i;)r.nodeType===1&&r.setAttribute("data-v-owner",n.uid),r=r.nextSibling;n.ut()}}function t5(t,e,n,r){const i=e.targetStart=n(""),a=e.targetAnchor=n("");return i[JS]=a,t&&(r(i,t),r(a,t)),a}const Go=Symbol("_leaveCb"),$h=Symbol("_enterCb");function n5(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ol(()=>{t.isMounted=!0}),sa(()=>{t.isUnmounting=!0}),t}const ga=[Function,Array],r5={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ga,onEnter:ga,onAfterEnter:ga,onEnterCancelled:ga,onBeforeLeave:ga,onLeave:ga,onAfterLeave:ga,onLeaveCancelled:ga,onBeforeAppear:ga,onAppear:ga,onAfterAppear:ga,onAppearCancelled:ga},i5=t=>{const e=t.subTree;return e.component?i5(e.component):e},dA={name:"BaseTransition",props:r5,setup(t,{slots:e}){const n=Bf(),r=n5();return()=>{const i=e.default&&_1(e.default(),!0);if(!i||!i.length)return;const a=a5(i),s=en(t),{mode:o}=s;if(r.isLeaving)return im(a);const l=a2(a);if(!l)return im(a);let u=vf(l,s,r,n,d=>u=d);l.type!==fi&&uu(l,u);let c=n.subTree&&a2(n.subTree);if(c&&c.type!==fi&&!jl(l,c)&&i5(n).type!==fi){let d=vf(c,s,r,n);if(uu(c,d),o==="out-in"&&l.type!==fi)return r.isLeaving=!0,d.afterLeave=()=>{r.isLeaving=!1,n.job.flags&8||n.update(),delete d.afterLeave,c=void 0},im(a);o==="in-out"&&l.type!==fi?d.delayLeave=(h,v,x)=>{const _=s5(r,c);_[String(c.key)]=c,h[Go]=()=>{v(),h[Go]=void 0,delete u.delayedLeave,c=void 0},u.delayedLeave=()=>{x(),delete u.delayedLeave,c=void 0}}:c=void 0}else c&&(c=void 0);return a}}};function a5(t){let e=t[0];if(t.length>1){for(const n of t)if(n.type!==fi){e=n;break}}return e}const fA=dA;function s5(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function vf(t,e,n,r,i){const{appear:a,mode:s,persisted:o=!1,onBeforeEnter:l,onEnter:u,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:h,onLeave:v,onAfterLeave:x,onLeaveCancelled:_,onBeforeAppear:b,onAppear:S,onAfterAppear:E,onAppearCancelled:C}=e,A=String(t.key),D=s5(n,t),O=(U,Y)=>{U&&Ha(U,r,9,Y)},V=(U,Y)=>{const fe=Y[1];O(U,Y),an(U)?U.every(Q=>Q.length<=1)&&fe():U.length<=1&&fe()},P={mode:s,persisted:o,beforeEnter(U){let Y=l;if(!n.isMounted)if(a)Y=b||l;else return;U[Go]&&U[Go](!0);const fe=D[A];fe&&jl(t,fe)&&fe.el[Go]&&fe.el[Go](),O(Y,[U])},enter(U){let Y=u,fe=c,Q=d;if(!n.isMounted)if(a)Y=S||u,fe=E||c,Q=C||d;else return;let G=!1;const re=U[$h]=he=>{G||(G=!0,he?O(Q,[U]):O(fe,[U]),P.delayedLeave&&P.delayedLeave(),U[$h]=void 0)};Y?V(Y,[U,re]):re()},leave(U,Y){const fe=String(t.key);if(U[$h]&&U[$h](!0),n.isUnmounting)return Y();O(h,[U]);let Q=!1;const G=U[Go]=re=>{Q||(Q=!0,Y(),re?O(_,[U]):O(x,[U]),U[Go]=void 0,D[fe]===t&&delete D[fe])};D[fe]=t,v?V(v,[U,G]):G()},clone(U){const Y=vf(U,e,n,r,i);return i&&i(Y),Y}};return P}function im(t){if(pp(t))return t=tl(t),t.children=null,t}function a2(t){if(!pp(t))return QS(t.type)&&t.children?a5(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:n}=t;if(n){if(e&16)return n[0];if(e&32&&fn(n.default))return n.default()}}function uu(t,e){t.shapeFlag&6&&t.component?(t.transition=e,uu(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function _1(t,e=!1,n){let r=[],i=0;for(let a=0;a<t.length;a++){let s=t[a];const o=n==null?s.key:String(n)+String(s.key!=null?s.key:a);s.type===On?(s.patchFlag&128&&i++,r=r.concat(_1(s.children,e,o))):(e||s.type!==fi)&&r.push(o!=null?tl(s,{key:o}):s)}if(i>1)for(let a=0;a<r.length;a++)r[a].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function hp(t,e){return fn(t)?Or({name:t.name},e,{setup:t}):t}function vu(){const t=Bf();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function o5(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function nf(t,e,n,r,i=!1){if(an(t)){t.forEach((x,_)=>nf(x,e&&(an(e)?e[_]:e),n,r,i));return}if(Cc(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&nf(t,e,n,r.component.subTree);return}const a=r.shapeFlag&4?vp(r.component):r.el,s=i?null:a,{i:o,r:l}=t,u=e&&e.r,c=o.refs===Qn?o.refs={}:o.refs,d=o.setupState,h=en(d),v=d===Qn?()=>!1:x=>Yn(h,x);if(u!=null&&u!==l&&(_r(u)?(c[u]=null,v(u)&&(d[u]=null)):lr(u)&&(u.value=null)),fn(l))zf(l,o,12,[s,c]);else{const x=_r(l),_=lr(l);if(x||_){const b=()=>{if(t.f){const S=x?v(l)?d[l]:c[l]:l.value;i?an(S)&&u1(S,a):an(S)?S.includes(a)||S.push(a):x?(c[l]=[a],v(l)&&(d[l]=c[l])):(l.value=[a],t.k&&(c[t.k]=l.value))}else x?(c[l]=s,v(l)&&(d[l]=s)):_&&(l.value=s,t.k&&(c[t.k]=s))};s?(b.id=-1,Ei(b,n)):b()}}}cp().requestIdleCallback;cp().cancelIdleCallback;const Cc=t=>!!t.type.__asyncLoader,pp=t=>t.type.__isKeepAlive;function l5(t,e){c5(t,"a",e)}function u5(t,e){c5(t,"da",e)}function c5(t,e,n=hi){const r=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(mp(e,r,n),n){let i=n.parent;for(;i&&i.parent;)pp(i.parent.vnode)&&hA(r,e,n,i),i=i.parent}}function hA(t,e,n,r){const i=mp(e,t,r,!0);d5(()=>{u1(r[e],i)},n)}function mp(t,e,n=hi,r=!1){if(n){const i=n[t]||(n[t]=[]),a=e.__weh||(e.__weh=(...s)=>{no();const o=Ff(n),l=Ha(e,n,t,s);return o(),ro(),l});return r?i.unshift(a):i.push(a),a}}const oo=t=>(e,n=hi)=>{(!bf||t==="sp")&&mp(t,(...r)=>e(...r),n)},Of=oo("bm"),ol=oo("m"),pA=oo("bu"),b1=oo("u"),sa=oo("bum"),d5=oo("um"),mA=oo("sp"),gA=oo("rtg"),vA=oo("rtc");function yA(t,e=hi){mp("ec",t,e)}const f5="components";function h5(t,e){return p5(f5,t,!0,e)||t}const _A=Symbol.for("v-ndc");function bA(t){return _r(t)&&p5(f5,t,!1)||t}function p5(t,e,n=!0,r=!1){const i=ri||hi;if(i){const a=i.type;{const o=ak(a,!1);if(o&&(o===e||o===Vi(e)||o===so(Vi(e))))return a}const s=s2(i[t]||a[t],e)||s2(i.appContext[t],e);return!s&&r?a:s}}function s2(t,e){return t&&(t[e]||t[Vi(e)]||t[so(Vi(e))])}function Po(t,e,n,r){let i;const a=n,s=an(t);if(s||_r(t)){const o=s&&Ec(t);let l=!1,u=!1;o&&(l=!wa(t),u=el(t),t=dp(t)),i=new Array(t.length);for(let c=0,d=t.length;c<d;c++)i[c]=e(l?u?$0(ni(t[c])):ni(t[c]):t[c],c,void 0,a)}else if(typeof t=="number"){i=new Array(t);for(let o=0;o<t;o++)i[o]=e(o+1,o,void 0,a)}else if(ar(t))if(t[Symbol.iterator])i=Array.from(t,(o,l)=>e(o,l,void 0,a));else{const o=Object.keys(t);i=new Array(o.length);for(let l=0,u=o.length;l<u;l++){const c=o[l];i[l]=e(t[c],c,l,a)}}else i=[];return i}function Wd(t,e,n={},r,i){if(ri.ce||ri.parent&&Cc(ri.parent)&&ri.parent.ce)return e!=="default"&&(n.name=e),Pn(),Oi(On,null,[le("slot",n,r&&r())],64);let a=t[e];a&&a._c&&(a._d=!1),Pn();const s=a&&m5(a(n)),o=n.key||s&&s.key,l=Oi(On,{key:(o&&!ao(o)?o:`_${e}`)+(!s&&r?"_fb":"")},s||(r?r():[]),s&&t._===1?64:-2);return!i&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),a&&a._c&&(a._d=!0),l}function m5(t){return t.some(e=>_f(e)?!(e.type===fi||e.type===On&&!m5(e.children)):!0)?t:null}const fv=t=>t?R5(t)?vp(t):fv(t.parent):null,rf=Or(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>fv(t.parent),$root:t=>fv(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>v5(t),$forceUpdate:t=>t.f||(t.f=()=>{y1(t.update)}),$nextTick:t=>t.n||(t.n=Wi.bind(t.proxy)),$watch:t=>UA.bind(t)}),am=(t,e)=>t!==Qn&&!t.__isScriptSetup&&Yn(t,e),xA={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:r,data:i,props:a,accessCache:s,type:o,appContext:l}=t;let u;if(e[0]!=="$"){const v=s[e];if(v!==void 0)switch(v){case 1:return r[e];case 2:return i[e];case 4:return n[e];case 3:return a[e]}else{if(am(r,e))return s[e]=1,r[e];if(i!==Qn&&Yn(i,e))return s[e]=2,i[e];if((u=t.propsOptions[0])&&Yn(u,e))return s[e]=3,a[e];if(n!==Qn&&Yn(n,e))return s[e]=4,n[e];hv&&(s[e]=0)}}const c=rf[e];let d,h;if(c)return e==="$attrs"&&di(t.attrs,"get",""),c(t);if((d=o.__cssModules)&&(d=d[e]))return d;if(n!==Qn&&Yn(n,e))return s[e]=4,n[e];if(h=l.config.globalProperties,Yn(h,e))return h[e]},set({_:t},e,n){const{data:r,setupState:i,ctx:a}=t;return am(i,e)?(i[e]=n,!0):r!==Qn&&Yn(r,e)?(r[e]=n,!0):Yn(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(a[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:i,propsOptions:a}},s){let o;return!!n[s]||t!==Qn&&Yn(t,s)||am(e,s)||(o=a[0])&&Yn(o,s)||Yn(r,s)||Yn(rf,s)||Yn(i.config.globalProperties,s)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Yn(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function o2(t){return an(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let hv=!0;function wA(t){const e=v5(t),n=t.proxy,r=t.ctx;hv=!1,e.beforeCreate&&l2(e.beforeCreate,t,"bc");const{data:i,computed:a,methods:s,watch:o,provide:l,inject:u,created:c,beforeMount:d,mounted:h,beforeUpdate:v,updated:x,activated:_,deactivated:b,beforeDestroy:S,beforeUnmount:E,destroyed:C,unmounted:A,render:D,renderTracked:O,renderTriggered:V,errorCaptured:P,serverPrefetch:U,expose:Y,inheritAttrs:fe,components:Q,directives:G,filters:re}=e;if(u&&SA(u,r,null),s)for(const $e in s){const _e=s[$e];fn(_e)&&(r[$e]=_e.bind(n))}if(i){const $e=i.call(n,n);ar($e)&&(t.data=qr($e))}if(hv=!0,a)for(const $e in a){const _e=a[$e],de=fn(_e)?_e.bind(n,n):fn(_e.get)?_e.get.bind(n,n):bs,Oe=!fn(_e)&&fn(_e.set)?_e.set.bind(n):bs,ve=Be({get:de,set:Oe});Object.defineProperty(r,$e,{enumerable:!0,configurable:!0,get:()=>ve.value,set:ie=>ve.value=ie})}if(o)for(const $e in o)g5(o[$e],r,n,$e);if(l){const $e=fn(l)?l.call(n):l;Reflect.ownKeys($e).forEach(_e=>{Lr(_e,$e[_e])})}c&&l2(c,t,"c");function ye($e,_e){an(_e)?_e.forEach(de=>$e(de.bind(n))):_e&&$e(_e.bind(n))}if(ye(Of,d),ye(ol,h),ye(pA,v),ye(b1,x),ye(l5,_),ye(u5,b),ye(yA,P),ye(vA,O),ye(gA,V),ye(sa,E),ye(d5,A),ye(mA,U),an(Y))if(Y.length){const $e=t.exposed||(t.exposed={});Y.forEach(_e=>{Object.defineProperty($e,_e,{get:()=>n[_e],set:de=>n[_e]=de,enumerable:!0})})}else t.exposed||(t.exposed={});D&&t.render===bs&&(t.render=D),fe!=null&&(t.inheritAttrs=fe),Q&&(t.components=Q),G&&(t.directives=G),U&&o5(t)}function SA(t,e,n=bs){an(t)&&(t=pv(t));for(const r in t){const i=t[r];let a;ar(i)?"default"in i?a=Fn(i.from||r,i.default,!0):a=Fn(i.from||r):a=Fn(i),lr(a)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>a.value,set:s=>a.value=s}):e[r]=a}}function l2(t,e,n){Ha(an(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function g5(t,e,n,r){let i=r.includes(".")?A5(n,r):()=>n[r];if(_r(t)){const a=e[t];fn(a)&&An(i,a)}else if(fn(t))An(i,t.bind(n));else if(ar(t))if(an(t))t.forEach(a=>g5(a,e,n,r));else{const a=fn(t.handler)?t.handler.bind(n):e[t.handler];fn(a)&&An(i,a,t)}}function v5(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:i,optionsCache:a,config:{optionMergeStrategies:s}}=t.appContext,o=a.get(e);let l;return o?l=o:!i.length&&!n&&!r?l=e:(l={},i.length&&i.forEach(u=>L0(l,u,s,!0)),L0(l,e,s)),ar(e)&&a.set(e,l),l}function L0(t,e,n,r=!1){const{mixins:i,extends:a}=e;a&&L0(t,a,n,!0),i&&i.forEach(s=>L0(t,s,n,!0));for(const s in e)if(!(r&&s==="expose")){const o=MA[s]||n&&n[s];t[s]=o?o(t[s],e[s]):e[s]}return t}const MA={data:u2,props:c2,emits:c2,methods:Gd,computed:Gd,beforeCreate:wi,created:wi,beforeMount:wi,mounted:wi,beforeUpdate:wi,updated:wi,beforeDestroy:wi,beforeUnmount:wi,destroyed:wi,unmounted:wi,activated:wi,deactivated:wi,errorCaptured:wi,serverPrefetch:wi,components:Gd,directives:Gd,watch:TA,provide:u2,inject:EA};function u2(t,e){return e?t?function(){return Or(fn(t)?t.call(this,this):t,fn(e)?e.call(this,this):e)}:e:t}function EA(t,e){return Gd(pv(t),pv(e))}function pv(t){if(an(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function wi(t,e){return t?[...new Set([].concat(t,e))]:e}function Gd(t,e){return t?Or(Object.create(null),t,e):e}function c2(t,e){return t?an(t)&&an(e)?[...new Set([...t,...e])]:Or(Object.create(null),o2(t),o2(e??{})):e}function TA(t,e){if(!t)return e;if(!e)return t;const n=Or(Object.create(null),t);for(const r in e)n[r]=wi(t[r],e[r]);return n}function y5(){return{app:null,config:{isNativeTag:_C,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let CA=0;function AA(t,e){return function(r,i=null){fn(r)||(r=Or({},r)),i!=null&&!ar(i)&&(i=null);const a=y5(),s=new WeakSet,o=[];let l=!1;const u=a.app={_uid:CA++,_component:r,_props:i,_container:null,_context:a,_instance:null,version:ok,get config(){return a.config},set config(c){},use(c,...d){return s.has(c)||(c&&fn(c.install)?(s.add(c),c.install(u,...d)):fn(c)&&(s.add(c),c(u,...d))),u},mixin(c){return a.mixins.includes(c)||a.mixins.push(c),u},component(c,d){return d?(a.components[c]=d,u):a.components[c]},directive(c,d){return d?(a.directives[c]=d,u):a.directives[c]},mount(c,d,h){if(!l){const v=u._ceVNode||le(r,i);return v.appContext=a,h===!0?h="svg":h===!1&&(h=void 0),t(v,c,h),l=!0,u._container=c,c.__vue_app__=u,vp(v.component)}},onUnmount(c){o.push(c)},unmount(){l&&(Ha(o,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(c,d){return a.provides[c]=d,u},runWithContext(c){const d=Ac;Ac=u;try{return c()}finally{Ac=d}}};return u}}let Ac=null;function Lr(t,e){if(hi){let n=hi.provides;const r=hi.parent&&hi.parent.provides;r===n&&(n=hi.provides=Object.create(r)),n[t]=e}}function Fn(t,e,n=!1){const r=Bf();if(r||Ac){let i=Ac?Ac._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return n&&fn(e)?e.call(r&&r.proxy):e}}const _5={},b5=()=>Object.create(_5),x5=t=>Object.getPrototypeOf(t)===_5;function kA(t,e,n,r=!1){const i={},a=b5();t.propsDefaults=Object.create(null),w5(t,e,i,a);for(const s in t.propsOptions[0])s in i||(i[s]=void 0);n?t.props=r?i:VS(i):t.type.props?t.props=i:t.props=a,t.attrs=a}function IA(t,e,n,r){const{props:i,attrs:a,vnode:{patchFlag:s}}=t,o=en(i),[l]=t.propsOptions;let u=!1;if((r||s>0)&&!(s&16)){if(s&8){const c=t.vnode.dynamicProps;for(let d=0;d<c.length;d++){let h=c[d];if(gp(t.emitsOptions,h))continue;const v=e[h];if(l)if(Yn(a,h))v!==a[h]&&(a[h]=v,u=!0);else{const x=Vi(h);i[x]=mv(l,o,x,v,t,!1)}else v!==a[h]&&(a[h]=v,u=!0)}}}else{w5(t,e,i,a)&&(u=!0);let c;for(const d in o)(!e||!Yn(e,d)&&((c=gu(d))===d||!Yn(e,c)))&&(l?n&&(n[d]!==void 0||n[c]!==void 0)&&(i[d]=mv(l,o,d,void 0,t,!0)):delete i[d]);if(a!==o)for(const d in a)(!e||!Yn(e,d))&&(delete a[d],u=!0)}u&&Js(t.attrs,"set","")}function w5(t,e,n,r){const[i,a]=t.propsOptions;let s=!1,o;if(e)for(let l in e){if(Jd(l))continue;const u=e[l];let c;i&&Yn(i,c=Vi(l))?!a||!a.includes(c)?n[c]=u:(o||(o={}))[c]=u:gp(t.emitsOptions,l)||(!(l in r)||u!==r[l])&&(r[l]=u,s=!0)}if(a){const l=en(n),u=o||Qn;for(let c=0;c<a.length;c++){const d=a[c];n[d]=mv(i,l,d,u[d],t,!Yn(u,d))}}return s}function mv(t,e,n,r,i,a){const s=t[n];if(s!=null){const o=Yn(s,"default");if(o&&r===void 0){const l=s.default;if(s.type!==Function&&!s.skipFactory&&fn(l)){const{propsDefaults:u}=i;if(n in u)r=u[n];else{const c=Ff(i);r=u[n]=l.call(null,e),c()}}else r=l;i.ce&&i.ce._setProp(n,r)}s[0]&&(a&&!o?r=!1:s[1]&&(r===""||r===gu(n))&&(r=!0))}return r}const $A=new WeakMap;function S5(t,e,n=!1){const r=n?$A:e.propsCache,i=r.get(t);if(i)return i;const a=t.props,s={},o=[];let l=!1;if(!fn(t)){const c=d=>{l=!0;const[h,v]=S5(d,e,!0);Or(s,h),v&&o.push(...v)};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!a&&!l)return ar(t)&&r.set(t,Sc),Sc;if(an(a))for(let c=0;c<a.length;c++){const d=Vi(a[c]);d2(d)&&(s[d]=Qn)}else if(a)for(const c in a){const d=Vi(c);if(d2(d)){const h=a[c],v=s[d]=an(h)||fn(h)?{type:h}:Or({},h),x=v.type;let _=!1,b=!0;if(an(x))for(let S=0;S<x.length;++S){const E=x[S],C=fn(E)&&E.name;if(C==="Boolean"){_=!0;break}else C==="String"&&(b=!1)}else _=fn(x)&&x.name==="Boolean";v[0]=_,v[1]=b,(_||Yn(v,"default"))&&o.push(d)}}const u=[s,o];return ar(t)&&r.set(t,u),u}function d2(t){return t[0]!=="$"&&!Jd(t)}const x1=t=>t==="_"||t==="__"||t==="_ctx"||t==="$stable",w1=t=>an(t)?t.map(vs):[vs(t)],PA=(t,e,n)=>{if(e._n)return e;const r=Ne((...i)=>w1(e(...i)),n);return r._c=!1,r},M5=(t,e,n)=>{const r=t._ctx;for(const i in t){if(x1(i))continue;const a=t[i];if(fn(a))e[i]=PA(i,a,r);else if(a!=null){const s=w1(a);e[i]=()=>s}}},E5=(t,e)=>{const n=w1(e);t.slots.default=()=>n},T5=(t,e,n)=>{for(const r in e)(n||!x1(r))&&(t[r]=e[r])},RA=(t,e,n)=>{const r=t.slots=b5();if(t.vnode.shapeFlag&32){const i=e.__;i&&ov(r,"__",i,!0);const a=e._;a?(T5(r,e,n),n&&ov(r,"_",a,!0)):M5(e,r)}else e&&E5(t,e)},DA=(t,e,n)=>{const{vnode:r,slots:i}=t;let a=!0,s=Qn;if(r.shapeFlag&32){const o=e._;o?n&&o===1?a=!1:T5(i,e,n):(a=!e.$stable,M5(e,i)),s=e}else e&&(E5(t,e),s={default:1});if(a)for(const o in i)!x1(o)&&s[o]==null&&delete i[o]},Ei=XA;function LA(t){return zA(t)}function zA(t,e){const n=cp();n.__VUE__=!0;const{insert:r,remove:i,patchProp:a,createElement:s,createText:o,createComment:l,setText:u,setElementText:c,parentNode:d,nextSibling:h,setScopeId:v=bs,insertStaticContent:x}=t,_=(ce,me,ke,Xe=null,Ze=null,We=null,gt=void 0,ht=null,vt=!!me.dynamicChildren)=>{if(ce===me)return;ce&&!jl(ce,me)&&(Xe=ge(ce),ie(ce,Ze,We,!0),ce=null),me.patchFlag===-2&&(vt=!1,me.dynamicChildren=null);const{type:ct,ref:se,shapeFlag:K}=me;switch(ct){case Nf:b(ce,me,ke,Xe);break;case fi:S(ce,me,ke,Xe);break;case om:ce==null&&E(me,ke,Xe,gt);break;case On:Q(ce,me,ke,Xe,Ze,We,gt,ht,vt);break;default:K&1?D(ce,me,ke,Xe,Ze,We,gt,ht,vt):K&6?G(ce,me,ke,Xe,Ze,We,gt,ht,vt):(K&64||K&128)&&ct.process(ce,me,ke,Xe,Ze,We,gt,ht,vt,Ge)}se!=null&&Ze?nf(se,ce&&ce.ref,We,me||ce,!me):se==null&&ce&&ce.ref!=null&&nf(ce.ref,null,We,ce,!0)},b=(ce,me,ke,Xe)=>{if(ce==null)r(me.el=o(me.children),ke,Xe);else{const Ze=me.el=ce.el;me.children!==ce.children&&u(Ze,me.children)}},S=(ce,me,ke,Xe)=>{ce==null?r(me.el=l(me.children||""),ke,Xe):me.el=ce.el},E=(ce,me,ke,Xe)=>{[ce.el,ce.anchor]=x(ce.children,me,ke,Xe,ce.el,ce.anchor)},C=({el:ce,anchor:me},ke,Xe)=>{let Ze;for(;ce&&ce!==me;)Ze=h(ce),r(ce,ke,Xe),ce=Ze;r(me,ke,Xe)},A=({el:ce,anchor:me})=>{let ke;for(;ce&&ce!==me;)ke=h(ce),i(ce),ce=ke;i(me)},D=(ce,me,ke,Xe,Ze,We,gt,ht,vt)=>{me.type==="svg"?gt="svg":me.type==="math"&&(gt="mathml"),ce==null?O(me,ke,Xe,Ze,We,gt,ht,vt):U(ce,me,Ze,We,gt,ht,vt)},O=(ce,me,ke,Xe,Ze,We,gt,ht)=>{let vt,ct;const{props:se,shapeFlag:K,transition:De,dirs:Je}=ce;if(vt=ce.el=s(ce.type,We,se&&se.is,se),K&8?c(vt,ce.children):K&16&&P(ce.children,vt,null,Xe,Ze,sm(ce,We),gt,ht),Je&&Rl(ce,null,Xe,"created"),V(vt,ce,ce.scopeId,gt,Xe),se){for(const nt in se)nt!=="value"&&!Jd(nt)&&a(vt,nt,null,se[nt],We,Xe);"value"in se&&a(vt,"value",null,se.value,We),(ct=se.onVnodeBeforeMount)&&ls(ct,Xe,ce)}Je&&Rl(ce,null,Xe,"beforeMount");const tt=OA(Ze,De);tt&&De.beforeEnter(vt),r(vt,me,ke),((ct=se&&se.onVnodeMounted)||tt||Je)&&Ei(()=>{ct&&ls(ct,Xe,ce),tt&&De.enter(vt),Je&&Rl(ce,null,Xe,"mounted")},Ze)},V=(ce,me,ke,Xe,Ze)=>{if(ke&&v(ce,ke),Xe)for(let We=0;We<Xe.length;We++)v(ce,Xe[We]);if(Ze){let We=Ze.subTree;if(me===We||I5(We.type)&&(We.ssContent===me||We.ssFallback===me)){const gt=Ze.vnode;V(ce,gt,gt.scopeId,gt.slotScopeIds,Ze.parent)}}},P=(ce,me,ke,Xe,Ze,We,gt,ht,vt=0)=>{for(let ct=vt;ct<ce.length;ct++){const se=ce[ct]=ht?qo(ce[ct]):vs(ce[ct]);_(null,se,me,ke,Xe,Ze,We,gt,ht)}},U=(ce,me,ke,Xe,Ze,We,gt)=>{const ht=me.el=ce.el;let{patchFlag:vt,dynamicChildren:ct,dirs:se}=me;vt|=ce.patchFlag&16;const K=ce.props||Qn,De=me.props||Qn;let Je;if(ke&&Dl(ke,!1),(Je=De.onVnodeBeforeUpdate)&&ls(Je,ke,me,ce),se&&Rl(me,ce,ke,"beforeUpdate"),ke&&Dl(ke,!0),(K.innerHTML&&De.innerHTML==null||K.textContent&&De.textContent==null)&&c(ht,""),ct?Y(ce.dynamicChildren,ct,ht,ke,Xe,sm(me,Ze),We):gt||_e(ce,me,ht,null,ke,Xe,sm(me,Ze),We,!1),vt>0){if(vt&16)fe(ht,K,De,ke,Ze);else if(vt&2&&K.class!==De.class&&a(ht,"class",null,De.class,Ze),vt&4&&a(ht,"style",K.style,De.style,Ze),vt&8){const tt=me.dynamicProps;for(let nt=0;nt<tt.length;nt++){const xt=tt[nt],be=K[xt],Ie=De[xt];(Ie!==be||xt==="value")&&a(ht,xt,be,Ie,Ze,ke)}}vt&1&&ce.children!==me.children&&c(ht,me.children)}else!gt&&ct==null&&fe(ht,K,De,ke,Ze);((Je=De.onVnodeUpdated)||se)&&Ei(()=>{Je&&ls(Je,ke,me,ce),se&&Rl(me,ce,ke,"updated")},Xe)},Y=(ce,me,ke,Xe,Ze,We,gt)=>{for(let ht=0;ht<me.length;ht++){const vt=ce[ht],ct=me[ht],se=vt.el&&(vt.type===On||!jl(vt,ct)||vt.shapeFlag&198)?d(vt.el):ke;_(vt,ct,se,null,Xe,Ze,We,gt,!0)}},fe=(ce,me,ke,Xe,Ze)=>{if(me!==ke){if(me!==Qn)for(const We in me)!Jd(We)&&!(We in ke)&&a(ce,We,me[We],null,Ze,Xe);for(const We in ke){if(Jd(We))continue;const gt=ke[We],ht=me[We];gt!==ht&&We!=="value"&&a(ce,We,ht,gt,Ze,Xe)}"value"in ke&&a(ce,"value",me.value,ke.value,Ze)}},Q=(ce,me,ke,Xe,Ze,We,gt,ht,vt)=>{const ct=me.el=ce?ce.el:o(""),se=me.anchor=ce?ce.anchor:o("");let{patchFlag:K,dynamicChildren:De,slotScopeIds:Je}=me;Je&&(ht=ht?ht.concat(Je):Je),ce==null?(r(ct,ke,Xe),r(se,ke,Xe),P(me.children||[],ke,se,Ze,We,gt,ht,vt)):K>0&&K&64&&De&&ce.dynamicChildren?(Y(ce.dynamicChildren,De,ke,Ze,We,gt,ht),(me.key!=null||Ze&&me===Ze.subTree)&&S1(ce,me,!0)):_e(ce,me,ke,se,Ze,We,gt,ht,vt)},G=(ce,me,ke,Xe,Ze,We,gt,ht,vt)=>{me.slotScopeIds=ht,ce==null?me.shapeFlag&512?Ze.ctx.activate(me,ke,Xe,gt,vt):re(me,ke,Xe,Ze,We,gt,vt):he(ce,me,vt)},re=(ce,me,ke,Xe,Ze,We,gt)=>{const ht=ce.component=ek(ce,Xe,Ze);if(pp(ce)&&(ht.ctx.renderer=Ge),tk(ht,!1,gt),ht.asyncDep){if(Ze&&Ze.registerDep(ht,ye,gt),!ce.el){const vt=ht.subTree=le(fi);S(null,vt,me,ke),ce.placeholder=vt.el}}else ye(ht,ce,me,ke,Ze,We,gt)},he=(ce,me,ke)=>{const Xe=me.component=ce.component;if(qA(ce,me,ke))if(Xe.asyncDep&&!Xe.asyncResolved){$e(Xe,me,ke);return}else Xe.next=me,Xe.update();else me.el=ce.el,Xe.vnode=me},ye=(ce,me,ke,Xe,Ze,We,gt)=>{const ht=()=>{if(ce.isMounted){let{next:K,bu:De,u:Je,parent:tt,vnode:nt}=ce;{const Le=C5(ce);if(Le){K&&(K.el=nt.el,$e(ce,K,gt)),Le.asyncDep.then(()=>{ce.isUnmounted||ht()});return}}let xt=K,be;Dl(ce,!1),K?(K.el=nt.el,$e(ce,K,gt)):K=nt,De&&Qp(De),(be=K.props&&K.props.onVnodeBeforeUpdate)&&ls(be,tt,K,nt),Dl(ce,!0);const Ie=h2(ce),at=ce.subTree;ce.subTree=Ie,_(at,Ie,d(at.el),ge(at),ce,Ze,We),K.el=Ie.el,xt===null&&jA(ce,Ie.el),Je&&Ei(Je,Ze),(be=K.props&&K.props.onVnodeUpdated)&&Ei(()=>ls(be,tt,K,nt),Ze)}else{let K;const{el:De,props:Je}=me,{bm:tt,m:nt,parent:xt,root:be,type:Ie}=ce,at=Cc(me);Dl(ce,!1),tt&&Qp(tt),!at&&(K=Je&&Je.onVnodeBeforeMount)&&ls(K,xt,me),Dl(ce,!0);{be.ce&&be.ce._def.shadowRoot!==!1&&be.ce._injectChildStyle(Ie);const Le=ce.subTree=h2(ce);_(null,Le,ke,Xe,ce,Ze,We),me.el=Le.el}if(nt&&Ei(nt,Ze),!at&&(K=Je&&Je.onVnodeMounted)){const Le=me;Ei(()=>ls(K,xt,Le),Ze)}(me.shapeFlag&256||xt&&Cc(xt.vnode)&&xt.vnode.shapeFlag&256)&&ce.a&&Ei(ce.a,Ze),ce.isMounted=!0,me=ke=Xe=null}};ce.scope.on();const vt=ce.effect=new AS(ht);ce.scope.off();const ct=ce.update=vt.run.bind(vt),se=ce.job=vt.runIfDirty.bind(vt);se.i=ce,se.id=ce.uid,vt.scheduler=()=>y1(se),Dl(ce,!0),ct()},$e=(ce,me,ke)=>{me.component=ce;const Xe=ce.vnode.props;ce.vnode=me,ce.next=null,IA(ce,me.props,Xe,ke),DA(ce,me.children,ke),no(),t2(ce),ro()},_e=(ce,me,ke,Xe,Ze,We,gt,ht,vt=!1)=>{const ct=ce&&ce.children,se=ce?ce.shapeFlag:0,K=me.children,{patchFlag:De,shapeFlag:Je}=me;if(De>0){if(De&128){Oe(ct,K,ke,Xe,Ze,We,gt,ht,vt);return}else if(De&256){de(ct,K,ke,Xe,Ze,We,gt,ht,vt);return}}Je&8?(se&16&&qe(ct,Ze,We),K!==ct&&c(ke,K)):se&16?Je&16?Oe(ct,K,ke,Xe,Ze,We,gt,ht,vt):qe(ct,Ze,We,!0):(se&8&&c(ke,""),Je&16&&P(K,ke,Xe,Ze,We,gt,ht,vt))},de=(ce,me,ke,Xe,Ze,We,gt,ht,vt)=>{ce=ce||Sc,me=me||Sc;const ct=ce.length,se=me.length,K=Math.min(ct,se);let De;for(De=0;De<K;De++){const Je=me[De]=vt?qo(me[De]):vs(me[De]);_(ce[De],Je,ke,null,Ze,We,gt,ht,vt)}ct>se?qe(ce,Ze,We,!0,!1,K):P(me,ke,Xe,Ze,We,gt,ht,vt,K)},Oe=(ce,me,ke,Xe,Ze,We,gt,ht,vt)=>{let ct=0;const se=me.length;let K=ce.length-1,De=se-1;for(;ct<=K&&ct<=De;){const Je=ce[ct],tt=me[ct]=vt?qo(me[ct]):vs(me[ct]);if(jl(Je,tt))_(Je,tt,ke,null,Ze,We,gt,ht,vt);else break;ct++}for(;ct<=K&&ct<=De;){const Je=ce[K],tt=me[De]=vt?qo(me[De]):vs(me[De]);if(jl(Je,tt))_(Je,tt,ke,null,Ze,We,gt,ht,vt);else break;K--,De--}if(ct>K){if(ct<=De){const Je=De+1,tt=Je<se?me[Je].el:Xe;for(;ct<=De;)_(null,me[ct]=vt?qo(me[ct]):vs(me[ct]),ke,tt,Ze,We,gt,ht,vt),ct++}}else if(ct>De)for(;ct<=K;)ie(ce[ct],Ze,We,!0),ct++;else{const Je=ct,tt=ct,nt=new Map;for(ct=tt;ct<=De;ct++){const At=me[ct]=vt?qo(me[ct]):vs(me[ct]);At.key!=null&&nt.set(At.key,ct)}let xt,be=0;const Ie=De-tt+1;let at=!1,Le=0;const kt=new Array(Ie);for(ct=0;ct<Ie;ct++)kt[ct]=0;for(ct=Je;ct<=K;ct++){const At=ce[ct];if(be>=Ie){ie(At,Ze,We,!0);continue}let Kt;if(At.key!=null)Kt=nt.get(At.key);else for(xt=tt;xt<=De;xt++)if(kt[xt-tt]===0&&jl(At,me[xt])){Kt=xt;break}Kt===void 0?ie(At,Ze,We,!0):(kt[Kt-tt]=ct+1,Kt>=Le?Le=Kt:at=!0,_(At,me[Kt],ke,null,Ze,We,gt,ht,vt),be++)}const Dt=at?NA(kt):Sc;for(xt=Dt.length-1,ct=Ie-1;ct>=0;ct--){const At=tt+ct,Kt=me[At],on=me[At+1],Mn=At+1<se?on.el||on.placeholder:Xe;kt[ct]===0?_(null,Kt,ke,Mn,Ze,We,gt,ht,vt):at&&(xt<0||ct!==Dt[xt]?ve(Kt,ke,Mn,2):xt--)}}},ve=(ce,me,ke,Xe,Ze=null)=>{const{el:We,type:gt,transition:ht,children:vt,shapeFlag:ct}=ce;if(ct&6){ve(ce.component.subTree,me,ke,Xe);return}if(ct&128){ce.suspense.move(me,ke,Xe);return}if(ct&64){gt.move(ce,me,ke,Ge);return}if(gt===On){r(We,me,ke);for(let K=0;K<vt.length;K++)ve(vt[K],me,ke,Xe);r(ce.anchor,me,ke);return}if(gt===om){C(ce,me,ke);return}if(Xe!==2&&ct&1&&ht)if(Xe===0)ht.beforeEnter(We),r(We,me,ke),Ei(()=>ht.enter(We),Ze);else{const{leave:K,delayLeave:De,afterLeave:Je}=ht,tt=()=>{ce.ctx.isUnmounted?i(We):r(We,me,ke)},nt=()=>{K(We,()=>{tt(),Je&&Je()})};De?De(We,tt,nt):nt()}else r(We,me,ke)},ie=(ce,me,ke,Xe=!1,Ze=!1)=>{const{type:We,props:gt,ref:ht,children:vt,dynamicChildren:ct,shapeFlag:se,patchFlag:K,dirs:De,cacheIndex:Je}=ce;if(K===-2&&(Ze=!1),ht!=null&&(no(),nf(ht,null,ke,ce,!0),ro()),Je!=null&&(me.renderCache[Je]=void 0),se&256){me.ctx.deactivate(ce);return}const tt=se&1&&De,nt=!Cc(ce);let xt;if(nt&&(xt=gt&&gt.onVnodeBeforeUnmount)&&ls(xt,me,ce),se&6)ne(ce.component,ke,Xe);else{if(se&128){ce.suspense.unmount(ke,Xe);return}tt&&Rl(ce,null,me,"beforeUnmount"),se&64?ce.type.remove(ce,me,ke,Ge,Xe):ct&&!ct.hasOnce&&(We!==On||K>0&&K&64)?qe(ct,me,ke,!1,!0):(We===On&&K&384||!Ze&&se&16)&&qe(vt,me,ke),Xe&&Pe(ce)}(nt&&(xt=gt&&gt.onVnodeUnmounted)||tt)&&Ei(()=>{xt&&ls(xt,me,ce),tt&&Rl(ce,null,me,"unmounted")},ke)},Pe=ce=>{const{type:me,el:ke,anchor:Xe,transition:Ze}=ce;if(me===On){et(ke,Xe);return}if(me===om){A(ce);return}const We=()=>{i(ke),Ze&&!Ze.persisted&&Ze.afterLeave&&Ze.afterLeave()};if(ce.shapeFlag&1&&Ze&&!Ze.persisted){const{leave:gt,delayLeave:ht}=Ze,vt=()=>gt(ke,We);ht?ht(ce.el,We,vt):vt()}else We()},et=(ce,me)=>{let ke;for(;ce!==me;)ke=h(ce),i(ce),ce=ke;i(me)},ne=(ce,me,ke)=>{const{bum:Xe,scope:Ze,job:We,subTree:gt,um:ht,m:vt,a:ct,parent:se,slots:{__:K}}=ce;f2(vt),f2(ct),Xe&&Qp(Xe),se&&an(K)&&K.forEach(De=>{se.renderCache[De]=void 0}),Ze.stop(),We&&(We.flags|=8,ie(gt,ce,me,ke)),ht&&Ei(ht,me),Ei(()=>{ce.isUnmounted=!0},me),me&&me.pendingBranch&&!me.isUnmounted&&ce.asyncDep&&!ce.asyncResolved&&ce.suspenseId===me.pendingId&&(me.deps--,me.deps===0&&me.resolve())},qe=(ce,me,ke,Xe=!1,Ze=!1,We=0)=>{for(let gt=We;gt<ce.length;gt++)ie(ce[gt],me,ke,Xe,Ze)},ge=ce=>{if(ce.shapeFlag&6)return ge(ce.component.subTree);if(ce.shapeFlag&128)return ce.suspense.next();const me=h(ce.anchor||ce.el),ke=me&&me[JS];return ke?h(ke):me};let xe=!1;const ze=(ce,me,ke)=>{ce==null?me._vnode&&ie(me._vnode,null,null,!0):_(me._vnode||null,ce,me,null,null,null,ke),me._vnode=ce,xe||(xe=!0,t2(),KS(),xe=!1)},Ge={p:_,um:ie,m:ve,r:Pe,mt:re,mc:P,pc:_e,pbc:Y,n:ge,o:t};return{render:ze,hydrate:void 0,createApp:AA(ze)}}function sm({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Dl({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function OA(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function S1(t,e,n=!1){const r=t.children,i=e.children;if(an(r)&&an(i))for(let a=0;a<r.length;a++){const s=r[a];let o=i[a];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[a]=qo(i[a]),o.el=s.el),!n&&o.patchFlag!==-2&&S1(s,o)),o.type===Nf&&(o.el=s.el),o.type===fi&&!o.el&&(o.el=s.el)}}function NA(t){const e=t.slice(),n=[0];let r,i,a,s,o;const l=t.length;for(r=0;r<l;r++){const u=t[r];if(u!==0){if(i=n[n.length-1],t[i]<u){e[r]=i,n.push(r);continue}for(a=0,s=n.length-1;a<s;)o=a+s>>1,t[n[o]]<u?a=o+1:s=o;u<t[n[a]]&&(a>0&&(e[r]=n[a-1]),n[a]=r)}}for(a=n.length,s=n[a-1];a-- >0;)n[a]=s,s=e[s];return n}function C5(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:C5(e)}function f2(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const BA=Symbol.for("v-scx"),FA=()=>Fn(BA);function lo(t,e){return M1(t,null,e)}function An(t,e,n){return M1(t,e,n)}function M1(t,e,n=Qn){const{immediate:r,deep:i,flush:a,once:s}=n,o=Or({},n),l=e&&r||!e&&a!=="post";let u;if(bf){if(a==="sync"){const v=FA();u=v.__watcherHandles||(v.__watcherHandles=[])}else if(!l){const v=()=>{};return v.stop=bs,v.resume=bs,v.pause=bs,v}}const c=hi;o.call=(v,x,_)=>Ha(v,c,x,_);let d=!1;a==="post"?o.scheduler=v=>{Ei(v,c&&c.suspense)}:a!=="sync"&&(d=!0,o.scheduler=(v,x)=>{x?v():y1(v)}),o.augmentJob=v=>{e&&(v.flags|=4),d&&(v.flags|=2,c&&(v.id=c.uid,v.i=c))};const h=aA(t,e,o);return bf&&(u?u.push(h):l&&h()),h}function UA(t,e,n){const r=this.proxy,i=_r(t)?t.includes(".")?A5(r,t):()=>r[t]:t.bind(r,r);let a;fn(e)?a=e:(a=e.handler,n=e);const s=Ff(this),o=M1(i,a.bind(r),n);return s(),o}function A5(t,e){const n=e.split(".");return()=>{let r=t;for(let i=0;i<n.length&&r;i++)r=r[n[i]];return r}}const VA=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Vi(e)}Modifiers`]||t[`${gu(e)}Modifiers`];function HA(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Qn;let i=n;const a=e.startsWith("update:"),s=a&&VA(r,e.slice(7));s&&(s.trim&&(i=n.map(c=>_r(c)?c.trim():c)),s.number&&(i=n.map(MC)));let o,l=r[o=Jp(e)]||r[o=Jp(Vi(e))];!l&&a&&(l=r[o=Jp(gu(e))]),l&&Ha(l,t,6,i);const u=r[o+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,Ha(u,t,6,i)}}function k5(t,e,n=!1){const r=e.emitsCache,i=r.get(t);if(i!==void 0)return i;const a=t.emits;let s={},o=!1;if(!fn(t)){const l=u=>{const c=k5(u,e,!0);c&&(o=!0,Or(s,c))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!a&&!o?(ar(t)&&r.set(t,null),null):(an(a)?a.forEach(l=>s[l]=null):Or(s,a),ar(t)&&r.set(t,s),s)}function gp(t,e){return!t||!op(e)?!1:(e=e.slice(2).replace(/Once$/,""),Yn(t,e[0].toLowerCase()+e.slice(1))||Yn(t,gu(e))||Yn(t,e))}function h2(t){const{type:e,vnode:n,proxy:r,withProxy:i,propsOptions:[a],slots:s,attrs:o,emit:l,render:u,renderCache:c,props:d,data:h,setupState:v,ctx:x,inheritAttrs:_}=t,b=D0(t);let S,E;try{if(n.shapeFlag&4){const A=i||r,D=A;S=vs(u.call(D,A,c,d,v,h,x)),E=o}else{const A=e;S=vs(A.length>1?A(d,{attrs:o,slots:s,emit:l}):A(d,null)),E=e.props?o:WA(o)}}catch(A){af.length=0,fp(A,t,1),S=le(fi)}let C=S;if(E&&_!==!1){const A=Object.keys(E),{shapeFlag:D}=C;A.length&&D&7&&(a&&A.some(l1)&&(E=GA(E,a)),C=tl(C,E,!1,!0))}return n.dirs&&(C=tl(C,null,!1,!0),C.dirs=C.dirs?C.dirs.concat(n.dirs):n.dirs),n.transition&&uu(C,n.transition),S=C,D0(b),S}const WA=t=>{let e;for(const n in t)(n==="class"||n==="style"||op(n))&&((e||(e={}))[n]=t[n]);return e},GA=(t,e)=>{const n={};for(const r in t)(!l1(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function qA(t,e,n){const{props:r,children:i,component:a}=t,{props:s,children:o,patchFlag:l}=e,u=a.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return r?p2(r,s,u):!!s;if(l&8){const c=e.dynamicProps;for(let d=0;d<c.length;d++){const h=c[d];if(s[h]!==r[h]&&!gp(u,h))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:r===s?!1:r?s?p2(r,s,u):!0:!!s;return!1}function p2(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let i=0;i<r.length;i++){const a=r[i];if(e[a]!==t[a]&&!gp(n,a))return!0}return!1}function jA({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=n,e=e.parent;else break}}const I5=t=>t.__isSuspense;function XA(t,e){e&&e.pendingBranch?an(t)?e.effects.push(...t):e.effects.push(t):lA(t)}const On=Symbol.for("v-fgt"),Nf=Symbol.for("v-txt"),fi=Symbol.for("v-cmt"),om=Symbol.for("v-stc"),af=[];let na=null;function Pn(t=!1){af.push(na=t?null:[])}function KA(){af.pop(),na=af[af.length-1]||null}let yf=1;function m2(t,e=!1){yf+=t,t<0&&na&&e&&(na.hasOnce=!0)}function $5(t){return t.dynamicChildren=yf>0?na||Sc:null,KA(),yf>0&&na&&na.push(t),t}function vr(t,e,n,r,i,a){return $5(Te(t,e,n,r,i,a,!0))}function Oi(t,e,n,r,i){return $5(le(t,e,n,r,i,!0))}function _f(t){return t?t.__v_isVNode===!0:!1}function jl(t,e){return t.type===e.type&&t.key===e.key}const P5=({key:t})=>t??null,_0=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?_r(t)||lr(t)||fn(t)?{i:ri,r:t,k:e,f:!!n}:t:null);function Te(t,e=null,n=null,r=0,i=null,a=t===On?0:1,s=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&P5(e),ref:e&&_0(e),scopeId:ZS,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:ri};return o?(E1(l,n),a&128&&t.normalize(l)):n&&(l.shapeFlag|=_r(n)?8:16),yf>0&&!s&&na&&(l.patchFlag>0||a&6)&&l.patchFlag!==32&&na.push(l),l}const le=YA;function YA(t,e=null,n=null,r=0,i=null,a=!1){if((!t||t===_A)&&(t=fi),_f(t)){const o=tl(t,e,!0);return n&&E1(o,n),yf>0&&!a&&na&&(o.shapeFlag&6?na[na.indexOf(t)]=o:na.push(o)),o.patchFlag=-2,o}if(sk(t)&&(t=t.__vccOpts),e){e=ZA(e);let{class:o,style:l}=e;o&&!_r(o)&&(e.class=Wt(o)),ar(l)&&(v1(l)&&!an(l)&&(l=Or({},l)),e.style=yn(l))}const s=_r(t)?1:I5(t)?128:QS(t)?64:ar(t)?4:fn(t)?2:0;return Te(t,e,n,r,i,s,a,!0)}function ZA(t){return t?v1(t)||x5(t)?Or({},t):t:null}function tl(t,e,n=!1,r=!1){const{props:i,ref:a,patchFlag:s,children:o,transition:l}=t,u=e?Rn(i||{},e):i,c={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&P5(u),ref:e&&e.ref?n&&a?an(a)?a.concat(_0(e)):[a,_0(e)]:_0(e):a,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==On?s===-1?16:s|16:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&tl(t.ssContent),ssFallback:t.ssFallback&&tl(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&r&&uu(c,l.clone(c)),c}function Mt(t=" ",e=0){return le(Nf,null,t,e)}function Qi(t="",e=!1){return e?(Pn(),Oi(fi,null,t)):le(fi,null,t)}function vs(t){return t==null||typeof t=="boolean"?le(fi):an(t)?le(On,null,t.slice()):_f(t)?qo(t):le(Nf,null,String(t))}function qo(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:tl(t)}function E1(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(an(e))n=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),E1(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!x5(e)?e._ctx=ri:i===3&&ri&&(ri.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else fn(e)?(e={default:e,_ctx:ri},n=32):(e=String(e),r&64?(n=16,e=[Mt(e)]):n=8);t.children=e,t.shapeFlag|=n}function Rn(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=Wt([e.class,r.class]));else if(i==="style")e.style=yn([e.style,r.style]);else if(op(i)){const a=e[i],s=r[i];s&&a!==s&&!(an(a)&&a.includes(s))&&(e[i]=a?[].concat(a,s):s)}else i!==""&&(e[i]=r[i])}return e}function ls(t,e,n,r=null){Ha(t,e,7,[n,r])}const JA=y5();let QA=0;function ek(t,e,n){const r=t.type,i=(e?e.appContext:t.appContext)||JA,a={uid:QA++,vnode:t,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new TS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:S5(r,i),emitsOptions:k5(r,i),emit:null,emitted:null,propsDefaults:Qn,inheritAttrs:r.inheritAttrs,ctx:Qn,data:Qn,props:Qn,attrs:Qn,slots:Qn,refs:Qn,setupState:Qn,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=e?e.root:a,a.emit=HA.bind(null,a),t.ce&&t.ce(a),a}let hi=null;const Bf=()=>hi||ri;let z0,gv;{const t=cp(),e=(n,r)=>{let i;return(i=t[n])||(i=t[n]=[]),i.push(r),a=>{i.length>1?i.forEach(s=>s(a)):i[0](a)}};z0=e("__VUE_INSTANCE_SETTERS__",n=>hi=n),gv=e("__VUE_SSR_SETTERS__",n=>bf=n)}const Ff=t=>{const e=hi;return z0(t),t.scope.on(),()=>{t.scope.off(),z0(e)}},g2=()=>{hi&&hi.scope.off(),z0(null)};function R5(t){return t.vnode.shapeFlag&4}let bf=!1;function tk(t,e=!1,n=!1){e&&gv(e);const{props:r,children:i}=t.vnode,a=R5(t);kA(t,r,a,e),RA(t,i,n||e);const s=a?nk(t,e):void 0;return e&&gv(!1),s}function nk(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,xA);const{setup:r}=n;if(r){no();const i=t.setupContext=r.length>1?ik(t):null,a=Ff(t),s=zf(r,t,0,[t.props,i]),o=bS(s);if(ro(),a(),(o||t.sp)&&!Cc(t)&&o5(t),o){if(s.then(g2,g2),e)return s.then(l=>{v2(t,l)}).catch(l=>{fp(l,t,0)});t.asyncDep=s}else v2(t,s)}else D5(t)}function v2(t,e,n){fn(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:ar(e)&&(t.setupState=WS(e)),D5(t)}function D5(t,e,n){const r=t.type;t.render||(t.render=r.render||bs);{const i=Ff(t);no();try{wA(t)}finally{ro(),i()}}}const rk={get(t,e){return di(t,"get",""),t[e]}};function ik(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,rk),slots:t.slots,emit:t.emit,expose:e}}function vp(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(WS(ZC(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in rf)return rf[n](t)},has(e,n){return n in e||n in rf}})):t.proxy}function ak(t,e=!0){return fn(t)?t.displayName||t.name:t.name||e&&t.__name}function sk(t){return fn(t)&&"__vccOpts"in t}const Be=(t,e)=>rA(t,e,bf);function qa(t,e,n){const r=arguments.length;return r===2?ar(e)&&!an(e)?_f(e)?le(t,null,[e]):le(t,e):le(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&_f(n)&&(n=[n]),le(t,e,n))}const ok="3.5.18";/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let vv;const y2=typeof window<"u"&&window.trustedTypes;if(y2)try{vv=y2.createPolicy("vue",{createHTML:t=>t})}catch{}const L5=vv?t=>vv.createHTML(t):t=>t,lk="http://www.w3.org/2000/svg",uk="http://www.w3.org/1998/Math/MathML",Zs=typeof document<"u"?document:null,_2=Zs&&Zs.createElement("template"),ck={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const i=e==="svg"?Zs.createElementNS(lk,t):e==="mathml"?Zs.createElementNS(uk,t):n?Zs.createElement(t,{is:n}):Zs.createElement(t);return t==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:t=>Zs.createTextNode(t),createComment:t=>Zs.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Zs.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,i,a){const s=n?n.previousSibling:e.lastChild;if(i&&(i===a||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===a||!(i=i.nextSibling)););else{_2.innerHTML=L5(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const o=_2.content;if(r==="svg"||r==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}e.insertBefore(o,n)}return[s?s.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},Ro="transition",wd="animation",Pc=Symbol("_vtc"),z5={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},O5=Or({},r5,z5),dk=t=>(t.displayName="Transition",t.props=O5,t),cu=dk((t,{slots:e})=>qa(fA,N5(t),e)),Ll=(t,e=[])=>{an(t)?t.forEach(n=>n(...e)):t&&t(...e)},b2=t=>t?an(t)?t.some(e=>e.length>1):t.length>1:!1;function N5(t){const e={};for(const Q in t)Q in z5||(e[Q]=t[Q]);if(t.css===!1)return e;const{name:n="v",type:r,duration:i,enterFromClass:a=`${n}-enter-from`,enterActiveClass:s=`${n}-enter-active`,enterToClass:o=`${n}-enter-to`,appearFromClass:l=a,appearActiveClass:u=s,appearToClass:c=o,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:h=`${n}-leave-active`,leaveToClass:v=`${n}-leave-to`}=t,x=fk(i),_=x&&x[0],b=x&&x[1],{onBeforeEnter:S,onEnter:E,onEnterCancelled:C,onLeave:A,onLeaveCancelled:D,onBeforeAppear:O=S,onAppear:V=E,onAppearCancelled:P=C}=e,U=(Q,G,re,he)=>{Q._enterCancelled=he,Vo(Q,G?c:o),Vo(Q,G?u:s),re&&re()},Y=(Q,G)=>{Q._isLeaving=!1,Vo(Q,d),Vo(Q,v),Vo(Q,h),G&&G()},fe=Q=>(G,re)=>{const he=Q?V:E,ye=()=>U(G,Q,re);Ll(he,[G,ye]),x2(()=>{Vo(G,Q?l:a),fs(G,Q?c:o),b2(he)||w2(G,r,_,ye)})};return Or(e,{onBeforeEnter(Q){Ll(S,[Q]),fs(Q,a),fs(Q,s)},onBeforeAppear(Q){Ll(O,[Q]),fs(Q,l),fs(Q,u)},onEnter:fe(!1),onAppear:fe(!0),onLeave(Q,G){Q._isLeaving=!0;const re=()=>Y(Q,G);fs(Q,d),Q._enterCancelled?(fs(Q,h),yv()):(yv(),fs(Q,h)),x2(()=>{Q._isLeaving&&(Vo(Q,d),fs(Q,v),b2(A)||w2(Q,r,b,re))}),Ll(A,[Q,re])},onEnterCancelled(Q){U(Q,!1,void 0,!0),Ll(C,[Q])},onAppearCancelled(Q){U(Q,!0,void 0,!0),Ll(P,[Q])},onLeaveCancelled(Q){Y(Q),Ll(D,[Q])}})}function fk(t){if(t==null)return null;if(ar(t))return[lm(t.enter),lm(t.leave)];{const e=lm(t);return[e,e]}}function lm(t){return EC(t)}function fs(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Pc]||(t[Pc]=new Set)).add(e)}function Vo(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.remove(r));const n=t[Pc];n&&(n.delete(e),n.size||(t[Pc]=void 0))}function x2(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let hk=0;function w2(t,e,n,r){const i=t._endId=++hk,a=()=>{i===t._endId&&r()};if(n!=null)return setTimeout(a,n);const{type:s,timeout:o,propCount:l}=B5(t,e);if(!s)return r();const u=s+"end";let c=0;const d=()=>{t.removeEventListener(u,h),a()},h=v=>{v.target===t&&++c>=l&&d()};setTimeout(()=>{c<l&&d()},o+1),t.addEventListener(u,h)}function B5(t,e){const n=window.getComputedStyle(t),r=x=>(n[x]||"").split(", "),i=r(`${Ro}Delay`),a=r(`${Ro}Duration`),s=S2(i,a),o=r(`${wd}Delay`),l=r(`${wd}Duration`),u=S2(o,l);let c=null,d=0,h=0;e===Ro?s>0&&(c=Ro,d=s,h=a.length):e===wd?u>0&&(c=wd,d=u,h=l.length):(d=Math.max(s,u),c=d>0?s>u?Ro:wd:null,h=c?c===Ro?a.length:l.length:0);const v=c===Ro&&/\b(transform|all)(,|$)/.test(r(`${Ro}Property`).toString());return{type:c,timeout:d,propCount:h,hasTransform:v}}function S2(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,r)=>M2(n)+M2(t[r])))}function M2(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function yv(){return document.body.offsetHeight}function pk(t,e,n){const r=t[Pc];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const O0=Symbol("_vod"),F5=Symbol("_vsh"),yu={beforeMount(t,{value:e},{transition:n}){t[O0]=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):Sd(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:r}){!e!=!n&&(r?e?(r.beforeEnter(t),Sd(t,!0),r.enter(t)):r.leave(t,()=>{Sd(t,!1)}):Sd(t,e))},beforeUnmount(t,{value:e}){Sd(t,e)}};function Sd(t,e){t.style.display=e?t[O0]:"none",t[F5]=!e}const mk=Symbol(""),gk=/(^|;)\s*display\s*:/;function vk(t,e,n){const r=t.style,i=_r(n);let a=!1;if(n&&!i){if(e)if(_r(e))for(const s of e.split(";")){const o=s.slice(0,s.indexOf(":")).trim();n[o]==null&&b0(r,o,"")}else for(const s in e)n[s]==null&&b0(r,s,"");for(const s in n)s==="display"&&(a=!0),b0(r,s,n[s])}else if(i){if(e!==n){const s=r[mk];s&&(n+=";"+s),r.cssText=n,a=gk.test(n)}}else e&&t.removeAttribute("style");O0 in t&&(t[O0]=a?r.display:"",t[F5]&&(r.display="none"))}const E2=/\s*!important$/;function b0(t,e,n){if(an(n))n.forEach(r=>b0(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=yk(t,e);E2.test(n)?t.setProperty(gu(r),n.replace(E2,""),"important"):t[r]=n}}const T2=["Webkit","Moz","ms"],um={};function yk(t,e){const n=um[e];if(n)return n;let r=Vi(e);if(r!=="filter"&&r in t)return um[e]=r;r=so(r);for(let i=0;i<T2.length;i++){const a=T2[i]+r;if(a in t)return um[e]=a}return e}const C2="http://www.w3.org/1999/xlink";function A2(t,e,n,r,i,a=$C(e)){r&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(C2,e.slice(6,e.length)):t.setAttributeNS(C2,e,n):n==null||a&&!SS(n)?t.removeAttribute(e):t.setAttribute(e,a?"":ao(n)?String(n):n)}function k2(t,e,n,r,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?L5(n):n);return}const a=t.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){const o=a==="OPTION"?t.getAttribute("value")||"":t.value,l=n==null?t.type==="checkbox"?"on":"":String(n);(o!==l||!("_value"in t))&&(t.value=l),n==null&&t.removeAttribute(e),t._value=n;return}let s=!1;if(n===""||n==null){const o=typeof t[e];o==="boolean"?n=SS(n):n==null&&o==="string"?(n="",s=!0):o==="number"&&(n=0,s=!0)}try{t[e]=n}catch{}s&&t.removeAttribute(i||e)}function _k(t,e,n,r){t.addEventListener(e,n,r)}function bk(t,e,n,r){t.removeEventListener(e,n,r)}const I2=Symbol("_vei");function xk(t,e,n,r,i=null){const a=t[I2]||(t[I2]={}),s=a[e];if(r&&s)s.value=r;else{const[o,l]=wk(e);if(r){const u=a[e]=Ek(r,i);_k(t,o,u,l)}else s&&(bk(t,o,s,l),a[e]=void 0)}}const $2=/(?:Once|Passive|Capture)$/;function wk(t){let e;if($2.test(t)){e={};let r;for(;r=t.match($2);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):gu(t.slice(2)),e]}let cm=0;const Sk=Promise.resolve(),Mk=()=>cm||(Sk.then(()=>cm=0),cm=Date.now());function Ek(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Ha(Tk(r,n.value),e,5,[r])};return n.value=t,n.attached=Mk(),n}function Tk(t,e){if(an(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const P2=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Ck=(t,e,n,r,i,a)=>{const s=i==="svg";e==="class"?pk(t,r,s):e==="style"?vk(t,n,r):op(e)?l1(e)||xk(t,e,n,r,a):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Ak(t,e,r,s))?(k2(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&A2(t,e,r,s,a,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!_r(r))?k2(t,Vi(e),r,a,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),A2(t,e,r,s))};function Ak(t,e,n,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&P2(e)&&fn(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return P2(e)&&_r(n)?!1:e in t}const U5=new WeakMap,V5=new WeakMap,N0=Symbol("_moveCb"),R2=Symbol("_enterCb"),kk=t=>(delete t.props.mode,t),Ik=kk({name:"TransitionGroup",props:Or({},O5,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=Bf(),r=n5();let i,a;return b1(()=>{if(!i.length)return;const s=t.moveClass||`${t.name||"v"}-move`;if(!Dk(i[0].el,n.vnode.el,s)){i=[];return}i.forEach($k),i.forEach(Pk);const o=i.filter(Rk);yv(),o.forEach(l=>{const u=l.el,c=u.style;fs(u,s),c.transform=c.webkitTransform=c.transitionDuration="";const d=u[N0]=h=>{h&&h.target!==u||(!h||/transform$/.test(h.propertyName))&&(u.removeEventListener("transitionend",d),u[N0]=null,Vo(u,s))};u.addEventListener("transitionend",d)}),i=[]}),()=>{const s=en(t),o=N5(s);let l=s.tag||On;if(i=[],a)for(let u=0;u<a.length;u++){const c=a[u];c.el&&c.el instanceof Element&&(i.push(c),uu(c,vf(c,o,r,n)),U5.set(c,c.el.getBoundingClientRect()))}a=e.default?_1(e.default()):[];for(let u=0;u<a.length;u++){const c=a[u];c.key!=null&&uu(c,vf(c,o,r,n))}return le(l,null,a)}}}),T1=Ik;function $k(t){const e=t.el;e[N0]&&e[N0](),e[R2]&&e[R2]()}function Pk(t){V5.set(t,t.el.getBoundingClientRect())}function Rk(t){const e=U5.get(t),n=V5.get(t),r=e.left-n.left,i=e.top-n.top;if(r||i){const a=t.el.style;return a.transform=a.webkitTransform=`translate(${r}px,${i}px)`,a.transitionDuration="0s",t}}function Dk(t,e,n){const r=t.cloneNode(),i=t[Pc];i&&i.forEach(o=>{o.split(/\s+/).forEach(l=>l&&r.classList.remove(l))}),n.split(/\s+/).forEach(o=>o&&r.classList.add(o)),r.style.display="none";const a=e.nodeType===1?e:e.parentNode;a.appendChild(r);const{hasTransform:s}=B5(r);return a.removeChild(r),s}const Lk=Or({patchProp:Ck},ck);let D2;function zk(){return D2||(D2=LA(Lk))}const Ok=(...t)=>{const e=zk().createApp(...t),{mount:n}=e;return e.mount=r=>{const i=Bk(r);if(!i)return;const a=e._component;!fn(a)&&!a.render&&!a.template&&(a.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const s=n(i,!1,Nk(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),s},e};function Nk(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Bk(t){return _r(t)?document.querySelector(t):t}function du(t,e){let n;function r(){n=hf(),n.run(()=>e.length?e(()=>{n==null||n.stop(),r()}):e())}An(t,i=>{i&&!n?r():i||(n==null||n.stop(),n=void 0)},{immediate:!0}),Pi(()=>{n==null||n.stop()})}const er=typeof window<"u",C1=er&&"IntersectionObserver"in window,Fk=er&&("ontouchstart"in window||window.navigator.maxTouchPoints>0),Uk=er&&"matchMedia"in window&&typeof window.matchMedia=="function";function L2(t,e,n){Vk(t,e),e.set(t,n)}function Vk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z2(t,e,n){return t.set(H5(t,e),n),n}function Hs(t,e){return t.get(H5(t,e))}function H5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function W5(t,e,n){const r=e.length-1;if(r<0)return t===void 0?n:t;for(let i=0;i<r;i++){if(t==null)return n;t=t[e[i]]}return t==null||t[e[r]]===void 0?n:t[e[r]]}function iu(t,e){if(t===e)return!0;if(t instanceof Date&&e instanceof Date&&t.getTime()!==e.getTime()||t!==Object(t)||e!==Object(e))return!1;const n=Object.keys(t);return n.length!==Object.keys(e).length?!1:n.every(r=>iu(t[r],e[r]))}function _v(t,e,n){return t==null||!e||typeof e!="string"?n:t[e]!==void 0?t[e]:(e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,""),W5(t,e.split("."),n))}function Md(t,e,n){if(e===!0)return t===void 0?n:t;if(e==null||typeof e=="boolean")return n;if(t!==Object(t)){if(typeof e!="function")return n;const i=e(t,n);return typeof i>"u"?n:i}if(typeof e=="string")return _v(t,e,n);if(Array.isArray(e))return W5(t,e,n);if(typeof e!="function")return n;const r=e(t,n);return typeof r>"u"?n:r}function A1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:t},(n,r)=>e+r)}function nn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(t==null||t==="")return;const n=Number(t);return isNaN(n)?String(t):isFinite(n)?`${n}${e}`:void 0}function B0(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function O2(t){let e;return t!==null&&typeof t=="object"&&((e=Object.getPrototypeOf(t))===Object.prototype||e===null)}function G5(t){if(t&&"$el"in t){const e=t.$el;return(e==null?void 0:e.nodeType)===Node.TEXT_NODE?e.nextElementSibling:e}return t}const Hk=Object.freeze({enter:"Enter",tab:"Tab",delete:"Delete",esc:"Escape",space:"Space",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",end:"End",home:"Home",del:"Delete",backspace:"Backspace",insert:"Insert",pageup:"PageUp",pagedown:"PageDown",shift:"Shift"});function q5(t){return Object.keys(t)}function dm(t,e){return e.every(n=>t.hasOwnProperty(n))}function j5(t,e){const n={};for(const r of e)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function N2(t,e,n){const r=Object.create(null),i=Object.create(null);for(const a in t)e.some(s=>s instanceof RegExp?s.test(a):s===a)?r[a]=t[a]:i[a]=t[a];return[r,i]}function Hc(t,e){const n={...t};return e.forEach(r=>delete n[r]),n}const X5=/^on[^a-z]/,K5=t=>X5.test(t),Wk=["onAfterscriptexecute","onAnimationcancel","onAnimationend","onAnimationiteration","onAnimationstart","onAuxclick","onBeforeinput","onBeforescriptexecute","onChange","onClick","onCompositionend","onCompositionstart","onCompositionupdate","onContextmenu","onCopy","onCut","onDblclick","onFocusin","onFocusout","onFullscreenchange","onFullscreenerror","onGesturechange","onGestureend","onGesturestart","onGotpointercapture","onInput","onKeydown","onKeypress","onKeyup","onLostpointercapture","onMousedown","onMousemove","onMouseout","onMouseover","onMouseup","onMousewheel","onPaste","onPointercancel","onPointerdown","onPointerenter","onPointerleave","onPointermove","onPointerout","onPointerover","onPointerup","onReset","onSelect","onSubmit","onTouchcancel","onTouchend","onTouchmove","onTouchstart","onTransitioncancel","onTransitionend","onTransitionrun","onTransitionstart","onWheel"];function Y5(t){const[e,n]=N2(t,[X5]),r=Hc(e,Wk),[i,a]=N2(n,["class","style","id",/^data-/]);return Object.assign(i,e),Object.assign(a,r),[i,a]}function xs(t){return t==null?[]:Array.isArray(t)?t:[t]}function Wa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(e,Math.min(n,t))}function B2(t){const e=t.toString().trim();return e.includes(".")?e.length-e.indexOf(".")-1:0}function F2(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return t+n.repeat(Math.max(0,e-t.length))}function U2(t,e){return(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0").repeat(Math.max(0,e-t.length))+t}function Gk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const n=[];let r=0;for(;r<t.length;)n.push(t.substr(r,e)),r+=e;return n}function pi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r={};for(const i in t)r[i]=t[i];for(const i in e){const a=t[i],s=e[i];if(O2(a)&&O2(s)){r[i]=pi(a,s,n);continue}if(n&&Array.isArray(a)&&Array.isArray(s)){r[i]=n(a,s);continue}r[i]=s}return r}function Z5(t){return t.map(e=>e.type===On?Z5(e.children):e).flat()}function au(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(au.cache.has(t))return au.cache.get(t);const e=t.replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase();return au.cache.set(t,e),e}au.cache=new Map;function yc(t,e){if(!e||typeof e!="object")return[];if(Array.isArray(e))return e.map(n=>yc(t,n)).flat(1);if(e.suspense)return yc(t,e.ssContent);if(Array.isArray(e.children))return e.children.map(n=>yc(t,n)).flat(1);if(e.component){if(Object.getOwnPropertySymbols(e.component.provides).includes(t))return[e.component];if(e.component.subTree)return yc(t,e.component.subTree).flat(1)}return[]}var Xu=new WeakMap,zl=new WeakMap;class qk{constructor(e){L2(this,Xu,[]),L2(this,zl,0),this.size=e}get isFull(){return Hs(Xu,this).length===this.size}push(e){Hs(Xu,this)[Hs(zl,this)]=e,z2(zl,this,(Hs(zl,this)+1)%this.size)}values(){return Hs(Xu,this).slice(Hs(zl,this)).concat(Hs(Xu,this).slice(0,Hs(zl,this)))}clear(){Hs(Xu,this).length=0,z2(zl,this,0)}}function k1(t){const e=qr({});lo(()=>{const r=t();for(const i in r)e[i]=r[i]},{flush:"sync"});const n={};for(const r in e)n[r]=dt(()=>e[r]);return n}function F0(t,e){return t.includes(e)}function J5(t){return t[2].toLowerCase()+t.slice(3)}const to=()=>[Function,Array];function V2(t,e){return e="on"+so(e),!!(t[e]||t[`${e}Once`]||t[`${e}Capture`]||t[`${e}OnceCapture`]||t[`${e}CaptureOnce`])}function jk(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if(Array.isArray(t))for(const i of t)i(...n);else typeof t=="function"&&t(...n)}function I1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=["button","[href]",'input:not([type="hidden"])',"select","textarea","[tabindex]"].map(r=>`${r}${e?':not([tabindex="-1"])':""}:not([disabled])`).join(", ");return[...t.querySelectorAll(n)]}function Xk(t,e,n){let r,i=t.indexOf(document.activeElement);const a=e==="next"?1:-1;do i+=a,r=t[i];while((!r||r.offsetParent==null)&&i<t.length&&i>=0);return r}function Q5(t,e){var r,i,a,s;const n=I1(t);if(e==null)(t===document.activeElement||!t.contains(document.activeElement))&&((r=n[0])==null||r.focus());else if(e==="first")(i=n[0])==null||i.focus();else if(e==="last")(a=n.at(-1))==null||a.focus();else if(typeof e=="number")(s=n[e])==null||s.focus();else{const o=Xk(n,e);o?o.focus():Q5(t,e==="next"?"first":"last")}}function e6(t,e){if(!(er&&typeof CSS<"u"&&typeof CSS.supports<"u"&&CSS.supports(`selector(${e})`)))return null;try{return!!t&&t.matches(e)}catch{return null}}function Kk(t,e){if(!er||t===0)return e(),()=>{};const n=window.setTimeout(e,t);return()=>window.clearTimeout(n)}function bv(){const t=rn(),e=n=>{t.value=n};return Object.defineProperty(e,"value",{enumerable:!0,get:()=>t.value,set:n=>t.value=n}),Object.defineProperty(e,"el",{enumerable:!0,get:()=>G5(t.value)}),e}function H2(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="bigint"}function Yk(t){const e=["checked","disabled"];return Object.fromEntries(Object.entries(t).filter(n=>{let[r,i]=n;return e.includes(r)?!!i:i!==void 0}))}const t6=["top","bottom"],Zk=["start","end","left","right"];function xv(t,e){let[n,r]=t.split(" ");return r||(r=F0(t6,n)?"start":F0(Zk,n)?"top":"center"),{side:W2(n,e),align:W2(r,e)}}function W2(t,e){return t==="start"?e?"right":"left":t==="end"?e?"left":"right":t}function fm(t){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[t.side],align:t.align}}function hm(t){return{side:t.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[t.align]}}function G2(t){return{side:t.align,align:t.side}}function q2(t){return F0(t6,t.side)?"y":"x"}class ws{constructor(e){let{x:n,y:r,width:i,height:a}=e;this.x=n,this.y=r,this.width=i,this.height=a}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function j2(t,e){return{x:{before:Math.max(0,e.left-t.left),after:Math.max(0,t.right-e.right)},y:{before:Math.max(0,e.top-t.top),after:Math.max(0,t.bottom-e.bottom)}}}function n6(t){return Array.isArray(t)?new ws({x:t[0],y:t[1],width:0,height:0}):t.getBoundingClientRect()}function Jk(t){if(t===document.documentElement)return visualViewport?new ws({x:visualViewport.scale>1?0:visualViewport.offsetLeft,y:visualViewport.scale>1?0:visualViewport.offsetTop,width:visualViewport.width*visualViewport.scale,height:visualViewport.height*visualViewport.scale}):new ws({x:0,y:0,width:document.documentElement.clientWidth,height:document.documentElement.clientHeight});{const e=t.getBoundingClientRect();return new ws({x:e.x,y:e.y,width:t.clientWidth,height:t.clientHeight})}}function r6(t){const e=t.getBoundingClientRect(),n=getComputedStyle(t),r=n.transform;if(r){let i,a,s,o,l;if(r.startsWith("matrix3d("))i=r.slice(9,-1).split(/, /),a=Number(i[0]),s=Number(i[5]),o=Number(i[12]),l=Number(i[13]);else if(r.startsWith("matrix("))i=r.slice(7,-1).split(/, /),a=Number(i[0]),s=Number(i[3]),o=Number(i[4]),l=Number(i[5]);else return new ws(e);const u=n.transformOrigin,c=e.x-o-(1-a)*parseFloat(u),d=e.y-l-(1-s)*parseFloat(u.slice(u.indexOf(" ")+1)),h=a?e.width/a:t.offsetWidth+1,v=s?e.height/s:t.offsetHeight+1;return new ws({x:c,y:d,width:h,height:v})}else return new ws(e)}function _c(t,e,n){if(typeof t.animate>"u")return{finished:Promise.resolve()};let r;try{r=t.animate(e,n)}catch{return{finished:Promise.resolve()}}return typeof r.finished>"u"&&(r.finished=new Promise(i=>{r.onfinish=()=>{i(r)}})),r}const x0=new WeakMap;function Qk(t,e){Object.keys(e).forEach(n=>{if(K5(n)){const r=J5(n),i=x0.get(t);if(e[n]==null)i==null||i.forEach(a=>{const[s,o]=a;s===r&&(t.removeEventListener(r,o),i.delete(a))});else if(!i||![...i].some(a=>a[0]===r&&a[1]===e[n])){t.addEventListener(r,e[n]);const a=i||new Set;a.add([r,e[n]]),x0.has(t)||x0.set(t,a)}}else e[n]==null?t.removeAttribute(n):t.setAttribute(n,e[n])})}function e9(t,e){Object.keys(e).forEach(n=>{if(K5(n)){const r=J5(n),i=x0.get(t);i==null||i.forEach(a=>{const[s,o]=a;s===r&&(t.removeEventListener(r,o),i.delete(a))})}else t.removeAttribute(n)})}const Ku=2.4,X2=.2126729,K2=.7151522,Y2=.072175,t9=.55,n9=.58,r9=.57,i9=.62,Ph=.03,Z2=1.45,a9=5e-4,s9=1.25,o9=1.25,J2=.078,Q2=12.82051282051282,Rh=.06,e_=.001;function t_(t,e){const n=(t.r/255)**Ku,r=(t.g/255)**Ku,i=(t.b/255)**Ku,a=(e.r/255)**Ku,s=(e.g/255)**Ku,o=(e.b/255)**Ku;let l=n*X2+r*K2+i*Y2,u=a*X2+s*K2+o*Y2;if(l<=Ph&&(l+=(Ph-l)**Z2),u<=Ph&&(u+=(Ph-u)**Z2),Math.abs(u-l)<a9)return 0;let c;if(u>l){const d=(u**t9-l**n9)*s9;c=d<e_?0:d<J2?d-d*Q2*Rh:d-Rh}else{const d=(u**i9-l**r9)*o9;c=d>-e_?0:d>-J2?d-d*Q2*Rh:d+Rh}return c*100}function i6(t,e){e=Array.isArray(e)?e.slice(0,-1).map(n=>`'${n}'`).join(", ")+` or '${e.at(-1)}'`:`'${e}'`}const U0=.20689655172413793,l9=t=>t>U0**3?Math.cbrt(t):t/(3*U0**2)+4/29,u9=t=>t>U0?t**3:3*U0**2*(t-4/29);function a6(t){const e=l9,n=e(t[1]);return[116*n-16,500*(e(t[0]/.95047)-n),200*(n-e(t[2]/1.08883))]}function s6(t){const e=u9,n=(t[0]+16)/116;return[e(n+t[1]/500)*.95047,e(n),e(n-t[2]/200)*1.08883]}const c9=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],d9=t=>t<=.0031308?t*12.92:1.055*t**(1/2.4)-.055,f9=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],h9=t=>t<=.04045?t/12.92:((t+.055)/1.055)**2.4;function o6(t){const e=Array(3),n=d9,r=c9;for(let i=0;i<3;++i)e[i]=Math.round(Wa(n(r[i][0]*t[0]+r[i][1]*t[1]+r[i][2]*t[2]))*255);return{r:e[0],g:e[1],b:e[2]}}function $1(t){let{r:e,g:n,b:r}=t;const i=[0,0,0],a=h9,s=f9;e=a(e/255),n=a(n/255),r=a(r/255);for(let o=0;o<3;++o)i[o]=s[o][0]*e+s[o][1]*n+s[o][2]*r;return i}function wv(t){return!!t&&/^(#|var\(--|(rgb|hsl)a?\()/.test(t)}function p9(t){return wv(t)&&!/^((rgb|hsl)a?\()?var\(--/.test(t)}const n_=/^(?<fn>(?:rgb|hsl)a?)\((?<values>.+)\)/,m9={rgb:(t,e,n,r)=>({r:t,g:e,b:n,a:r}),rgba:(t,e,n,r)=>({r:t,g:e,b:n,a:r}),hsl:(t,e,n,r)=>r_({h:t,s:e,l:n,a:r}),hsla:(t,e,n,r)=>r_({h:t,s:e,l:n,a:r}),hsv:(t,e,n,r)=>xf({h:t,s:e,v:n,a:r}),hsva:(t,e,n,r)=>xf({h:t,s:e,v:n,a:r})};function _s(t){if(typeof t=="number")return{r:(t&16711680)>>16,g:(t&65280)>>8,b:t&255};if(typeof t=="string"&&n_.test(t)){const{groups:e}=t.match(n_),{fn:n,values:r}=e,i=r.split(/,\s*|\s*\/\s*|\s+/).map((a,s)=>a.endsWith("%")||s>0&&s<3&&["hsl","hsla","hsv","hsva"].includes(n)?parseFloat(a)/100:parseFloat(a));return m9[n](...i)}else if(typeof t=="string"){let e=t.startsWith("#")?t.slice(1):t;return[3,4].includes(e.length)?e=e.split("").map(n=>n+n).join(""):[6,8].includes(e.length),v9(e)}else if(typeof t=="object"){if(dm(t,["r","g","b"]))return t;if(dm(t,["h","s","l"]))return xf(l6(t));if(dm(t,["h","s","v"]))return xf(t)}throw new TypeError(`Invalid color: ${t==null?t:String(t)||t.constructor.name}
Expected #hex, #hexa, rgb(), rgba(), hsl(), hsla(), object or number`)}function xf(t){const{h:e,s:n,v:r,a:i}=t,a=o=>{const l=(o+e/60)%6;return r-r*n*Math.max(Math.min(l,4-l,1),0)},s=[a(5),a(3),a(1)].map(o=>Math.round(o*255));return{r:s[0],g:s[1],b:s[2],a:i}}function r_(t){return xf(l6(t))}function l6(t){const{h:e,s:n,l:r,a:i}=t,a=r+n*Math.min(r,1-r),s=a===0?0:2-2*r/a;return{h:e,s,v:a,a:i}}function Dh(t){const e=Math.round(t).toString(16);return("00".substr(0,2-e.length)+e).toUpperCase()}function g9(t){let{r:e,g:n,b:r,a:i}=t;return`#${[Dh(e),Dh(n),Dh(r),i!==void 0?Dh(Math.round(i*255)):""].join("")}`}function v9(t){t=y9(t);let[e,n,r,i]=Gk(t,2).map(a=>parseInt(a,16));return i=i===void 0?i:i/255,{r:e,g:n,b:r,a:i}}function y9(t){return t.startsWith("#")&&(t=t.slice(1)),t=t.replace(/([^0-9a-f])/gi,"F"),(t.length===3||t.length===4)&&(t=t.split("").map(e=>e+e).join("")),t.length!==6&&(t=F2(F2(t,6),8,"F")),t}function _9(t,e){const n=a6($1(t));return n[0]=n[0]+e*10,o6(s6(n))}function b9(t,e){const n=a6($1(t));return n[0]=n[0]-e*10,o6(s6(n))}function x9(t){const e=_s(t);return $1(e)[1]}function u6(t){const e=Math.abs(t_(_s(0),_s(t)));return Math.abs(t_(_s(16777215),_s(t)))>Math.min(e,50)?"#fff":"#000"}function Et(t,e){return n=>Object.keys(t).reduce((r,i)=>{const s=typeof t[i]=="object"&&t[i]!=null&&!Array.isArray(t[i])?t[i]:{type:t[i]};return n&&i in n?r[i]={...s,default:n[i]}:r[i]=s,e&&!r[i].source&&(r[i].source=e),r},{})}const In=Et({class:[String,Array,Object],style:{type:[String,Array,Object],default:null}},"component");function kr(t,e){const n=Bf();if(!n)throw new Error(`[Vuetify] ${t} must be called from inside a setup function`);return n}function Cs(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const e=kr(t).type;return au((e==null?void 0:e.aliasName)||(e==null?void 0:e.name))}function w9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:kr("injectSelf");const{provides:n}=e;if(n&&t in n)return n[t]}const Rc=Symbol.for("vuetify:defaults");function S9(t){return cn(t)}function P1(){const t=Fn(Rc);if(!t)throw new Error("[Vuetify] Could not find defaults instance");return t}function Wc(t,e){const n=P1(),r=cn(t),i=Be(()=>{if(ki(e==null?void 0:e.disabled))return n.value;const s=ki(e==null?void 0:e.scoped),o=ki(e==null?void 0:e.reset),l=ki(e==null?void 0:e.root);if(r.value==null&&!(s||o||l))return n.value;let u=pi(r.value,{prev:n.value});if(s)return u;if(o||l){const c=Number(o||1/0);for(let d=0;d<=c&&!(!u||!("prev"in u));d++)u=u.prev;return u&&typeof l=="string"&&l in u&&(u=pi(pi(u,{prev:u}),u[l])),u}return u.prev?pi(u.prev,u):u});return Lr(Rc,i),i}function M9(t,e){return t.props&&(typeof t.props[e]<"u"||typeof t.props[au(e)]<"u")}function E9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:P1();const r=kr("useDefaults");if(e=e??r.type.name??r.type.__name,!e)throw new Error("[Vuetify] Could not determine component name");const i=Be(()=>{var l;return(l=n.value)==null?void 0:l[t._as??e]}),a=new Proxy(t,{get(l,u){var v,x,_,b;const c=Reflect.get(l,u);if(u==="class"||u==="style")return[(v=i.value)==null?void 0:v[u],c].filter(S=>S!=null);if(M9(r.vnode,u))return c;const d=(x=i.value)==null?void 0:x[u];if(d!==void 0)return d;const h=(b=(_=n.value)==null?void 0:_.global)==null?void 0:b[u];return h!==void 0?h:c}}),s=rn();lo(()=>{if(i.value){const l=Object.entries(i.value).filter(u=>{let[c]=u;return c.startsWith(c[0].toUpperCase())});s.value=l.length?Object.fromEntries(l):void 0}else s.value=void 0});function o(){const l=w9(Rc,r);Lr(Rc,Be(()=>s.value?pi((l==null?void 0:l.value)??{},s.value):l==null?void 0:l.value))}return{props:a,provideSubDefaults:o}}function Gc(t){if(t._setup=t._setup??t.setup,!t.name)return t;if(t._setup){t.props=Et(t.props??{},t.name)();const e=Object.keys(t.props).filter(n=>n!=="class"&&n!=="style");t.filterProps=function(r){return j5(r,e)},t.props._as=String,t.setup=function(r,i){const a=P1();if(!a.value)return t._setup(r,i);const{props:s,provideSubDefaults:o}=E9(r,r._as??t.name,a),l=t._setup(s,i);return o(),l}}return t}function Jt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return e=>(t?Gc:hp)(e)}function R1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",n=arguments.length>2?arguments[2]:void 0;return Jt()({name:n??so(Vi(t.replace(/__/g,"-"))),props:{tag:{type:String,default:e},...In()},setup(r,i){let{slots:a}=i;return()=>{var s;return qa(r.tag,{class:[t,r.class],style:r.style},(s=a.default)==null?void 0:s.call(a))}}})}function c6(t){if(typeof t.getRootNode!="function"){for(;t.parentNode;)t=t.parentNode;return t!==document?null:document}const e=t.getRootNode();return e!==document&&e.getRootNode({composed:!0})!==document?null:e}const V0="cubic-bezier(0.4, 0, 0.2, 1)",T9="cubic-bezier(0.0, 0, 0.2, 1)",C9="cubic-bezier(0.4, 0, 1, 1)",A9={linear:t=>t,easeInQuad:t=>t**2,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t**2:-1+(4-2*t)*t,easeInCubic:t=>t**3,easeOutCubic:t=>--t**3+1,easeInOutCubic:t=>t<.5?4*t**3:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t**4,easeOutQuart:t=>1- --t**4,easeInOutQuart:t=>t<.5?8*t**4:1-8*--t**4,easeInQuint:t=>t**5,easeOutQuint:t=>1+--t**5,easeInOutQuint:t=>t<.5?16*t**5:1+16*--t**5};function k9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(;t;){if(e?I9(t):D1(t))return t;t=t.parentElement}return document.scrollingElement}function H0(t,e){const n=[];if(e&&t&&!e.contains(t))return n;for(;t&&(D1(t)&&n.push(t),t!==e);)t=t.parentElement;return n}function D1(t){if(!t||t.nodeType!==Node.ELEMENT_NODE)return!1;const e=window.getComputedStyle(t);return e.overflowY==="scroll"||e.overflowY==="auto"&&t.scrollHeight>t.clientHeight}function I9(t){if(!t||t.nodeType!==Node.ELEMENT_NODE)return!1;const e=window.getComputedStyle(t);return["scroll","auto"].includes(e.overflowY)}function $9(t){for(;t;){if(window.getComputedStyle(t).position==="fixed")return!0;t=t.offsetParent}return!1}function vn(t){const e=kr("useRender");e.render=t}function jr(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:d=>d,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:d=>d;const a=kr("useProxiedModel"),s=cn(t[e]!==void 0?t[e]:n),o=au(e),u=Be(o!==e?()=>{var d,h,v,x;return t[e],!!(((d=a.vnode.props)!=null&&d.hasOwnProperty(e)||(h=a.vnode.props)!=null&&h.hasOwnProperty(o))&&((v=a.vnode.props)!=null&&v.hasOwnProperty(`onUpdate:${e}`)||(x=a.vnode.props)!=null&&x.hasOwnProperty(`onUpdate:${o}`)))}:()=>{var d,h;return t[e],!!((d=a.vnode.props)!=null&&d.hasOwnProperty(e)&&((h=a.vnode.props)!=null&&h.hasOwnProperty(`onUpdate:${e}`)))});du(()=>!u.value,()=>{An(()=>t[e],d=>{s.value=d})});const c=Be({get(){const d=t[e];return r(u.value?d:s.value)},set(d){const h=i(d),v=en(u.value?t[e]:s.value);v===h||r(v)===d||(s.value=h,a==null||a.emit(`update:${e}`,h))}});return Object.defineProperty(c,"externalValue",{get:()=>u.value?t[e]:s.value}),c}const P9={badge:"Badge",open:"Open",close:"Close",dismiss:"Dismiss",confirmEdit:{ok:"OK",cancel:"Cancel"},dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},dateRangeInput:{divider:"to"},datePicker:{itemsSelected:"{0} selected",range:{title:"Select dates",header:"Enter dates"},title:"Select date",header:"Enter date",input:{placeholder:"Enter date"},ariaLabel:{previousMonth:"Previous month",nextMonth:"Next month",selectYear:"Select year",selectDate:"{0}",currentDate:"Today, {0}"}},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more",today:"Today"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action",otp:"Please enter OTP character {0}"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},fileUpload:{title:"Drag and drop files here",divider:"or",browse:"Browse Files"},timePicker:{am:"AM",pm:"PM",title:"Select Time"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Go to page {0}",currentPage:"Page {0}, Current page",first:"First page",last:"Last page"}},stepper:{next:"Next",prev:"Previous"},rating:{ariaLabel:{item:"Rating {0} of {1}"}},loading:"Loading...",infiniteScroll:{loadMore:"Load more",empty:"No more"},rules:{required:"This field is required",email:"Please enter a valid email",number:"This field can only contain numbers",integer:"This field can only contain integer values",capital:"This field can only contain uppercase letters",maxLength:"You must enter a maximum of {0} characters",minLength:"You must enter a minimum of {0} characters",strictLength:"The length of the entered field is invalid",exclude:"The {0} character is not allowed",notEmpty:"Please choose at least one value",pattern:"Invalid format"},hotkey:{then:"then",ctrl:"Ctrl",command:"Command",space:"Space",shift:"Shift",alt:"Alt",enter:"Enter",escape:"Escape",upArrow:"Up Arrow",downArrow:"Down Arrow",leftArrow:"Left Arrow",rightArrow:"Right Arrow",backspace:"Backspace",option:"Option",plus:"plus",shortcut:"Keyboard shortcut: {0}"},video:{play:"Play",pause:"Pause",seek:"Seek",volume:"Volume",showVolume:"Show volume control",mute:"Mute",unmute:"Unmute",enterFullscreen:"Full screen",exitFullscreen:"Exit full screen"}},i_="$vuetify.",a_=(t,e)=>t.replace(/\{(\d+)\}/g,(n,r)=>String(e[Number(r)])),d6=(t,e,n)=>function(r){for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];if(!r.startsWith(i_))return a_(r,a);const o=r.replace(i_,""),l=t.value&&n.value[t.value],u=e.value&&n.value[e.value];let c=_v(l,o,null);return c||(`${r}${t.value}`,c=_v(u,o,null)),c||(c=r),typeof c!="string"&&(c=r),a_(c,a)};function L1(t,e){return(n,r)=>new Intl.NumberFormat([t.value,e.value],r).format(n)}function f6(t,e){return L1(t,e)(.1).includes(",")?",":"."}function pm(t,e,n){const r=jr(t,e,t[e]??n.value);return r.value=t[e]??n.value,An(n,i=>{t[e]==null&&(r.value=n.value)}),r}function h6(t){return e=>{const n=pm(e,"locale",t.current),r=pm(e,"fallback",t.fallback),i=pm(e,"messages",t.messages);return{name:"vuetify",current:n,fallback:r,messages:i,decimalSeparator:dt(()=>f6(n,r)),t:d6(n,r,i),n:L1(n,r),provide:h6({current:n,fallback:r,messages:i})}}}function R9(t){const e=rn((t==null?void 0:t.locale)??"en"),n=rn((t==null?void 0:t.fallback)??"en"),r=cn({en:P9,...t==null?void 0:t.messages});return{name:"vuetify",current:e,fallback:n,messages:r,decimalSeparator:dt(()=>(t==null?void 0:t.decimalSeparator)??f6(e,n)),t:d6(e,n,r),n:L1(e,n),provide:h6({current:e,fallback:n,messages:r})}}const W0=Symbol.for("vuetify:locale");function D9(t){return t.name!=null}function L9(t){const e=t!=null&&t.adapter&&D9(t==null?void 0:t.adapter)?t==null?void 0:t.adapter:R9(t),n=O9(e,t);return{...e,...n}}function p6(){const t=Fn(W0);if(!t)throw new Error("[Vuetify] Could not find injected locale instance");return t}function z9(){return{af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!0,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,km:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1}}function O9(t,e){const n=cn((e==null?void 0:e.rtl)??z9()),r=Be(()=>n.value[t.current.value]??!1);return{isRtl:r,rtl:n,rtlClasses:dt(()=>`v-locale--is-${r.value?"rtl":"ltr"}`)}}function Sa(){const t=Fn(W0);if(!t)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:t.isRtl,rtlClasses:t.rtlClasses}}function Uf(t){const e=t.slice(-2).toUpperCase();switch(!0){case t==="GB-alt-variant":return{firstDay:0,firstWeekSize:4};case t==="001":return{firstDay:1,firstWeekSize:1};case`AG AS BD BR BS BT BW BZ CA CO DM DO ET GT GU HK HN ID IL IN JM JP KE
    KH KR LA MH MM MO MT MX MZ NI NP PA PE PH PK PR PY SA SG SV TH TT TW UM US
    VE VI WS YE ZA ZW`.includes(e):return{firstDay:0,firstWeekSize:1};case`AI AL AM AR AU AZ BA BM BN BY CL CM CN CR CY EC GE HR KG KZ LB LK LV
    MD ME MK MN MY NZ RO RS SI TJ TM TR UA UY UZ VN XK`.includes(e):return{firstDay:1,firstWeekSize:1};case`AD AN AT AX BE BG CH CZ DE DK EE ES FI FJ FO FR GB GF GP GR HU IE IS
    IT LI LT LU MC MQ NL NO PL RE RU SE SK SM VA`.includes(e):return{firstDay:1,firstWeekSize:4};case"AE AF BH DJ DZ EG IQ IR JO KW LY OM QA SD SY".includes(e):return{firstDay:6,firstWeekSize:1};case e==="MV":return{firstDay:5,firstWeekSize:1};case e==="PT":return{firstDay:0,firstWeekSize:4};default:return null}}function N9(t,e,n){var c;const r=[];let i=[];const a=m6(t),s=g6(t),o=n??((c=Uf(e))==null?void 0:c.firstDay)??0,l=(a.getDay()-o+7)%7,u=(s.getDay()-o+7)%7;for(let d=0;d<l;d++){const h=new Date(a);h.setDate(h.getDate()-(l-d)),i.push(h)}for(let d=1;d<=s.getDate();d++){const h=new Date(t.getFullYear(),t.getMonth(),d);i.push(h),i.length===7&&(r.push(i),i=[])}for(let d=1;d<7-u;d++){const h=new Date(s);h.setDate(h.getDate()+d),i.push(h)}return i.length>0&&r.push(i),r}function Sv(t,e,n){var a;let r=(n??((a=Uf(e))==null?void 0:a.firstDay)??0)%7;[0,1,2,3,4,5,6].includes(r)||(r=0);const i=new Date(t);for(;i.getDay()!==r;)i.setDate(i.getDate()-1);return i}function B9(t,e){var i;const n=new Date(t),r=((((i=Uf(e))==null?void 0:i.firstDay)??0)+6)%7;for(;n.getDay()!==r;)n.setDate(n.getDate()+1);return n}function m6(t){return new Date(t.getFullYear(),t.getMonth(),1)}function g6(t){return new Date(t.getFullYear(),t.getMonth()+1,0)}function F9(t){const e=t.split("-").map(Number);return new Date(e[0],e[1]-1,e[2])}const U9=/^([12]\d{3}-([1-9]|0[1-9]|1[0-2])-([1-9]|0[1-9]|[12]\d|3[01]))$/;function v6(t){if(t==null)return new Date;if(t instanceof Date)return t;if(typeof t=="string"){let e;if(U9.test(t))return F9(t);if(e=Date.parse(t),!isNaN(e))return new Date(e)}return null}const s_=new Date(2e3,0,2);function V9(t,e,n){var i;const r=e??((i=Uf(t))==null?void 0:i.firstDay)??0;return A1(7).map(a=>{const s=new Date(s_);return s.setDate(s_.getDate()+r+a),new Intl.DateTimeFormat(t,{weekday:n??"narrow"}).format(s)})}function H9(t,e,n,r){const i=v6(t)??new Date,a=r==null?void 0:r[e];if(typeof a=="function")return a(i,e,n);let s={};switch(e){case"fullDate":s={year:"numeric",month:"short",day:"numeric"};break;case"fullDateWithWeekday":s={weekday:"long",year:"numeric",month:"long",day:"numeric"};break;case"normalDate":const o=i.getDate(),l=new Intl.DateTimeFormat(n,{month:"long"}).format(i);return`${o} ${l}`;case"normalDateWithWeekday":s={weekday:"short",day:"numeric",month:"short"};break;case"shortDate":s={month:"short",day:"numeric"};break;case"year":s={year:"numeric"};break;case"month":s={month:"long"};break;case"monthShort":s={month:"short"};break;case"monthAndYear":s={month:"long",year:"numeric"};break;case"monthAndDate":s={month:"long",day:"numeric"};break;case"weekday":s={weekday:"long"};break;case"weekdayShort":s={weekday:"short"};break;case"dayOfMonth":return new Intl.NumberFormat(n).format(i.getDate());case"hours12h":s={hour:"numeric",hour12:!0};break;case"hours24h":s={hour:"numeric",hour12:!1};break;case"minutes":s={minute:"numeric"};break;case"seconds":s={second:"numeric"};break;case"fullTime":s={hour:"numeric",minute:"numeric"};break;case"fullTime12h":s={hour:"numeric",minute:"numeric",hour12:!0};break;case"fullTime24h":s={hour:"numeric",minute:"numeric",hour12:!1};break;case"fullDateTime":s={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"};break;case"fullDateTime12h":s={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0};break;case"fullDateTime24h":s={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!1};break;case"keyboardDate":s={year:"numeric",month:"2-digit",day:"2-digit"};break;case"keyboardDateTime":return s={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric"},new Intl.DateTimeFormat(n,s).format(i).replace(/, /g," ");case"keyboardDateTime12h":return s={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!0},new Intl.DateTimeFormat(n,s).format(i).replace(/, /g," ");case"keyboardDateTime24h":return s={year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!1},new Intl.DateTimeFormat(n,s).format(i).replace(/, /g," ");default:s=a??{timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(n,s).format(i)}function W9(t,e){const n=t.toJsDate(e),r=n.getFullYear(),i=U2(String(n.getMonth()+1),2,"0"),a=U2(String(n.getDate()),2,"0");return`${r}-${i}-${a}`}function G9(t){const[e,n,r]=t.split("-").map(Number);return new Date(e,n-1,r)}function q9(t,e){const n=new Date(t);return n.setMinutes(n.getMinutes()+e),n}function j9(t,e){const n=new Date(t);return n.setHours(n.getHours()+e),n}function w0(t,e){const n=new Date(t);return n.setDate(n.getDate()+e),n}function X9(t,e){const n=new Date(t);return n.setDate(n.getDate()+e*7),n}function K9(t,e){const n=new Date(t);return n.setDate(1),n.setMonth(n.getMonth()+e),n}function Mv(t){return t.getFullYear()}function Y9(t){return t.getMonth()}function Z9(t,e,n,r){const i=Uf(e),a=n??(i==null?void 0:i.firstDay)??0,s=r??(i==null?void 0:i.firstWeekSize)??1;function o(v){const x=new Date(v,0,1);return 7-Ev(x,Sv(x,e,a),"days")}let l=Mv(t);const u=w0(Sv(t,e,a),6);l<Mv(u)&&o(l+1)>=s&&l++;const c=new Date(l,0,1),d=o(l),h=d>=s?w0(c,d-7):w0(c,d);return 1+Ev(y6(t),q0(h),"weeks")}function J9(t){return t.getDate()}function Q9(t){return new Date(t.getFullYear(),t.getMonth()+1,1)}function eI(t){return new Date(t.getFullYear(),t.getMonth()-1,1)}function tI(t){return t.getHours()}function nI(t){return t.getMinutes()}function rI(t){return new Date(t.getFullYear(),0,1)}function iI(t){return new Date(t.getFullYear(),11,31)}function aI(t,e){return G0(t,e[0])&&lI(t,e[1])}function sI(t){const e=new Date(t);return e instanceof Date&&!isNaN(e.getTime())}function G0(t,e){return t.getTime()>e.getTime()}function oI(t,e){return G0(q0(t),q0(e))}function lI(t,e){return t.getTime()<e.getTime()}function o_(t,e){return t.getTime()===e.getTime()}function uI(t,e){return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}function cI(t,e){return t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}function dI(t,e){return t.getFullYear()===e.getFullYear()}function Ev(t,e,n){const r=new Date(t),i=new Date(e);switch(n){case"years":return r.getFullYear()-i.getFullYear();case"quarters":return Math.floor((r.getMonth()-i.getMonth()+(r.getFullYear()-i.getFullYear())*12)/4);case"months":return r.getMonth()-i.getMonth()+(r.getFullYear()-i.getFullYear())*12;case"weeks":return Math.floor((r.getTime()-i.getTime())/(1e3*60*60*24*7));case"days":return Math.floor((r.getTime()-i.getTime())/(1e3*60*60*24));case"hours":return Math.floor((r.getTime()-i.getTime())/(1e3*60*60));case"minutes":return Math.floor((r.getTime()-i.getTime())/(1e3*60));case"seconds":return Math.floor((r.getTime()-i.getTime())/1e3);default:return r.getTime()-i.getTime()}}function fI(t,e){const n=new Date(t);return n.setHours(e),n}function hI(t,e){const n=new Date(t);return n.setMinutes(e),n}function pI(t,e){const n=new Date(t);return n.setMonth(e),n}function mI(t,e){const n=new Date(t);return n.setDate(e),n}function gI(t,e){const n=new Date(t);return n.setFullYear(e),n}function q0(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)}function y6(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)}class vI{constructor(e){this.locale=e.locale,this.formats=e.formats}date(e){return v6(e)}toJsDate(e){return e}toISO(e){return W9(this,e)}parseISO(e){return G9(e)}addMinutes(e,n){return q9(e,n)}addHours(e,n){return j9(e,n)}addDays(e,n){return w0(e,n)}addWeeks(e,n){return X9(e,n)}addMonths(e,n){return K9(e,n)}getWeekArray(e,n){const r=n!==void 0?Number(n):void 0;return N9(e,this.locale,r)}startOfWeek(e,n){const r=n!==void 0?Number(n):void 0;return Sv(e,this.locale,r)}endOfWeek(e){return B9(e,this.locale)}startOfMonth(e){return m6(e)}endOfMonth(e){return g6(e)}format(e,n){return H9(e,n,this.locale,this.formats)}isEqual(e,n){return o_(e,n)}isValid(e){return sI(e)}isWithinRange(e,n){return aI(e,n)}isAfter(e,n){return G0(e,n)}isAfterDay(e,n){return oI(e,n)}isBefore(e,n){return!G0(e,n)&&!o_(e,n)}isSameDay(e,n){return uI(e,n)}isSameMonth(e,n){return cI(e,n)}isSameYear(e,n){return dI(e,n)}setMinutes(e,n){return hI(e,n)}setHours(e,n){return fI(e,n)}setMonth(e,n){return pI(e,n)}setDate(e,n){return mI(e,n)}setYear(e,n){return gI(e,n)}getDiff(e,n,r){return Ev(e,n,r)}getWeekdays(e,n){const r=e!==void 0?Number(e):void 0;return V9(this.locale,r,n)}getYear(e){return Mv(e)}getMonth(e){return Y9(e)}getWeek(e,n,r){const i=n!==void 0?Number(n):void 0;return Z9(e,this.locale,i,r)}getDate(e){return J9(e)}getNextMonth(e){return Q9(e)}getPreviousMonth(e){return eI(e)}getHours(e){return tI(e)}getMinutes(e){return nI(e)}startOfDay(e){return q0(e)}endOfDay(e){return y6(e)}startOfYear(e){return rI(e)}endOfYear(e){return iI(e)}}const yI=Symbol.for("vuetify:date-options"),l_=Symbol.for("vuetify:date-adapter");function _I(t,e){const n=pi({adapter:vI,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"cs-CZ",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"no-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},t);return{options:n,instance:bI(n,e)}}function bI(t,e){const n=qr(typeof t.adapter=="function"?new t.adapter({locale:t.locale[e.current.value]??e.current.value,formats:t.formats}):t.adapter);return An(e.current,r=>{n.locale=t.locale[r]??r??n.locale}),n}const yp=["sm","md","lg","xl","xxl"],Tv=Symbol.for("vuetify:display"),u_={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},xI=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u_;return pi(u_,t)};function c_(t){return er&&!t?window.innerWidth:typeof t=="object"&&t.clientWidth||0}function d_(t){return er&&!t?window.innerHeight:typeof t=="object"&&t.clientHeight||0}function f_(t){const e=er&&!t?window.navigator.userAgent:"ssr";function n(x){return!!e.match(x)}const r=n(/android/i),i=n(/iphone|ipad|ipod/i),a=n(/cordova/i),s=n(/electron/i),o=n(/chrome/i),l=n(/edge/i),u=n(/firefox/i),c=n(/opera/i),d=n(/win/i),h=n(/mac/i),v=n(/linux/i);return{android:r,ios:i,cordova:a,electron:s,chrome:o,edge:l,firefox:u,opera:c,win:d,mac:h,linux:v,touch:Fk,ssr:e==="ssr"}}function wI(t,e){const{thresholds:n,mobileBreakpoint:r}=xI(t),i=rn(d_(e)),a=rn(f_(e)),s=qr({}),o=rn(c_(e));function l(){i.value=d_(),o.value=c_()}function u(){l(),a.value=f_()}return lo(()=>{const c=o.value<n.sm,d=o.value<n.md&&!c,h=o.value<n.lg&&!(d||c),v=o.value<n.xl&&!(h||d||c),x=o.value<n.xxl&&!(v||h||d||c),_=o.value>=n.xxl,b=c?"xs":d?"sm":h?"md":v?"lg":x?"xl":"xxl",S=typeof r=="number"?r:n[r],E=o.value<S;s.xs=c,s.sm=d,s.md=h,s.lg=v,s.xl=x,s.xxl=_,s.smAndUp=!c,s.mdAndUp=!(c||d),s.lgAndUp=!(c||d||h),s.xlAndUp=!(c||d||h||v),s.smAndDown=!(h||v||x||_),s.mdAndDown=!(v||x||_),s.lgAndDown=!(x||_),s.xlAndDown=!_,s.name=b,s.height=i.value,s.width=o.value,s.mobile=E,s.mobileBreakpoint=r,s.platform=a.value,s.thresholds=n}),er&&(window.addEventListener("resize",l,{passive:!0}),Pi(()=>{window.removeEventListener("resize",l)},!0)),{...GS(s),update:u,ssr:!!e}}const SI=Et({mobile:{type:Boolean,default:!1},mobileBreakpoint:[Number,String]},"display");function _6(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{mobile:null},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs();const n=Fn(Tv);if(!n)throw new Error("Could not find Vuetify display injection");const r=Be(()=>t.mobile?!0:typeof t.mobileBreakpoint=="number"?n.width.value<t.mobileBreakpoint:t.mobileBreakpoint?n.width.value<n.thresholds.value[t.mobileBreakpoint]:t.mobile===null?n.mobile.value:!1),i=dt(()=>e?{[`${e}--mobile`]:r.value}:{});return{...n,displayClasses:i,mobile:r}}const b6=Symbol.for("vuetify:goto");function x6(){return{container:void 0,duration:300,layout:!1,offset:0,easing:"easeInOutCubic",patterns:A9}}function MI(t){return z1(t)??(document.scrollingElement||document.body)}function z1(t){return typeof t=="string"?document.querySelector(t):G5(t)}function mm(t,e,n){if(typeof t=="number")return e&&n?-t:t;let r=z1(t),i=0;for(;r;)i+=e?r.offsetLeft:r.offsetTop,r=r.offsetParent;return i}function EI(t,e){return{rtl:e.isRtl,options:pi(x6(),t)}}async function h_(t,e,n,r){const i=n?"scrollLeft":"scrollTop",a=pi((r==null?void 0:r.options)??x6(),e),s=r==null?void 0:r.rtl.value,o=(typeof t=="number"?t:z1(t))??0,l=a.container==="parent"&&o instanceof HTMLElement?o.parentElement:MI(a.container),u=typeof a.easing=="function"?a.easing:a.patterns[a.easing];if(!u)throw new TypeError(`Easing function "${a.easing}" not found.`);let c;if(typeof o=="number")c=mm(o,n,s);else if(c=mm(o,n,s)-mm(l,n,s),a.layout){const x=window.getComputedStyle(o).getPropertyValue("--v-layout-top");x&&(c-=parseInt(x,10))}c+=a.offset,c=CI(l,c,!!s,!!n);const d=l[i]??0;if(c===d)return Promise.resolve(c);const h=performance.now();return new Promise(v=>requestAnimationFrame(function x(_){const S=(_-h)/a.duration,E=Math.floor(d+(c-d)*u(Wa(S,0,1)));if(l[i]=E,S>=1&&Math.abs(E-l[i])<10)return v(c);if(S>2)return v(l[i]);requestAnimationFrame(x)}))}function TI(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=Fn(b6),{isRtl:n}=Sa();if(!e)throw new Error("[Vuetify] Could not find injected goto instance");const r={...e,rtl:dt(()=>e.rtl.value||n.value)};async function i(a,s){return h_(a,pi(t,s),!1,r)}return i.horizontal=async(a,s)=>h_(a,pi(t,s),!0,r),i}function CI(t,e,n,r){const{scrollWidth:i,scrollHeight:a}=t,[s,o]=t===document.scrollingElement?[window.innerWidth,window.innerHeight]:[t.offsetWidth,t.offsetHeight];let l,u;return r?n?(l=-(i-s),u=0):(l=0,u=i-s):(l=0,u=a+-o),Wa(e,l,u)}const AI={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sortAsc:"mdi-arrow-up",sortDesc:"mdi-arrow-down",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus",calendar:"mdi-calendar",treeviewCollapse:"mdi-menu-down",treeviewExpand:"mdi-menu-right",eyeDropper:"mdi-eyedropper",upload:"mdi-cloud-upload",color:"mdi-palette",command:"mdi-apple-keyboard-command",ctrl:"mdi-apple-keyboard-control",space:"mdi-keyboard-space",shift:"mdi-apple-keyboard-shift",alt:"mdi-apple-keyboard-option",enter:"mdi-keyboard-return",arrowup:"mdi-arrow-up",arrowdown:"mdi-arrow-down",arrowleft:"mdi-arrow-left",arrowright:"mdi-arrow-right",backspace:"mdi-backspace",play:"mdi-play",pause:"mdi-pause",fullscreen:"mdi-fullscreen",fullscreenExit:"mdi-fullscreen-exit",volumeHigh:"mdi-volume-high",volumeMedium:"mdi-volume-medium",volumeLow:"mdi-volume-low",volumeOff:"mdi-volume-variant-off"},kI={component:t=>qa(S6,{...t,class:"mdi"})},pr=[String,Function,Object,Array],Cv=Symbol.for("vuetify:icons"),_p=Et({icon:{type:pr},tag:{type:[String,Object,Function],required:!0}},"icon"),p_=Jt()({name:"VComponentIcon",props:_p(),setup(t,e){let{slots:n}=e;return()=>{const r=t.icon;return le(t.tag,null,{default:()=>{var i;return[t.icon?le(r,null,null):(i=n.default)==null?void 0:i.call(n)]}})}}}),w6=Gc({name:"VSvgIcon",inheritAttrs:!1,props:_p(),setup(t,e){let{attrs:n}=e;return()=>le(t.tag,Rn(n,{style:null}),{default:()=>[Te("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[Array.isArray(t.icon)?t.icon.map(r=>Array.isArray(r)?Te("path",{d:r[0],"fill-opacity":r[1]},null):Te("path",{d:r},null)):Te("path",{d:t.icon},null)])]})}});Gc({name:"VLigatureIcon",props:_p(),setup(t){return()=>le(t.tag,null,{default:()=>[t.icon]})}});const S6=Gc({name:"VClassIcon",props:_p(),setup(t){return()=>le(t.tag,{class:Wt(t.icon)},null)}});function II(){return{svg:{component:w6},class:{component:S6}}}function $I(t){const e=II(),n=(t==null?void 0:t.defaultSet)??"mdi";return n==="mdi"&&!e.mdi&&(e.mdi=kI),pi({defaultSet:n,sets:e,aliases:{...AI,vuetify:["M8.2241 14.2009L12 21L22 3H14.4459L8.2241 14.2009Z",["M7.26303 12.4733L7.00113 12L2 3H12.5261C12.5261 3 12.5261 3 12.5261 3L7.26303 12.4733Z",.6]],"vuetify-outline":"svg:M7.26 12.47 12.53 3H2L7.26 12.47ZM14.45 3 8.22 14.2 12 21 22 3H14.45ZM18.6 5 12 16.88 10.51 14.2 15.62 5ZM7.26 8.35 5.4 5H9.13L7.26 8.35Z","vuetify-play":["m6.376 13.184-4.11-7.192C1.505 4.66 2.467 3 4.003 3h8.532l-.953 1.576-.006.01-.396.677c-.429.732-.214 1.507.194 2.015.404.503 1.092.878 1.869.806a3.72 3.72 0 0 1 1.005.022c.276.053.434.143.523.237.138.146.38.635-.25 2.09-.893 1.63-1.553 1.722-1.847 1.677-.213-.033-.468-.158-.756-.406a4.95 4.95 0 0 1-.8-.927c-.39-.564-1.04-.84-1.66-.846-.625-.006-1.316.27-1.693.921l-.478.826-.911 1.506Z",["M9.093 11.552c.046-.079.144-.15.32-.148a.53.53 0 0 1 .43.207c.285.414.636.847 1.046 1.2.405.35.914.662 1.516.754 1.334.205 2.502-.698 3.48-2.495l.014-.028.013-.03c.687-1.574.774-2.852-.005-3.675-.37-.391-.861-.586-1.333-.676a5.243 5.243 0 0 0-1.447-.044c-.173.016-.393-.073-.54-.257-.145-.18-.127-.316-.082-.392l.393-.672L14.287 3h5.71c1.536 0 2.499 1.659 1.737 2.992l-7.997 13.996c-.768 1.344-2.706 1.344-3.473 0l-3.037-5.314 1.377-2.278.004-.006.004-.007.481-.831Z",.6]]}},t)}const PI=t=>{const e=Fn(Cv);if(!e)throw new Error("Missing Vuetify Icons provide!");return{iconData:Be(()=>{var l;const r=Ms(t);if(!r)return{component:p_};let i=r;if(typeof i=="string"&&(i=i.trim(),i.startsWith("$")&&(i=(l=e.aliases)==null?void 0:l[i.slice(1)])),Array.isArray(i))return{component:w6,icon:i};if(typeof i!="string")return{component:p_,icon:i};const a=Object.keys(e.sets).find(u=>typeof i=="string"&&i.startsWith(`${u}:`)),s=a?i.slice(a.length+1):i;return{component:e.sets[a??e.defaultSet].component,icon:s}})}},wf=Symbol.for("vuetify:theme"),Kr=Et({theme:String},"theme");function m_(){return{defaultTheme:"light",prefix:"v-",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-bright":"#FFFFFF","surface-light":"#EEEEEE","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#1867C0","primary-darken-1":"#1F5592",secondary:"#48A9A6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#EEEEEE","theme-on-kbd":"#000000","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-bright":"#ccbfd6","surface-light":"#424242","surface-variant":"#c8c8c8","on-surface-variant":"#000000",primary:"#2196F3","primary-darken-1":"#277CC1",secondary:"#54B6B2","secondary-darken-1":"#48A9A6",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":1,"medium-emphasis-opacity":.7,"disabled-opacity":.5,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#424242","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}},stylesheetId:"vuetify-theme-stylesheet",scoped:!1,unimportant:!1,utilities:!0}}function RI(){var r,i;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m_();const e=m_();if(!t)return{...e,isDisabled:!0};const n={};for(const[a,s]of Object.entries(t.themes??{})){const o=s.dark||a==="dark"?(r=e.themes)==null?void 0:r.dark:(i=e.themes)==null?void 0:i.light;n[a]=pi(o,s)}return pi(e,{...t,themes:n})}function Ol(t,e,n,r){t.push(`${OI(e,r)} {
`,...n.map(i=>`  ${i};
`),`}
`)}function g_(t,e){const n=t.dark?2:1,r=t.dark?1:2,i=[];for(const[a,s]of Object.entries(t.colors)){const o=_s(s);i.push(`--${e}theme-${a}: ${o.r},${o.g},${o.b}`),a.startsWith("on-")||i.push(`--${e}theme-${a}-overlay-multiplier: ${x9(s)>.18?n:r}`)}for(const[a,s]of Object.entries(t.variables)){const o=typeof s=="string"&&s.startsWith("#")?_s(s):void 0,l=o?`${o.r}, ${o.g}, ${o.b}`:void 0;i.push(`--${e}${a}: ${l??s}`)}return i}function DI(t,e,n){const r={};if(n)for(const i of["lighten","darken"]){const a=i==="lighten"?_9:b9;for(const s of A1(n[i],1))r[`${t}-${i}-${s}`]=g9(a(_s(e),s))}return r}function LI(t,e){if(!e)return{};let n={};for(const r of e.colors){const i=t[r];i&&(n={...n,...DI(r,i,e)})}return n}function zI(t){const e={};for(const n of Object.keys(t)){if(n.startsWith("on-")||t[`on-${n}`])continue;const r=`on-${n}`,i=_s(t[n]);e[r]=u6(i)}return e}function OI(t,e){if(!e)return t;const n=`:where(${e})`;return t===":root"?n:`${n} ${t}`}function NI(t,e,n){const r=BI(t,e);r&&(r.innerHTML=n)}function BI(t,e){if(!er)return null;let n=document.getElementById(t);return n||(n=document.createElement("style"),n.id=t,n.type="text/css",e&&n.setAttribute("nonce",e),document.head.appendChild(n)),n}function FI(t){const e=RI(t),n=rn(e.defaultTheme),r=cn(e.themes),i=rn("light"),a=Be({get(){return n.value==="system"?i.value:n.value},set(S){n.value=S}}),s=Be(()=>{const S={};for(const[E,C]of Object.entries(r.value)){const A={...C.colors,...LI(C.colors,e.variations)};S[E]={...C,colors:{...A,...zI(A)}}}return S}),o=dt(()=>s.value[a.value]),l=dt(()=>n.value==="system"),u=Be(()=>{var A;const S=[],E=e.unimportant?"":" !important",C=e.scoped?e.prefix:"";(A=o.value)!=null&&A.dark&&Ol(S,":root",["color-scheme: dark"],e.scope),Ol(S,":root",g_(o.value,e.prefix),e.scope);for(const[D,O]of Object.entries(s.value))Ol(S,`.${e.prefix}theme--${D}`,[`color-scheme: ${O.dark?"dark":"normal"}`,...g_(O,e.prefix)],e.scope);if(e.utilities){const D=[],O=[],V=new Set(Object.values(s.value).flatMap(P=>Object.keys(P.colors)));for(const P of V)P.startsWith("on-")?Ol(O,`.${P}`,[`color: rgb(var(--${e.prefix}theme-${P}))${E}`],e.scope):(Ol(D,`.${C}bg-${P}`,[`--${e.prefix}theme-overlay-multiplier: var(--${e.prefix}theme-${P}-overlay-multiplier)`,`background-color: rgb(var(--${e.prefix}theme-${P}))${E}`,`color: rgb(var(--${e.prefix}theme-on-${P}))${E}`],e.scope),Ol(O,`.${C}text-${P}`,[`color: rgb(var(--${e.prefix}theme-${P}))${E}`],e.scope),Ol(O,`.${C}border-${P}`,[`--${e.prefix}border-color: var(--${e.prefix}theme-${P})`],e.scope));S.push(...D,...O)}return S.map((D,O)=>O===0?D:`    ${D}`).join("")}),c=dt(()=>e.isDisabled?void 0:`${e.prefix}theme--${a.value}`),d=dt(()=>Object.keys(s.value));if(Uk){let E=function(){i.value=S.matches?"dark":"light"};const S=window.matchMedia("(prefers-color-scheme: dark)");E(),S.addEventListener("change",E,{passive:!0}),CS()&&Pi(()=>{S.removeEventListener("change",E)})}function h(S){if(e.isDisabled)return;const E=S._context.provides.usehead;if(E){let C=function(){return{style:[{textContent:u.value,id:e.stylesheetId,nonce:e.cspNonce||!1}]}};if(E.push){const A=E.push(C);er&&An(u,()=>{A.patch(C)})}else er?(E.addHeadObjs(dt(C)),lo(()=>E.updateDOM())):E.addHeadObjs(C())}else{let C=function(){NI(e.stylesheetId,e.cspNonce,u.value)};er?An(u,C,{immediate:!0}):C()}}function v(S){S!=="system"&&!d.value.includes(S)||(a.value=S)}function x(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:d.value;const E=S.indexOf(a.value),C=E===-1?0:(E+1)%S.length;v(S[C])}function _(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["light","dark"];x(S)}const b=new Proxy(a,{get(S,E){return Reflect.get(S,E)},set(S,E,C){return E==="value"&&i6(`theme.global.name.value = ${C}`,`theme.change('${C}')`),Reflect.set(S,E,C)}});return{install:h,change:v,cycle:x,toggle:_,isDisabled:e.isDisabled,isSystem:l,name:a,themes:r,current:o,computedThemes:s,prefix:e.prefix,themeClasses:c,styles:u,global:{name:b,current:o}}}function Ri(t){kr("provideTheme");const e=Fn(wf,null);if(!e)throw new Error("Could not find Vuetify theme injection");const n=dt(()=>t.theme??e.name.value),r=dt(()=>e.themes.value[n.value]),i=dt(()=>e.isDisabled?void 0:`${e.prefix}theme--${n.value}`),a={...e,name:n,current:r,themeClasses:i};return Lr(wf,a),a}function UI(){kr("useTheme");const t=Fn(wf,null);if(!t)throw new Error("Could not find Vuetify theme injection");return t}function Sf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"content";const n=bv(),r=cn();if(er){const i=new ResizeObserver(a=>{t==null||t(a,i),a.length&&(e==="content"?r.value=a[0].contentRect:r.value=a[0].target.getBoundingClientRect())});sa(()=>{i.disconnect()}),An(()=>n.el,(a,s)=>{s&&(i.unobserve(s),r.value=void 0),a&&i.observe(a)},{flush:"post"})}return{resizeRef:n,contentRect:Lf(r)}}const j0=Symbol.for("vuetify:layout"),M6=Symbol.for("vuetify:layout-item"),v_=1e3,VI=Et({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),HI=Et({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function WI(){const t=Fn(j0);if(!t)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:t.getLayoutItem,mainRect:t.mainRect,mainStyles:t.mainStyles}}function GI(t){const e=Fn(j0);if(!e)throw new Error("[Vuetify] Could not find injected layout");const n=t.id??`layout-item-${vu()}`,r=kr("useLayoutItem");Lr(M6,{id:n});const i=rn(!1);u5(()=>i.value=!0),l5(()=>i.value=!1);const{layoutItemStyles:a,layoutItemScrimStyles:s}=e.register(r,{...t,active:Be(()=>i.value?!1:t.active.value),id:n});return sa(()=>e.unregister(n)),{layoutItemStyles:a,layoutRect:e.layoutRect,layoutItemScrimStyles:s}}const qI=(t,e,n,r)=>{let i={top:0,left:0,right:0,bottom:0};const a=[{id:"",layer:{...i}}];for(const s of t){const o=e.get(s),l=n.get(s),u=r.get(s);if(!o||!l||!u)continue;const c={...i,[o.value]:parseInt(i[o.value],10)+(u.value?parseInt(l.value,10):0)};a.push({id:s,layer:c}),i=c}return a};function jI(t){const e=Fn(j0,null),n=Be(()=>e?e.rootZIndex.value-100:v_),r=cn([]),i=qr(new Map),a=qr(new Map),s=qr(new Map),o=qr(new Map),l=qr(new Map),{resizeRef:u,contentRect:c}=Sf(),d=Be(()=>{const O=new Map,V=t.overlaps??[];for(const P of V.filter(U=>U.includes(":"))){const[U,Y]=P.split(":");if(!r.value.includes(U)||!r.value.includes(Y))continue;const fe=i.get(U),Q=i.get(Y),G=a.get(U),re=a.get(Y);!fe||!Q||!G||!re||(O.set(Y,{position:fe.value,amount:parseInt(G.value,10)}),O.set(U,{position:Q.value,amount:-parseInt(re.value,10)}))}return O}),h=Be(()=>{const O=[...new Set([...s.values()].map(P=>P.value))].sort((P,U)=>P-U),V=[];for(const P of O){const U=r.value.filter(Y=>{var fe;return((fe=s.get(Y))==null?void 0:fe.value)===P});V.push(...U)}return qI(V,i,a,o)}),v=Be(()=>!Array.from(l.values()).some(O=>O.value)),x=Be(()=>h.value[h.value.length-1].layer),_=dt(()=>({"--v-layout-left":nn(x.value.left),"--v-layout-right":nn(x.value.right),"--v-layout-top":nn(x.value.top),"--v-layout-bottom":nn(x.value.bottom),...v.value?void 0:{transition:"none"}})),b=Be(()=>h.value.slice(1).map((O,V)=>{let{id:P}=O;const{layer:U}=h.value[V],Y=a.get(P),fe=i.get(P);return{id:P,...U,size:Number(Y.value),position:fe.value}})),S=O=>b.value.find(V=>V.id===O),E=kr("createLayout"),C=rn(!1);ol(()=>{C.value=!0}),Lr(j0,{register:(O,V)=>{let{id:P,order:U,position:Y,layoutSize:fe,elementSize:Q,active:G,disableTransitions:re,absolute:he}=V;s.set(P,U),i.set(P,Y),a.set(P,fe),o.set(P,G),re&&l.set(P,re);const $e=yc(M6,E==null?void 0:E.vnode).indexOf(O);$e>-1?r.value.splice($e,0,P):r.value.push(P);const _e=Be(()=>b.value.findIndex(ie=>ie.id===P)),de=Be(()=>n.value+h.value.length*2-_e.value*2),Oe=Be(()=>{const ie=Y.value==="left"||Y.value==="right",Pe=Y.value==="right",et=Y.value==="bottom",ne=Q.value??fe.value,qe=ne===0?"%":"px",ge={[Y.value]:0,zIndex:de.value,transform:`translate${ie?"X":"Y"}(${(G.value?0:-(ne===0?100:ne))*(Pe||et?-1:1)}${qe})`,position:he.value||n.value!==v_?"absolute":"fixed",...v.value?void 0:{transition:"none"}};if(!C.value)return ge;const xe=b.value[_e.value],ze=d.value.get(P);return ze&&(xe[ze.position]+=ze.amount),{...ge,height:ie?`calc(100% - ${xe.top}px - ${xe.bottom}px)`:Q.value?`${Q.value}px`:void 0,left:Pe?void 0:`${xe.left}px`,right:Pe?`${xe.right}px`:void 0,top:Y.value!=="bottom"?`${xe.top}px`:void 0,bottom:Y.value!=="top"?`${xe.bottom}px`:void 0,width:ie?Q.value?`${Q.value}px`:void 0:`calc(100% - ${xe.left}px - ${xe.right}px)`}}),ve=Be(()=>({zIndex:de.value-1}));return{layoutItemStyles:Oe,layoutItemScrimStyles:ve,zIndex:de}},unregister:O=>{s.delete(O),i.delete(O),a.delete(O),o.delete(O),l.delete(O),r.value=r.value.filter(V=>V!==O)},mainRect:x,mainStyles:_,getLayoutItem:S,items:b,layoutRect:c,rootZIndex:n});const A=dt(()=>["v-layout",{"v-layout--full-height":t.fullHeight}]),D=dt(()=>({zIndex:e?n.value:void 0,position:e?"relative":void 0,overflow:e?"hidden":void 0}));return{layoutClasses:A,layoutStyles:D,getLayoutItem:S,items:b,layoutRect:c,layoutRef:u}}function E6(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:e,...n}=t,r=pi(e,n),{aliases:i={},components:a={},directives:s={}}=r,o=hf();return o.run(()=>{const l=S9(r.defaults),u=wI(r.display,r.ssr),c=FI(r.theme),d=$I(r.icons),h=L9(r.locale),v=_I(r.date,h),x=EI(r.goTo,h);function _(S){for(const C in s)S.directive(C,s[C]);for(const C in a)S.component(C,a[C]);for(const C in i)S.component(C,Gc({...i[C],name:C,aliasName:i[C].name}));const E=hf();if(E.run(()=>{c.install(S)}),S.onUnmount(()=>E.stop()),S.provide(Rc,l),S.provide(Tv,u),S.provide(wf,c),S.provide(Cv,d),S.provide(W0,h),S.provide(yI,v.options),S.provide(l_,v.instance),S.provide(b6,x),er&&r.ssr)if(S.$nuxt)S.$nuxt.hook("app:suspense:resolve",()=>{u.update()});else{const{mount:C}=S;S.mount=function(){const A=C(...arguments);return Wi(()=>u.update()),S.mount=C,A}}S.mixin({computed:{$vuetify(){return qr({defaults:Yu.call(this,Rc),display:Yu.call(this,Tv),theme:Yu.call(this,wf),icons:Yu.call(this,Cv),locale:Yu.call(this,W0),date:Yu.call(this,l_)})}}})}function b(){o.stop()}return{install:_,unmount:b,defaults:l,display:u,theme:c,icons:d,locale:h,date:v,goTo:x}})}const XI="3.9.3";E6.version=XI;function Yu(t){var r,i;const e=this.$,n=((r=e.parent)==null?void 0:r.provides)??((i=e.vnode.appContext)==null?void 0:i.provides);if(n&&t in n)return n[t]}const KI=E6({theme:{defaultTheme:"light"},defaults:{VSlider:{color:"primary"},VCheckbox:{color:"primary"},VImg:{eager:!0}}});/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const mc=typeof document<"u";function T6(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function YI(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&T6(t.default)}const Kn=Object.assign;function gm(t,e){const n={};for(const r in e){const i=e[r];n[r]=Ga(i)?i.map(t):t(i)}return n}const sf=()=>{},Ga=Array.isArray,C6=/#/g,ZI=/&/g,JI=/\//g,QI=/=/g,e$=/\?/g,A6=/\+/g,t$=/%5B/g,n$=/%5D/g,k6=/%5E/g,r$=/%60/g,I6=/%7B/g,i$=/%7C/g,$6=/%7D/g,a$=/%20/g;function O1(t){return encodeURI(""+t).replace(i$,"|").replace(t$,"[").replace(n$,"]")}function s$(t){return O1(t).replace(I6,"{").replace($6,"}").replace(k6,"^")}function Av(t){return O1(t).replace(A6,"%2B").replace(a$,"+").replace(C6,"%23").replace(ZI,"%26").replace(r$,"`").replace(I6,"{").replace($6,"}").replace(k6,"^")}function o$(t){return Av(t).replace(QI,"%3D")}function l$(t){return O1(t).replace(C6,"%23").replace(e$,"%3F")}function u$(t){return t==null?"":l$(t).replace(JI,"%2F")}function Mf(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const c$=/\/$/,d$=t=>t.replace(c$,"");function vm(t,e,n="/"){let r,i={},a="",s="";const o=e.indexOf("#");let l=e.indexOf("?");return o<l&&o>=0&&(l=-1),l>-1&&(r=e.slice(0,l),a=e.slice(l+1,o>-1?o:e.length),i=t(a)),o>-1&&(r=r||e.slice(0,o),s=e.slice(o,e.length)),r=m$(r??e,n),{fullPath:r+(a&&"?")+a+s,path:r,query:i,hash:Mf(s)}}function f$(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function y_(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function h$(t,e,n){const r=e.matched.length-1,i=n.matched.length-1;return r>-1&&r===i&&Dc(e.matched[r],n.matched[i])&&P6(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Dc(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function P6(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!p$(t[n],e[n]))return!1;return!0}function p$(t,e){return Ga(t)?__(t,e):Ga(e)?__(e,t):t===e}function __(t,e){return Ga(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function m$(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let a=n.length-1,s,o;for(s=0;s<r.length;s++)if(o=r[s],o!==".")if(o==="..")a>1&&a--;else break;return n.slice(0,a).join("/")+"/"+r.slice(s).join("/")}const Do={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Ef;(function(t){t.pop="pop",t.push="push"})(Ef||(Ef={}));var of;(function(t){t.back="back",t.forward="forward",t.unknown=""})(of||(of={}));function g$(t){if(!t)if(mc){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),d$(t)}const v$=/^[^#]+#/;function y$(t,e){return t.replace(v$,"#")+e}function _$(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const bp=()=>({left:window.scrollX,top:window.scrollY});function b$(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),i=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!i)return;e=_$(i,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function b_(t,e){return(history.state?history.state.position-e:-1)+t}const kv=new Map;function x$(t,e){kv.set(t,e)}function w$(t){const e=kv.get(t);return kv.delete(t),e}let S$=()=>location.protocol+"//"+location.host;function R6(t,e){const{pathname:n,search:r,hash:i}=e,a=t.indexOf("#");if(a>-1){let o=i.includes(t.slice(a))?t.slice(a).length:1,l=i.slice(o);return l[0]!=="/"&&(l="/"+l),y_(l,"")}return y_(n,t)+r+i}function M$(t,e,n,r){let i=[],a=[],s=null;const o=({state:h})=>{const v=R6(t,location),x=n.value,_=e.value;let b=0;if(h){if(n.value=v,e.value=h,s&&s===x){s=null;return}b=_?h.position-_.position:0}else r(v);i.forEach(S=>{S(n.value,x,{delta:b,type:Ef.pop,direction:b?b>0?of.forward:of.back:of.unknown})})};function l(){s=n.value}function u(h){i.push(h);const v=()=>{const x=i.indexOf(h);x>-1&&i.splice(x,1)};return a.push(v),v}function c(){const{history:h}=window;h.state&&h.replaceState(Kn({},h.state,{scroll:bp()}),"")}function d(){for(const h of a)h();a=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:l,listen:u,destroy:d}}function x_(t,e,n,r=!1,i=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:i?bp():null}}function E$(t){const{history:e,location:n}=window,r={value:R6(t,n)},i={value:e.state};i.value||a(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function a(l,u,c){const d=t.indexOf("#"),h=d>-1?(n.host&&document.querySelector("base")?t:t.slice(d))+l:S$()+t+l;try{e[c?"replaceState":"pushState"](u,"",h),i.value=u}catch(v){console.error(v),n[c?"replace":"assign"](h)}}function s(l,u){const c=Kn({},e.state,x_(i.value.back,l,i.value.forward,!0),u,{position:i.value.position});a(l,c,!0),r.value=l}function o(l,u){const c=Kn({},i.value,e.state,{forward:l,scroll:bp()});a(c.current,c,!0);const d=Kn({},x_(r.value,l,null),{position:c.position+1},u);a(l,d,!1),r.value=l}return{location:r,state:i,push:o,replace:s}}function T$(t){t=g$(t);const e=E$(t),n=M$(t,e.state,e.location,e.replace);function r(a,s=!0){s||n.pauseListeners(),history.go(a)}const i=Kn({location:"",base:t,go:r,createHref:y$.bind(null,t)},e,n);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function C$(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),T$(t)}function A$(t){return typeof t=="string"||t&&typeof t=="object"}function D6(t){return typeof t=="string"||typeof t=="symbol"}const L6=Symbol("");var w_;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(w_||(w_={}));function Lc(t,e){return Kn(new Error,{type:t,[L6]:!0},e)}function Ws(t,e){return t instanceof Error&&L6 in t&&(e==null||!!(t.type&e))}const S_="[^/]+?",k$={sensitive:!1,strict:!1,start:!0,end:!0},I$=/[.+*?^${}()[\]/\\]/g;function $$(t,e){const n=Kn({},k$,e),r=[];let i=n.start?"^":"";const a=[];for(const u of t){const c=u.length?[]:[90];n.strict&&!u.length&&(i+="/");for(let d=0;d<u.length;d++){const h=u[d];let v=40+(n.sensitive?.25:0);if(h.type===0)d||(i+="/"),i+=h.value.replace(I$,"\\$&"),v+=40;else if(h.type===1){const{value:x,repeatable:_,optional:b,regexp:S}=h;a.push({name:x,repeatable:_,optional:b});const E=S||S_;if(E!==S_){v+=10;try{new RegExp(`(${E})`)}catch(A){throw new Error(`Invalid custom RegExp for param "${x}" (${E}): `+A.message)}}let C=_?`((?:${E})(?:/(?:${E}))*)`:`(${E})`;d||(C=b&&u.length<2?`(?:/${C})`:"/"+C),b&&(C+="?"),i+=C,v+=20,b&&(v+=-8),_&&(v+=-20),E===".*"&&(v+=-50)}c.push(v)}r.push(c)}if(n.strict&&n.end){const u=r.length-1;r[u][r[u].length-1]+=.7000000000000001}n.strict||(i+="/?"),n.end?i+="$":n.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const s=new RegExp(i,n.sensitive?"":"i");function o(u){const c=u.match(s),d={};if(!c)return null;for(let h=1;h<c.length;h++){const v=c[h]||"",x=a[h-1];d[x.name]=v&&x.repeatable?v.split("/"):v}return d}function l(u){let c="",d=!1;for(const h of t){(!d||!c.endsWith("/"))&&(c+="/"),d=!1;for(const v of h)if(v.type===0)c+=v.value;else if(v.type===1){const{value:x,repeatable:_,optional:b}=v,S=x in u?u[x]:"";if(Ga(S)&&!_)throw new Error(`Provided param "${x}" is an array but it is not repeatable (* or + modifiers)`);const E=Ga(S)?S.join("/"):S;if(!E)if(b)h.length<2&&(c.endsWith("/")?c=c.slice(0,-1):d=!0);else throw new Error(`Missing required param "${x}"`);c+=E}}return c||"/"}return{re:s,score:r,keys:a,parse:o,stringify:l}}function P$(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function z6(t,e){let n=0;const r=t.score,i=e.score;for(;n<r.length&&n<i.length;){const a=P$(r[n],i[n]);if(a)return a;n++}if(Math.abs(i.length-r.length)===1){if(M_(r))return 1;if(M_(i))return-1}return i.length-r.length}function M_(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const R$={type:0,value:""},D$=/[a-zA-Z0-9_]/;function L$(t){if(!t)return[[]];if(t==="/")return[[R$]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(v){throw new Error(`ERR (${n})/"${u}": ${v}`)}let n=0,r=n;const i=[];let a;function s(){a&&i.push(a),a=[]}let o=0,l,u="",c="";function d(){u&&(n===0?a.push({type:0,value:u}):n===1||n===2||n===3?(a.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),a.push({type:1,value:u,regexp:c,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),u="")}function h(){u+=l}for(;o<t.length;){if(l=t[o++],l==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:l==="/"?(u&&d(),s()):l===":"?(d(),n=1):h();break;case 4:h(),n=r;break;case 1:l==="("?n=2:D$.test(l)?h():(d(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&o--);break;case 2:l===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+l:n=3:c+=l;break;case 3:d(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&o--,c="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${u}"`),d(),s(),i}function z$(t,e,n){const r=$$(L$(t.path),n),i=Kn(r,{record:t,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function O$(t,e){const n=[],r=new Map;e=A_({strict:!1,end:!0,sensitive:!1},e);function i(d){return r.get(d)}function a(d,h,v){const x=!v,_=T_(d);_.aliasOf=v&&v.record;const b=A_(e,d),S=[_];if("alias"in d){const A=typeof d.alias=="string"?[d.alias]:d.alias;for(const D of A)S.push(T_(Kn({},_,{components:v?v.record.components:_.components,path:D,aliasOf:v?v.record:_})))}let E,C;for(const A of S){const{path:D}=A;if(h&&D[0]!=="/"){const O=h.record.path,V=O[O.length-1]==="/"?"":"/";A.path=h.record.path+(D&&V+D)}if(E=z$(A,h,b),v?v.alias.push(E):(C=C||E,C!==E&&C.alias.push(E),x&&d.name&&!C_(E)&&s(d.name)),O6(E)&&l(E),_.children){const O=_.children;for(let V=0;V<O.length;V++)a(O[V],E,v&&v.children[V])}v=v||E}return C?()=>{s(C)}:sf}function s(d){if(D6(d)){const h=r.get(d);h&&(r.delete(d),n.splice(n.indexOf(h),1),h.children.forEach(s),h.alias.forEach(s))}else{const h=n.indexOf(d);h>-1&&(n.splice(h,1),d.record.name&&r.delete(d.record.name),d.children.forEach(s),d.alias.forEach(s))}}function o(){return n}function l(d){const h=F$(d,n);n.splice(h,0,d),d.record.name&&!C_(d)&&r.set(d.record.name,d)}function u(d,h){let v,x={},_,b;if("name"in d&&d.name){if(v=r.get(d.name),!v)throw Lc(1,{location:d});b=v.record.name,x=Kn(E_(h.params,v.keys.filter(C=>!C.optional).concat(v.parent?v.parent.keys.filter(C=>C.optional):[]).map(C=>C.name)),d.params&&E_(d.params,v.keys.map(C=>C.name))),_=v.stringify(x)}else if(d.path!=null)_=d.path,v=n.find(C=>C.re.test(_)),v&&(x=v.parse(_),b=v.record.name);else{if(v=h.name?r.get(h.name):n.find(C=>C.re.test(h.path)),!v)throw Lc(1,{location:d,currentLocation:h});b=v.record.name,x=Kn({},h.params,d.params),_=v.stringify(x)}const S=[];let E=v;for(;E;)S.unshift(E.record),E=E.parent;return{name:b,path:_,params:x,matched:S,meta:B$(S)}}t.forEach(d=>a(d));function c(){n.length=0,r.clear()}return{addRoute:a,resolve:u,removeRoute:s,clearRoutes:c,getRoutes:o,getRecordMatcher:i}}function E_(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function T_(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:N$(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function N$(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="object"?n[r]:n;return e}function C_(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function B$(t){return t.reduce((e,n)=>Kn(e,n.meta),{})}function A_(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function F$(t,e){let n=0,r=e.length;for(;n!==r;){const a=n+r>>1;z6(t,e[a])<0?r=a:n=a+1}const i=U$(t);return i&&(r=e.lastIndexOf(i,r-1)),r}function U$(t){let e=t;for(;e=e.parent;)if(O6(e)&&z6(t,e)===0)return e}function O6({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function V$(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let i=0;i<r.length;++i){const a=r[i].replace(A6," "),s=a.indexOf("="),o=Mf(s<0?a:a.slice(0,s)),l=s<0?null:Mf(a.slice(s+1));if(o in e){let u=e[o];Ga(u)||(u=e[o]=[u]),u.push(l)}else e[o]=l}return e}function k_(t){let e="";for(let n in t){const r=t[n];if(n=o$(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(Ga(r)?r.map(a=>a&&Av(a)):[r&&Av(r)]).forEach(a=>{a!==void 0&&(e+=(e.length?"&":"")+n,a!=null&&(e+="="+a))})}return e}function H$(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=Ga(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return e}const W$=Symbol(""),I_=Symbol(""),N1=Symbol(""),N6=Symbol(""),Iv=Symbol("");function Ed(){let t=[];function e(r){return t.push(r),()=>{const i=t.indexOf(r);i>-1&&t.splice(i,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function jo(t,e,n,r,i,a=s=>s()){const s=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((o,l)=>{const u=h=>{h===!1?l(Lc(4,{from:n,to:e})):h instanceof Error?l(h):A$(h)?l(Lc(2,{from:e,to:h})):(s&&r.enterCallbacks[i]===s&&typeof h=="function"&&s.push(h),o())},c=a(()=>t.call(r&&r.instances[i],e,n,u));let d=Promise.resolve(c);t.length<3&&(d=d.then(u)),d.catch(h=>l(h))})}function ym(t,e,n,r,i=a=>a()){const a=[];for(const s of t)for(const o in s.components){let l=s.components[o];if(!(e!=="beforeRouteEnter"&&!s.instances[o]))if(T6(l)){const c=(l.__vccOpts||l)[e];c&&a.push(jo(c,n,r,s,o,i))}else{let u=l();a.push(()=>u.then(c=>{if(!c)throw new Error(`Couldn't resolve component "${o}" at "${s.path}"`);const d=YI(c)?c.default:c;s.mods[o]=c,s.components[o]=d;const v=(d.__vccOpts||d)[e];return v&&jo(v,n,r,s,o,i)()}))}}return a}function $_(t){const e=Fn(N1),n=Fn(N6),r=Be(()=>{const l=ki(t.to);return e.resolve(l)}),i=Be(()=>{const{matched:l}=r.value,{length:u}=l,c=l[u-1],d=n.matched;if(!c||!d.length)return-1;const h=d.findIndex(Dc.bind(null,c));if(h>-1)return h;const v=P_(l[u-2]);return u>1&&P_(c)===v&&d[d.length-1].path!==v?d.findIndex(Dc.bind(null,l[u-2])):h}),a=Be(()=>i.value>-1&&K$(n.params,r.value.params)),s=Be(()=>i.value>-1&&i.value===n.matched.length-1&&P6(n.params,r.value.params));function o(l={}){if(X$(l)){const u=e[ki(t.replace)?"replace":"push"](ki(t.to)).catch(sf);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:r,href:Be(()=>r.value.href),isActive:a,isExactActive:s,navigate:o}}function G$(t){return t.length===1?t[0]:t}const q$=hp({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:$_,setup(t,{slots:e}){const n=qr($_(t)),{options:r}=Fn(N1),i=Be(()=>({[R_(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[R_(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const a=e.default&&G$(e.default(n));return t.custom?a:qa("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:i.value},a)}}}),j$=q$;function X$(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function K$(t,e){for(const n in e){const r=e[n],i=t[n];if(typeof r=="string"){if(r!==i)return!1}else if(!Ga(i)||i.length!==r.length||r.some((a,s)=>a!==i[s]))return!1}return!0}function P_(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const R_=(t,e,n)=>t??e??n,Y$=hp({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const r=Fn(Iv),i=Be(()=>t.route||r.value),a=Fn(I_,0),s=Be(()=>{let u=ki(a);const{matched:c}=i.value;let d;for(;(d=c[u])&&!d.components;)u++;return u}),o=Be(()=>i.value.matched[s.value]);Lr(I_,Be(()=>s.value+1)),Lr(W$,o),Lr(Iv,i);const l=cn();return An(()=>[l.value,o.value,t.name],([u,c,d],[h,v,x])=>{c&&(c.instances[d]=u,v&&v!==c&&u&&u===h&&(c.leaveGuards.size||(c.leaveGuards=v.leaveGuards),c.updateGuards.size||(c.updateGuards=v.updateGuards))),u&&c&&(!v||!Dc(c,v)||!h)&&(c.enterCallbacks[d]||[]).forEach(_=>_(u))},{flush:"post"}),()=>{const u=i.value,c=t.name,d=o.value,h=d&&d.components[c];if(!h)return D_(n.default,{Component:h,route:u});const v=d.props[c],x=v?v===!0?u.params:typeof v=="function"?v(u):v:null,b=qa(h,Kn({},x,e,{onVnodeUnmounted:S=>{S.component.isUnmounted&&(d.instances[c]=null)},ref:l}));return D_(n.default,{Component:b,route:u})||b}}});function D_(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const Z$=Y$;function J$(t){const e=O$(t.routes,t),n=t.parseQuery||V$,r=t.stringifyQuery||k_,i=t.history,a=Ed(),s=Ed(),o=Ed(),l=rn(Do);let u=Do;mc&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=gm.bind(null,ge=>""+ge),d=gm.bind(null,u$),h=gm.bind(null,Mf);function v(ge,xe){let ze,Ge;return D6(ge)?(ze=e.getRecordMatcher(ge),Ge=xe):Ge=ge,e.addRoute(Ge,ze)}function x(ge){const xe=e.getRecordMatcher(ge);xe&&e.removeRoute(xe)}function _(){return e.getRoutes().map(ge=>ge.record)}function b(ge){return!!e.getRecordMatcher(ge)}function S(ge,xe){if(xe=Kn({},xe||l.value),typeof ge=="string"){const ke=vm(n,ge,xe.path),Xe=e.resolve({path:ke.path},xe),Ze=i.createHref(ke.fullPath);return Kn(ke,Xe,{params:h(Xe.params),hash:Mf(ke.hash),redirectedFrom:void 0,href:Ze})}let ze;if(ge.path!=null)ze=Kn({},ge,{path:vm(n,ge.path,xe.path).path});else{const ke=Kn({},ge.params);for(const Xe in ke)ke[Xe]==null&&delete ke[Xe];ze=Kn({},ge,{params:d(ke)}),xe.params=d(xe.params)}const Ge=e.resolve(ze,xe),ut=ge.hash||"";Ge.params=c(h(Ge.params));const ce=f$(r,Kn({},ge,{hash:s$(ut),path:Ge.path})),me=i.createHref(ce);return Kn({fullPath:ce,hash:ut,query:r===k_?H$(ge.query):ge.query||{}},Ge,{redirectedFrom:void 0,href:me})}function E(ge){return typeof ge=="string"?vm(n,ge,l.value.path):Kn({},ge)}function C(ge,xe){if(u!==ge)return Lc(8,{from:xe,to:ge})}function A(ge){return V(ge)}function D(ge){return A(Kn(E(ge),{replace:!0}))}function O(ge){const xe=ge.matched[ge.matched.length-1];if(xe&&xe.redirect){const{redirect:ze}=xe;let Ge=typeof ze=="function"?ze(ge):ze;return typeof Ge=="string"&&(Ge=Ge.includes("?")||Ge.includes("#")?Ge=E(Ge):{path:Ge},Ge.params={}),Kn({query:ge.query,hash:ge.hash,params:Ge.path!=null?{}:ge.params},Ge)}}function V(ge,xe){const ze=u=S(ge),Ge=l.value,ut=ge.state,ce=ge.force,me=ge.replace===!0,ke=O(ze);if(ke)return V(Kn(E(ke),{state:typeof ke=="object"?Kn({},ut,ke.state):ut,force:ce,replace:me}),xe||ze);const Xe=ze;Xe.redirectedFrom=xe;let Ze;return!ce&&h$(r,Ge,ze)&&(Ze=Lc(16,{to:Xe,from:Ge}),ve(Ge,Ge,!0,!1)),(Ze?Promise.resolve(Ze):Y(Xe,Ge)).catch(We=>Ws(We)?Ws(We,2)?We:Oe(We):_e(We,Xe,Ge)).then(We=>{if(We){if(Ws(We,2))return V(Kn({replace:me},E(We.to),{state:typeof We.to=="object"?Kn({},ut,We.to.state):ut,force:ce}),xe||Xe)}else We=Q(Xe,Ge,!0,me,ut);return fe(Xe,Ge,We),We})}function P(ge,xe){const ze=C(ge,xe);return ze?Promise.reject(ze):Promise.resolve()}function U(ge){const xe=et.values().next().value;return xe&&typeof xe.runWithContext=="function"?xe.runWithContext(ge):ge()}function Y(ge,xe){let ze;const[Ge,ut,ce]=Q$(ge,xe);ze=ym(Ge.reverse(),"beforeRouteLeave",ge,xe);for(const ke of Ge)ke.leaveGuards.forEach(Xe=>{ze.push(jo(Xe,ge,xe))});const me=P.bind(null,ge,xe);return ze.push(me),qe(ze).then(()=>{ze=[];for(const ke of a.list())ze.push(jo(ke,ge,xe));return ze.push(me),qe(ze)}).then(()=>{ze=ym(ut,"beforeRouteUpdate",ge,xe);for(const ke of ut)ke.updateGuards.forEach(Xe=>{ze.push(jo(Xe,ge,xe))});return ze.push(me),qe(ze)}).then(()=>{ze=[];for(const ke of ce)if(ke.beforeEnter)if(Ga(ke.beforeEnter))for(const Xe of ke.beforeEnter)ze.push(jo(Xe,ge,xe));else ze.push(jo(ke.beforeEnter,ge,xe));return ze.push(me),qe(ze)}).then(()=>(ge.matched.forEach(ke=>ke.enterCallbacks={}),ze=ym(ce,"beforeRouteEnter",ge,xe,U),ze.push(me),qe(ze))).then(()=>{ze=[];for(const ke of s.list())ze.push(jo(ke,ge,xe));return ze.push(me),qe(ze)}).catch(ke=>Ws(ke,8)?ke:Promise.reject(ke))}function fe(ge,xe,ze){o.list().forEach(Ge=>U(()=>Ge(ge,xe,ze)))}function Q(ge,xe,ze,Ge,ut){const ce=C(ge,xe);if(ce)return ce;const me=xe===Do,ke=mc?history.state:{};ze&&(Ge||me?i.replace(ge.fullPath,Kn({scroll:me&&ke&&ke.scroll},ut)):i.push(ge.fullPath,ut)),l.value=ge,ve(ge,xe,ze,me),Oe()}let G;function re(){G||(G=i.listen((ge,xe,ze)=>{if(!ne.listening)return;const Ge=S(ge),ut=O(Ge);if(ut){V(Kn(ut,{replace:!0,force:!0}),Ge).catch(sf);return}u=Ge;const ce=l.value;mc&&x$(b_(ce.fullPath,ze.delta),bp()),Y(Ge,ce).catch(me=>Ws(me,12)?me:Ws(me,2)?(V(Kn(E(me.to),{force:!0}),Ge).then(ke=>{Ws(ke,20)&&!ze.delta&&ze.type===Ef.pop&&i.go(-1,!1)}).catch(sf),Promise.reject()):(ze.delta&&i.go(-ze.delta,!1),_e(me,Ge,ce))).then(me=>{me=me||Q(Ge,ce,!1),me&&(ze.delta&&!Ws(me,8)?i.go(-ze.delta,!1):ze.type===Ef.pop&&Ws(me,20)&&i.go(-1,!1)),fe(Ge,ce,me)}).catch(sf)}))}let he=Ed(),ye=Ed(),$e;function _e(ge,xe,ze){Oe(ge);const Ge=ye.list();return Ge.length?Ge.forEach(ut=>ut(ge,xe,ze)):console.error(ge),Promise.reject(ge)}function de(){return $e&&l.value!==Do?Promise.resolve():new Promise((ge,xe)=>{he.add([ge,xe])})}function Oe(ge){return $e||($e=!ge,re(),he.list().forEach(([xe,ze])=>ge?ze(ge):xe()),he.reset()),ge}function ve(ge,xe,ze,Ge){const{scrollBehavior:ut}=t;if(!mc||!ut)return Promise.resolve();const ce=!ze&&w$(b_(ge.fullPath,0))||(Ge||!ze)&&history.state&&history.state.scroll||null;return Wi().then(()=>ut(ge,xe,ce)).then(me=>me&&b$(me)).catch(me=>_e(me,ge,xe))}const ie=ge=>i.go(ge);let Pe;const et=new Set,ne={currentRoute:l,listening:!0,addRoute:v,removeRoute:x,clearRoutes:e.clearRoutes,hasRoute:b,getRoutes:_,resolve:S,options:t,push:A,replace:D,go:ie,back:()=>ie(-1),forward:()=>ie(1),beforeEach:a.add,beforeResolve:s.add,afterEach:o.add,onError:ye.add,isReady:de,install(ge){const xe=this;ge.component("RouterLink",j$),ge.component("RouterView",Z$),ge.config.globalProperties.$router=xe,Object.defineProperty(ge.config.globalProperties,"$route",{enumerable:!0,get:()=>ki(l)}),mc&&!Pe&&l.value===Do&&(Pe=!0,A(i.location).catch(ut=>{}));const ze={};for(const ut in Do)Object.defineProperty(ze,ut,{get:()=>l.value[ut],enumerable:!0});ge.provide(N1,xe),ge.provide(N6,VS(ze)),ge.provide(Iv,l);const Ge=ge.unmount;et.add(ge),ge.unmount=function(){et.delete(ge),et.size<1&&(u=Do,G&&G(),G=null,l.value=Do,Pe=!1,$e=!1),Ge()}}};function qe(ge){return ge.reduce((xe,ze)=>xe.then(()=>U(ze)),Promise.resolve())}return ne}function Q$(t,e){const n=[],r=[],i=[],a=Math.max(e.matched.length,t.matched.length);for(let s=0;s<a;s++){const o=e.matched[s];o&&(t.matched.find(u=>Dc(u,o))?r.push(o):n.push(o));const l=t.matched[s];l&&(e.matched.find(u=>Dc(u,l))||i.push(l))}return[n,r,i]}const ll=Et({border:[Boolean,Number,String]},"border");function ul(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs();return{borderClasses:Be(()=>{const r=t.border;return r===!0||r===""?`${e}--border`:typeof r=="string"||r===0?String(r).split(" ").map(i=>`border-${i}`):[]})}}const eP=[null,"default","comfortable","compact"],As=Et({density:{type:String,default:"default",validator:t=>eP.includes(t)}},"density");function uo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs();return{densityClasses:dt(()=>`${e}--density-${t.density}`)}}const cl=Et({elevation:{type:[Number,String],validator(t){const e=parseInt(t);return!isNaN(e)&&e>=0&&e<=24}}},"elevation");function dl(t){return{elevationClasses:dt(()=>{const n=lr(t)?t.value:t.elevation;return n==null?[]:[`elevation-${n}`]})}}const ja=Et({rounded:{type:[Boolean,Number,String],default:void 0},tile:Boolean},"rounded");function Xa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs();return{roundedClasses:Be(()=>{const r=lr(t)?t.value:t.rounded,i=lr(t)?t.value:t.tile,a=[];if(r===!0||r==="")a.push(`${e}--rounded`);else if(typeof r=="string"||r===0)for(const s of String(r).split(" "))a.push(`rounded-${s}`);else(i||r===!1)&&a.push("rounded-0");return a})}}const br=Et({tag:{type:[String,Object,Function],default:"div"}},"tag");function B1(t){return k1(()=>{const e=Ms(t),n=[],r={};if(e.background)if(wv(e.background)){if(r.backgroundColor=e.background,!e.text&&p9(e.background)){const i=_s(e.background);if(i.a==null||i.a===1){const a=u6(i);r.color=a,r.caretColor=a}}}else n.push(`bg-${e.background}`);return e.text&&(wv(e.text)?(r.color=e.text,r.caretColor=e.text):n.push(`text-${e.text}`)),{colorClasses:n,colorStyles:r}})}function Es(t){const{colorClasses:e,colorStyles:n}=B1(()=>({text:Ms(t)}));return{textColorClasses:e,textColorStyles:n}}function ra(t){const{colorClasses:e,colorStyles:n}=B1(()=>({background:Ms(t)}));return{backgroundColorClasses:e,backgroundColorStyles:n}}const tP=["elevated","flat","tonal","outlined","text","plain"];function xp(t,e){return Te(On,null,[t&&Te("span",{key:"overlay",class:Wt(`${e}__overlay`)},null),Te("span",{key:"underlay",class:Wt(`${e}__underlay`)},null)])}const qc=Et({color:String,variant:{type:String,default:"elevated",validator:t=>tP.includes(t)}},"variant");function wp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs();const n=dt(()=>{const{variant:a}=Ms(t);return`${e}--variant-${a}`}),{colorClasses:r,colorStyles:i}=B1(()=>{const{variant:a,color:s}=Ms(t);return{[["elevated","flat"].includes(a)?"background":"text"]:s}});return{colorClasses:r,colorStyles:i,variantClasses:n}}const B6=Et({baseColor:String,divided:Boolean,direction:{type:String,default:"horizontal"},...ll(),...In(),...As(),...cl(),...ja(),...br(),...Kr(),...qc()},"VBtnGroup"),L_=Jt()({name:"VBtnGroup",props:B6(),setup(t,e){let{slots:n}=e;const{themeClasses:r}=Ri(t),{densityClasses:i}=uo(t),{borderClasses:a}=ul(t),{elevationClasses:s}=dl(t),{roundedClasses:o}=Xa(t);Wc({VBtn:{height:dt(()=>t.direction==="horizontal"?"auto":null),baseColor:dt(()=>t.baseColor),color:dt(()=>t.color),density:dt(()=>t.density),flat:!0,variant:dt(()=>t.variant)}}),vn(()=>le(t.tag,{class:Wt(["v-btn-group",`v-btn-group--${t.direction}`,{"v-btn-group--divided":t.divided},r.value,a.value,i.value,s.value,o.value,t.class]),style:yn(t.style)},n))}}),F6=Et({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),U6=Et({value:null,disabled:Boolean,selectedClass:String},"group-item");function V6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=kr("useGroupItem");if(!r)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const i=vu();Lr(Symbol.for(`${e.description}:id`),i);const a=Fn(e,null);if(!a){if(!n)return a;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${e.description}`)}const s=dt(()=>t.value),o=Be(()=>!!(a.disabled.value||t.disabled));a.register({id:i,value:s,disabled:o},r),sa(()=>{a.unregister(i)});const l=Be(()=>a.isSelected(i)),u=Be(()=>a.items.value[0].id===i),c=Be(()=>a.items.value[a.items.value.length-1].id===i),d=Be(()=>l.value&&[a.selectedClass.value,t.selectedClass]);return An(l,h=>{r.emit("group:selected",{value:h})},{flush:"sync"}),{id:i,isSelected:l,isFirst:u,isLast:c,toggle:()=>a.select(i,!l.value),select:h=>a.select(i,h),selectedClass:d,value:s,disabled:o,group:a}}function F1(t,e){let n=!1;const r=qr([]),i=jr(t,"modelValue",[],h=>h==null?[]:H6(r,xs(h)),h=>{const v=rP(r,h);return t.multiple?v:v[0]}),a=kr("useGroup");function s(h,v){const x=h,_=Symbol.for(`${e.description}:id`),S=yc(_,a==null?void 0:a.vnode).indexOf(v);ki(x.value)==null&&(x.value=S,x.useIndexAsValue=!0),S>-1?r.splice(S,0,x):r.push(x)}function o(h){if(n)return;l();const v=r.findIndex(x=>x.id===h);r.splice(v,1)}function l(){const h=r.find(v=>!v.disabled);h&&t.mandatory==="force"&&!i.value.length&&(i.value=[h.id])}ol(()=>{l()}),sa(()=>{n=!0}),b1(()=>{for(let h=0;h<r.length;h++)r[h].useIndexAsValue&&(r[h].value=h)});function u(h,v){const x=r.find(_=>_.id===h);if(!(v&&(x!=null&&x.disabled)))if(t.multiple){const _=i.value.slice(),b=_.findIndex(E=>E===h),S=~b;if(v=v??!S,S&&t.mandatory&&_.length<=1||!S&&t.max!=null&&_.length+1>t.max)return;b<0&&v?_.push(h):b>=0&&!v&&_.splice(b,1),i.value=_}else{const _=i.value.includes(h);if(t.mandatory&&_||!_&&!v)return;i.value=v??!_?[h]:[]}}function c(h){if(t.multiple,i.value.length){const v=i.value[0],x=r.findIndex(S=>S.id===v);let _=(x+h)%r.length,b=r[_];for(;b.disabled&&_!==x;)_=(_+h)%r.length,b=r[_];if(b.disabled)return;i.value=[r[_].id]}else{const v=r.find(x=>!x.disabled);v&&(i.value=[v.id])}}const d={register:s,unregister:o,selected:i,select:u,disabled:dt(()=>t.disabled),prev:()=>c(r.length-1),next:()=>c(1),isSelected:h=>i.value.includes(h),selectedClass:dt(()=>t.selectedClass),items:dt(()=>r),getItemIndex:h=>nP(r,h)};return Lr(e,d),d}function nP(t,e){const n=H6(t,[e]);return n.length?t.findIndex(r=>r.id===n[0]):-1}function H6(t,e){const n=[];return e.forEach(r=>{const i=t.find(s=>iu(r,s.value)),a=t[r];(i==null?void 0:i.value)!=null?n.push(i.id):a!=null&&a.useIndexAsValue&&n.push(a.id)}),n}function rP(t,e){const n=[];return e.forEach(r=>{const i=t.findIndex(a=>a.id===r);if(~i){const a=t[i];n.push(a.value!=null?a.value:i)}}),n}const W6=Symbol.for("vuetify:v-btn-toggle"),iP=Et({...B6(),...F6()},"VBtnToggle"),aP=Jt()({name:"VBtnToggle",props:iP(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:n}=e;const{isSelected:r,next:i,prev:a,select:s,selected:o}=F1(t,W6);return vn(()=>{const l=L_.filterProps(t);return le(L_,Rn({class:["v-btn-toggle",t.class]},l,{style:t.style}),{default:()=>{var u;return[(u=n.default)==null?void 0:u.call(n,{isSelected:r,next:i,prev:a,select:s,selected:o})]}})}),{next:i,prev:a,select:s}}}),sP=Et({defaults:Object,disabled:Boolean,reset:[Number,String],root:[Boolean,String],scoped:Boolean},"VDefaultsProvider"),Ua=Jt(!1)({name:"VDefaultsProvider",props:sP(),setup(t,e){let{slots:n}=e;const{defaults:r,disabled:i,reset:a,root:s,scoped:o}=GS(t);return Wc(r,{reset:a,root:s,scoped:o,disabled:i}),()=>{var l;return(l=n.default)==null?void 0:l.call(n)}}}),oP=["x-small","small","default","large","x-large"],Sp=Et({size:{type:[String,Number],default:"default"}},"size");function Mp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs();return k1(()=>{const n=t.size;let r,i;return F0(oP,n)?r=`${e}--size-${n}`:n&&(i={width:nn(n),height:nn(n)}),{sizeClasses:r,sizeStyles:i}})}const lP=Et({color:String,disabled:Boolean,start:Boolean,end:Boolean,icon:pr,opacity:[String,Number],...In(),...Sp(),...br({tag:"i"}),...Kr()},"VIcon"),yr=Jt()({name:"VIcon",props:lP(),setup(t,e){let{attrs:n,slots:r}=e;const i=rn(),{themeClasses:a}=UI(),{iconData:s}=PI(()=>i.value||t.icon),{sizeClasses:o}=Mp(t),{textColorClasses:l,textColorStyles:u}=Es(()=>t.color);return vn(()=>{var h,v;const c=(h=r.default)==null?void 0:h.call(r);c&&(i.value=(v=Z5(c).filter(x=>x.type===Nf&&x.children&&typeof x.children=="string")[0])==null?void 0:v.children);const d=!!(n.onClick||n.onClickOnce);return le(s.value.component,{tag:t.tag,icon:s.value.icon,class:Wt(["v-icon","notranslate",a.value,o.value,l.value,{"v-icon--clickable":d,"v-icon--disabled":t.disabled,"v-icon--start":t.start,"v-icon--end":t.end},t.class]),style:yn([{"--v-icon-opacity":t.opacity},o.value?void 0:{fontSize:nn(t.size),height:nn(t.size),width:nn(t.size)},u.value,t.style]),role:d?"button":void 0,"aria-hidden":!d,tabindex:d?t.disabled?-1:0:void 0},{default:()=>[c]})}),{}}});function G6(t,e){const n=cn(),r=rn(!1);if(C1){const i=new IntersectionObserver(a=>{r.value=!!a.find(s=>s.isIntersecting)},e);Pi(()=>{i.disconnect()}),An(n,(a,s)=>{s&&(i.unobserve(s),r.value=!1),a&&i.observe(a)},{flush:"post"})}return{intersectionRef:n,isIntersecting:r}}const uP=Et({bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...In(),...Sp(),...br({tag:"div"}),...Kr()},"VProgressCircular"),q6=Jt()({name:"VProgressCircular",props:uP(),setup(t,e){let{slots:n}=e;const r=20,i=2*Math.PI*r,a=cn(),{themeClasses:s}=Ri(t),{sizeClasses:o,sizeStyles:l}=Mp(t),{textColorClasses:u,textColorStyles:c}=Es(()=>t.color),{textColorClasses:d,textColorStyles:h}=Es(()=>t.bgColor),{intersectionRef:v,isIntersecting:x}=G6(),{resizeRef:_,contentRect:b}=Sf(),S=dt(()=>Wa(parseFloat(t.modelValue),0,100)),E=dt(()=>Number(t.width)),C=dt(()=>l.value?Number(t.size):b.value?b.value.width:Math.max(E.value,32)),A=dt(()=>r/(1-E.value/C.value)*2),D=dt(()=>E.value/C.value*A.value),O=dt(()=>nn((100-S.value)/100*i));return lo(()=>{v.value=a.value,_.value=a.value}),vn(()=>le(t.tag,{ref:a,class:Wt(["v-progress-circular",{"v-progress-circular--indeterminate":!!t.indeterminate,"v-progress-circular--visible":x.value,"v-progress-circular--disable-shrink":t.indeterminate==="disable-shrink"},s.value,o.value,u.value,t.class]),style:yn([l.value,c.value,t.style]),role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":t.indeterminate?void 0:S.value},{default:()=>[Te("svg",{style:{transform:`rotate(calc(-90deg + ${Number(t.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${A.value} ${A.value}`},[Te("circle",{class:Wt(["v-progress-circular__underlay",d.value]),style:yn(h.value),fill:"transparent",cx:"50%",cy:"50%",r,"stroke-width":D.value,"stroke-dasharray":i,"stroke-dashoffset":0},null),Te("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r,"stroke-width":D.value,"stroke-dasharray":i,"stroke-dashoffset":O.value},null)]),n.default&&Te("div",{class:"v-progress-circular__content"},[n.default({value:S.value})])]})),{}}}),ks=Et({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function Is(t){return{dimensionStyles:Be(()=>{const n={},r=nn(t.height),i=nn(t.maxHeight),a=nn(t.maxWidth),s=nn(t.minHeight),o=nn(t.minWidth),l=nn(t.width);return r!=null&&(n.height=r),i!=null&&(n.maxHeight=i),a!=null&&(n.maxWidth=a),s!=null&&(n.minHeight=s),o!=null&&(n.minWidth=o),l!=null&&(n.width=l),n})}}const z_={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},Ep=Et({location:String},"location");function Tp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2?arguments[2]:void 0;const{isRtl:r}=Sa();return{locationStyles:Be(()=>{if(!t.location)return{};const{side:a,align:s}=xv(t.location.split(" ").length>1?t.location:`${t.location} center`,r.value);function o(u){return n?n(u):0}const l={};return a!=="center"&&(e?l[z_[a]]=`calc(100% - ${o(a)}px)`:l[a]=0),s!=="center"?e?l[z_[s]]=`calc(100% - ${o(s)}px)`:l[s]=0:(a==="center"?l.top=l.left="50%":l[{top:"left",bottom:"left",left:"top",right:"top"}[a]]="50%",l.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[a]),l})}}const cP=Et({absolute:Boolean,active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},bufferColor:String,bufferOpacity:[Number,String],clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},opacity:[Number,String],reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...In(),...Ep({location:"top"}),...ja(),...br(),...Kr()},"VProgressLinear"),j6=Jt()({name:"VProgressLinear",props:cP(),emits:{"update:modelValue":t=>!0},setup(t,e){var fe;let{slots:n}=e;const r=jr(t,"modelValue"),{isRtl:i,rtlClasses:a}=Sa(),{themeClasses:s}=Ri(t),{locationStyles:o}=Tp(t),{textColorClasses:l,textColorStyles:u}=Es(()=>t.color),{backgroundColorClasses:c,backgroundColorStyles:d}=ra(()=>t.bgColor||t.color),{backgroundColorClasses:h,backgroundColorStyles:v}=ra(()=>t.bufferColor||t.bgColor||t.color),{backgroundColorClasses:x,backgroundColorStyles:_}=ra(()=>t.color),{roundedClasses:b}=Xa(t),{intersectionRef:S,isIntersecting:E}=G6(),C=Be(()=>parseFloat(t.max)),A=Be(()=>parseFloat(t.height)),D=Be(()=>Wa(parseFloat(t.bufferValue)/C.value*100,0,100)),O=Be(()=>Wa(parseFloat(r.value)/C.value*100,0,100)),V=Be(()=>i.value!==t.reverse),P=Be(()=>t.indeterminate?"fade-transition":"slide-x-transition"),U=er&&((fe=window.matchMedia)==null?void 0:fe.call(window,"(forced-colors: active)").matches);function Y(Q){if(!S.value)return;const{left:G,right:re,width:he}=S.value.getBoundingClientRect(),ye=V.value?he-Q.clientX+(re-he):Q.clientX-G;r.value=Math.round(ye/he*C.value)}return vn(()=>le(t.tag,{ref:S,class:Wt(["v-progress-linear",{"v-progress-linear--absolute":t.absolute,"v-progress-linear--active":t.active&&E.value,"v-progress-linear--reverse":V.value,"v-progress-linear--rounded":t.rounded,"v-progress-linear--rounded-bar":t.roundedBar,"v-progress-linear--striped":t.striped,"v-progress-linear--clickable":t.clickable},b.value,s.value,a.value,t.class]),style:yn([{bottom:t.location==="bottom"?0:void 0,top:t.location==="top"?0:void 0,height:t.active?nn(A.value):0,"--v-progress-linear-height":nn(A.value),...t.absolute?o.value:{}},t.style]),role:"progressbar","aria-hidden":t.active?"false":"true","aria-valuemin":"0","aria-valuemax":t.max,"aria-valuenow":t.indeterminate?void 0:Math.min(parseFloat(r.value),C.value),onClick:t.clickable&&Y},{default:()=>[t.stream&&Te("div",{key:"stream",class:Wt(["v-progress-linear__stream",l.value]),style:{...u.value,[V.value?"left":"right"]:nn(-A.value),borderTop:`${nn(A.value/2)} dotted`,opacity:parseFloat(t.bufferOpacity),top:`calc(50% - ${nn(A.value/4)})`,width:nn(100-D.value,"%"),"--v-progress-linear-stream-to":nn(A.value*(V.value?1:-1))}},null),Te("div",{class:Wt(["v-progress-linear__background",U?void 0:c.value]),style:yn([d.value,{opacity:parseFloat(t.bgOpacity),width:t.stream?0:void 0}])},null),Te("div",{class:Wt(["v-progress-linear__buffer",U?void 0:h.value]),style:yn([v.value,{opacity:parseFloat(t.bufferOpacity),width:nn(D.value,"%")}])},null),le(cu,{name:P.value},{default:()=>[t.indeterminate?Te("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(Q=>Te("div",{key:Q,class:Wt(["v-progress-linear__indeterminate",Q,U?void 0:x.value]),style:yn(_.value)},null))]):Te("div",{class:Wt(["v-progress-linear__determinate",U?void 0:x.value]),style:yn([_.value,{width:nn(O.value,"%")}])},null)]}),n.default&&Te("div",{class:"v-progress-linear__content"},[n.default({value:O.value,buffer:D.value})])]})),{}}}),X6=Et({loading:[Boolean,String]},"loader");function K6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs();return{loaderClasses:dt(()=>({[`${e}--loading`]:t.loading}))}}function dP(t,e){var r;let{slots:n}=e;return Te("div",{class:Wt(`${t.name}__loader`)},[((r=n.default)==null?void 0:r.call(n,{color:t.color,isActive:t.active}))||le(j6,{absolute:t.absolute,active:t.active,color:t.color,height:"2",indeterminate:!0},null)])}const fP=["static","relative","fixed","absolute","sticky"],U1=Et({position:{type:String,validator:t=>fP.includes(t)}},"position");function V1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs();return{positionClasses:dt(()=>t.position?`${e}--${t.position}`:void 0)}}function hP(){const t=kr("useRoute");return Be(()=>{var e;return(e=t==null?void 0:t.proxy)==null?void 0:e.$route})}function pP(){var t,e;return(e=(t=kr("useRouter"))==null?void 0:t.proxy)==null?void 0:e.$router}function H1(t,e){var c,d;const n=bA("RouterLink"),r=dt(()=>!!(t.href||t.to)),i=Be(()=>(r==null?void 0:r.value)||V2(e,"click")||V2(t,"click"));if(typeof n=="string"||!("useLink"in n)){const h=dt(()=>t.href);return{isLink:r,isClickable:i,href:h,linkProps:qr({href:h})}}const a=n.useLink({to:dt(()=>t.to||""),replace:dt(()=>t.replace)}),s=Be(()=>t.to?a:void 0),o=hP(),l=Be(()=>{var h,v,x;return s.value?t.exact?o.value?((x=s.value.isExactActive)==null?void 0:x.value)&&iu(s.value.route.value.query,o.value.query):((v=s.value.isExactActive)==null?void 0:v.value)??!1:((h=s.value.isActive)==null?void 0:h.value)??!1:!1}),u=Be(()=>{var h;return t.to?(h=s.value)==null?void 0:h.route.value.href:t.href});return{isLink:r,isClickable:i,isActive:l,route:(c=s.value)==null?void 0:c.route,navigate:(d=s.value)==null?void 0:d.navigate,href:u,linkProps:qr({href:u,"aria-current":dt(()=>l.value?"page":void 0)})}}const W1=Et({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let _m=!1;function mP(t,e){let n=!1,r,i;er&&(t!=null&&t.beforeEach)&&(Wi(()=>{window.addEventListener("popstate",a),r=t.beforeEach((s,o,l)=>{_m?n?e(l):l():setTimeout(()=>n?e(l):l()),_m=!0}),i=t==null?void 0:t.afterEach(()=>{_m=!1})}),Pi(()=>{window.removeEventListener("popstate",a),r==null||r(),i==null||i()}));function a(s){var o;(o=s.state)!=null&&o.replaced||(n=!0,setTimeout(()=>n=!1))}}function gP(t,e){An(()=>{var n;return(n=t.isActive)==null?void 0:n.value},n=>{t.isLink.value&&n!=null&&e&&Wi(()=>{e(n)})},{immediate:!0})}const $v=Symbol("rippleStop"),vP=80;function O_(t,e){t.style.transform=e,t.style.webkitTransform=e}function Pv(t){return t.constructor.name==="TouchEvent"}function Y6(t){return t.constructor.name==="KeyboardEvent"}const yP=function(t,e){var d;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=0,i=0;if(!Y6(t)){const h=e.getBoundingClientRect(),v=Pv(t)?t.touches[t.touches.length-1]:t;r=v.clientX-h.left,i=v.clientY-h.top}let a=0,s=.3;(d=e._ripple)!=null&&d.circle?(s=.15,a=e.clientWidth/2,a=n.center?a:a+Math.sqrt((r-a)**2+(i-a)**2)/4):a=Math.sqrt(e.clientWidth**2+e.clientHeight**2)/2;const o=`${(e.clientWidth-a*2)/2}px`,l=`${(e.clientHeight-a*2)/2}px`,u=n.center?o:`${r-a}px`,c=n.center?l:`${i-a}px`;return{radius:a,scale:s,x:u,y:c,centerX:o,centerY:l}},X0={show(t,e){var v;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!((v=e==null?void 0:e._ripple)!=null&&v.enabled))return;const r=document.createElement("span"),i=document.createElement("span");r.appendChild(i),r.className="v-ripple__container",n.class&&(r.className+=` ${n.class}`);const{radius:a,scale:s,x:o,y:l,centerX:u,centerY:c}=yP(t,e,n),d=`${a*2}px`;i.className="v-ripple__animation",i.style.width=d,i.style.height=d,e.appendChild(r);const h=window.getComputedStyle(e);h&&h.position==="static"&&(e.style.position="relative",e.dataset.previousPosition="static"),i.classList.add("v-ripple__animation--enter"),i.classList.add("v-ripple__animation--visible"),O_(i,`translate(${o}, ${l}) scale3d(${s},${s},${s})`),i.dataset.activated=String(performance.now()),requestAnimationFrame(()=>{requestAnimationFrame(()=>{i.classList.remove("v-ripple__animation--enter"),i.classList.add("v-ripple__animation--in"),O_(i,`translate(${u}, ${c}) scale3d(1,1,1)`)})})},hide(t){var a;if(!((a=t==null?void 0:t._ripple)!=null&&a.enabled))return;const e=t.getElementsByClassName("v-ripple__animation");if(e.length===0)return;const n=Array.from(e).findLast(s=>!s.dataset.isHiding);if(n)n.dataset.isHiding="true";else return;const r=performance.now()-Number(n.dataset.activated),i=Math.max(250-r,0);setTimeout(()=>{n.classList.remove("v-ripple__animation--in"),n.classList.add("v-ripple__animation--out"),setTimeout(()=>{var o;t.getElementsByClassName("v-ripple__animation").length===1&&t.dataset.previousPosition&&(t.style.position=t.dataset.previousPosition,delete t.dataset.previousPosition),((o=n.parentNode)==null?void 0:o.parentNode)===t&&t.removeChild(n.parentNode)},300)},i)}};function Z6(t){return typeof t>"u"||!!t}function Tf(t){const e={},n=t.currentTarget;if(!(!(n!=null&&n._ripple)||n._ripple.touched||t[$v])){if(t[$v]=!0,Pv(t))n._ripple.touched=!0,n._ripple.isTouch=!0;else if(n._ripple.isTouch)return;if(e.center=n._ripple.centered||Y6(t),n._ripple.class&&(e.class=n._ripple.class),Pv(t)){if(n._ripple.showTimerCommit)return;n._ripple.showTimerCommit=()=>{X0.show(t,n,e)},n._ripple.showTimer=window.setTimeout(()=>{var r;(r=n==null?void 0:n._ripple)!=null&&r.showTimerCommit&&(n._ripple.showTimerCommit(),n._ripple.showTimerCommit=null)},vP)}else X0.show(t,n,e)}}function N_(t){t[$v]=!0}function ta(t){const e=t.currentTarget;if(e!=null&&e._ripple){if(window.clearTimeout(e._ripple.showTimer),t.type==="touchend"&&e._ripple.showTimerCommit){e._ripple.showTimerCommit(),e._ripple.showTimerCommit=null,e._ripple.showTimer=window.setTimeout(()=>{ta(t)});return}window.setTimeout(()=>{e._ripple&&(e._ripple.touched=!1)}),X0.hide(e)}}function J6(t){const e=t.currentTarget;e!=null&&e._ripple&&(e._ripple.showTimerCommit&&(e._ripple.showTimerCommit=null),window.clearTimeout(e._ripple.showTimer))}let Cf=!1;function B_(t,e){!Cf&&e.includes(t.key)&&(Cf=!0,Tf(t))}function Q6(t){Cf=!1,ta(t)}function e8(t){Cf&&(Cf=!1,ta(t))}function t8(t,e,n){const{value:r,modifiers:i}=e,a=Z6(r);a||X0.hide(t),t._ripple=t._ripple??{},t._ripple.enabled=a,t._ripple.centered=i.center,t._ripple.circle=i.circle;const s=B0(r)?r:{};s.class&&(t._ripple.class=s.class);const o=s.keys??["Enter","Space"];if(t._ripple.keyDownHandler=l=>B_(l,o),a&&!n){if(i.stop){t.addEventListener("touchstart",N_,{passive:!0}),t.addEventListener("mousedown",N_);return}t.addEventListener("touchstart",Tf,{passive:!0}),t.addEventListener("touchend",ta,{passive:!0}),t.addEventListener("touchmove",J6,{passive:!0}),t.addEventListener("touchcancel",ta),t.addEventListener("mousedown",Tf),t.addEventListener("mouseup",ta),t.addEventListener("mouseleave",ta),t.addEventListener("keydown",l=>B_(l,o)),t.addEventListener("keyup",Q6),t.addEventListener("blur",e8),t.addEventListener("dragstart",ta,{passive:!0})}else!a&&n&&n8(t)}function n8(t){var e;t.removeEventListener("mousedown",Tf),t.removeEventListener("touchstart",Tf),t.removeEventListener("touchend",ta),t.removeEventListener("touchmove",J6),t.removeEventListener("touchcancel",ta),t.removeEventListener("mouseup",ta),t.removeEventListener("mouseleave",ta),(e=t._ripple)!=null&&e.keyDownHandler&&t.removeEventListener("keydown",t._ripple.keyDownHandler),t.removeEventListener("keyup",Q6),t.removeEventListener("dragstart",ta),t.removeEventListener("blur",e8)}function _P(t,e){t8(t,e,!1)}function bP(t){n8(t),delete t._ripple}function xP(t,e){if(e.value===e.oldValue)return;const n=Z6(e.oldValue);t8(t,e,n)}const io={mounted:_P,unmounted:bP,updated:xP},r8=Et({active:{type:Boolean,default:void 0},activeColor:String,baseColor:String,symbol:{type:null,default:W6},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:pr,appendIcon:pr,block:Boolean,readonly:Boolean,slim:Boolean,stacked:Boolean,ripple:{type:[Boolean,Object],default:!0},text:{type:[String,Number,Boolean],default:void 0},...ll(),...In(),...As(),...ks(),...cl(),...U6(),...X6(),...Ep(),...U1(),...ja(),...W1(),...Sp(),...br({tag:"button"}),...Kr(),...qc({variant:"elevated"})},"VBtn"),Ci=Jt()({name:"VBtn",props:r8(),emits:{"group:selected":t=>!0},setup(t,e){let{attrs:n,slots:r}=e;const{themeClasses:i}=Ri(t),{borderClasses:a}=ul(t),{densityClasses:s}=uo(t),{dimensionStyles:o}=Is(t),{elevationClasses:l}=dl(t),{loaderClasses:u}=K6(t),{locationStyles:c}=Tp(t),{positionClasses:d}=V1(t),{roundedClasses:h}=Xa(t),{sizeClasses:v,sizeStyles:x}=Mp(t),_=V6(t,t.symbol,!1),b=H1(t,n),S=Be(()=>{var fe;return t.active!==void 0?t.active:b.isLink.value?(fe=b.isActive)==null?void 0:fe.value:_==null?void 0:_.isSelected.value}),E=dt(()=>S.value?t.activeColor??t.color:t.color),C=Be(()=>{var Q,G;return{color:(_==null?void 0:_.isSelected.value)&&(!b.isLink.value||((Q=b.isActive)==null?void 0:Q.value))||!_||((G=b.isActive)==null?void 0:G.value)?E.value??t.baseColor:t.baseColor,variant:t.variant}}),{colorClasses:A,colorStyles:D,variantClasses:O}=wp(C),V=Be(()=>(_==null?void 0:_.disabled.value)||t.disabled),P=dt(()=>t.variant==="elevated"&&!(t.disabled||t.flat||t.border)),U=Be(()=>{if(!(t.value===void 0||typeof t.value=="symbol"))return Object(t.value)===t.value?JSON.stringify(t.value,null,0):t.value});function Y(fe){var Q;V.value||b.isLink.value&&(fe.metaKey||fe.ctrlKey||fe.shiftKey||fe.button!==0||n.target==="_blank")||((Q=b.navigate)==null||Q.call(b,fe),_==null||_.toggle())}return gP(b,_==null?void 0:_.select),vn(()=>{const fe=b.isLink.value?"a":t.tag,Q=!!(t.prependIcon||r.prepend),G=!!(t.appendIcon||r.append),re=!!(t.icon&&t.icon!==!0);return Hi(le(fe,Rn({type:fe==="a"?void 0:"button",class:["v-btn",_==null?void 0:_.selectedClass.value,{"v-btn--active":S.value,"v-btn--block":t.block,"v-btn--disabled":V.value,"v-btn--elevated":P.value,"v-btn--flat":t.flat,"v-btn--icon":!!t.icon,"v-btn--loading":t.loading,"v-btn--readonly":t.readonly,"v-btn--slim":t.slim,"v-btn--stacked":t.stacked},i.value,a.value,A.value,s.value,l.value,u.value,d.value,h.value,v.value,O.value,t.class],style:[D.value,o.value,c.value,x.value,t.style],"aria-busy":t.loading?!0:void 0,disabled:V.value||void 0,tabindex:t.loading||t.readonly?-1:void 0,onClick:Y,value:U.value},b.linkProps),{default:()=>{var he;return[xp(!0,"v-btn"),!t.icon&&Q&&Te("span",{key:"prepend",class:"v-btn__prepend"},[r.prepend?le(Ua,{key:"prepend-defaults",disabled:!t.prependIcon,defaults:{VIcon:{icon:t.prependIcon}}},r.prepend):le(yr,{key:"prepend-icon",icon:t.prependIcon},null)]),Te("span",{class:"v-btn__content","data-no-activator":""},[!r.default&&re?le(yr,{key:"content-icon",icon:t.icon},null):le(Ua,{key:"content-defaults",disabled:!re,defaults:{VIcon:{icon:t.icon}}},{default:()=>{var ye;return[((ye=r.default)==null?void 0:ye.call(r))??fr(t.text)]}})]),!t.icon&&G&&Te("span",{key:"append",class:"v-btn__append"},[r.append?le(Ua,{key:"append-defaults",disabled:!t.appendIcon,defaults:{VIcon:{icon:t.appendIcon}}},r.append):le(yr,{key:"append-icon",icon:t.appendIcon},null)]),!!t.loading&&Te("span",{key:"loader",class:"v-btn__loader"},[((he=r.loader)==null?void 0:he.call(r))??le(q6,{color:typeof t.loading=="boolean"?void 0:t.loading,indeterminate:!0,width:"2"},null)])]}}),[[io,!V.value&&t.ripple,"",{center:!!t.icon}]])}),{group:_}}}),i8=Jt()({name:"VCardActions",props:In(),setup(t,e){let{slots:n}=e;return Wc({VBtn:{slim:!0,variant:"text"}}),vn(()=>{var r;return Te("div",{class:Wt(["v-card-actions",t.class]),style:yn(t.style)},[(r=n.default)==null?void 0:r.call(n)])}),{}}}),wP=Et({opacity:[Number,String],...In(),...br()},"VCardSubtitle"),SP=Jt()({name:"VCardSubtitle",props:wP(),setup(t,e){let{slots:n}=e;return vn(()=>le(t.tag,{class:Wt(["v-card-subtitle",t.class]),style:yn([{"--v-card-subtitle-opacity":t.opacity},t.style])},n)),{}}}),a8=R1("v-card-title");function MP(t){return{aspectStyles:Be(()=>{const e=Number(t.aspectRatio);return e?{paddingBottom:String(1/e*100)+"%"}:void 0})}}const s8=Et({aspectRatio:[String,Number],contentClass:null,inline:Boolean,...In(),...ks()},"VResponsive"),F_=Jt()({name:"VResponsive",props:s8(),setup(t,e){let{slots:n}=e;const{aspectStyles:r}=MP(t),{dimensionStyles:i}=Is(t);return vn(()=>{var a;return Te("div",{class:Wt(["v-responsive",{"v-responsive--inline":t.inline},t.class]),style:yn([i.value,t.style])},[Te("div",{class:"v-responsive__sizer",style:yn(r.value)},null),(a=n.additional)==null?void 0:a.call(n),n.default&&Te("div",{class:Wt(["v-responsive__content",t.contentClass])},[n.default()])])}),{}}}),G1=Et({transition:{type:null,default:"fade-transition",validator:t=>t!==!0}},"transition"),Ko=(t,e)=>{let{slots:n}=e;const{transition:r,disabled:i,group:a,...s}=t,{component:o=a?T1:cu,...l}=B0(r)?r:{};let u;return B0(r)?u=Rn(l,Yk({disabled:i,group:a}),s):u=Rn({name:i||!r?"":r},s),qa(o,u,n)};function EP(t,e){if(!C1)return;const n=e.modifiers||{},r=e.value,{handler:i,options:a}=typeof r=="object"?r:{handler:r,options:{}},s=new IntersectionObserver(function(){var d;let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],l=arguments.length>1?arguments[1]:void 0;const u=(d=t._observe)==null?void 0:d[e.instance.$.uid];if(!u)return;const c=o.some(h=>h.isIntersecting);i&&(!n.quiet||u.init)&&(!n.once||c||u.init)&&i(c,o,l),c&&n.once?o8(t,e):u.init=!0},a);t._observe=Object(t._observe),t._observe[e.instance.$.uid]={init:!1,observer:s},s.observe(t)}function o8(t,e){var r;const n=(r=t._observe)==null?void 0:r[e.instance.$.uid];n&&(n.observer.unobserve(t),delete t._observe[e.instance.$.uid])}const U_={mounted:EP,unmounted:o8},TP=Et({absolute:Boolean,alt:String,cover:Boolean,color:String,draggable:{type:[Boolean,String],default:void 0},eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},crossorigin:String,referrerpolicy:String,srcset:String,position:String,...s8(),...In(),...ja(),...G1()},"VImg"),ya=Jt()({name:"VImg",directives:{vIntersect:U_},props:TP(),emits:{loadstart:t=>!0,load:t=>!0,error:t=>!0},setup(t,e){let{emit:n,slots:r}=e;const{backgroundColorClasses:i,backgroundColorStyles:a}=ra(()=>t.color),{roundedClasses:s}=Xa(t),o=kr("VImg"),l=rn(""),u=cn(),c=rn(t.eager?"loading":"idle"),d=rn(),h=rn(),v=Be(()=>t.src&&typeof t.src=="object"?{src:t.src.src,srcset:t.srcset||t.src.srcset,lazySrc:t.lazySrc||t.src.lazySrc,aspect:Number(t.aspectRatio||t.src.aspect||0)}:{src:t.src,srcset:t.srcset,lazySrc:t.lazySrc,aspect:Number(t.aspectRatio||0)}),x=Be(()=>v.value.aspect||d.value/h.value||0);An(()=>t.src,()=>{_(c.value!=="idle")}),An(x,(Q,G)=>{!Q&&G&&u.value&&A(u.value)}),Of(()=>_());function _(Q){if(!(t.eager&&Q)&&!(C1&&!Q&&!t.eager)){if(c.value="loading",v.value.lazySrc){const G=new Image;G.src=v.value.lazySrc,A(G,null)}v.value.src&&Wi(()=>{var G;n("loadstart",((G=u.value)==null?void 0:G.currentSrc)||v.value.src),setTimeout(()=>{var re;if(!o.isUnmounted)if((re=u.value)!=null&&re.complete){if(u.value.naturalWidth||S(),c.value==="error")return;x.value||A(u.value,null),c.value==="loading"&&b()}else x.value||A(u.value),E()})})}}function b(){var Q;o.isUnmounted||(E(),A(u.value),c.value="loaded",n("load",((Q=u.value)==null?void 0:Q.currentSrc)||v.value.src))}function S(){var Q;o.isUnmounted||(c.value="error",n("error",((Q=u.value)==null?void 0:Q.currentSrc)||v.value.src))}function E(){const Q=u.value;Q&&(l.value=Q.currentSrc||Q.src)}let C=-1;sa(()=>{clearTimeout(C)});function A(Q){let G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const re=()=>{if(clearTimeout(C),o.isUnmounted)return;const{naturalHeight:he,naturalWidth:ye}=Q;he||ye?(d.value=ye,h.value=he):!Q.complete&&c.value==="loading"&&G!=null?C=window.setTimeout(re,G):(Q.currentSrc.endsWith(".svg")||Q.currentSrc.startsWith("data:image/svg+xml"))&&(d.value=1,h.value=1)};re()}const D=dt(()=>({"v-img__img--cover":t.cover,"v-img__img--contain":!t.cover})),O=()=>{var re;if(!v.value.src||c.value==="idle")return null;const Q=Te("img",{class:Wt(["v-img__img",D.value]),style:{objectPosition:t.position},crossorigin:t.crossorigin,src:v.value.src,srcset:v.value.srcset,alt:t.alt,referrerpolicy:t.referrerpolicy,draggable:t.draggable,sizes:t.sizes,ref:u,onLoad:b,onError:S},null),G=(re=r.sources)==null?void 0:re.call(r);return le(Ko,{transition:t.transition,appear:!0},{default:()=>[Hi(G?Te("picture",{class:"v-img__picture"},[G,Q]):Q,[[yu,c.value==="loaded"]])]})},V=()=>le(Ko,{transition:t.transition},{default:()=>[v.value.lazySrc&&c.value!=="loaded"&&Te("img",{class:Wt(["v-img__img","v-img__img--preload",D.value]),style:{objectPosition:t.position},crossorigin:t.crossorigin,src:v.value.lazySrc,alt:t.alt,referrerpolicy:t.referrerpolicy,draggable:t.draggable},null)]}),P=()=>r.placeholder?le(Ko,{transition:t.transition,appear:!0},{default:()=>[(c.value==="loading"||c.value==="error"&&!r.error)&&Te("div",{class:"v-img__placeholder"},[r.placeholder()])]}):null,U=()=>r.error?le(Ko,{transition:t.transition,appear:!0},{default:()=>[c.value==="error"&&Te("div",{class:"v-img__error"},[r.error()])]}):null,Y=()=>t.gradient?Te("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${t.gradient})`}},null):null,fe=rn(!1);{const Q=An(x,G=>{G&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{fe.value=!0})}),Q())})}return vn(()=>{const Q=F_.filterProps(t);return Hi(le(F_,Rn({class:["v-img",{"v-img--absolute":t.absolute,"v-img--booting":!fe.value},i.value,s.value,t.class],style:[{width:nn(t.width==="auto"?d.value:t.width)},a.value,t.style]},Q,{aspectRatio:x.value,"aria-label":t.alt,role:t.alt?"img":void 0}),{additional:()=>Te(On,null,[le(O,null,null),le(V,null,null),le(Y,null,null),le(P,null,null),le(U,null,null)]),default:r.default}),[[U_,{handler:_,options:t.options},null,{once:!0}]])}),{currentSrc:l,image:u,state:c,naturalWidth:d,naturalHeight:h}}}),CP=Et({start:Boolean,end:Boolean,icon:pr,image:String,text:String,...ll(),...In(),...As(),...ja(),...Sp(),...br(),...Kr(),...qc({variant:"flat"})},"VAvatar"),Af=Jt()({name:"VAvatar",props:CP(),setup(t,e){let{slots:n}=e;const{themeClasses:r}=Ri(t),{borderClasses:i}=ul(t),{colorClasses:a,colorStyles:s,variantClasses:o}=wp(t),{densityClasses:l}=uo(t),{roundedClasses:u}=Xa(t),{sizeClasses:c,sizeStyles:d}=Mp(t);return vn(()=>le(t.tag,{class:Wt(["v-avatar",{"v-avatar--start":t.start,"v-avatar--end":t.end},r.value,i.value,a.value,l.value,u.value,c.value,o.value,t.class]),style:yn([s.value,d.value,t.style])},{default:()=>[n.default?le(Ua,{key:"content-defaults",defaults:{VImg:{cover:!0,src:t.image},VIcon:{icon:t.icon}}},{default:()=>[n.default()]}):t.image?le(ya,{key:"image",src:t.image,alt:"",cover:!0},null):t.icon?le(yr,{key:"icon",icon:t.icon},null):t.text,xp(!1,"v-avatar")]})),{}}}),AP=Et({appendAvatar:String,appendIcon:pr,prependAvatar:String,prependIcon:pr,subtitle:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...In(),...As()},"VCardItem"),kP=Jt()({name:"VCardItem",props:AP(),setup(t,e){let{slots:n}=e;return vn(()=>{var u;const r=!!(t.prependAvatar||t.prependIcon),i=!!(r||n.prepend),a=!!(t.appendAvatar||t.appendIcon),s=!!(a||n.append),o=!!(t.title!=null||n.title),l=!!(t.subtitle!=null||n.subtitle);return Te("div",{class:Wt(["v-card-item",t.class]),style:yn(t.style)},[i&&Te("div",{key:"prepend",class:"v-card-item__prepend"},[n.prepend?le(Ua,{key:"prepend-defaults",disabled:!r,defaults:{VAvatar:{density:t.density,image:t.prependAvatar},VIcon:{density:t.density,icon:t.prependIcon}}},n.prepend):Te(On,null,[t.prependAvatar&&le(Af,{key:"prepend-avatar",density:t.density,image:t.prependAvatar},null),t.prependIcon&&le(yr,{key:"prepend-icon",density:t.density,icon:t.prependIcon},null)])]),Te("div",{class:"v-card-item__content"},[o&&le(a8,{key:"title"},{default:()=>{var c;return[((c=n.title)==null?void 0:c.call(n))??fr(t.title)]}}),l&&le(SP,{key:"subtitle"},{default:()=>{var c;return[((c=n.subtitle)==null?void 0:c.call(n))??fr(t.subtitle)]}}),(u=n.default)==null?void 0:u.call(n)]),s&&Te("div",{key:"append",class:"v-card-item__append"},[n.append?le(Ua,{key:"append-defaults",disabled:!a,defaults:{VAvatar:{density:t.density,image:t.appendAvatar},VIcon:{density:t.density,icon:t.appendIcon}}},n.append):Te(On,null,[t.appendIcon&&le(yr,{key:"append-icon",density:t.density,icon:t.appendIcon},null),t.appendAvatar&&le(Af,{key:"append-avatar",density:t.density,image:t.appendAvatar},null)])])])}),{}}}),IP=Et({opacity:[Number,String],...In(),...br()},"VCardText"),Mi=Jt()({name:"VCardText",props:IP(),setup(t,e){let{slots:n}=e;return vn(()=>le(t.tag,{class:Wt(["v-card-text",t.class]),style:yn([{"--v-card-text-opacity":t.opacity},t.style])},n)),{}}}),$P=Et({appendAvatar:String,appendIcon:pr,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:pr,ripple:{type:[Boolean,Object],default:!0},subtitle:{type:[String,Number,Boolean],default:void 0},text:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...ll(),...In(),...As(),...ks(),...cl(),...X6(),...Ep(),...U1(),...ja(),...W1(),...br(),...Kr(),...qc({variant:"elevated"})},"VCard"),su=Jt()({name:"VCard",directives:{vRipple:io},props:$P(),setup(t,e){let{attrs:n,slots:r}=e;const{themeClasses:i}=Ri(t),{borderClasses:a}=ul(t),{colorClasses:s,colorStyles:o,variantClasses:l}=wp(t),{densityClasses:u}=uo(t),{dimensionStyles:c}=Is(t),{elevationClasses:d}=dl(t),{loaderClasses:h}=K6(t),{locationStyles:v}=Tp(t),{positionClasses:x}=V1(t),{roundedClasses:_}=Xa(t),b=H1(t,n);return vn(()=>{const S=t.link!==!1&&b.isLink.value,E=!t.disabled&&t.link!==!1&&(t.link||b.isClickable.value),C=S?"a":t.tag,A=!!(r.title||t.title!=null),D=!!(r.subtitle||t.subtitle!=null),O=A||D,V=!!(r.append||t.appendAvatar||t.appendIcon),P=!!(r.prepend||t.prependAvatar||t.prependIcon),U=!!(r.image||t.image),Y=O||P||V,fe=!!(r.text||t.text!=null);return Hi(le(C,Rn({class:["v-card",{"v-card--disabled":t.disabled,"v-card--flat":t.flat,"v-card--hover":t.hover&&!(t.disabled||t.flat),"v-card--link":E},i.value,a.value,s.value,u.value,d.value,h.value,x.value,_.value,l.value,t.class],style:[o.value,c.value,v.value,t.style],onClick:E&&b.navigate,tabindex:t.disabled?-1:void 0},b.linkProps),{default:()=>{var Q;return[U&&Te("div",{key:"image",class:"v-card__image"},[r.image?le(Ua,{key:"image-defaults",disabled:!t.image,defaults:{VImg:{cover:!0,src:t.image}}},r.image):le(ya,{key:"image-img",cover:!0,src:t.image},null)]),le(dP,{name:"v-card",active:!!t.loading,color:typeof t.loading=="boolean"?void 0:t.loading},{default:r.loader}),Y&&le(kP,{key:"item",prependAvatar:t.prependAvatar,prependIcon:t.prependIcon,title:t.title,subtitle:t.subtitle,appendAvatar:t.appendAvatar,appendIcon:t.appendIcon},{default:r.item,prepend:r.prepend,title:r.title,subtitle:r.subtitle,append:r.append}),fe&&le(Mi,{key:"text"},{default:()=>{var G;return[((G=r.text)==null?void 0:G.call(r))??t.text]}}),(Q=r.default)==null?void 0:Q.call(r),r.actions&&le(i8,null,{default:r.actions}),xp(E,"v-card")]}}),[[io,E&&t.ripple]])}),{}}}),PP=Et({color:String,inset:Boolean,length:[Number,String],opacity:[Number,String],thickness:[Number,String],vertical:Boolean,...In(),...Kr()},"VDivider"),lf=Jt()({name:"VDivider",props:PP(),setup(t,e){let{attrs:n,slots:r}=e;const{themeClasses:i}=Ri(t),{textColorClasses:a,textColorStyles:s}=Es(()=>t.color),o=Be(()=>{const l={};return t.length&&(l[t.vertical?"height":"width"]=nn(t.length)),t.thickness&&(l[t.vertical?"borderRightWidth":"borderTopWidth"]=nn(t.thickness)),l});return vn(()=>{const l=Te("hr",{class:Wt([{"v-divider":!0,"v-divider--inset":t.inset,"v-divider--vertical":t.vertical},i.value,a.value,t.class]),style:yn([o.value,s.value,{"--v-border-opacity":t.opacity},t.style]),"aria-orientation":!n.role||n.role==="separator"?t.vertical?"vertical":"horizontal":void 0,role:`${n.role||"separator"}`},null);return r.default?Te("div",{class:Wt(["v-divider__wrapper",{"v-divider__wrapper--vertical":t.vertical,"v-divider__wrapper--inset":t.inset}])},[l,Te("div",{class:"v-divider__content"},[r.default()]),l]):l}),{}}}),RP=Et({fluid:{type:Boolean,default:!1},...In(),...ks(),...br()},"VContainer"),us=Jt()({name:"VContainer",props:RP(),setup(t,e){let{slots:n}=e;const{rtlClasses:r}=Sa(),{dimensionStyles:i}=Is(t);return vn(()=>le(t.tag,{class:Wt(["v-container",{"v-container--fluid":t.fluid},r.value,t.class]),style:yn([i.value,t.style])},n)),{}}}),l8=yp.reduce((t,e)=>(t[e]={type:[Boolean,String,Number],default:!1},t),{}),u8=yp.reduce((t,e)=>{const n="offset"+so(e);return t[n]={type:[String,Number],default:null},t},{}),c8=yp.reduce((t,e)=>{const n="order"+so(e);return t[n]={type:[String,Number],default:null},t},{}),V_={col:Object.keys(l8),offset:Object.keys(u8),order:Object.keys(c8)};function DP(t,e,n){let r=t;if(!(n==null||n===!1)){if(e){const i=e.replace(t,"");r+=`-${i}`}return t==="col"&&(r="v-"+r),t==="col"&&(n===""||n===!0)||(r+=`-${n}`),r.toLowerCase()}}const LP=["auto","start","end","center","baseline","stretch"],zP=Et({cols:{type:[Boolean,String,Number],default:!1},...l8,offset:{type:[String,Number],default:null},...u8,order:{type:[String,Number],default:null},...c8,alignSelf:{type:String,default:null,validator:t=>LP.includes(t)},...In(),...br()},"VCol"),Mr=Jt()({name:"VCol",props:zP(),setup(t,e){let{slots:n}=e;const r=Be(()=>{const i=[];let a;for(a in V_)V_[a].forEach(o=>{const l=t[o],u=DP(a,o,l);u&&i.push(u)});const s=i.some(o=>o.startsWith("v-col-"));return i.push({"v-col":!s||!t.cols,[`v-col-${t.cols}`]:t.cols,[`offset-${t.offset}`]:t.offset,[`order-${t.order}`]:t.order,[`align-self-${t.alignSelf}`]:t.alignSelf}),i});return()=>{var i;return qa(t.tag,{class:[r.value,t.class],style:t.style},(i=n.default)==null?void 0:i.call(n))}}}),q1=["start","end","center"],d8=["space-between","space-around","space-evenly"];function j1(t,e){return yp.reduce((n,r)=>{const i=t+so(r);return n[i]=e(),n},{})}const OP=[...q1,"baseline","stretch"],f8=t=>OP.includes(t),h8=j1("align",()=>({type:String,default:null,validator:f8})),NP=[...q1,...d8],p8=t=>NP.includes(t),m8=j1("justify",()=>({type:String,default:null,validator:p8})),BP=[...q1,...d8,"stretch"],g8=t=>BP.includes(t),v8=j1("alignContent",()=>({type:String,default:null,validator:g8})),H_={align:Object.keys(h8),justify:Object.keys(m8),alignContent:Object.keys(v8)},FP={align:"align",justify:"justify",alignContent:"align-content"};function UP(t,e,n){let r=FP[t];if(n!=null){if(e){const i=e.replace(t,"");r+=`-${i}`}return r+=`-${n}`,r.toLowerCase()}}const VP=Et({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:f8},...h8,justify:{type:String,default:null,validator:p8},...m8,alignContent:{type:String,default:null,validator:g8},...v8,...In(),...br()},"VRow"),si=Jt()({name:"VRow",props:VP(),setup(t,e){let{slots:n}=e;const r=Be(()=>{const i=[];let a;for(a in H_)H_[a].forEach(s=>{const o=t[s],l=UP(a,s,o);l&&i.push(l)});return i.push({"v-row--no-gutters":t.noGutters,"v-row--dense":t.dense,[`align-${t.align}`]:t.align,[`justify-${t.justify}`]:t.justify,[`align-content-${t.alignContent}`]:t.alignContent}),i});return()=>{var i;return qa(t.tag,{class:["v-row",r.value,t.class],style:t.style},(i=n.default)==null?void 0:i.call(n))}}}),HP=R1("v-spacer","div","VSpacer"),WP=Et({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function oa(t,e,n){return Jt()({name:t,props:WP({mode:n,origin:e}),setup(r,i){let{slots:a}=i;const s={onBeforeEnter(o){r.origin&&(o.style.transformOrigin=r.origin)},onLeave(o){if(r.leaveAbsolute){const{offsetTop:l,offsetLeft:u,offsetWidth:c,offsetHeight:d}=o;o._transitionInitialStyles={position:o.style.position,top:o.style.top,left:o.style.left,width:o.style.width,height:o.style.height},o.style.position="absolute",o.style.top=`${l}px`,o.style.left=`${u}px`,o.style.width=`${c}px`,o.style.height=`${d}px`}r.hideOnLeave&&o.style.setProperty("display","none","important")},onAfterLeave(o){if(r.leaveAbsolute&&(o!=null&&o._transitionInitialStyles)){const{position:l,top:u,left:c,width:d,height:h}=o._transitionInitialStyles;delete o._transitionInitialStyles,o.style.position=l||"",o.style.top=u||"",o.style.left=c||"",o.style.width=d||"",o.style.height=h||""}}};return()=>{const o=r.group?T1:cu;return qa(o,{name:r.disabled?"":t,css:!r.disabled,...r.group?void 0:{mode:r.mode},...r.disabled?{}:s},a.default)}}})}function y8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return Jt()({name:t,props:{mode:{type:String,default:n},disabled:Boolean,group:Boolean},setup(r,i){let{slots:a}=i;const s=r.group?T1:cu;return()=>qa(s,{name:r.disabled?"":t,css:!r.disabled,...r.disabled?{}:e},a.default)}})}function _8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",r=Vi(`offset-${n}`);return{onBeforeEnter(s){s._parent=s.parentNode,s._initialStyle={transition:s.style.transition,overflow:s.style.overflow,[n]:s.style[n]}},onEnter(s){const o=s._initialStyle;if(!o)return;s.style.setProperty("transition","none","important"),s.style.overflow="hidden";const l=`${s[r]}px`;s.style[n]="0",s.offsetHeight,s.style.transition=o.transition,t&&s._parent&&s._parent.classList.add(t),requestAnimationFrame(()=>{s.style[n]=l})},onAfterEnter:a,onEnterCancelled:a,onLeave(s){s._initialStyle={transition:"",overflow:s.style.overflow,[n]:s.style[n]},s.style.overflow="hidden",s.style[n]=`${s[r]}px`,s.offsetHeight,requestAnimationFrame(()=>s.style[n]="0")},onAfterLeave:i,onLeaveCancelled:i};function i(s){t&&s._parent&&s._parent.classList.remove(t),a(s)}function a(s){if(!s._initialStyle)return;const o=s._initialStyle[n];s.style.overflow=s._initialStyle.overflow,o!=null&&(s.style[n]=o),delete s._initialStyle}}const GP=Et({target:[Object,Array]},"v-dialog-transition"),bm=new WeakMap,qP=Jt()({name:"VDialogTransition",props:GP(),setup(t,e){let{slots:n}=e;const r={onBeforeEnter(i){i.style.pointerEvents="none",i.style.visibility="hidden"},async onEnter(i,a){var v;await new Promise(x=>requestAnimationFrame(x)),await new Promise(x=>requestAnimationFrame(x)),i.style.visibility="";const s=G_(t.target,i),{x:o,y:l,sx:u,sy:c,speed:d}=s;bm.set(i,s);const h=_c(i,[{transform:`translate(${o}px, ${l}px) scale(${u}, ${c})`,opacity:0},{}],{duration:225*d,easing:T9});(v=W_(i))==null||v.forEach(x=>{_c(x,[{opacity:0},{opacity:0,offset:.33},{}],{duration:450*d,easing:V0})}),h.finished.then(()=>a())},onAfterEnter(i){i.style.removeProperty("pointer-events")},onBeforeLeave(i){i.style.pointerEvents="none"},async onLeave(i,a){var v;await new Promise(x=>requestAnimationFrame(x));let s;!bm.has(i)||Array.isArray(t.target)||t.target.offsetParent||t.target.getClientRects().length?s=G_(t.target,i):s=bm.get(i);const{x:o,y:l,sx:u,sy:c,speed:d}=s;_c(i,[{},{transform:`translate(${o}px, ${l}px) scale(${u}, ${c})`,opacity:0}],{duration:125*d,easing:C9}).finished.then(()=>a()),(v=W_(i))==null||v.forEach(x=>{_c(x,[{},{opacity:0,offset:.2},{opacity:0}],{duration:250*d,easing:V0})})},onAfterLeave(i){i.style.removeProperty("pointer-events")}};return()=>t.target?le(cu,Rn({name:"dialog-transition"},r,{css:!1}),n):le(cu,{name:"dialog-transition"},n)}});function W_(t){var n;const e=(n=t.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:n.children;return e&&[...e]}function G_(t,e){const n=n6(t),r=r6(e),[i,a]=getComputedStyle(e).transformOrigin.split(" ").map(S=>parseFloat(S)),[s,o]=getComputedStyle(e).getPropertyValue("--v-overlay-anchor-origin").split(" ");let l=n.left+n.width/2;s==="left"||o==="left"?l-=n.width/2:(s==="right"||o==="right")&&(l+=n.width/2);let u=n.top+n.height/2;s==="top"||o==="top"?u-=n.height/2:(s==="bottom"||o==="bottom")&&(u+=n.height/2);const c=n.width/r.width,d=n.height/r.height,h=Math.max(1,c,d),v=c/h||0,x=d/h||0,_=r.width*r.height/(window.innerWidth*window.innerHeight),b=_>.12?Math.min(1.5,(_-.12)*10+1):1;return{x:l-(i+r.left),y:u-(a+r.top),sx:v,sy:x,speed:b}}oa("fab-transition","center center","out-in");oa("dialog-bottom-transition");oa("dialog-top-transition");const K0=oa("fade-transition"),jP=oa("scale-transition");oa("scroll-x-transition");oa("scroll-x-reverse-transition");oa("scroll-y-transition");oa("scroll-y-reverse-transition");oa("slide-x-transition");oa("slide-x-reverse-transition");const XP=oa("slide-y-transition");oa("slide-y-reverse-transition");const b8=y8("expand-transition",_8());y8("expand-x-transition",_8("",!0));const KP={class:"flex-grow-0"},YP={__name:"ExpansionCard",props:{expanded:{type:Boolean,default:!1}},emits:["update:expanded"],setup(t,{emit:e}){const n=t,r=e;function i(){r("update:expanded",!n.expanded)}return(a,s)=>(Pn(),Oi(su,{class:"mb-4 h-100 d-flex flex-column"},{default:Ne(()=>[Te("div",KP,[Wd(a.$slots,"media",{},()=>[le(ya,{height:"300",contain:"",class:"grey lighten-3"})])]),le(a8,{class:"text-h6 flex-grow-0"},{default:Ne(()=>[Wd(a.$slots,"title")]),_:3}),le(Mi,{class:"text-subtitle-1 flex-grow-0"},{default:Ne(()=>[Wd(a.$slots,"subtitle")]),_:3}),le(b8,null,{default:Ne(()=>[Hi(Te("div",null,[le(lf),le(Mi,null,{default:Ne(()=>[Wd(a.$slots,"default")]),_:3})],512),[[yu,t.expanded]])]),_:3}),le(i8,{class:"mt-auto"},{default:Ne(()=>[le(HP),le(Ci,{text:"",color:"primary",onClick:i},{default:Ne(()=>[Mt(fr(t.expanded?"Show Less":"Show More")+" ",1),le(yr,null,{default:Ne(()=>[Mt(fr(t.expanded?"mdi-chevron-up":"mdi-chevron-down"),1)]),_:1})]),_:1})]),_:1})]),_:3}))}},Cp=(t,e)=>{const n=t.__vccOpts||t;for(const[r,i]of e)n[r]=i;return n},ZP={class:"video-container"},JP={key:0,class:"loading-overlay"},QP={__name:"LazyVideo",props:{showLoading:{type:Boolean,default:!0}},setup(t){const e=t,n=cn(null);let r=null,i=cn(e.showLoading),a=cn(!0);return ol(()=>{r=new IntersectionObserver(([s])=>{n.value&&(s.isIntersecting?n.value.play().catch(()=>{}):n.value.pause())},{threshold:.1}),n.value&&(r.observe(n.value),n.value.pause())}),sa(()=>{r&&n.value&&(r.unobserve(n.value),r.disconnect())}),(s,o)=>(Pn(),vr("div",ZP,[Te("video",Rn({ref_key:"videoEl",ref:n},s.$attrs,{onWaiting:o[0]||(o[0]=l=>lr(a)?a.value=!0:a=!0),onLoadeddata:o[1]||(o[1]=l=>lr(a)?a.value=!1:a=!1),onCanplay:o[2]||(o[2]=l=>lr(a)?a.value=!1:a=!1),onPlaying:o[3]||(o[3]=l=>lr(a)?a.value=!1:a=!1)}),[Wd(s.$slots,"default",{},void 0,!0)],16),ki(a)&&ki(i)?(Pn(),vr("div",JP,[le(q6,{indeterminate:"",color:"primary"})])):Qi("",!0)]))}},x8=Cp(QP,[["__scopeId","data-v-3d48c171"]]);function eR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var S0={exports:{}},tR=S0.exports,q_;function nR(){return q_||(q_=1,function(t,e){(function(r,i){t.exports=i()})(typeof self<"u"?self:tR,function(){return function(){var n={};(function(){n.d=function(N,f){for(var m in f)n.o(f,m)&&!n.o(N,m)&&Object.defineProperty(N,m,{enumerable:!0,get:f[m]})}})(),function(){n.o=function(N,f){return Object.prototype.hasOwnProperty.call(N,f)}}();var r={};n.d(r,{default:function(){return Kp}});var i=function N(f,m){this.position=void 0;var g="KaTeX parse error: "+f,w,k=m&&m.loc;if(k&&k.start<=k.end){var z=k.lexer.input;w=k.start;var W=k.end;w===z.length?g+=" at end of input: ":g+=" at position "+(w+1)+": ";var ee=z.slice(w,W).replace(/[^]/g,"$&̲"),ue;w>15?ue="…"+z.slice(w-15,w):ue=z.slice(0,w);var Me;W+15<z.length?Me=z.slice(W,W+15)+"…":Me=z.slice(W),g+=ue+ee+Me}var Ue=new Error(g);return Ue.name="ParseError",Ue.__proto__=N.prototype,Ue.position=w,Ue};i.prototype.__proto__=Error.prototype;var a=i,s=function(f,m){return f.indexOf(m)!==-1},o=function(f,m){return f===void 0?m:f},l=/([A-Z])/g,u=function(f){return f.replace(l,"-$1").toLowerCase()},c={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},d=/[&><"']/g;function h(N){return String(N).replace(d,function(f){return c[f]})}var v=function N(f){return f.type==="ordgroup"||f.type==="color"?f.body.length===1?N(f.body[0]):f:f.type==="font"?N(f.body):f},x=function(f){var m=v(f);return m.type==="mathord"||m.type==="textord"||m.type==="atom"},_=function(f){if(!f)throw new Error("Expected non-null, but got "+String(f));return f},b=function(f){var m=/^\s*([^\\/#]*?)(?::|&#0*58|&#x0*3a)/i.exec(f);return m!=null?m[1]:"_relative"},S={contains:s,deflt:o,escape:h,hyphenate:u,getBaseElem:v,isCharacterBox:x,protocolFromUrl:b},E=function(){function N(m){this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,m=m||{},this.displayMode=S.deflt(m.displayMode,!1),this.output=S.deflt(m.output,"htmlAndMathml"),this.leqno=S.deflt(m.leqno,!1),this.fleqn=S.deflt(m.fleqn,!1),this.throwOnError=S.deflt(m.throwOnError,!0),this.errorColor=S.deflt(m.errorColor,"#cc0000"),this.macros=m.macros||{},this.minRuleThickness=Math.max(0,S.deflt(m.minRuleThickness,0)),this.colorIsTextColor=S.deflt(m.colorIsTextColor,!1),this.strict=S.deflt(m.strict,"warn"),this.trust=S.deflt(m.trust,!1),this.maxSize=Math.max(0,S.deflt(m.maxSize,1/0)),this.maxExpand=Math.max(0,S.deflt(m.maxExpand,1e3)),this.globalGroup=S.deflt(m.globalGroup,!1)}var f=N.prototype;return f.reportNonstrict=function(g,w,k){var z=this.strict;if(typeof z=="function"&&(z=z(g,w,k)),!(!z||z==="ignore")){if(z===!0||z==="error")throw new a("LaTeX-incompatible input and strict mode is set to 'error': "+(w+" ["+g+"]"),k);z==="warn"?typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(w+" ["+g+"]")):typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+z+"': "+w+" ["+g+"]"))}},f.useStrictBehavior=function(g,w,k){var z=this.strict;if(typeof z=="function")try{z=z(g,w,k)}catch{z="error"}return!z||z==="ignore"?!1:z===!0||z==="error"?!0:z==="warn"?(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(w+" ["+g+"]")),!1):(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+z+"': "+w+" ["+g+"]")),!1)},f.isTrusted=function(g){g.url&&!g.protocol&&(g.protocol=S.protocolFromUrl(g.url));var w=typeof this.trust=="function"?this.trust(g):this.trust;return!!w},N}(),C=function(){function N(m,g,w){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=m,this.size=g,this.cramped=w}var f=N.prototype;return f.sup=function(){return Q[G[this.id]]},f.sub=function(){return Q[re[this.id]]},f.fracNum=function(){return Q[he[this.id]]},f.fracDen=function(){return Q[ye[this.id]]},f.cramp=function(){return Q[$e[this.id]]},f.text=function(){return Q[_e[this.id]]},f.isTight=function(){return this.size>=2},N}(),A=0,D=1,O=2,V=3,P=4,U=5,Y=6,fe=7,Q=[new C(A,0,!1),new C(D,0,!0),new C(O,1,!1),new C(V,1,!0),new C(P,2,!1),new C(U,2,!0),new C(Y,3,!1),new C(fe,3,!0)],G=[P,U,P,U,Y,fe,Y,fe],re=[U,U,U,U,fe,fe,fe,fe],he=[O,V,P,U,Y,fe,Y,fe],ye=[V,V,U,U,fe,fe,fe,fe],$e=[D,D,V,V,U,U,fe,fe],_e=[A,D,O,V,O,V,O,V],de={DISPLAY:Q[A],TEXT:Q[O],SCRIPT:Q[P],SCRIPTSCRIPT:Q[Y]},Oe=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];function ve(N){for(var f=0;f<Oe.length;f++)for(var m=Oe[f],g=0;g<m.blocks.length;g++){var w=m.blocks[g];if(N>=w[0]&&N<=w[1])return m.name}return null}var ie=[];Oe.forEach(function(N){return N.blocks.forEach(function(f){return ie.push.apply(ie,f)})});function Pe(N){for(var f=0;f<ie.length;f+=2)if(N>=ie[f]&&N<=ie[f+1])return!0;return!1}var et=80,ne=function(f,m){return"M95,"+(622+f+m)+`
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l`+f/2.075+" -"+f+`
c5.3,-9.3,12,-14,20,-14
H400000v`+(40+f)+`H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M`+(834+f)+" "+m+"h400000v"+(40+f)+"h-400000z"},qe=function(f,m){return"M263,"+(601+f+m)+`c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l`+f/2.084+" -"+f+`
c4.7,-7.3,11,-11,19,-11
H40000v`+(40+f)+`H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M`+(1001+f)+" "+m+"h400000v"+(40+f)+"h-400000z"},ge=function(f,m){return"M983 "+(10+f+m)+`
l`+f/3.13+" -"+f+`
c4,-6.7,10,-10,18,-10 H400000v`+(40+f)+`
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M`+(1001+f)+" "+m+"h400000v"+(40+f)+"h-400000z"},xe=function(f,m){return"M424,"+(2398+f+m)+`
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l`+f/4.223+" -"+f+`c4,-6.7,10,-10,18,-10 H400000
v`+(40+f)+`H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M`+(1001+f)+" "+m+`
h400000v`+(40+f)+"h-400000z"},ze=function(f,m){return"M473,"+(2713+f+m)+`
c339.3,-1799.3,509.3,-2700,510,-2702 l`+f/5.298+" -"+f+`
c3.3,-7.3,9.3,-11,18,-11 H400000v`+(40+f)+`H1017.7
s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200
c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26
s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,
606zM`+(1001+f)+" "+m+"h400000v"+(40+f)+"H1017.7z"},Ge=function(f){var m=f/2;return"M400000 "+f+" H0 L"+m+" 0 l65 45 L145 "+(f-80)+" H400000z"},ut=function(f,m,g){var w=g-54-m-f;return"M702 "+(f+m)+"H400000"+(40+f)+`
H742v`+w+`l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 `+m+"H400000v"+(40+f)+"H742z"},ce=function(f,m,g){m=1e3*m;var w="";switch(f){case"sqrtMain":w=ne(m,et);break;case"sqrtSize1":w=qe(m,et);break;case"sqrtSize2":w=ge(m,et);break;case"sqrtSize3":w=xe(m,et);break;case"sqrtSize4":w=ze(m,et);break;case"sqrtTall":w=ut(m,et,g)}return w},me=function(f,m){switch(f){case"⎜":return"M291 0 H417 V"+m+" H291z M291 0 H417 V"+m+" H291z";case"∣":return"M145 0 H188 V"+m+" H145z M145 0 H188 V"+m+" H145z";case"∥":return"M145 0 H188 V"+m+" H145z M145 0 H188 V"+m+" H145z"+("M367 0 H410 V"+m+" H367z M367 0 H410 V"+m+" H367z");case"⎟":return"M457 0 H583 V"+m+" H457z M457 0 H583 V"+m+" H457z";case"⎢":return"M319 0 H403 V"+m+" H319z M319 0 H403 V"+m+" H319z";case"⎥":return"M263 0 H347 V"+m+" H263z M263 0 H347 V"+m+" H263z";case"⎪":return"M384 0 H504 V"+m+" H384z M384 0 H504 V"+m+" H384z";case"⏐":return"M312 0 H355 V"+m+" H312z M312 0 H355 V"+m+" H312z";case"‖":return"M257 0 H300 V"+m+" H257z M257 0 H300 V"+m+" H257z"+("M478 0 H521 V"+m+" H478z M478 0 H521 V"+m+" H478z");default:return""}},ke={doubleleftarrow:`M262 157
l10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3
 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28
 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5
c2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5
 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87
-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7
-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z
m8 0v40h399730v-40zm0 194v40h399730v-40z`,doublerightarrow:`M399738 392l
-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5
 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88
-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68
-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18
-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782
c-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3
-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,leftarrow:`M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z`,leftbrace:`M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,leftbraceunder:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,leftgroup:`M400000 80
H435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0
 435 0h399565z`,leftgroupunder:`M400000 262
H435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219
 435 219h399565z`,leftharpoon:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3
-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5
-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7
-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,leftharpoonplus:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5
 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3
-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7
-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z
m0 0v40h400000v-40z`,leftharpoondown:`M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333
 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5
 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667
-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,leftharpoondownplus:`M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12
 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7
-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0
v40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,lefthook:`M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5
-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3
-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21
 71.5 23h399859zM103 281v-40h399897v40z`,leftlinesegment:`M40 281 V428 H0 V94 H40 V241 H400000 v40z
M40 281 V428 H0 V94 H40 V241 H400000 v40z`,leftmapsto:`M40 281 V448H0V74H40V241H400000v40z
M40 281 V448H0V74H40V241H400000v40z`,leftToFrom:`M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23
-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8
c28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3
 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,longequal:`M0 50 h400000 v40H0z m0 194h40000v40H0z
M0 50 h400000 v40H0z m0 194h40000v40H0z`,midbrace:`M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,midbraceunder:`M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,oiintSize1:`M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6
-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z
m368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8
60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,oiintSize2:`M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8
-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z
m502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2
c0 110 84 276 504 276s502.4-166 502.4-276z`,oiiintSize1:`M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6
-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z
m525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0
85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,oiiintSize2:`M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8
-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z
m770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1
c0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,rightarrow:`M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z`,rightbrace:`M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,rightbraceunder:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,rightgroup:`M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0
 3-1 3-3v-38c-76-158-257-219-435-219H0z`,rightgroupunder:`M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18
 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,rightharpoon:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3
-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2
-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58
 69.2 92 94.5zm0 0v40h399900v-40z`,rightharpoonplus:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11
-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7
 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z
m0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,rightharpoondown:`M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8
 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5
-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95
-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,rightharpoondownplus:`M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8
 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3
 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3
-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z
m0-194v40h400000v-40zm0 0v40h400000v-40z`,righthook:`M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3
 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0
-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21
 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,rightlinesegment:`M399960 241 V94 h40 V428 h-40 V281 H0 v-40z
M399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,rightToFrom:`M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23
 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32
-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142
-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,twoheadleftarrow:`M0 167c68 40
 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69
-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3
-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19
-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101
 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,twoheadrightarrow:`M400000 167
c-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3
 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42
 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333
-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70
 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,tilde1:`M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z`,tilde2:`M344 55.266c-142 0-300.638 81.316-311.5 86.418
-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9
 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114
c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751
 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,tilde3:`M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457
-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0
 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697
 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696
 -338 0-409-156.573-744-156.573z`,tilde4:`M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345
-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409
 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9
 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409
 -175.236-744-175.236z`,vec:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z`,widehat1:`M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,widehat2:`M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat3:`M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat4:`M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widecheck1:`M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,
-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,widecheck2:`M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck3:`M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck4:`M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,baraboveleftarrow:`M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202
c4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5
c-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130
s-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47
121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6
s2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11
c0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z
M100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,rightarrowabovebar:`M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32
-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0
13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39
-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5
-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,baraboveshortleftharpoon:`M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17
c2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21
c-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40
c-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z
M0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,rightharpoonaboveshortbar:`M0,241 l0,40c399126,0,399993,0,399993,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,shortbaraboveleftharpoon:`M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,
1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,
-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z
M93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,shortrightharpoonabovebar:`M53,241l0,40c398570,0,399437,0,399437,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`},Xe=function(){function N(m){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=m,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}var f=N.prototype;return f.hasClass=function(g){return S.contains(this.classes,g)},f.toNode=function(){for(var g=document.createDocumentFragment(),w=0;w<this.children.length;w++)g.appendChild(this.children[w].toNode());return g},f.toMarkup=function(){for(var g="",w=0;w<this.children.length;w++)g+=this.children[w].toMarkup();return g},f.toText=function(){var g=function(k){return k.toText()};return this.children.map(g).join("")},N}(),Ze={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},We={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},gt={Å:"A",Ð:"D",Þ:"o",å:"a",ð:"d",þ:"o",А:"A",Б:"B",В:"B",Г:"F",Д:"A",Е:"E",Ж:"K",З:"3",И:"N",Й:"N",К:"K",Л:"N",М:"M",Н:"H",О:"O",П:"N",Р:"P",С:"C",Т:"T",У:"y",Ф:"O",Х:"X",Ц:"U",Ч:"h",Ш:"W",Щ:"W",Ъ:"B",Ы:"X",Ь:"B",Э:"3",Ю:"X",Я:"R",а:"a",б:"b",в:"a",г:"r",д:"y",е:"e",ж:"m",з:"e",и:"n",й:"n",к:"n",л:"n",м:"m",н:"n",о:"o",п:"n",р:"p",с:"c",т:"o",у:"y",ф:"b",х:"x",ц:"n",ч:"n",ш:"w",щ:"w",ъ:"a",ы:"m",ь:"a",э:"e",ю:"m",я:"r"};function ht(N,f){Ze[N]=f}function vt(N,f,m){if(!Ze[f])throw new Error("Font metrics not found for font: "+f+".");var g=N.charCodeAt(0),w=Ze[f][g];if(!w&&N[0]in gt&&(g=gt[N[0]].charCodeAt(0),w=Ze[f][g]),!w&&m==="text"&&Pe(g)&&(w=Ze[f][77]),w)return{depth:w[0],height:w[1],italic:w[2],skew:w[3],width:w[4]}}var ct={};function se(N){var f;if(N>=5?f=0:N>=3?f=1:f=2,!ct[f]){var m=ct[f]={cssEmPerMu:We.quad[f]/18};for(var g in We)We.hasOwnProperty(g)&&(m[g]=We[g][f])}return ct[f]}var K=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],De=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],Je=function(f,m){return m.size<2?f:K[f-1][m.size-1]},tt=function(){function N(m){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=m.style,this.color=m.color,this.size=m.size||N.BASESIZE,this.textSize=m.textSize||this.size,this.phantom=!!m.phantom,this.font=m.font||"",this.fontFamily=m.fontFamily||"",this.fontWeight=m.fontWeight||"",this.fontShape=m.fontShape||"",this.sizeMultiplier=De[this.size-1],this.maxSize=m.maxSize,this.minRuleThickness=m.minRuleThickness,this._fontMetrics=void 0}var f=N.prototype;return f.extend=function(g){var w={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var k in g)g.hasOwnProperty(k)&&(w[k]=g[k]);return new N(w)},f.havingStyle=function(g){return this.style===g?this:this.extend({style:g,size:Je(this.textSize,g)})},f.havingCrampedStyle=function(){return this.havingStyle(this.style.cramp())},f.havingSize=function(g){return this.size===g&&this.textSize===g?this:this.extend({style:this.style.text(),size:g,textSize:g,sizeMultiplier:De[g-1]})},f.havingBaseStyle=function(g){g=g||this.style.text();var w=Je(N.BASESIZE,g);return this.size===w&&this.textSize===N.BASESIZE&&this.style===g?this:this.extend({style:g,size:w})},f.havingBaseSizing=function(){var g;switch(this.style.id){case 4:case 5:g=3;break;case 6:case 7:g=1;break;default:g=6}return this.extend({style:this.style.text(),size:g})},f.withColor=function(g){return this.extend({color:g})},f.withPhantom=function(){return this.extend({phantom:!0})},f.withFont=function(g){return this.extend({font:g})},f.withTextFontFamily=function(g){return this.extend({fontFamily:g,font:""})},f.withTextFontWeight=function(g){return this.extend({fontWeight:g,font:""})},f.withTextFontShape=function(g){return this.extend({fontShape:g,font:""})},f.sizingClasses=function(g){return g.size!==this.size?["sizing","reset-size"+g.size,"size"+this.size]:[]},f.baseSizingClasses=function(){return this.size!==N.BASESIZE?["sizing","reset-size"+this.size,"size"+N.BASESIZE]:[]},f.fontMetrics=function(){return this._fontMetrics||(this._fontMetrics=se(this.size)),this._fontMetrics},f.getColor=function(){return this.phantom?"transparent":this.color},N}();tt.BASESIZE=6;var nt=tt,xt={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:803/800,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:803/800},be={ex:!0,em:!0,mu:!0},Ie=function(f){return typeof f!="string"&&(f=f.unit),f in xt||f in be||f==="ex"},at=function(f,m){var g;if(f.unit in xt)g=xt[f.unit]/m.fontMetrics().ptPerEm/m.sizeMultiplier;else if(f.unit==="mu")g=m.fontMetrics().cssEmPerMu;else{var w;if(m.style.isTight()?w=m.havingStyle(m.style.text()):w=m,f.unit==="ex")g=w.fontMetrics().xHeight;else if(f.unit==="em")g=w.fontMetrics().quad;else throw new a("Invalid unit: '"+f.unit+"'");w!==m&&(g*=w.sizeMultiplier/m.sizeMultiplier)}return Math.min(f.number*g,m.maxSize)},Le=function(f){return+f.toFixed(4)+"em"},kt=function(f){return f.filter(function(m){return m}).join(" ")},Dt=function(f,m,g){if(this.classes=f||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=g||{},m){m.style.isTight()&&this.classes.push("mtight");var w=m.getColor();w&&(this.style.color=w)}},At=function(f){var m=document.createElement(f);m.className=kt(this.classes);for(var g in this.style)this.style.hasOwnProperty(g)&&(m.style[g]=this.style[g]);for(var w in this.attributes)this.attributes.hasOwnProperty(w)&&m.setAttribute(w,this.attributes[w]);for(var k=0;k<this.children.length;k++)m.appendChild(this.children[k].toNode());return m},Kt=function(f){var m="<"+f;this.classes.length&&(m+=' class="'+S.escape(kt(this.classes))+'"');var g="";for(var w in this.style)this.style.hasOwnProperty(w)&&(g+=S.hyphenate(w)+":"+this.style[w]+";");g&&(m+=' style="'+S.escape(g)+'"');for(var k in this.attributes)this.attributes.hasOwnProperty(k)&&(m+=" "+k+'="'+S.escape(this.attributes[k])+'"');m+=">";for(var z=0;z<this.children.length;z++)m+=this.children[z].toMarkup();return m+="</"+f+">",m},on=function(){function N(m,g,w,k){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,Dt.call(this,m,w,k),this.children=g||[]}var f=N.prototype;return f.setAttribute=function(g,w){this.attributes[g]=w},f.hasClass=function(g){return S.contains(this.classes,g)},f.toNode=function(){return At.call(this,"span")},f.toMarkup=function(){return Kt.call(this,"span")},N}(),Mn=function(){function N(m,g,w,k){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,Dt.call(this,g,k),this.children=w||[],this.setAttribute("href",m)}var f=N.prototype;return f.setAttribute=function(g,w){this.attributes[g]=w},f.hasClass=function(g){return S.contains(this.classes,g)},f.toNode=function(){return At.call(this,"a")},f.toMarkup=function(){return Kt.call(this,"a")},N}(),Re=function(){function N(m,g,w){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=g,this.src=m,this.classes=["mord"],this.style=w}var f=N.prototype;return f.hasClass=function(g){return S.contains(this.classes,g)},f.toNode=function(){var g=document.createElement("img");g.src=this.src,g.alt=this.alt,g.className="mord";for(var w in this.style)this.style.hasOwnProperty(w)&&(g.style[w]=this.style[w]);return g},f.toMarkup=function(){var g="<img  src='"+this.src+" 'alt='"+this.alt+"' ",w="";for(var k in this.style)this.style.hasOwnProperty(k)&&(w+=S.hyphenate(k)+":"+this.style[k]+";");return w&&(g+=' style="'+S.escape(w)+'"'),g+="'/>",g},N}(),it={î:"ı̂",ï:"ı̈",í:"ı́",ì:"ı̀"},pt=function(){function N(m,g,w,k,z,W,ee,ue){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=m,this.height=g||0,this.depth=w||0,this.italic=k||0,this.skew=z||0,this.width=W||0,this.classes=ee||[],this.style=ue||{},this.maxFontSize=0;var Me=ve(this.text.charCodeAt(0));Me&&this.classes.push(Me+"_fallback"),/[îïíì]/.test(this.text)&&(this.text=it[this.text])}var f=N.prototype;return f.hasClass=function(g){return S.contains(this.classes,g)},f.toNode=function(){var g=document.createTextNode(this.text),w=null;this.italic>0&&(w=document.createElement("span"),w.style.marginRight=Le(this.italic)),this.classes.length>0&&(w=w||document.createElement("span"),w.className=kt(this.classes));for(var k in this.style)this.style.hasOwnProperty(k)&&(w=w||document.createElement("span"),w.style[k]=this.style[k]);return w?(w.appendChild(g),w):g},f.toMarkup=function(){var g=!1,w="<span";this.classes.length&&(g=!0,w+=' class="',w+=S.escape(kt(this.classes)),w+='"');var k="";this.italic>0&&(k+="margin-right:"+this.italic+"em;");for(var z in this.style)this.style.hasOwnProperty(z)&&(k+=S.hyphenate(z)+":"+this.style[z]+";");k&&(g=!0,w+=' style="'+S.escape(k)+'"');var W=S.escape(this.text);return g?(w+=">",w+=W,w+="</span>",w):W},N}(),Tt=function(){function N(m,g){this.children=void 0,this.attributes=void 0,this.children=m||[],this.attributes=g||{}}var f=N.prototype;return f.toNode=function(){var g="http://www.w3.org/2000/svg",w=document.createElementNS(g,"svg");for(var k in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,k)&&w.setAttribute(k,this.attributes[k]);for(var z=0;z<this.children.length;z++)w.appendChild(this.children[z].toNode());return w},f.toMarkup=function(){var g='<svg xmlns="http://www.w3.org/2000/svg"';for(var w in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,w)&&(g+=" "+w+"='"+this.attributes[w]+"'");g+=">";for(var k=0;k<this.children.length;k++)g+=this.children[k].toMarkup();return g+="</svg>",g},N}(),Rt=function(){function N(m,g){this.pathName=void 0,this.alternate=void 0,this.pathName=m,this.alternate=g}var f=N.prototype;return f.toNode=function(){var g="http://www.w3.org/2000/svg",w=document.createElementNS(g,"path");return this.alternate?w.setAttribute("d",this.alternate):w.setAttribute("d",ke[this.pathName]),w},f.toMarkup=function(){return this.alternate?"<path d='"+this.alternate+"'/>":"<path d='"+ke[this.pathName]+"'/>"},N}(),$n=function(){function N(m){this.attributes=void 0,this.attributes=m||{}}var f=N.prototype;return f.toNode=function(){var g="http://www.w3.org/2000/svg",w=document.createElementNS(g,"line");for(var k in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,k)&&w.setAttribute(k,this.attributes[k]);return w},f.toMarkup=function(){var g="<line";for(var w in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,w)&&(g+=" "+w+"='"+this.attributes[w]+"'");return g+="/>",g},N}();function nr(N){if(N instanceof pt)return N;throw new Error("Expected symbolNode but got "+String(N)+".")}function mr(N){if(N instanceof on)return N;throw new Error("Expected span<HtmlDomNode> but got "+String(N)+".")}var bn={bin:1,close:1,inner:1,open:1,punct:1,rel:1},Yt={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},ln={math:{},text:{}},sn=ln;function R(N,f,m,g,w,k){ln[N][w]={font:f,group:m,replace:g},k&&g&&(ln[N][g]=ln[N][w])}var B="math",ft="text",I="main",X="ams",Ve="accent-token",we="bin",je="close",Vt="inner",yt="mathord",Ot="op-token",Gt="open",_n="punct",pe="rel",tn="spacing",Se="textord";R(B,I,pe,"≡","\\equiv",!0),R(B,I,pe,"≺","\\prec",!0),R(B,I,pe,"≻","\\succ",!0),R(B,I,pe,"∼","\\sim",!0),R(B,I,pe,"⊥","\\perp"),R(B,I,pe,"⪯","\\preceq",!0),R(B,I,pe,"⪰","\\succeq",!0),R(B,I,pe,"≃","\\simeq",!0),R(B,I,pe,"∣","\\mid",!0),R(B,I,pe,"≪","\\ll",!0),R(B,I,pe,"≫","\\gg",!0),R(B,I,pe,"≍","\\asymp",!0),R(B,I,pe,"∥","\\parallel"),R(B,I,pe,"⋈","\\bowtie",!0),R(B,I,pe,"⌣","\\smile",!0),R(B,I,pe,"⊑","\\sqsubseteq",!0),R(B,I,pe,"⊒","\\sqsupseteq",!0),R(B,I,pe,"≐","\\doteq",!0),R(B,I,pe,"⌢","\\frown",!0),R(B,I,pe,"∋","\\ni",!0),R(B,I,pe,"∝","\\propto",!0),R(B,I,pe,"⊢","\\vdash",!0),R(B,I,pe,"⊣","\\dashv",!0),R(B,I,pe,"∋","\\owns"),R(B,I,_n,".","\\ldotp"),R(B,I,_n,"⋅","\\cdotp"),R(B,I,Se,"#","\\#"),R(ft,I,Se,"#","\\#"),R(B,I,Se,"&","\\&"),R(ft,I,Se,"&","\\&"),R(B,I,Se,"ℵ","\\aleph",!0),R(B,I,Se,"∀","\\forall",!0),R(B,I,Se,"ℏ","\\hbar",!0),R(B,I,Se,"∃","\\exists",!0),R(B,I,Se,"∇","\\nabla",!0),R(B,I,Se,"♭","\\flat",!0),R(B,I,Se,"ℓ","\\ell",!0),R(B,I,Se,"♮","\\natural",!0),R(B,I,Se,"♣","\\clubsuit",!0),R(B,I,Se,"℘","\\wp",!0),R(B,I,Se,"♯","\\sharp",!0),R(B,I,Se,"♢","\\diamondsuit",!0),R(B,I,Se,"ℜ","\\Re",!0),R(B,I,Se,"♡","\\heartsuit",!0),R(B,I,Se,"ℑ","\\Im",!0),R(B,I,Se,"♠","\\spadesuit",!0),R(B,I,Se,"§","\\S",!0),R(ft,I,Se,"§","\\S"),R(B,I,Se,"¶","\\P",!0),R(ft,I,Se,"¶","\\P"),R(B,I,Se,"†","\\dag"),R(ft,I,Se,"†","\\dag"),R(ft,I,Se,"†","\\textdagger"),R(B,I,Se,"‡","\\ddag"),R(ft,I,Se,"‡","\\ddag"),R(ft,I,Se,"‡","\\textdaggerdbl"),R(B,I,je,"⎱","\\rmoustache",!0),R(B,I,Gt,"⎰","\\lmoustache",!0),R(B,I,je,"⟯","\\rgroup",!0),R(B,I,Gt,"⟮","\\lgroup",!0),R(B,I,we,"∓","\\mp",!0),R(B,I,we,"⊖","\\ominus",!0),R(B,I,we,"⊎","\\uplus",!0),R(B,I,we,"⊓","\\sqcap",!0),R(B,I,we,"∗","\\ast"),R(B,I,we,"⊔","\\sqcup",!0),R(B,I,we,"◯","\\bigcirc",!0),R(B,I,we,"∙","\\bullet"),R(B,I,we,"‡","\\ddagger"),R(B,I,we,"≀","\\wr",!0),R(B,I,we,"⨿","\\amalg"),R(B,I,we,"&","\\And"),R(B,I,pe,"⟵","\\longleftarrow",!0),R(B,I,pe,"⇐","\\Leftarrow",!0),R(B,I,pe,"⟸","\\Longleftarrow",!0),R(B,I,pe,"⟶","\\longrightarrow",!0),R(B,I,pe,"⇒","\\Rightarrow",!0),R(B,I,pe,"⟹","\\Longrightarrow",!0),R(B,I,pe,"↔","\\leftrightarrow",!0),R(B,I,pe,"⟷","\\longleftrightarrow",!0),R(B,I,pe,"⇔","\\Leftrightarrow",!0),R(B,I,pe,"⟺","\\Longleftrightarrow",!0),R(B,I,pe,"↦","\\mapsto",!0),R(B,I,pe,"⟼","\\longmapsto",!0),R(B,I,pe,"↗","\\nearrow",!0),R(B,I,pe,"↩","\\hookleftarrow",!0),R(B,I,pe,"↪","\\hookrightarrow",!0),R(B,I,pe,"↘","\\searrow",!0),R(B,I,pe,"↼","\\leftharpoonup",!0),R(B,I,pe,"⇀","\\rightharpoonup",!0),R(B,I,pe,"↙","\\swarrow",!0),R(B,I,pe,"↽","\\leftharpoondown",!0),R(B,I,pe,"⇁","\\rightharpoondown",!0),R(B,I,pe,"↖","\\nwarrow",!0),R(B,I,pe,"⇌","\\rightleftharpoons",!0),R(B,X,pe,"≮","\\nless",!0),R(B,X,pe,"","\\@nleqslant"),R(B,X,pe,"","\\@nleqq"),R(B,X,pe,"⪇","\\lneq",!0),R(B,X,pe,"≨","\\lneqq",!0),R(B,X,pe,"","\\@lvertneqq"),R(B,X,pe,"⋦","\\lnsim",!0),R(B,X,pe,"⪉","\\lnapprox",!0),R(B,X,pe,"⊀","\\nprec",!0),R(B,X,pe,"⋠","\\npreceq",!0),R(B,X,pe,"⋨","\\precnsim",!0),R(B,X,pe,"⪹","\\precnapprox",!0),R(B,X,pe,"≁","\\nsim",!0),R(B,X,pe,"","\\@nshortmid"),R(B,X,pe,"∤","\\nmid",!0),R(B,X,pe,"⊬","\\nvdash",!0),R(B,X,pe,"⊭","\\nvDash",!0),R(B,X,pe,"⋪","\\ntriangleleft"),R(B,X,pe,"⋬","\\ntrianglelefteq",!0),R(B,X,pe,"⊊","\\subsetneq",!0),R(B,X,pe,"","\\@varsubsetneq"),R(B,X,pe,"⫋","\\subsetneqq",!0),R(B,X,pe,"","\\@varsubsetneqq"),R(B,X,pe,"≯","\\ngtr",!0),R(B,X,pe,"","\\@ngeqslant"),R(B,X,pe,"","\\@ngeqq"),R(B,X,pe,"⪈","\\gneq",!0),R(B,X,pe,"≩","\\gneqq",!0),R(B,X,pe,"","\\@gvertneqq"),R(B,X,pe,"⋧","\\gnsim",!0),R(B,X,pe,"⪊","\\gnapprox",!0),R(B,X,pe,"⊁","\\nsucc",!0),R(B,X,pe,"⋡","\\nsucceq",!0),R(B,X,pe,"⋩","\\succnsim",!0),R(B,X,pe,"⪺","\\succnapprox",!0),R(B,X,pe,"≆","\\ncong",!0),R(B,X,pe,"","\\@nshortparallel"),R(B,X,pe,"∦","\\nparallel",!0),R(B,X,pe,"⊯","\\nVDash",!0),R(B,X,pe,"⋫","\\ntriangleright"),R(B,X,pe,"⋭","\\ntrianglerighteq",!0),R(B,X,pe,"","\\@nsupseteqq"),R(B,X,pe,"⊋","\\supsetneq",!0),R(B,X,pe,"","\\@varsupsetneq"),R(B,X,pe,"⫌","\\supsetneqq",!0),R(B,X,pe,"","\\@varsupsetneqq"),R(B,X,pe,"⊮","\\nVdash",!0),R(B,X,pe,"⪵","\\precneqq",!0),R(B,X,pe,"⪶","\\succneqq",!0),R(B,X,pe,"","\\@nsubseteqq"),R(B,X,we,"⊴","\\unlhd"),R(B,X,we,"⊵","\\unrhd"),R(B,X,pe,"↚","\\nleftarrow",!0),R(B,X,pe,"↛","\\nrightarrow",!0),R(B,X,pe,"⇍","\\nLeftarrow",!0),R(B,X,pe,"⇏","\\nRightarrow",!0),R(B,X,pe,"↮","\\nleftrightarrow",!0),R(B,X,pe,"⇎","\\nLeftrightarrow",!0),R(B,X,pe,"△","\\vartriangle"),R(B,X,Se,"ℏ","\\hslash"),R(B,X,Se,"▽","\\triangledown"),R(B,X,Se,"◊","\\lozenge"),R(B,X,Se,"Ⓢ","\\circledS"),R(B,X,Se,"®","\\circledR"),R(ft,X,Se,"®","\\circledR"),R(B,X,Se,"∡","\\measuredangle",!0),R(B,X,Se,"∄","\\nexists"),R(B,X,Se,"℧","\\mho"),R(B,X,Se,"Ⅎ","\\Finv",!0),R(B,X,Se,"⅁","\\Game",!0),R(B,X,Se,"‵","\\backprime"),R(B,X,Se,"▲","\\blacktriangle"),R(B,X,Se,"▼","\\blacktriangledown"),R(B,X,Se,"■","\\blacksquare"),R(B,X,Se,"⧫","\\blacklozenge"),R(B,X,Se,"★","\\bigstar"),R(B,X,Se,"∢","\\sphericalangle",!0),R(B,X,Se,"∁","\\complement",!0),R(B,X,Se,"ð","\\eth",!0),R(ft,I,Se,"ð","ð"),R(B,X,Se,"╱","\\diagup"),R(B,X,Se,"╲","\\diagdown"),R(B,X,Se,"□","\\square"),R(B,X,Se,"□","\\Box"),R(B,X,Se,"◊","\\Diamond"),R(B,X,Se,"¥","\\yen",!0),R(ft,X,Se,"¥","\\yen",!0),R(B,X,Se,"✓","\\checkmark",!0),R(ft,X,Se,"✓","\\checkmark"),R(B,X,Se,"ℶ","\\beth",!0),R(B,X,Se,"ℸ","\\daleth",!0),R(B,X,Se,"ℷ","\\gimel",!0),R(B,X,Se,"ϝ","\\digamma",!0),R(B,X,Se,"ϰ","\\varkappa"),R(B,X,Gt,"┌","\\@ulcorner",!0),R(B,X,je,"┐","\\@urcorner",!0),R(B,X,Gt,"└","\\@llcorner",!0),R(B,X,je,"┘","\\@lrcorner",!0),R(B,X,pe,"≦","\\leqq",!0),R(B,X,pe,"⩽","\\leqslant",!0),R(B,X,pe,"⪕","\\eqslantless",!0),R(B,X,pe,"≲","\\lesssim",!0),R(B,X,pe,"⪅","\\lessapprox",!0),R(B,X,pe,"≊","\\approxeq",!0),R(B,X,we,"⋖","\\lessdot"),R(B,X,pe,"⋘","\\lll",!0),R(B,X,pe,"≶","\\lessgtr",!0),R(B,X,pe,"⋚","\\lesseqgtr",!0),R(B,X,pe,"⪋","\\lesseqqgtr",!0),R(B,X,pe,"≑","\\doteqdot"),R(B,X,pe,"≓","\\risingdotseq",!0),R(B,X,pe,"≒","\\fallingdotseq",!0),R(B,X,pe,"∽","\\backsim",!0),R(B,X,pe,"⋍","\\backsimeq",!0),R(B,X,pe,"⫅","\\subseteqq",!0),R(B,X,pe,"⋐","\\Subset",!0),R(B,X,pe,"⊏","\\sqsubset",!0),R(B,X,pe,"≼","\\preccurlyeq",!0),R(B,X,pe,"⋞","\\curlyeqprec",!0),R(B,X,pe,"≾","\\precsim",!0),R(B,X,pe,"⪷","\\precapprox",!0),R(B,X,pe,"⊲","\\vartriangleleft"),R(B,X,pe,"⊴","\\trianglelefteq"),R(B,X,pe,"⊨","\\vDash",!0),R(B,X,pe,"⊪","\\Vvdash",!0),R(B,X,pe,"⌣","\\smallsmile"),R(B,X,pe,"⌢","\\smallfrown"),R(B,X,pe,"≏","\\bumpeq",!0),R(B,X,pe,"≎","\\Bumpeq",!0),R(B,X,pe,"≧","\\geqq",!0),R(B,X,pe,"⩾","\\geqslant",!0),R(B,X,pe,"⪖","\\eqslantgtr",!0),R(B,X,pe,"≳","\\gtrsim",!0),R(B,X,pe,"⪆","\\gtrapprox",!0),R(B,X,we,"⋗","\\gtrdot"),R(B,X,pe,"⋙","\\ggg",!0),R(B,X,pe,"≷","\\gtrless",!0),R(B,X,pe,"⋛","\\gtreqless",!0),R(B,X,pe,"⪌","\\gtreqqless",!0),R(B,X,pe,"≖","\\eqcirc",!0),R(B,X,pe,"≗","\\circeq",!0),R(B,X,pe,"≜","\\triangleq",!0),R(B,X,pe,"∼","\\thicksim"),R(B,X,pe,"≈","\\thickapprox"),R(B,X,pe,"⫆","\\supseteqq",!0),R(B,X,pe,"⋑","\\Supset",!0),R(B,X,pe,"⊐","\\sqsupset",!0),R(B,X,pe,"≽","\\succcurlyeq",!0),R(B,X,pe,"⋟","\\curlyeqsucc",!0),R(B,X,pe,"≿","\\succsim",!0),R(B,X,pe,"⪸","\\succapprox",!0),R(B,X,pe,"⊳","\\vartriangleright"),R(B,X,pe,"⊵","\\trianglerighteq"),R(B,X,pe,"⊩","\\Vdash",!0),R(B,X,pe,"∣","\\shortmid"),R(B,X,pe,"∥","\\shortparallel"),R(B,X,pe,"≬","\\between",!0),R(B,X,pe,"⋔","\\pitchfork",!0),R(B,X,pe,"∝","\\varpropto"),R(B,X,pe,"◀","\\blacktriangleleft"),R(B,X,pe,"∴","\\therefore",!0),R(B,X,pe,"∍","\\backepsilon"),R(B,X,pe,"▶","\\blacktriangleright"),R(B,X,pe,"∵","\\because",!0),R(B,X,pe,"⋘","\\llless"),R(B,X,pe,"⋙","\\gggtr"),R(B,X,we,"⊲","\\lhd"),R(B,X,we,"⊳","\\rhd"),R(B,X,pe,"≂","\\eqsim",!0),R(B,I,pe,"⋈","\\Join"),R(B,X,pe,"≑","\\Doteq",!0),R(B,X,we,"∔","\\dotplus",!0),R(B,X,we,"∖","\\smallsetminus"),R(B,X,we,"⋒","\\Cap",!0),R(B,X,we,"⋓","\\Cup",!0),R(B,X,we,"⩞","\\doublebarwedge",!0),R(B,X,we,"⊟","\\boxminus",!0),R(B,X,we,"⊞","\\boxplus",!0),R(B,X,we,"⋇","\\divideontimes",!0),R(B,X,we,"⋉","\\ltimes",!0),R(B,X,we,"⋊","\\rtimes",!0),R(B,X,we,"⋋","\\leftthreetimes",!0),R(B,X,we,"⋌","\\rightthreetimes",!0),R(B,X,we,"⋏","\\curlywedge",!0),R(B,X,we,"⋎","\\curlyvee",!0),R(B,X,we,"⊝","\\circleddash",!0),R(B,X,we,"⊛","\\circledast",!0),R(B,X,we,"⋅","\\centerdot"),R(B,X,we,"⊺","\\intercal",!0),R(B,X,we,"⋒","\\doublecap"),R(B,X,we,"⋓","\\doublecup"),R(B,X,we,"⊠","\\boxtimes",!0),R(B,X,pe,"⇢","\\dashrightarrow",!0),R(B,X,pe,"⇠","\\dashleftarrow",!0),R(B,X,pe,"⇇","\\leftleftarrows",!0),R(B,X,pe,"⇆","\\leftrightarrows",!0),R(B,X,pe,"⇚","\\Lleftarrow",!0),R(B,X,pe,"↞","\\twoheadleftarrow",!0),R(B,X,pe,"↢","\\leftarrowtail",!0),R(B,X,pe,"↫","\\looparrowleft",!0),R(B,X,pe,"⇋","\\leftrightharpoons",!0),R(B,X,pe,"↶","\\curvearrowleft",!0),R(B,X,pe,"↺","\\circlearrowleft",!0),R(B,X,pe,"↰","\\Lsh",!0),R(B,X,pe,"⇈","\\upuparrows",!0),R(B,X,pe,"↿","\\upharpoonleft",!0),R(B,X,pe,"⇃","\\downharpoonleft",!0),R(B,I,pe,"⊶","\\origof",!0),R(B,I,pe,"⊷","\\imageof",!0),R(B,X,pe,"⊸","\\multimap",!0),R(B,X,pe,"↭","\\leftrightsquigarrow",!0),R(B,X,pe,"⇉","\\rightrightarrows",!0),R(B,X,pe,"⇄","\\rightleftarrows",!0),R(B,X,pe,"↠","\\twoheadrightarrow",!0),R(B,X,pe,"↣","\\rightarrowtail",!0),R(B,X,pe,"↬","\\looparrowright",!0),R(B,X,pe,"↷","\\curvearrowright",!0),R(B,X,pe,"↻","\\circlearrowright",!0),R(B,X,pe,"↱","\\Rsh",!0),R(B,X,pe,"⇊","\\downdownarrows",!0),R(B,X,pe,"↾","\\upharpoonright",!0),R(B,X,pe,"⇂","\\downharpoonright",!0),R(B,X,pe,"⇝","\\rightsquigarrow",!0),R(B,X,pe,"⇝","\\leadsto"),R(B,X,pe,"⇛","\\Rrightarrow",!0),R(B,X,pe,"↾","\\restriction"),R(B,I,Se,"‘","`"),R(B,I,Se,"$","\\$"),R(ft,I,Se,"$","\\$"),R(ft,I,Se,"$","\\textdollar"),R(B,I,Se,"%","\\%"),R(ft,I,Se,"%","\\%"),R(B,I,Se,"_","\\_"),R(ft,I,Se,"_","\\_"),R(ft,I,Se,"_","\\textunderscore"),R(B,I,Se,"∠","\\angle",!0),R(B,I,Se,"∞","\\infty",!0),R(B,I,Se,"′","\\prime"),R(B,I,Se,"△","\\triangle"),R(B,I,Se,"Γ","\\Gamma",!0),R(B,I,Se,"Δ","\\Delta",!0),R(B,I,Se,"Θ","\\Theta",!0),R(B,I,Se,"Λ","\\Lambda",!0),R(B,I,Se,"Ξ","\\Xi",!0),R(B,I,Se,"Π","\\Pi",!0),R(B,I,Se,"Σ","\\Sigma",!0),R(B,I,Se,"Υ","\\Upsilon",!0),R(B,I,Se,"Φ","\\Phi",!0),R(B,I,Se,"Ψ","\\Psi",!0),R(B,I,Se,"Ω","\\Omega",!0),R(B,I,Se,"A","Α"),R(B,I,Se,"B","Β"),R(B,I,Se,"E","Ε"),R(B,I,Se,"Z","Ζ"),R(B,I,Se,"H","Η"),R(B,I,Se,"I","Ι"),R(B,I,Se,"K","Κ"),R(B,I,Se,"M","Μ"),R(B,I,Se,"N","Ν"),R(B,I,Se,"O","Ο"),R(B,I,Se,"P","Ρ"),R(B,I,Se,"T","Τ"),R(B,I,Se,"X","Χ"),R(B,I,Se,"¬","\\neg",!0),R(B,I,Se,"¬","\\lnot"),R(B,I,Se,"⊤","\\top"),R(B,I,Se,"⊥","\\bot"),R(B,I,Se,"∅","\\emptyset"),R(B,X,Se,"∅","\\varnothing"),R(B,I,yt,"α","\\alpha",!0),R(B,I,yt,"β","\\beta",!0),R(B,I,yt,"γ","\\gamma",!0),R(B,I,yt,"δ","\\delta",!0),R(B,I,yt,"ϵ","\\epsilon",!0),R(B,I,yt,"ζ","\\zeta",!0),R(B,I,yt,"η","\\eta",!0),R(B,I,yt,"θ","\\theta",!0),R(B,I,yt,"ι","\\iota",!0),R(B,I,yt,"κ","\\kappa",!0),R(B,I,yt,"λ","\\lambda",!0),R(B,I,yt,"μ","\\mu",!0),R(B,I,yt,"ν","\\nu",!0),R(B,I,yt,"ξ","\\xi",!0),R(B,I,yt,"ο","\\omicron",!0),R(B,I,yt,"π","\\pi",!0),R(B,I,yt,"ρ","\\rho",!0),R(B,I,yt,"σ","\\sigma",!0),R(B,I,yt,"τ","\\tau",!0),R(B,I,yt,"υ","\\upsilon",!0),R(B,I,yt,"ϕ","\\phi",!0),R(B,I,yt,"χ","\\chi",!0),R(B,I,yt,"ψ","\\psi",!0),R(B,I,yt,"ω","\\omega",!0),R(B,I,yt,"ε","\\varepsilon",!0),R(B,I,yt,"ϑ","\\vartheta",!0),R(B,I,yt,"ϖ","\\varpi",!0),R(B,I,yt,"ϱ","\\varrho",!0),R(B,I,yt,"ς","\\varsigma",!0),R(B,I,yt,"φ","\\varphi",!0),R(B,I,we,"∗","*",!0),R(B,I,we,"+","+"),R(B,I,we,"−","-",!0),R(B,I,we,"⋅","\\cdot",!0),R(B,I,we,"∘","\\circ"),R(B,I,we,"÷","\\div",!0),R(B,I,we,"±","\\pm",!0),R(B,I,we,"×","\\times",!0),R(B,I,we,"∩","\\cap",!0),R(B,I,we,"∪","\\cup",!0),R(B,I,we,"∖","\\setminus"),R(B,I,we,"∧","\\land"),R(B,I,we,"∨","\\lor"),R(B,I,we,"∧","\\wedge",!0),R(B,I,we,"∨","\\vee",!0),R(B,I,Se,"√","\\surd"),R(B,I,Gt,"⟨","\\langle",!0),R(B,I,Gt,"∣","\\lvert"),R(B,I,Gt,"∥","\\lVert"),R(B,I,je,"?","?"),R(B,I,je,"!","!"),R(B,I,je,"⟩","\\rangle",!0),R(B,I,je,"∣","\\rvert"),R(B,I,je,"∥","\\rVert"),R(B,I,pe,"=","="),R(B,I,pe,":",":"),R(B,I,pe,"≈","\\approx",!0),R(B,I,pe,"≅","\\cong",!0),R(B,I,pe,"≥","\\ge"),R(B,I,pe,"≥","\\geq",!0),R(B,I,pe,"←","\\gets"),R(B,I,pe,">","\\gt",!0),R(B,I,pe,"∈","\\in",!0),R(B,I,pe,"","\\@not"),R(B,I,pe,"⊂","\\subset",!0),R(B,I,pe,"⊃","\\supset",!0),R(B,I,pe,"⊆","\\subseteq",!0),R(B,I,pe,"⊇","\\supseteq",!0),R(B,X,pe,"⊈","\\nsubseteq",!0),R(B,X,pe,"⊉","\\nsupseteq",!0),R(B,I,pe,"⊨","\\models"),R(B,I,pe,"←","\\leftarrow",!0),R(B,I,pe,"≤","\\le"),R(B,I,pe,"≤","\\leq",!0),R(B,I,pe,"<","\\lt",!0),R(B,I,pe,"→","\\rightarrow",!0),R(B,I,pe,"→","\\to"),R(B,X,pe,"≱","\\ngeq",!0),R(B,X,pe,"≰","\\nleq",!0),R(B,I,tn," ","\\ "),R(B,I,tn," ","\\space"),R(B,I,tn," ","\\nobreakspace"),R(ft,I,tn," ","\\ "),R(ft,I,tn," "," "),R(ft,I,tn," ","\\space"),R(ft,I,tn," ","\\nobreakspace"),R(B,I,tn,null,"\\nobreak"),R(B,I,tn,null,"\\allowbreak"),R(B,I,_n,",",","),R(B,I,_n,";",";"),R(B,X,we,"⊼","\\barwedge",!0),R(B,X,we,"⊻","\\veebar",!0),R(B,I,we,"⊙","\\odot",!0),R(B,I,we,"⊕","\\oplus",!0),R(B,I,we,"⊗","\\otimes",!0),R(B,I,Se,"∂","\\partial",!0),R(B,I,we,"⊘","\\oslash",!0),R(B,X,we,"⊚","\\circledcirc",!0),R(B,X,we,"⊡","\\boxdot",!0),R(B,I,we,"△","\\bigtriangleup"),R(B,I,we,"▽","\\bigtriangledown"),R(B,I,we,"†","\\dagger"),R(B,I,we,"⋄","\\diamond"),R(B,I,we,"⋆","\\star"),R(B,I,we,"◃","\\triangleleft"),R(B,I,we,"▹","\\triangleright"),R(B,I,Gt,"{","\\{"),R(ft,I,Se,"{","\\{"),R(ft,I,Se,"{","\\textbraceleft"),R(B,I,je,"}","\\}"),R(ft,I,Se,"}","\\}"),R(ft,I,Se,"}","\\textbraceright"),R(B,I,Gt,"{","\\lbrace"),R(B,I,je,"}","\\rbrace"),R(B,I,Gt,"[","\\lbrack",!0),R(ft,I,Se,"[","\\lbrack",!0),R(B,I,je,"]","\\rbrack",!0),R(ft,I,Se,"]","\\rbrack",!0),R(B,I,Gt,"(","\\lparen",!0),R(B,I,je,")","\\rparen",!0),R(ft,I,Se,"<","\\textless",!0),R(ft,I,Se,">","\\textgreater",!0),R(B,I,Gt,"⌊","\\lfloor",!0),R(B,I,je,"⌋","\\rfloor",!0),R(B,I,Gt,"⌈","\\lceil",!0),R(B,I,je,"⌉","\\rceil",!0),R(B,I,Se,"\\","\\backslash"),R(B,I,Se,"∣","|"),R(B,I,Se,"∣","\\vert"),R(ft,I,Se,"|","\\textbar",!0),R(B,I,Se,"∥","\\|"),R(B,I,Se,"∥","\\Vert"),R(ft,I,Se,"∥","\\textbardbl"),R(ft,I,Se,"~","\\textasciitilde"),R(ft,I,Se,"\\","\\textbackslash"),R(ft,I,Se,"^","\\textasciicircum"),R(B,I,pe,"↑","\\uparrow",!0),R(B,I,pe,"⇑","\\Uparrow",!0),R(B,I,pe,"↓","\\downarrow",!0),R(B,I,pe,"⇓","\\Downarrow",!0),R(B,I,pe,"↕","\\updownarrow",!0),R(B,I,pe,"⇕","\\Updownarrow",!0),R(B,I,Ot,"∐","\\coprod"),R(B,I,Ot,"⋁","\\bigvee"),R(B,I,Ot,"⋀","\\bigwedge"),R(B,I,Ot,"⨄","\\biguplus"),R(B,I,Ot,"⋂","\\bigcap"),R(B,I,Ot,"⋃","\\bigcup"),R(B,I,Ot,"∫","\\int"),R(B,I,Ot,"∫","\\intop"),R(B,I,Ot,"∬","\\iint"),R(B,I,Ot,"∭","\\iiint"),R(B,I,Ot,"∏","\\prod"),R(B,I,Ot,"∑","\\sum"),R(B,I,Ot,"⨂","\\bigotimes"),R(B,I,Ot,"⨁","\\bigoplus"),R(B,I,Ot,"⨀","\\bigodot"),R(B,I,Ot,"∮","\\oint"),R(B,I,Ot,"∯","\\oiint"),R(B,I,Ot,"∰","\\oiiint"),R(B,I,Ot,"⨆","\\bigsqcup"),R(B,I,Ot,"∫","\\smallint"),R(ft,I,Vt,"…","\\textellipsis"),R(B,I,Vt,"…","\\mathellipsis"),R(ft,I,Vt,"…","\\ldots",!0),R(B,I,Vt,"…","\\ldots",!0),R(B,I,Vt,"⋯","\\@cdots",!0),R(B,I,Vt,"⋱","\\ddots",!0),R(B,I,Se,"⋮","\\varvdots"),R(B,I,Ve,"ˊ","\\acute"),R(B,I,Ve,"ˋ","\\grave"),R(B,I,Ve,"¨","\\ddot"),R(B,I,Ve,"~","\\tilde"),R(B,I,Ve,"ˉ","\\bar"),R(B,I,Ve,"˘","\\breve"),R(B,I,Ve,"ˇ","\\check"),R(B,I,Ve,"^","\\hat"),R(B,I,Ve,"⃗","\\vec"),R(B,I,Ve,"˙","\\dot"),R(B,I,Ve,"˚","\\mathring"),R(B,I,yt,"","\\@imath"),R(B,I,yt,"","\\@jmath"),R(B,I,Se,"ı","ı"),R(B,I,Se,"ȷ","ȷ"),R(ft,I,Se,"ı","\\i",!0),R(ft,I,Se,"ȷ","\\j",!0),R(ft,I,Se,"ß","\\ss",!0),R(ft,I,Se,"æ","\\ae",!0),R(ft,I,Se,"œ","\\oe",!0),R(ft,I,Se,"ø","\\o",!0),R(ft,I,Se,"Æ","\\AE",!0),R(ft,I,Se,"Œ","\\OE",!0),R(ft,I,Se,"Ø","\\O",!0),R(ft,I,Ve,"ˊ","\\'"),R(ft,I,Ve,"ˋ","\\`"),R(ft,I,Ve,"ˆ","\\^"),R(ft,I,Ve,"˜","\\~"),R(ft,I,Ve,"ˉ","\\="),R(ft,I,Ve,"˘","\\u"),R(ft,I,Ve,"˙","\\."),R(ft,I,Ve,"¸","\\c"),R(ft,I,Ve,"˚","\\r"),R(ft,I,Ve,"ˇ","\\v"),R(ft,I,Ve,"¨",'\\"'),R(ft,I,Ve,"˝","\\H"),R(ft,I,Ve,"◯","\\textcircled");var wr={"--":!0,"---":!0,"``":!0,"''":!0};R(ft,I,Se,"–","--",!0),R(ft,I,Se,"–","\\textendash"),R(ft,I,Se,"—","---",!0),R(ft,I,Se,"—","\\textemdash"),R(ft,I,Se,"‘","`",!0),R(ft,I,Se,"‘","\\textquoteleft"),R(ft,I,Se,"’","'",!0),R(ft,I,Se,"’","\\textquoteright"),R(ft,I,Se,"“","``",!0),R(ft,I,Se,"“","\\textquotedblleft"),R(ft,I,Se,"”","''",!0),R(ft,I,Se,"”","\\textquotedblright"),R(B,I,Se,"°","\\degree",!0),R(ft,I,Se,"°","\\degree"),R(ft,I,Se,"°","\\textdegree",!0),R(B,I,Se,"£","\\pounds"),R(B,I,Se,"£","\\mathsterling",!0),R(ft,I,Se,"£","\\pounds"),R(ft,I,Se,"£","\\textsterling",!0),R(B,X,Se,"✠","\\maltese"),R(ft,X,Se,"✠","\\maltese");for(var Fr='0123456789/@."',gr=0;gr<Fr.length;gr++){var Xt=Fr.charAt(gr);R(B,I,Se,Xt,Xt)}for(var xn='0123456789!@*()-=+";:?/.,',Ir=0;Ir<xn.length;Ir++){var jn=xn.charAt(Ir);R(ft,I,Se,jn,jn)}for(var Er="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",ur=0;ur<Er.length;ur++){var Ur=Er.charAt(ur);R(B,I,yt,Ur,Ur),R(ft,I,Se,Ur,Ur)}R(B,X,Se,"C","ℂ"),R(ft,X,Se,"C","ℂ"),R(B,X,Se,"H","ℍ"),R(ft,X,Se,"H","ℍ"),R(B,X,Se,"N","ℕ"),R(ft,X,Se,"N","ℕ"),R(B,X,Se,"P","ℙ"),R(ft,X,Se,"P","ℙ"),R(B,X,Se,"Q","ℚ"),R(ft,X,Se,"Q","ℚ"),R(B,X,Se,"R","ℝ"),R(ft,X,Se,"R","ℝ"),R(B,X,Se,"Z","ℤ"),R(ft,X,Se,"Z","ℤ"),R(B,I,yt,"h","ℎ"),R(ft,I,yt,"h","ℎ");for(var Nt="",hn=0;hn<Er.length;hn++){var wn=Er.charAt(hn);Nt=String.fromCharCode(55349,56320+hn),R(B,I,yt,wn,Nt),R(ft,I,Se,wn,Nt),Nt=String.fromCharCode(55349,56372+hn),R(B,I,yt,wn,Nt),R(ft,I,Se,wn,Nt),Nt=String.fromCharCode(55349,56424+hn),R(B,I,yt,wn,Nt),R(ft,I,Se,wn,Nt),Nt=String.fromCharCode(55349,56580+hn),R(B,I,yt,wn,Nt),R(ft,I,Se,wn,Nt),Nt=String.fromCharCode(55349,56736+hn),R(B,I,yt,wn,Nt),R(ft,I,Se,wn,Nt),Nt=String.fromCharCode(55349,56788+hn),R(B,I,yt,wn,Nt),R(ft,I,Se,wn,Nt),Nt=String.fromCharCode(55349,56840+hn),R(B,I,yt,wn,Nt),R(ft,I,Se,wn,Nt),Nt=String.fromCharCode(55349,56944+hn),R(B,I,yt,wn,Nt),R(ft,I,Se,wn,Nt),hn<26&&(Nt=String.fromCharCode(55349,56632+hn),R(B,I,yt,wn,Nt),R(ft,I,Se,wn,Nt),Nt=String.fromCharCode(55349,56476+hn),R(B,I,yt,wn,Nt),R(ft,I,Se,wn,Nt))}Nt="𝕜",R(B,I,yt,"k",Nt),R(ft,I,Se,"k",Nt);for(var ii=0;ii<10;ii++){var zt=ii.toString();Nt=String.fromCharCode(55349,57294+ii),R(B,I,yt,zt,Nt),R(ft,I,Se,zt,Nt),Nt=String.fromCharCode(55349,57314+ii),R(B,I,yt,zt,Nt),R(ft,I,Se,zt,Nt),Nt=String.fromCharCode(55349,57324+ii),R(B,I,yt,zt,Nt),R(ft,I,Se,zt,Nt),Nt=String.fromCharCode(55349,57334+ii),R(B,I,yt,zt,Nt),R(ft,I,Se,zt,Nt)}for(var Ma="ÐÞþ",Ya=0;Ya<Ma.length;Ya++){var ua=Ma.charAt(Ya);R(B,I,yt,ua,ua),R(ft,I,Se,ua,ua)}var fo=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["","",""],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],hl=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],Su=function(f,m){var g=f.charCodeAt(0),w=f.charCodeAt(1),k=(g-55296)*1024+(w-56320)+65536,z=m==="math"?0:1;if(119808<=k&&k<120484){var W=Math.floor((k-119808)/26);return[fo[W][2],fo[W][z]]}else if(120782<=k&&k<=120831){var ee=Math.floor((k-120782)/10);return[hl[ee][2],hl[ee][z]]}else{if(k===120485||k===120486)return[fo[0][2],fo[0][z]];if(120486<k&&k<120782)return["",""];throw new a("Unsupported character: "+f)}},Za=function(f,m,g){return sn[g][f]&&sn[g][f].replace&&(f=sn[g][f].replace),{value:f,metrics:vt(f,m,g)}},mi=function(f,m,g,w,k){var z=Za(f,m,g),W=z.metrics;f=z.value;var ee;if(W){var ue=W.italic;(g==="text"||w&&w.font==="mathit")&&(ue=0),ee=new pt(f,W.height,W.depth,ue,W.skew,W.width,k)}else typeof console<"u"&&console.warn("No character metrics "+("for '"+f+"' in style '"+m+"' and mode '"+g+"'")),ee=new pt(f,0,0,0,0,0,k);if(w){ee.maxFontSize=w.sizeMultiplier,w.style.isTight()&&ee.classes.push("mtight");var Me=w.getColor();Me&&(ee.style.color=Me)}return ee},Mu=function(f,m,g,w){return w===void 0&&(w=[]),g.font==="boldsymbol"&&Za(f,"Main-Bold",m).metrics?mi(f,"Main-Bold",m,g,w.concat(["mathbf"])):f==="\\"||sn[m][f].font==="main"?mi(f,"Main-Regular",m,g,w):mi(f,"AMS-Regular",m,g,w.concat(["amsrm"]))},j=function(f,m,g,w,k){return k!=="textord"&&Za(f,"Math-BoldItalic",m).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}},Zn=function(f,m,g){var w=f.mode,k=f.text,z=["mord"],W=w==="math"||w==="text"&&m.font,ee=W?m.font:m.fontFamily;if(k.charCodeAt(0)===55349){var ue=Su(k,w),Me=ue[0],Ue=ue[1];return mi(k,Me,w,m,z.concat(Ue))}else if(ee){var lt,p;if(ee==="boldsymbol"){var y=j(k,w,m,z,g);lt=y.fontName,p=[y.fontClass]}else W?(lt=Gi[ee].fontName,p=[ee]):(lt=Ea(ee,m.fontWeight,m.fontShape),p=[ee,m.fontWeight,m.fontShape]);if(Za(k,lt,w).metrics)return mi(k,lt,w,m,z.concat(p));if(wr.hasOwnProperty(k)&&lt.substr(0,10)==="Typewriter"){for(var T=[],$=0;$<k.length;$++)T.push(mi(k[$],lt,w,m,z.concat(p)));return Eu(T)}}if(g==="mathord")return mi(k,"Math-Italic",w,m,z.concat(["mathnormal"]));if(g==="textord"){var F=sn[w][k]&&sn[w][k].font;if(F==="ams"){var q=Ea("amsrm",m.fontWeight,m.fontShape);return mi(k,q,w,m,z.concat("amsrm",m.fontWeight,m.fontShape))}else if(F==="main"||!F){var J=Ea("textrm",m.fontWeight,m.fontShape);return mi(k,J,w,m,z.concat(m.fontWeight,m.fontShape))}else{var oe=Ea(F,m.fontWeight,m.fontShape);return mi(k,oe,w,m,z.concat(oe,m.fontWeight,m.fontShape))}}else throw new Error("unexpected type: "+g+" in makeOrd")},Kc=function(f,m){if(kt(f.classes)!==kt(m.classes)||f.skew!==m.skew||f.maxFontSize!==m.maxFontSize)return!1;if(f.classes.length===1){var g=f.classes[0];if(g==="mbin"||g==="mord")return!1}for(var w in f.style)if(f.style.hasOwnProperty(w)&&f.style[w]!==m.style[w])return!1;for(var k in m.style)if(m.style.hasOwnProperty(k)&&f.style[k]!==m.style[k])return!1;return!0},ho=function(f){for(var m=0;m<f.length-1;m++){var g=f[m],w=f[m+1];g instanceof pt&&w instanceof pt&&Kc(g,w)&&(g.text+=w.text,g.height=Math.max(g.height,w.height),g.depth=Math.max(g.depth,w.depth),g.italic=w.italic,f.splice(m+1,1),m--)}return f},ca=function(f){for(var m=0,g=0,w=0,k=0;k<f.children.length;k++){var z=f.children[k];z.height>m&&(m=z.height),z.depth>g&&(g=z.depth),z.maxFontSize>w&&(w=z.maxFontSize)}f.height=m,f.depth=g,f.maxFontSize=w},Vr=function(f,m,g,w){var k=new on(f,m,g,w);return ca(k),k},po=function(f,m,g,w){return new on(f,m,g,w)},pl=function(f,m,g){var w=Vr([f],[],m);return w.height=Math.max(g||m.fontMetrics().defaultRuleThickness,m.minRuleThickness),w.style.borderBottomWidth=Le(w.height),w.maxFontSize=1,w},mo=function(f,m,g,w){var k=new Mn(f,m,g,w);return ca(k),k},Eu=function(f){var m=new Xe(f);return ca(m),m},ml=function(f,m){return f instanceof Xe?Vr([],[f],m):f},Yc=function(f){if(f.positionType==="individualShift"){for(var m=f.children,g=[m[0]],w=-m[0].shift-m[0].elem.depth,k=w,z=1;z<m.length;z++){var W=-m[z].shift-k-m[z].elem.depth,ee=W-(m[z-1].elem.height+m[z-1].elem.depth);k=k+W,g.push({type:"kern",size:ee}),g.push(m[z])}return{children:g,depth:w}}var ue;if(f.positionType==="top"){for(var Me=f.positionData,Ue=0;Ue<f.children.length;Ue++){var lt=f.children[Ue];Me-=lt.type==="kern"?lt.size:lt.elem.height+lt.elem.depth}ue=Me}else if(f.positionType==="bottom")ue=-f.positionData;else{var p=f.children[0];if(p.type!=="elem")throw new Error('First child must have type "elem".');if(f.positionType==="shift")ue=-p.elem.depth-f.positionData;else if(f.positionType==="firstBaseline")ue=-p.elem.depth;else throw new Error("Invalid positionType "+f.positionType+".")}return{children:f.children,depth:ue}},Zc=function(f,m){for(var g=Yc(f),w=g.children,k=g.depth,z=0,W=0;W<w.length;W++){var ee=w[W];if(ee.type==="elem"){var ue=ee.elem;z=Math.max(z,ue.maxFontSize,ue.height)}}z+=2;var Me=Vr(["pstrut"],[]);Me.style.height=Le(z);for(var Ue=[],lt=k,p=k,y=k,T=0;T<w.length;T++){var $=w[T];if($.type==="kern")y+=$.size;else{var F=$.elem,q=$.wrapperClasses||[],J=$.wrapperStyle||{},oe=Vr(q,[Me,F],void 0,J);oe.style.top=Le(-z-y-F.depth),$.marginLeft&&(oe.style.marginLeft=$.marginLeft),$.marginRight&&(oe.style.marginRight=$.marginRight),Ue.push(oe),y+=F.height+F.depth}lt=Math.min(lt,y),p=Math.max(p,y)}var Ce=Vr(["vlist"],Ue);Ce.style.height=Le(p);var He;if(lt<0){var Ke=Vr([],[]),st=Vr(["vlist"],[Ke]);st.style.height=Le(-lt);var wt=Vr(["vlist-s"],[new pt("​")]);He=[Vr(["vlist-r"],[Ce,wt]),Vr(["vlist-r"],[st])]}else He=[Vr(["vlist-r"],[Ce])];var ot=Vr(["vlist-t"],He);return He.length===2&&ot.classes.push("vlist-t2"),ot.height=p,ot.depth=-lt,ot},go=function(f,m){var g=Vr(["mspace"],[],m),w=at(f,m);return g.style.marginRight=Le(w),g},Ea=function(f,m,g){var w="";switch(f){case"amsrm":w="AMS";break;case"textrm":w="Main";break;case"textsf":w="SansSerif";break;case"texttt":w="Typewriter";break;default:w=f}var k;return m==="textbf"&&g==="textit"?k="BoldItalic":m==="textbf"?k="Bold":m==="textit"?k="Italic":k="Regular",w+"-"+k},Gi={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},da={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]},Ta=function(f,m){var g=da[f],w=g[0],k=g[1],z=g[2],W=new Rt(w),ee=new Tt([W],{width:Le(k),height:Le(z),style:"width:"+Le(k),viewBox:"0 0 "+1e3*k+" "+1e3*z,preserveAspectRatio:"xMinYMin"}),ue=po(["overlay"],[ee],m);return ue.height=z,ue.style.height=Le(z),ue.style.width=Le(k),ue},Fe={fontMap:Gi,makeSymbol:mi,mathsym:Mu,makeSpan:Vr,makeSvgSpan:po,makeLineSpan:pl,makeAnchor:mo,makeFragment:Eu,wrapFragment:ml,makeVList:Zc,makeOrd:Zn,makeGlue:go,staticSvg:Ta,svgData:da,tryCombineChars:ho},Xn={number:3,unit:"mu"},Sr={number:4,unit:"mu"},Wn={number:5,unit:"mu"},Tu={mord:{mop:Xn,mbin:Sr,mrel:Wn,minner:Xn},mop:{mord:Xn,mop:Xn,mrel:Wn,minner:Xn},mbin:{mord:Sr,mop:Sr,mopen:Sr,minner:Sr},mrel:{mord:Wn,mop:Wn,mopen:Wn,minner:Wn},mopen:{},mclose:{mop:Xn,mbin:Sr,mrel:Wn,minner:Xn},mpunct:{mord:Xn,mop:Xn,mrel:Wn,mopen:Xn,mclose:Xn,mpunct:Xn,minner:Xn},minner:{mord:Xn,mop:Xn,mbin:Sr,mrel:Wn,mopen:Xn,mpunct:Xn,minner:Xn}},gi={mord:{mop:Xn},mop:{mord:Xn,mop:Xn},mbin:{},mrel:{},mopen:{},mclose:{mop:Xn},mpunct:{},minner:{mop:Xn}},gl={},Ja={},rr={};function Ct(N){for(var f=N.type,m=N.names,g=N.props,w=N.handler,k=N.htmlBuilder,z=N.mathmlBuilder,W={type:f,numArgs:g.numArgs,argTypes:g.argTypes,allowedInArgument:!!g.allowedInArgument,allowedInText:!!g.allowedInText,allowedInMath:g.allowedInMath===void 0?!0:g.allowedInMath,numOptionalArgs:g.numOptionalArgs||0,infix:!!g.infix,primitive:!!g.primitive,handler:w},ee=0;ee<m.length;++ee)gl[m[ee]]=W;f&&(k&&(Ja[f]=k),z&&(rr[f]=z))}function pn(N){var f=N.type,m=N.htmlBuilder,g=N.mathmlBuilder;Ct({type:f,names:[],props:{numArgs:0},handler:function(){throw new Error("Should never be called.")},htmlBuilder:m,mathmlBuilder:g})}var Ps=function(f){return f.type==="ordgroup"&&f.body.length===1?f.body[0]:f},zn=function(f){return f.type==="ordgroup"?f.body:[f]},Yr=Fe.makeSpan,Jc=["leftmost","mbin","mopen","mrel","mop","mpunct"],vi=["rightmost","mrel","mclose","mpunct"],vo={display:de.DISPLAY,text:de.TEXT,script:de.SCRIPT,scriptscript:de.SCRIPTSCRIPT},Qc={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},cr=function(f,m,g,w){w===void 0&&(w=[null,null]);for(var k=[],z=0;z<f.length;z++){var W=kn(f[z],m);if(W instanceof Xe){var ee=W.children;k.push.apply(k,ee)}else k.push(W)}if(Fe.tryCombineChars(k),!g)return k;var ue=m;if(f.length===1){var Me=f[0];Me.type==="sizing"?ue=m.havingSize(Me.size):Me.type==="styling"&&(ue=m.havingStyle(vo[Me.style]))}var Ue=Yr([w[0]||"leftmost"],[],m),lt=Yr([w[1]||"rightmost"],[],m),p=g==="root";return yo(k,function(y,T){var $=T.classes[0],F=y.classes[0];$==="mbin"&&S.contains(vi,F)?T.classes[0]="mord":F==="mbin"&&S.contains(Jc,$)&&(y.classes[0]="mord")},{node:Ue},lt,p),yo(k,function(y,T){var $=Rs(T),F=Rs(y),q=$&&F?y.hasClass("mtight")?gi[$][F]:Tu[$][F]:null;if(q)return Fe.makeGlue(q,ue)},{node:Ue},lt,p),k},yo=function N(f,m,g,w,k){w&&f.push(w);for(var z=0;z<f.length;z++){var W=f[z],ee=vl(W);if(ee){N(ee.children,m,g,null,k);continue}var ue=!W.hasClass("mspace");if(ue){var Me=m(W,g.node);Me&&(g.insertAfter?g.insertAfter(Me):(f.unshift(Me),z++))}ue?g.node=W:k&&W.hasClass("newline")&&(g.node=Yr(["leftmost"])),g.insertAfter=function(Ue){return function(lt){f.splice(Ue+1,0,lt),z++}}(z)}w&&f.pop()},vl=function(f){return f instanceof Xe||f instanceof Mn||f instanceof on&&f.hasClass("enclosing")?f:null},ed=function N(f,m){var g=vl(f);if(g){var w=g.children;if(w.length){if(m==="right")return N(w[w.length-1],"right");if(m==="left")return N(w[0],"left")}}return f},Rs=function(f,m){return f?(m&&(f=ed(f,m)),Qc[f.classes[0]]||null):null},Qa=function(f,m){var g=["nulldelimiter"].concat(f.baseSizingClasses());return Yr(m.concat(g))},kn=function(f,m,g){if(!f)return Yr();if(Ja[f.type]){var w=Ja[f.type](f,m);if(g&&m.size!==g.size){w=Yr(m.sizingClasses(g),[w],m);var k=m.sizeMultiplier/g.sizeMultiplier;w.height*=k,w.depth*=k}return w}else throw new a("Got group of unknown type: '"+f.type+"'")};function _o(N,f){var m=Yr(["base"],N,f),g=Yr(["strut"]);return g.style.height=Le(m.height+m.depth),m.depth&&(g.style.verticalAlign=Le(-m.depth)),m.children.unshift(g),m}function yl(N,f){var m=null;N.length===1&&N[0].type==="tag"&&(m=N[0].tag,N=N[0].body);var g=cr(N,f,"root"),w;g.length===2&&g[1].hasClass("tag")&&(w=g.pop());for(var k=[],z=[],W=0;W<g.length;W++)if(z.push(g[W]),g[W].hasClass("mbin")||g[W].hasClass("mrel")||g[W].hasClass("allowbreak")){for(var ee=!1;W<g.length-1&&g[W+1].hasClass("mspace")&&!g[W+1].hasClass("newline");)W++,z.push(g[W]),g[W].hasClass("nobreak")&&(ee=!0);ee||(k.push(_o(z,f)),z=[])}else g[W].hasClass("newline")&&(z.pop(),z.length>0&&(k.push(_o(z,f)),z=[]),k.push(g[W]));z.length>0&&k.push(_o(z,f));var ue;m?(ue=_o(cr(m,f,!0)),ue.classes=["tag"],k.push(ue)):w&&k.push(w);var Me=Yr(["katex-html"],k);if(Me.setAttribute("aria-hidden","true"),ue){var Ue=ue.children[0];Ue.style.height=Le(Me.height+Me.depth),Me.depth&&(Ue.style.verticalAlign=Le(-Me.depth))}return Me}function Cu(N){return new Xe(N)}var $r=function(){function N(m,g,w){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=m,this.attributes={},this.children=g||[],this.classes=w||[]}var f=N.prototype;return f.setAttribute=function(g,w){this.attributes[g]=w},f.getAttribute=function(g){return this.attributes[g]},f.toNode=function(){var g=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(var w in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,w)&&g.setAttribute(w,this.attributes[w]);this.classes.length>0&&(g.className=kt(this.classes));for(var k=0;k<this.children.length;k++)g.appendChild(this.children[k].toNode());return g},f.toMarkup=function(){var g="<"+this.type;for(var w in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,w)&&(g+=" "+w+'="',g+=S.escape(this.attributes[w]),g+='"');this.classes.length>0&&(g+=' class ="'+S.escape(kt(this.classes))+'"'),g+=">";for(var k=0;k<this.children.length;k++)g+=this.children[k].toMarkup();return g+="</"+this.type+">",g},f.toText=function(){return this.children.map(function(g){return g.toText()}).join("")},N}(),es=function(){function N(m){this.text=void 0,this.text=m}var f=N.prototype;return f.toNode=function(){return document.createTextNode(this.text)},f.toMarkup=function(){return S.escape(this.toText())},f.toText=function(){return this.text},N}(),Ds=function(){function N(m){this.width=void 0,this.character=void 0,this.width=m,m>=.05555&&m<=.05556?this.character=" ":m>=.1666&&m<=.1667?this.character=" ":m>=.2222&&m<=.2223?this.character=" ":m>=.2777&&m<=.2778?this.character="  ":m>=-.05556&&m<=-.05555?this.character=" ⁣":m>=-.1667&&m<=-.1666?this.character=" ⁣":m>=-.2223&&m<=-.2222?this.character=" ⁣":m>=-.2778&&m<=-.2777?this.character=" ⁣":this.character=null}var f=N.prototype;return f.toNode=function(){if(this.character)return document.createTextNode(this.character);var g=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return g.setAttribute("width",Le(this.width)),g},f.toMarkup=function(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+Le(this.width)+'"/>'},f.toText=function(){return this.character?this.character:" "},N}(),_t={MathNode:$r,TextNode:es,SpaceNode:Ds,newDocumentFragment:Cu},Pr=function(f,m,g){return sn[m][f]&&sn[m][f].replace&&f.charCodeAt(0)!==55349&&!(wr.hasOwnProperty(f)&&g&&(g.fontFamily&&g.fontFamily.substr(4,2)==="tt"||g.font&&g.font.substr(4,2)==="tt"))&&(f=sn[m][f].replace),new _t.TextNode(f)},Ls=function(f){return f.length===1?f[0]:new _t.MathNode("mrow",f)},zs=function(f,m){if(m.fontFamily==="texttt")return"monospace";if(m.fontFamily==="textsf")return m.fontShape==="textit"&&m.fontWeight==="textbf"?"sans-serif-bold-italic":m.fontShape==="textit"?"sans-serif-italic":m.fontWeight==="textbf"?"bold-sans-serif":"sans-serif";if(m.fontShape==="textit"&&m.fontWeight==="textbf")return"bold-italic";if(m.fontShape==="textit")return"italic";if(m.fontWeight==="textbf")return"bold";var g=m.font;if(!g||g==="mathnormal")return null;var w=f.mode;if(g==="mathit")return"italic";if(g==="boldsymbol")return f.type==="textord"?"bold":"bold-italic";if(g==="mathbf")return"bold";if(g==="mathbb")return"double-struck";if(g==="mathfrak")return"fraktur";if(g==="mathscr"||g==="mathcal")return"script";if(g==="mathsf")return"sans-serif";if(g==="mathtt")return"monospace";var k=f.text;if(S.contains(["\\imath","\\jmath"],k))return null;sn[w][k]&&sn[w][k].replace&&(k=sn[w][k].replace);var z=Fe.fontMap[g].fontName;return vt(k,z,w)?Fe.fontMap[g].variant:null},Rr=function(f,m,g){if(f.length===1){var w=Hn(f[0],m);return g&&w instanceof $r&&w.type==="mo"&&(w.setAttribute("lspace","0em"),w.setAttribute("rspace","0em")),[w]}for(var k=[],z,W=0;W<f.length;W++){var ee=Hn(f[W],m);if(ee instanceof $r&&z instanceof $r){if(ee.type==="mtext"&&z.type==="mtext"&&ee.getAttribute("mathvariant")===z.getAttribute("mathvariant")){var ue;(ue=z.children).push.apply(ue,ee.children);continue}else if(ee.type==="mn"&&z.type==="mn"){var Me;(Me=z.children).push.apply(Me,ee.children);continue}else if(ee.type==="mi"&&ee.children.length===1&&z.type==="mn"){var Ue=ee.children[0];if(Ue instanceof es&&Ue.text==="."){var lt;(lt=z.children).push.apply(lt,ee.children);continue}}else if(z.type==="mi"&&z.children.length===1){var p=z.children[0];if(p instanceof es&&p.text==="̸"&&(ee.type==="mo"||ee.type==="mi"||ee.type==="mn")){var y=ee.children[0];y instanceof es&&y.text.length>0&&(y.text=y.text.slice(0,1)+"̸"+y.text.slice(1),k.pop())}}}k.push(ee),z=ee}return k},qi=function(f,m,g){return Ls(Rr(f,m,g))},Hn=function(f,m){if(!f)return new _t.MathNode("mrow");if(rr[f.type]){var g=rr[f.type](f,m);return g}else throw new a("Got group of unknown type: '"+f.type+"'")};function Au(N,f,m,g,w){var k=Rr(N,m),z;k.length===1&&k[0]instanceof $r&&S.contains(["mrow","mtable"],k[0].type)?z=k[0]:z=new _t.MathNode("mrow",k);var W=new _t.MathNode("annotation",[new _t.TextNode(f)]);W.setAttribute("encoding","application/x-tex");var ee=new _t.MathNode("semantics",[z,W]),ue=new _t.MathNode("math",[ee]);ue.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),g&&ue.setAttribute("display","block");var Me=w?"katex":"katex-mathml";return Fe.makeSpan([Me],[ue])}var ku=function(f){return new nt({style:f.displayMode?de.DISPLAY:de.TEXT,maxSize:f.maxSize,minRuleThickness:f.minRuleThickness})},ts=function(f,m){if(m.displayMode){var g=["katex-display"];m.leqno&&g.push("leqno"),m.fleqn&&g.push("fleqn"),f=Fe.makeSpan(g,[f])}return f},Iu=function(f,m,g){var w=ku(g),k;if(g.output==="mathml")return Au(f,m,w,g.displayMode,!0);if(g.output==="html"){var z=yl(f,w);k=Fe.makeSpan(["katex"],[z])}else{var W=Au(f,m,w,g.displayMode,!1),ee=yl(f,w);k=Fe.makeSpan(["katex"],[W,ee])}return ts(k,g)},Os=function(f,m,g){var w=ku(g),k=yl(f,w),z=Fe.makeSpan(["katex"],[k]);return ts(z,g)},td={widehat:"^",widecheck:"ˇ",widetilde:"~",utilde:"~",overleftarrow:"←",underleftarrow:"←",xleftarrow:"←",overrightarrow:"→",underrightarrow:"→",xrightarrow:"→",underbrace:"⏟",overbrace:"⏞",overgroup:"⏠",undergroup:"⏡",overleftrightarrow:"↔",underleftrightarrow:"↔",xleftrightarrow:"↔",Overrightarrow:"⇒",xRightarrow:"⇒",overleftharpoon:"↼",xleftharpoonup:"↼",overrightharpoon:"⇀",xrightharpoonup:"⇀",xLeftarrow:"⇐",xLeftrightarrow:"⇔",xhookleftarrow:"↩",xhookrightarrow:"↪",xmapsto:"↦",xrightharpoondown:"⇁",xleftharpoondown:"↽",xrightleftharpoons:"⇌",xleftrightharpoons:"⇋",xtwoheadleftarrow:"↞",xtwoheadrightarrow:"↠",xlongequal:"=",xtofrom:"⇄",xrightleftarrows:"⇄",xrightequilibrium:"⇌",xleftequilibrium:"⇋","\\cdrightarrow":"→","\\cdleftarrow":"←","\\cdlongequal":"="},$u=function(f){var m=new _t.MathNode("mo",[new _t.TextNode(td[f.replace(/^\\/,"")])]);return m.setAttribute("stretchy","true"),m},bo={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},nd=function(f){return f.type==="ordgroup"?f.body.length:1},Pu=function(f,m){function g(){var ee=4e5,ue=f.label.substr(1);if(S.contains(["widehat","widecheck","widetilde","utilde"],ue)){var Me=f,Ue=nd(Me.base),lt,p,y;if(Ue>5)ue==="widehat"||ue==="widecheck"?(lt=420,ee=2364,y=.42,p=ue+"4"):(lt=312,ee=2340,y=.34,p="tilde4");else{var T=[1,1,2,2,3,3][Ue];ue==="widehat"||ue==="widecheck"?(ee=[0,1062,2364,2364,2364][T],lt=[0,239,300,360,420][T],y=[0,.24,.3,.3,.36,.42][T],p=ue+T):(ee=[0,600,1033,2339,2340][T],lt=[0,260,286,306,312][T],y=[0,.26,.286,.3,.306,.34][T],p="tilde"+T)}var $=new Rt(p),F=new Tt([$],{width:"100%",height:Le(y),viewBox:"0 0 "+ee+" "+lt,preserveAspectRatio:"none"});return{span:Fe.makeSvgSpan([],[F],m),minWidth:0,height:y}}else{var q=[],J=bo[ue],oe=J[0],Ce=J[1],He=J[2],Ke=He/1e3,st=oe.length,wt,ot;if(st===1){var $t=J[3];wt=["hide-tail"],ot=[$t]}else if(st===2)wt=["halfarrow-left","halfarrow-right"],ot=["xMinYMin","xMaxYMin"];else if(st===3)wt=["brace-left","brace-center","brace-right"],ot=["xMinYMin","xMidYMin","xMaxYMin"];else throw new Error(`Correct katexImagesData or update code here to support
                    `+st+" children.");for(var jt=0;jt<st;jt++){var En=new Rt(oe[jt]),mn=new Tt([En],{width:"400em",height:Le(Ke),viewBox:"0 0 "+ee+" "+He,preserveAspectRatio:ot[jt]+" slice"}),Dn=Fe.makeSvgSpan([wt[jt]],[mn],m);if(st===1)return{span:Dn,minWidth:Ce,height:Ke};Dn.style.height=Le(Ke),q.push(Dn)}return{span:Fe.makeSpan(["stretchy"],q,m),minWidth:Ce,height:Ke}}}var w=g(),k=w.span,z=w.minWidth,W=w.height;return k.height=W,k.style.height=Le(W),z>0&&(k.style.minWidth=Le(z)),k},ns=function(f,m,g,w,k){var z,W=f.height+f.depth+g+w;if(/fbox|color|angl/.test(m)){if(z=Fe.makeSpan(["stretchy",m],[],k),m==="fbox"){var ee=k.color&&k.getColor();ee&&(z.style.borderColor=ee)}}else{var ue=[];/^[bx]cancel$/.test(m)&&ue.push(new $n({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(m)&&ue.push(new $n({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));var Me=new Tt(ue,{width:"100%",height:Le(W)});z=Fe.makeSvgSpan([],[Me],k)}return z.height=W,z.style.height=Le(W),z},Tn={encloseSpan:ns,mathMLnode:$u,svgSpan:Pu};function qt(N,f){if(!N||N.type!==f)throw new Error("Expected node of type "+f+", but got "+(N?"node of type "+N.type:String(N)));return N}function _l(N){var f=Ns(N);if(!f)throw new Error("Expected node of symbol group type, but got "+(N?"node of type "+N.type:String(N)));return f}function Ns(N){return N&&(N.type==="atom"||Yt.hasOwnProperty(N.type))?N:null}var fa=function(f,m){var g,w,k;f&&f.type==="supsub"?(w=qt(f.base,"accent"),g=w.base,f.base=g,k=mr(kn(f,m)),f.base=w):(w=qt(f,"accent"),g=w.base);var z=kn(g,m.havingCrampedStyle()),W=w.isShifty&&S.isCharacterBox(g),ee=0;if(W){var ue=S.getBaseElem(g),Me=kn(ue,m.havingCrampedStyle());ee=nr(Me).skew}var Ue=w.label==="\\c",lt=Ue?z.height+z.depth:Math.min(z.height,m.fontMetrics().xHeight),p;if(w.isStretchy)p=Tn.svgSpan(w,m),p=Fe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:z},{type:"elem",elem:p,wrapperClasses:["svg-align"],wrapperStyle:ee>0?{width:"calc(100% - "+Le(2*ee)+")",marginLeft:Le(2*ee)}:void 0}]},m);else{var y,T;w.label==="\\vec"?(y=Fe.staticSvg("vec",m),T=Fe.svgData.vec[1]):(y=Fe.makeOrd({mode:w.mode,text:w.label},m,"textord"),y=nr(y),y.italic=0,T=y.width,Ue&&(lt+=y.depth)),p=Fe.makeSpan(["accent-body"],[y]);var $=w.label==="\\textcircled";$&&(p.classes.push("accent-full"),lt=z.height);var F=ee;$||(F-=T/2),p.style.left=Le(F),w.label==="\\textcircled"&&(p.style.top=".2em"),p=Fe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:z},{type:"kern",size:-lt},{type:"elem",elem:p}]},m)}var q=Fe.makeSpan(["mord","accent"],[p],m);return k?(k.children[0]=q,k.height=Math.max(q.height,k.height),k.classes[0]="mord",k):q},Ru=function(f,m){var g=f.isStretchy?Tn.mathMLnode(f.label):new _t.MathNode("mo",[Pr(f.label,f.mode)]),w=new _t.MathNode("mover",[Hn(f.base,m),g]);return w.setAttribute("accent","true"),w},Du=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map(function(N){return"\\"+N}).join("|"));Ct({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:function(f,m){var g=Ps(m[0]),w=!Du.test(f.funcName),k=!w||f.funcName==="\\widehat"||f.funcName==="\\widetilde"||f.funcName==="\\widecheck";return{type:"accent",mode:f.parser.mode,label:f.funcName,isStretchy:w,isShifty:k,base:g}},htmlBuilder:fa,mathmlBuilder:Ru}),Ct({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:function(f,m){var g=m[0],w=f.parser.mode;return w==="math"&&(f.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+f.funcName+" works only in text mode"),w="text"),{type:"accent",mode:w,label:f.funcName,isStretchy:!1,isShifty:!0,base:g}},htmlBuilder:fa,mathmlBuilder:Ru}),Ct({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:function(f,m){var g=f.parser,w=f.funcName,k=m[0];return{type:"accentUnder",mode:g.mode,label:w,base:k}},htmlBuilder:function(f,m){var g=kn(f.base,m),w=Tn.svgSpan(f,m),k=f.label==="\\utilde"?.12:0,z=Fe.makeVList({positionType:"top",positionData:g.height,children:[{type:"elem",elem:w,wrapperClasses:["svg-align"]},{type:"kern",size:k},{type:"elem",elem:g}]},m);return Fe.makeSpan(["mord","accentunder"],[z],m)},mathmlBuilder:function(f,m){var g=Tn.mathMLnode(f.label),w=new _t.MathNode("munder",[Hn(f.base,m),g]);return w.setAttribute("accentunder","true"),w}});var xo=function(f){var m=new _t.MathNode("mpadded",f?[f]:[]);return m.setAttribute("width","+0.6em"),m.setAttribute("lspace","0.3em"),m};Ct({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler:function(f,m,g){var w=f.parser,k=f.funcName;return{type:"xArrow",mode:w.mode,label:k,body:m[0],below:g[0]}},htmlBuilder:function(f,m){var g=m.style,w=m.havingStyle(g.sup()),k=Fe.wrapFragment(kn(f.body,w,m),m),z=f.label.slice(0,2)==="\\x"?"x":"cd";k.classes.push(z+"-arrow-pad");var W;f.below&&(w=m.havingStyle(g.sub()),W=Fe.wrapFragment(kn(f.below,w,m),m),W.classes.push(z+"-arrow-pad"));var ee=Tn.svgSpan(f,m),ue=-m.fontMetrics().axisHeight+.5*ee.height,Me=-m.fontMetrics().axisHeight-.5*ee.height-.111;(k.depth>.25||f.label==="\\xleftequilibrium")&&(Me-=k.depth);var Ue;if(W){var lt=-m.fontMetrics().axisHeight+W.height+.5*ee.height+.111;Ue=Fe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:k,shift:Me},{type:"elem",elem:ee,shift:ue},{type:"elem",elem:W,shift:lt}]},m)}else Ue=Fe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:k,shift:Me},{type:"elem",elem:ee,shift:ue}]},m);return Ue.children[0].children[0].children[1].classes.push("svg-align"),Fe.makeSpan(["mrel","x-arrow"],[Ue],m)},mathmlBuilder:function(f,m){var g=Tn.mathMLnode(f.label);g.setAttribute("minsize",f.label.charAt(0)==="x"?"1.75em":"3.0em");var w;if(f.body){var k=xo(Hn(f.body,m));if(f.below){var z=xo(Hn(f.below,m));w=new _t.MathNode("munderover",[g,z,k])}else w=new _t.MathNode("mover",[g,k])}else if(f.below){var W=xo(Hn(f.below,m));w=new _t.MathNode("munder",[g,W])}else w=xo(),w=new _t.MathNode("mover",[g,w]);return w}});var rd={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},Lu=function(){return{type:"styling",body:[],mode:"math",style:"display"}},Ca=function(f){return f.type==="textord"&&f.text==="@"},Aa=function(f,m){return(f.type==="mathord"||f.type==="atom")&&f.text===m};function bl(N,f,m){var g=rd[N];switch(g){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return m.callFunction(g,[f[0]],[f[1]]);case"\\uparrow":case"\\downarrow":{var w=m.callFunction("\\\\cdleft",[f[0]],[]),k={type:"atom",text:g,mode:"math",family:"rel"},z=m.callFunction("\\Big",[k],[]),W=m.callFunction("\\\\cdright",[f[1]],[]),ee={type:"ordgroup",mode:"math",body:[w,z,W]};return m.callFunction("\\\\cdparent",[ee],[])}case"\\\\cdlongequal":return m.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{var ue={type:"textord",text:"\\Vert",mode:"math"};return m.callFunction("\\Big",[ue],[])}default:return{type:"textord",text:" ",mode:"math"}}}function id(N){var f=[];for(N.gullet.beginGroup(),N.gullet.macros.set("\\cr","\\\\\\relax"),N.gullet.beginGroup();;){f.push(N.parseExpression(!1,"\\\\")),N.gullet.endGroup(),N.gullet.beginGroup();var m=N.fetch().text;if(m==="&"||m==="\\\\")N.consume();else if(m==="\\end"){f[f.length-1].length===0&&f.pop();break}else throw new a("Expected \\\\ or \\cr or \\end",N.nextToken)}for(var g=[],w=[g],k=0;k<f.length;k++){for(var z=f[k],W=Lu(),ee=0;ee<z.length;ee++)if(!Ca(z[ee]))W.body.push(z[ee]);else{g.push(W),ee+=1;var ue=_l(z[ee]).text,Me=new Array(2);if(Me[0]={type:"ordgroup",mode:"math",body:[]},Me[1]={type:"ordgroup",mode:"math",body:[]},!("=|.".indexOf(ue)>-1))if("<>AV".indexOf(ue)>-1)for(var Ue=0;Ue<2;Ue++){for(var lt=!0,p=ee+1;p<z.length;p++){if(Aa(z[p],ue)){lt=!1,ee=p;break}if(Ca(z[p]))throw new a("Missing a "+ue+" character to complete a CD arrow.",z[p]);Me[Ue].body.push(z[p])}if(lt)throw new a("Missing a "+ue+" character to complete a CD arrow.",z[ee])}else throw new a('Expected one of "<>AV=|." after @',z[ee]);var y=bl(ue,Me,N),T={type:"styling",body:[y],mode:"math",style:"display"};g.push(T),W=Lu()}k%2===0?g.push(W):g.shift(),g=[],w.push(g)}N.gullet.endGroup(),N.gullet.endGroup();var $=new Array(w[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25});return{type:"array",mode:"math",body:w,arraystretch:1,addJot:!0,rowGaps:[null],cols:$,colSeparationType:"CD",hLinesBeforeRow:new Array(w.length+1).fill([])}}Ct({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler:function(f,m){var g=f.parser,w=f.funcName;return{type:"cdlabel",mode:g.mode,side:w.slice(4),label:m[0]}},htmlBuilder:function(f,m){var g=m.havingStyle(m.style.sup()),w=Fe.wrapFragment(kn(f.label,g,m),m);return w.classes.push("cd-label-"+f.side),w.style.bottom=Le(.8-w.depth),w.height=0,w.depth=0,w},mathmlBuilder:function(f,m){var g=new _t.MathNode("mrow",[Hn(f.label,m)]);return g=new _t.MathNode("mpadded",[g]),g.setAttribute("width","0"),f.side==="left"&&g.setAttribute("lspace","-1width"),g.setAttribute("voffset","0.7em"),g=new _t.MathNode("mstyle",[g]),g.setAttribute("displaystyle","false"),g.setAttribute("scriptlevel","1"),g}}),Ct({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler:function(f,m){var g=f.parser;return{type:"cdlabelparent",mode:g.mode,fragment:m[0]}},htmlBuilder:function(f,m){var g=Fe.wrapFragment(kn(f.fragment,m),m);return g.classes.push("cd-vert-arrow"),g},mathmlBuilder:function(f,m){return new _t.MathNode("mrow",[Hn(f.fragment,m)])}}),Ct({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler:function(f,m){for(var g=f.parser,w=qt(m[0],"ordgroup"),k=w.body,z="",W=0;W<k.length;W++){var ee=qt(k[W],"textord");z+=ee.text}var ue=parseInt(z),Me;if(isNaN(ue))throw new a("\\@char has non-numeric argument "+z);if(ue<0||ue>=1114111)throw new a("\\@char with invalid code point "+z);return ue<=65535?Me=String.fromCharCode(ue):(ue-=65536,Me=String.fromCharCode((ue>>10)+55296,(ue&1023)+56320)),{type:"textord",mode:g.mode,text:Me}}});var zu=function(f,m){var g=cr(f.body,m.withColor(f.color),!1);return Fe.makeFragment(g)},wo=function(f,m){var g=Rr(f.body,m.withColor(f.color)),w=new _t.MathNode("mstyle",g);return w.setAttribute("mathcolor",f.color),w};Ct({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler:function(f,m){var g=f.parser,w=qt(m[0],"color-token").color,k=m[1];return{type:"color",mode:g.mode,color:w,body:zn(k)}},htmlBuilder:zu,mathmlBuilder:wo}),Ct({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler:function(f,m){var g=f.parser,w=f.breakOnTokenText,k=qt(m[0],"color-token").color;g.gullet.macros.set("\\current@color",k);var z=g.parseExpression(!0,w);return{type:"color",mode:g.mode,color:k,body:z}},htmlBuilder:zu,mathmlBuilder:wo}),Ct({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:1,argTypes:["size"],allowedInText:!0},handler:function(f,m,g){var w=f.parser,k=g[0],z=!w.settings.displayMode||!w.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:w.mode,newLine:z,size:k&&qt(k,"size").value}},htmlBuilder:function(f,m){var g=Fe.makeSpan(["mspace"],[],m);return f.newLine&&(g.classes.push("newline"),f.size&&(g.style.marginTop=Le(at(f.size,m)))),g},mathmlBuilder:function(f,m){var g=new _t.MathNode("mspace");return f.newLine&&(g.setAttribute("linebreak","newline"),f.size&&g.setAttribute("height",Le(at(f.size,m)))),g}});var rs={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},xl=function(f){var m=f.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(m))throw new a("Expected a control sequence",f);return m},So=function(f){var m=f.gullet.popToken();return m.text==="="&&(m=f.gullet.popToken(),m.text===" "&&(m=f.gullet.popToken())),m},Zr=function(f,m,g,w){var k=f.gullet.macros.get(g.text);k==null&&(g.noexpand=!0,k={tokens:[g],numArgs:0,unexpandable:!f.gullet.isExpandable(g.text)}),f.gullet.macros.set(m,k,w)};Ct({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler:function(f){var m=f.parser,g=f.funcName;m.consumeSpaces();var w=m.fetch();if(rs[w.text])return(g==="\\global"||g==="\\\\globallong")&&(w.text=rs[w.text]),qt(m.parseFunction(),"internal");throw new a("Invalid token after macro prefix",w)}}),Ct({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler:function(f){var m=f.parser,g=f.funcName,w=m.gullet.popToken(),k=w.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(k))throw new a("Expected a control sequence",w);for(var z=0,W,ee=[[]];m.gullet.future().text!=="{";)if(w=m.gullet.popToken(),w.text==="#"){if(m.gullet.future().text==="{"){W=m.gullet.future(),ee[z].push("{");break}if(w=m.gullet.popToken(),!/^[1-9]$/.test(w.text))throw new a('Invalid argument number "'+w.text+'"');if(parseInt(w.text)!==z+1)throw new a('Argument number "'+w.text+'" out of order');z++,ee.push([])}else{if(w.text==="EOF")throw new a("Expected a macro definition");ee[z].push(w.text)}var ue=m.gullet.consumeArg(),Me=ue.tokens;return W&&Me.unshift(W),(g==="\\edef"||g==="\\xdef")&&(Me=m.gullet.expandTokens(Me),Me.reverse()),m.gullet.macros.set(k,{tokens:Me,numArgs:z,delimiters:ee},g===rs[g]),{type:"internal",mode:m.mode}}}),Ct({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler:function(f){var m=f.parser,g=f.funcName,w=xl(m.gullet.popToken());m.gullet.consumeSpaces();var k=So(m);return Zr(m,w,k,g==="\\\\globallet"),{type:"internal",mode:m.mode}}}),Ct({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler:function(f){var m=f.parser,g=f.funcName,w=xl(m.gullet.popToken()),k=m.gullet.popToken(),z=m.gullet.popToken();return Zr(m,w,z,g==="\\\\globalfuture"),m.gullet.pushToken(z),m.gullet.pushToken(k),{type:"internal",mode:m.mode}}});var ha=function(f,m,g){var w=sn.math[f]&&sn.math[f].replace,k=vt(w||f,m,g);if(!k)throw new Error("Unsupported symbol "+f+" and font size "+m+".");return k},Mo=function(f,m,g,w){var k=g.havingBaseStyle(m),z=Fe.makeSpan(w.concat(k.sizingClasses(g)),[f],g),W=k.sizeMultiplier/g.sizeMultiplier;return z.height*=W,z.depth*=W,z.maxFontSize=k.sizeMultiplier,z},wl=function(f,m,g){var w=m.havingBaseStyle(g),k=(1-m.sizeMultiplier/w.sizeMultiplier)*m.fontMetrics().axisHeight;f.classes.push("delimcenter"),f.style.top=Le(k),f.height-=k,f.depth+=k},yi=function(f,m,g,w,k,z){var W=Fe.makeSymbol(f,"Main-Regular",k,w),ee=Mo(W,m,w,z);return g&&wl(ee,w,m),ee},Sl=function(f,m,g,w){return Fe.makeSymbol(f,"Size"+m+"-Regular",g,w)},Ml=function(f,m,g,w,k,z){var W=Sl(f,m,k,w),ee=Mo(Fe.makeSpan(["delimsizing","size"+m],[W],w),de.TEXT,w,z);return g&&wl(ee,w,de.TEXT),ee},is=function(f,m,g){var w;m==="Size1-Regular"?w="delim-size1":w="delim-size4";var k=Fe.makeSpan(["delimsizinginner",w],[Fe.makeSpan([],[Fe.makeSymbol(f,m,g)])]);return{type:"elem",elem:k}},Ft=function(f,m,g){var w=Ze["Size4-Regular"][f.charCodeAt(0)]?Ze["Size4-Regular"][f.charCodeAt(0)][4]:Ze["Size1-Regular"][f.charCodeAt(0)][4],k=new Rt("inner",me(f,Math.round(1e3*m))),z=new Tt([k],{width:Le(w),height:Le(m),style:"width:"+Le(w),viewBox:"0 0 "+1e3*w+" "+Math.round(1e3*m),preserveAspectRatio:"xMinYMin"}),W=Fe.makeSvgSpan([],[z],g);return W.height=m,W.style.height=Le(m),W.style.width=Le(w),{type:"elem",elem:W}},Bs=.008,Fs={type:"kern",size:-1*Bs},Ou=["|","\\lvert","\\rvert","\\vert"],Eo=["\\|","\\lVert","\\rVert","\\Vert"],_i=function(f,m,g,w,k,z){var W,ee,ue,Me;W=ue=Me=f,ee=null;var Ue="Size1-Regular";f==="\\uparrow"?ue=Me="⏐":f==="\\Uparrow"?ue=Me="‖":f==="\\downarrow"?W=ue="⏐":f==="\\Downarrow"?W=ue="‖":f==="\\updownarrow"?(W="\\uparrow",ue="⏐",Me="\\downarrow"):f==="\\Updownarrow"?(W="\\Uparrow",ue="‖",Me="\\Downarrow"):S.contains(Ou,f)?ue="∣":S.contains(Eo,f)?ue="∥":f==="["||f==="\\lbrack"?(W="⎡",ue="⎢",Me="⎣",Ue="Size4-Regular"):f==="]"||f==="\\rbrack"?(W="⎤",ue="⎥",Me="⎦",Ue="Size4-Regular"):f==="\\lfloor"||f==="⌊"?(ue=W="⎢",Me="⎣",Ue="Size4-Regular"):f==="\\lceil"||f==="⌈"?(W="⎡",ue=Me="⎢",Ue="Size4-Regular"):f==="\\rfloor"||f==="⌋"?(ue=W="⎥",Me="⎦",Ue="Size4-Regular"):f==="\\rceil"||f==="⌉"?(W="⎤",ue=Me="⎥",Ue="Size4-Regular"):f==="("||f==="\\lparen"?(W="⎛",ue="⎜",Me="⎝",Ue="Size4-Regular"):f===")"||f==="\\rparen"?(W="⎞",ue="⎟",Me="⎠",Ue="Size4-Regular"):f==="\\{"||f==="\\lbrace"?(W="⎧",ee="⎨",Me="⎩",ue="⎪",Ue="Size4-Regular"):f==="\\}"||f==="\\rbrace"?(W="⎫",ee="⎬",Me="⎭",ue="⎪",Ue="Size4-Regular"):f==="\\lgroup"||f==="⟮"?(W="⎧",Me="⎩",ue="⎪",Ue="Size4-Regular"):f==="\\rgroup"||f==="⟯"?(W="⎫",Me="⎭",ue="⎪",Ue="Size4-Regular"):f==="\\lmoustache"||f==="⎰"?(W="⎧",Me="⎭",ue="⎪",Ue="Size4-Regular"):(f==="\\rmoustache"||f==="⎱")&&(W="⎫",Me="⎩",ue="⎪",Ue="Size4-Regular");var lt=ha(W,Ue,k),p=lt.height+lt.depth,y=ha(ue,Ue,k),T=y.height+y.depth,$=ha(Me,Ue,k),F=$.height+$.depth,q=0,J=1;if(ee!==null){var oe=ha(ee,Ue,k);q=oe.height+oe.depth,J=2}var Ce=p+F+q,He=Math.max(0,Math.ceil((m-Ce)/(J*T))),Ke=Ce+He*J*T,st=w.fontMetrics().axisHeight;g&&(st*=w.sizeMultiplier);var wt=Ke/2-st,ot=[];if(ot.push(is(Me,Ue,k)),ot.push(Fs),ee===null){var $t=Ke-p-F+2*Bs;ot.push(Ft(ue,$t,w))}else{var jt=(Ke-p-F-q)/2+2*Bs;ot.push(Ft(ue,jt,w)),ot.push(Fs),ot.push(is(ee,Ue,k)),ot.push(Fs),ot.push(Ft(ue,jt,w))}ot.push(Fs),ot.push(is(W,Ue,k));var En=w.havingBaseStyle(de.TEXT),mn=Fe.makeVList({positionType:"bottom",positionData:wt,children:ot},En);return Mo(Fe.makeSpan(["delimsizing","mult"],[mn],En),de.TEXT,w,z)},as=80,Us=.08,To=function(f,m,g,w,k){var z=ce(f,w,g),W=new Rt(f,z),ee=new Tt([W],{width:"400em",height:Le(m),viewBox:"0 0 400000 "+g,preserveAspectRatio:"xMinYMin slice"});return Fe.makeSvgSpan(["hide-tail"],[ee],k)},pa=function(f,m){var g=m.havingBaseSizing(),w=Al("\\surd",f*g.sizeMultiplier,ko,g),k=g.sizeMultiplier,z=Math.max(0,m.minRuleThickness-m.fontMetrics().sqrtRuleThickness),W,ee=0,ue=0,Me=0,Ue;return w.type==="small"?(Me=1e3+1e3*z+as,f<1?k=1:f<1.4&&(k=.7),ee=(1+z+Us)/k,ue=(1+z)/k,W=To("sqrtMain",ee,Me,z,m),W.style.minWidth="0.853em",Ue=.833/k):w.type==="large"?(Me=(1e3+as)*ss[w.size],ue=(ss[w.size]+z)/k,ee=(ss[w.size]+z+Us)/k,W=To("sqrtSize"+w.size,ee,Me,z,m),W.style.minWidth="1.02em",Ue=1/k):(ee=f+z+Us,ue=f+z,Me=Math.floor(1e3*f+z)+as,W=To("sqrtTall",ee,Me,z,m),W.style.minWidth="0.742em",Ue=1.056),W.height=ue,W.style.height=Le(ee),{span:W,advanceWidth:Ue,ruleWidth:(m.fontMetrics().sqrtRuleThickness+z)*k}},El=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","\\surd"],Co=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱"],Tl=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],ss=[0,1.2,1.8,2.4,3],Nu=function(f,m,g,w,k){if(f==="<"||f==="\\lt"||f==="⟨"?f="\\langle":(f===">"||f==="\\gt"||f==="⟩")&&(f="\\rangle"),S.contains(El,f)||S.contains(Tl,f))return Ml(f,m,!1,g,w,k);if(S.contains(Co,f))return _i(f,ss[m],!1,g,w,k);throw new a("Illegal delimiter: '"+f+"'")},Ao=[{type:"small",style:de.SCRIPTSCRIPT},{type:"small",style:de.SCRIPT},{type:"small",style:de.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],Cl=[{type:"small",style:de.SCRIPTSCRIPT},{type:"small",style:de.SCRIPT},{type:"small",style:de.TEXT},{type:"stack"}],ko=[{type:"small",style:de.SCRIPTSCRIPT},{type:"small",style:de.SCRIPT},{type:"small",style:de.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],Bu=function(f){if(f.type==="small")return"Main-Regular";if(f.type==="large")return"Size"+f.size+"-Regular";if(f.type==="stack")return"Size4-Regular";throw new Error("Add support for delim type '"+f.type+"' here.")},Al=function(f,m,g,w){for(var k=Math.min(2,3-w.style.size),z=k;z<g.length&&g[z].type!=="stack";z++){var W=ha(f,Bu(g[z]),"math"),ee=W.height+W.depth;if(g[z].type==="small"){var ue=w.havingBaseStyle(g[z].style);ee*=ue.sizeMultiplier}if(ee>m)return g[z]}return g[g.length-1]},kl=function(f,m,g,w,k,z){f==="<"||f==="\\lt"||f==="⟨"?f="\\langle":(f===">"||f==="\\gt"||f==="⟩")&&(f="\\rangle");var W;S.contains(Tl,f)?W=Ao:S.contains(El,f)?W=ko:W=Cl;var ee=Al(f,m,W,w);return ee.type==="small"?yi(f,ee.style,g,w,k,z):ee.type==="large"?Ml(f,ee.size,g,w,k,z):_i(f,m,g,w,k,z)},Fu=function(f,m,g,w,k,z){var W=w.fontMetrics().axisHeight*w.sizeMultiplier,ee=901,ue=5/w.fontMetrics().ptPerEm,Me=Math.max(m-W,g+W),Ue=Math.max(Me/500*ee,2*Me-ue);return kl(f,Ue,!0,w,k,z)},Di={sqrtImage:pa,sizedDelim:Nu,sizeToMaxHeight:ss,customSizedDelim:kl,leftRightDelim:Fu},Il={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},M=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","<",">","\\langle","⟨","\\rangle","⟩","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function L(N,f){var m=Ns(N);if(m&&S.contains(M,m.text))return m;throw m?new a("Invalid delimiter '"+m.text+"' after '"+f.funcName+"'",N):new a("Invalid delimiter type '"+N.type+"'",N)}Ct({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:function(f,m){var g=L(m[0],f);return{type:"delimsizing",mode:f.parser.mode,size:Il[f.funcName].size,mclass:Il[f.funcName].mclass,delim:g.text}},htmlBuilder:function(f,m){return f.delim==="."?Fe.makeSpan([f.mclass]):Di.sizedDelim(f.delim,f.size,m,f.mode,[f.mclass])},mathmlBuilder:function(f){var m=[];f.delim!=="."&&m.push(Pr(f.delim,f.mode));var g=new _t.MathNode("mo",m);f.mclass==="mopen"||f.mclass==="mclose"?g.setAttribute("fence","true"):g.setAttribute("fence","false"),g.setAttribute("stretchy","true");var w=Le(Di.sizeToMaxHeight[f.size]);return g.setAttribute("minsize",w),g.setAttribute("maxsize",w),g}});function H(N){if(!N.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}Ct({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:function(f,m){var g=f.parser.gullet.macros.get("\\current@color");if(g&&typeof g!="string")throw new a("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:f.parser.mode,delim:L(m[0],f).text,color:g}}}),Ct({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:function(f,m){var g=L(m[0],f),w=f.parser;++w.leftrightDepth;var k=w.parseExpression(!1);--w.leftrightDepth,w.expect("\\right",!1);var z=qt(w.parseFunction(),"leftright-right");return{type:"leftright",mode:w.mode,body:k,left:g.text,right:z.delim,rightColor:z.color}},htmlBuilder:function(f,m){H(f);for(var g=cr(f.body,m,!0,["mopen","mclose"]),w=0,k=0,z=!1,W=0;W<g.length;W++)g[W].isMiddle?z=!0:(w=Math.max(g[W].height,w),k=Math.max(g[W].depth,k));w*=m.sizeMultiplier,k*=m.sizeMultiplier;var ee;if(f.left==="."?ee=Qa(m,["mopen"]):ee=Di.leftRightDelim(f.left,w,k,m,f.mode,["mopen"]),g.unshift(ee),z)for(var ue=1;ue<g.length;ue++){var Me=g[ue],Ue=Me.isMiddle;Ue&&(g[ue]=Di.leftRightDelim(Ue.delim,w,k,Ue.options,f.mode,[]))}var lt;if(f.right===".")lt=Qa(m,["mclose"]);else{var p=f.rightColor?m.withColor(f.rightColor):m;lt=Di.leftRightDelim(f.right,w,k,p,f.mode,["mclose"])}return g.push(lt),Fe.makeSpan(["minner"],g,m)},mathmlBuilder:function(f,m){H(f);var g=Rr(f.body,m);if(f.left!=="."){var w=new _t.MathNode("mo",[Pr(f.left,f.mode)]);w.setAttribute("fence","true"),g.unshift(w)}if(f.right!=="."){var k=new _t.MathNode("mo",[Pr(f.right,f.mode)]);k.setAttribute("fence","true"),f.rightColor&&k.setAttribute("mathcolor",f.rightColor),g.push(k)}return Ls(g)}}),Ct({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:function(f,m){var g=L(m[0],f);if(!f.parser.leftrightDepth)throw new a("\\middle without preceding \\left",g);return{type:"middle",mode:f.parser.mode,delim:g.text}},htmlBuilder:function(f,m){var g;if(f.delim===".")g=Qa(m,[]);else{g=Di.sizedDelim(f.delim,1,m,f.mode,[]);var w={delim:f.delim,options:m};g.isMiddle=w}return g},mathmlBuilder:function(f,m){var g=f.delim==="\\vert"||f.delim==="|"?Pr("|","text"):Pr(f.delim,f.mode),w=new _t.MathNode("mo",[g]);return w.setAttribute("fence","true"),w.setAttribute("lspace","0.05em"),w.setAttribute("rspace","0.05em"),w}});var Z=function(f,m){var g=Fe.wrapFragment(kn(f.body,m),m),w=f.label.substr(1),k=m.sizeMultiplier,z,W=0,ee=S.isCharacterBox(f.body);if(w==="sout")z=Fe.makeSpan(["stretchy","sout"]),z.height=m.fontMetrics().defaultRuleThickness/k,W=-.5*m.fontMetrics().xHeight;else if(w==="phase"){var ue=at({number:.6,unit:"pt"},m),Me=at({number:.35,unit:"ex"},m),Ue=m.havingBaseSizing();k=k/Ue.sizeMultiplier;var lt=g.height+g.depth+ue+Me;g.style.paddingLeft=Le(lt/2+ue);var p=Math.floor(1e3*lt*k),y=Ge(p),T=new Tt([new Rt("phase",y)],{width:"400em",height:Le(p/1e3),viewBox:"0 0 400000 "+p,preserveAspectRatio:"xMinYMin slice"});z=Fe.makeSvgSpan(["hide-tail"],[T],m),z.style.height=Le(lt),W=g.depth+ue+Me}else{/cancel/.test(w)?ee||g.classes.push("cancel-pad"):w==="angl"?g.classes.push("anglpad"):g.classes.push("boxpad");var $=0,F=0,q=0;/box/.test(w)?(q=Math.max(m.fontMetrics().fboxrule,m.minRuleThickness),$=m.fontMetrics().fboxsep+(w==="colorbox"?0:q),F=$):w==="angl"?(q=Math.max(m.fontMetrics().defaultRuleThickness,m.minRuleThickness),$=4*q,F=Math.max(0,.25-g.depth)):($=ee?.2:0,F=$),z=Tn.encloseSpan(g,w,$,F,m),/fbox|boxed|fcolorbox/.test(w)?(z.style.borderStyle="solid",z.style.borderWidth=Le(q)):w==="angl"&&q!==.049&&(z.style.borderTopWidth=Le(q),z.style.borderRightWidth=Le(q)),W=g.depth+F,f.backgroundColor&&(z.style.backgroundColor=f.backgroundColor,f.borderColor&&(z.style.borderColor=f.borderColor))}var J;if(f.backgroundColor)J=Fe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:z,shift:W},{type:"elem",elem:g,shift:0}]},m);else{var oe=/cancel|phase/.test(w)?["svg-align"]:[];J=Fe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:g,shift:0},{type:"elem",elem:z,shift:W,wrapperClasses:oe}]},m)}return/cancel/.test(w)&&(J.height=g.height,J.depth=g.depth),/cancel/.test(w)&&!ee?Fe.makeSpan(["mord","cancel-lap"],[J],m):Fe.makeSpan(["mord"],[J],m)},ae=function(f,m){var g=0,w=new _t.MathNode(f.label.indexOf("colorbox")>-1?"mpadded":"menclose",[Hn(f.body,m)]);switch(f.label){case"\\cancel":w.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":w.setAttribute("notation","downdiagonalstrike");break;case"\\phase":w.setAttribute("notation","phasorangle");break;case"\\sout":w.setAttribute("notation","horizontalstrike");break;case"\\fbox":w.setAttribute("notation","box");break;case"\\angl":w.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(g=m.fontMetrics().fboxsep*m.fontMetrics().ptPerEm,w.setAttribute("width","+"+2*g+"pt"),w.setAttribute("height","+"+2*g+"pt"),w.setAttribute("lspace",g+"pt"),w.setAttribute("voffset",g+"pt"),f.label==="\\fcolorbox"){var k=Math.max(m.fontMetrics().fboxrule,m.minRuleThickness);w.setAttribute("style","border: "+k+"em solid "+String(f.borderColor))}break;case"\\xcancel":w.setAttribute("notation","updiagonalstrike downdiagonalstrike");break}return f.backgroundColor&&w.setAttribute("mathbackground",f.backgroundColor),w};Ct({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler:function(f,m,g){var w=f.parser,k=f.funcName,z=qt(m[0],"color-token").color,W=m[1];return{type:"enclose",mode:w.mode,label:k,backgroundColor:z,body:W}},htmlBuilder:Z,mathmlBuilder:ae}),Ct({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler:function(f,m,g){var w=f.parser,k=f.funcName,z=qt(m[0],"color-token").color,W=qt(m[1],"color-token").color,ee=m[2];return{type:"enclose",mode:w.mode,label:k,backgroundColor:W,borderColor:z,body:ee}},htmlBuilder:Z,mathmlBuilder:ae}),Ct({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler:function(f,m){var g=f.parser;return{type:"enclose",mode:g.mode,label:"\\fbox",body:m[0]}}}),Ct({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler:function(f,m){var g=f.parser,w=f.funcName,k=m[0];return{type:"enclose",mode:g.mode,label:w,body:k}},htmlBuilder:Z,mathmlBuilder:ae}),Ct({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler:function(f,m){var g=f.parser;return{type:"enclose",mode:g.mode,label:"\\angl",body:m[0]}}});var Ae={};function Qe(N){for(var f=N.type,m=N.names,g=N.props,w=N.handler,k=N.htmlBuilder,z=N.mathmlBuilder,W={type:f,numArgs:g.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:w},ee=0;ee<m.length;++ee)Ae[m[ee]]=W;k&&(Ja[f]=k),z&&(rr[f]=z)}function mt(N){var f=[];N.consumeSpaces();for(var m=N.fetch().text;m==="\\hline"||m==="\\hdashline";)N.consume(),f.push(m==="\\hdashline"),N.consumeSpaces(),m=N.fetch().text;return f}var St=function(f){var m=f.parser.settings;if(!m.displayMode)throw new a("{"+f.envName+"} can be used only in display mode.")};function It(N,f,m){var g=f.hskipBeforeAndAfter,w=f.addJot,k=f.cols,z=f.arraystretch,W=f.colSeparationType,ee=f.addEqnNum,ue=f.singleRow,Me=f.emptySingleRow,Ue=f.maxNumCols,lt=f.leqno;if(N.gullet.beginGroup(),ue||N.gullet.macros.set("\\cr","\\\\\\relax"),!z){var p=N.gullet.expandMacroAsText("\\arraystretch");if(p==null)z=1;else if(z=parseFloat(p),!z||z<0)throw new a("Invalid \\arraystretch: "+p)}N.gullet.beginGroup();var y=[],T=[y],$=[],F=[];for(F.push(mt(N));;){var q=N.parseExpression(!1,ue?"\\end":"\\\\");N.gullet.endGroup(),N.gullet.beginGroup(),q={type:"ordgroup",mode:N.mode,body:q},m&&(q={type:"styling",mode:N.mode,style:m,body:[q]}),y.push(q);var J=N.fetch().text;if(J==="&"){if(Ue&&y.length===Ue){if(ue||W)throw new a("Too many tab characters: &",N.nextToken);N.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}N.consume()}else if(J==="\\end"){y.length===1&&q.type==="styling"&&q.body[0].body.length===0&&(T.length>1||!Me)&&T.pop(),F.length<T.length+1&&F.push([]);break}else if(J==="\\\\"){N.consume();var oe=void 0;N.gullet.future().text!==" "&&(oe=N.parseSizeGroup(!0)),$.push(oe?oe.value:null),F.push(mt(N)),y=[],T.push(y)}else throw new a("Expected & or \\\\ or \\cr or \\end",N.nextToken)}return N.gullet.endGroup(),N.gullet.endGroup(),{type:"array",mode:N.mode,addJot:w,arraystretch:z,body:T,cols:k,rowGaps:$,hskipBeforeAndAfter:g,hLinesBeforeRow:F,colSeparationType:W,addEqnNum:ee,leqno:lt}}function Zt(N){return N.substr(0,1)==="d"?"display":"text"}var un=function(f,m){var g,w,k=f.body.length,z=f.hLinesBeforeRow,W=0,ee=new Array(k),ue=[],Me=Math.max(m.fontMetrics().arrayRuleWidth,m.minRuleThickness),Ue=1/m.fontMetrics().ptPerEm,lt=5*Ue;if(f.colSeparationType&&f.colSeparationType==="small"){var p=m.havingStyle(de.SCRIPT).sizeMultiplier;lt=.2778*(p/m.sizeMultiplier)}var y=f.colSeparationType==="CD"?at({number:3,unit:"ex"},m):12*Ue,T=3*Ue,$=f.arraystretch*y,F=.7*$,q=.3*$,J=0;function oe(Zy){for(var Th=0;Th<Zy.length;++Th)Th>0&&(J+=.25),ue.push({pos:J,isDashed:Zy[Th]})}for(oe(z[0]),g=0;g<f.body.length;++g){var Ce=f.body[g],He=F,Ke=q;W<Ce.length&&(W=Ce.length);var st=new Array(Ce.length);for(w=0;w<Ce.length;++w){var wt=kn(Ce[w],m);Ke<wt.depth&&(Ke=wt.depth),He<wt.height&&(He=wt.height),st[w]=wt}var ot=f.rowGaps[g],$t=0;ot&&($t=at(ot,m),$t>0&&($t+=q,Ke<$t&&(Ke=$t),$t=0)),f.addJot&&(Ke+=T),st.height=He,st.depth=Ke,J+=He,st.pos=J,J+=Ke+$t,ee[g]=st,oe(z[g+1])}var jt=J/2+m.fontMetrics().axisHeight,En=f.cols||[],mn=[],Dn,Nn,ji=[];if(f.addEqnNum)for(g=0;g<k;++g){var Qr=ee[g],Ia=Qr.pos-jt,dr=Fe.makeSpan(["eqn-num"],[],m);dr.depth=Qr.depth,dr.height=Qr.height,ji.push({type:"elem",elem:dr,shift:Ia})}for(w=0,Nn=0;w<W||Nn<En.length;++w,++Nn){for(var Xi=En[Nn]||{},bd=!0;Xi.type==="separator";){if(bd||(Dn=Fe.makeSpan(["arraycolsep"],[]),Dn.style.width=Le(m.fontMetrics().doubleRuleSep),mn.push(Dn)),Xi.separator==="|"||Xi.separator===":"){var hC=Xi.separator==="|"?"solid":"dashed",Wu=Fe.makeSpan(["vertical-separator"],[],m);Wu.style.height=Le(J),Wu.style.borderRightWidth=Le(Me),Wu.style.borderRightStyle=hC,Wu.style.margin="0 "+Le(-Me/2);var Xy=J-jt;Xy&&(Wu.style.verticalAlign=Le(-Xy)),mn.push(Wu)}else throw new a("Invalid separator type: "+Xi.separator);Nn++,Xi=En[Nn]||{},bd=!1}if(!(w>=W)){var Gu=void 0;(w>0||f.hskipBeforeAndAfter)&&(Gu=S.deflt(Xi.pregap,lt),Gu!==0&&(Dn=Fe.makeSpan(["arraycolsep"],[]),Dn.style.width=Le(Gu),mn.push(Dn)));var qu=[];for(g=0;g<k;++g){var Mh=ee[g],Eh=Mh[w];if(Eh){var pC=Mh.pos-jt;Eh.depth=Mh.depth,Eh.height=Mh.height,qu.push({type:"elem",elem:Eh,shift:pC})}}qu=Fe.makeVList({positionType:"individualShift",children:qu},m),qu=Fe.makeSpan(["col-align-"+(Xi.align||"c")],[qu]),mn.push(qu),(w<W-1||f.hskipBeforeAndAfter)&&(Gu=S.deflt(Xi.postgap,lt),Gu!==0&&(Dn=Fe.makeSpan(["arraycolsep"],[]),Dn.style.width=Le(Gu),mn.push(Dn)))}}if(ee=Fe.makeSpan(["mtable"],mn),ue.length>0){for(var mC=Fe.makeLineSpan("hline",m,Me),gC=Fe.makeLineSpan("hdashline",m,Me),Yp=[{type:"elem",elem:ee,shift:0}];ue.length>0;){var Ky=ue.pop(),Yy=Ky.pos-jt;Ky.isDashed?Yp.push({type:"elem",elem:gC,shift:Yy}):Yp.push({type:"elem",elem:mC,shift:Yy})}ee=Fe.makeVList({positionType:"individualShift",children:Yp},m)}if(f.addEqnNum){var Zp=Fe.makeVList({positionType:"individualShift",children:ji},m);return Zp=Fe.makeSpan(["tag"],[Zp],m),Fe.makeFragment([ee,Zp])}else return Fe.makeSpan(["mord"],[ee],m)},Un={c:"center ",l:"left ",r:"right "},Gn=function(f,m){for(var g=[],w=new _t.MathNode("mtd",[],["mtr-glue"]),k=new _t.MathNode("mtd",[],["mml-eqn-num"]),z=0;z<f.body.length;z++){for(var W=f.body[z],ee=[],ue=0;ue<W.length;ue++)ee.push(new _t.MathNode("mtd",[Hn(W[ue],m)]));f.addEqnNum&&(ee.unshift(w),ee.push(w),f.leqno?ee.unshift(k):ee.push(k)),g.push(new _t.MathNode("mtr",ee))}var Me=new _t.MathNode("mtable",g),Ue=f.arraystretch===.5?.1:.16+f.arraystretch-1+(f.addJot?.09:0);Me.setAttribute("rowspacing",Le(Ue));var lt="",p="";if(f.cols&&f.cols.length>0){var y=f.cols,T="",$=!1,F=0,q=y.length;y[0].type==="separator"&&(lt+="top ",F=1),y[y.length-1].type==="separator"&&(lt+="bottom ",q-=1);for(var J=F;J<q;J++)y[J].type==="align"?(p+=Un[y[J].align],$&&(T+="none "),$=!0):y[J].type==="separator"&&$&&(T+=y[J].separator==="|"?"solid ":"dashed ",$=!1);Me.setAttribute("columnalign",p.trim()),/[sd]/.test(T)&&Me.setAttribute("columnlines",T.trim())}if(f.colSeparationType==="align"){for(var oe=f.cols||[],Ce="",He=1;He<oe.length;He++)Ce+=He%2?"0em ":"1em ";Me.setAttribute("columnspacing",Ce.trim())}else f.colSeparationType==="alignat"||f.colSeparationType==="gather"?Me.setAttribute("columnspacing","0em"):f.colSeparationType==="small"?Me.setAttribute("columnspacing","0.2778em"):f.colSeparationType==="CD"?Me.setAttribute("columnspacing","0.5em"):Me.setAttribute("columnspacing","1em");var Ke="",st=f.hLinesBeforeRow;lt+=st[0].length>0?"left ":"",lt+=st[st.length-1].length>0?"right ":"";for(var wt=1;wt<st.length-1;wt++)Ke+=st[wt].length===0?"none ":st[wt][0]?"dashed ":"solid ";return/[sd]/.test(Ke)&&Me.setAttribute("rowlines",Ke.trim()),lt!==""&&(Me=new _t.MathNode("menclose",[Me]),Me.setAttribute("notation",lt.trim())),f.arraystretch&&f.arraystretch<1&&(Me=new _t.MathNode("mstyle",[Me]),Me.setAttribute("scriptlevel","1")),Me},ka=function(f,m){f.envName.indexOf("ed")===-1&&St(f);var g=[],w=f.envName.indexOf("at")>-1?"alignat":"align",k=It(f.parser,{cols:g,addJot:!0,addEqnNum:f.envName==="align"||f.envName==="alignat",emptySingleRow:!0,colSeparationType:w,maxNumCols:f.envName==="split"?2:void 0,leqno:f.parser.settings.leqno},"display"),z,W=0,ee={type:"ordgroup",mode:f.mode,body:[]};if(m[0]&&m[0].type==="ordgroup"){for(var ue="",Me=0;Me<m[0].body.length;Me++){var Ue=qt(m[0].body[Me],"textord");ue+=Ue.text}z=Number(ue),W=z*2}var lt=!W;k.body.forEach(function($){for(var F=1;F<$.length;F+=2){var q=qt($[F],"styling"),J=qt(q.body[0],"ordgroup");J.body.unshift(ee)}if(lt)W<$.length&&(W=$.length);else{var oe=$.length/2;if(z<oe)throw new a("Too many math in a row: "+("expected "+z+", but got "+oe),$[0])}});for(var p=0;p<W;++p){var y="r",T=0;p%2===1?y="l":p>0&&lt&&(T=1),g[p]={type:"align",align:y,pregap:T,postgap:0}}return k.colSeparationType=lt?"align":"alignat",k};Qe({type:"array",names:["array","darray"],props:{numArgs:1},handler:function(f,m){var g=Ns(m[0]),w=g?[m[0]]:qt(m[0],"ordgroup").body,k=w.map(function(W){var ee=_l(W),ue=ee.text;if("lcr".indexOf(ue)!==-1)return{type:"align",align:ue};if(ue==="|")return{type:"separator",separator:"|"};if(ue===":")return{type:"separator",separator:":"};throw new a("Unknown column alignment: "+ue,W)}),z={cols:k,hskipBeforeAndAfter:!0,maxNumCols:k.length};return It(f.parser,z,Zt(f.envName))},htmlBuilder:un,mathmlBuilder:Gn}),Qe({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler:function(f){var m={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[f.envName.replace("*","")],g="c",w={hskipBeforeAndAfter:!1,cols:[{type:"align",align:g}]};if(f.envName.charAt(f.envName.length-1)==="*"){var k=f.parser;if(k.consumeSpaces(),k.fetch().text==="["){if(k.consume(),k.consumeSpaces(),g=k.fetch().text,"lcr".indexOf(g)===-1)throw new a("Expected l or c or r",k.nextToken);k.consume(),k.consumeSpaces(),k.expect("]"),k.consume(),w.cols=[{type:"align",align:g}]}}var z=It(f.parser,w,Zt(f.envName)),W=Math.max.apply(Math,[0].concat(z.body.map(function(ee){return ee.length})));return z.cols=new Array(W).fill({type:"align",align:g}),m?{type:"leftright",mode:f.mode,body:[z],left:m[0],right:m[1],rightColor:void 0}:z},htmlBuilder:un,mathmlBuilder:Gn}),Qe({type:"array",names:["smallmatrix"],props:{numArgs:0},handler:function(f){var m={arraystretch:.5},g=It(f.parser,m,"script");return g.colSeparationType="small",g},htmlBuilder:un,mathmlBuilder:Gn}),Qe({type:"array",names:["subarray"],props:{numArgs:1},handler:function(f,m){var g=Ns(m[0]),w=g?[m[0]]:qt(m[0],"ordgroup").body,k=w.map(function(W){var ee=_l(W),ue=ee.text;if("lc".indexOf(ue)!==-1)return{type:"align",align:ue};throw new a("Unknown column alignment: "+ue,W)});if(k.length>1)throw new a("{subarray} can contain only one column");var z={cols:k,hskipBeforeAndAfter:!1,arraystretch:.5};if(z=It(f.parser,z,"script"),z.body.length>0&&z.body[0].length>1)throw new a("{subarray} can contain only one column");return z},htmlBuilder:un,mathmlBuilder:Gn}),Qe({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler:function(f){var m={arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},g=It(f.parser,m,Zt(f.envName));return{type:"leftright",mode:f.mode,body:[g],left:f.envName.indexOf("r")>-1?".":"\\{",right:f.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:un,mathmlBuilder:Gn}),Qe({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:ka,htmlBuilder:un,mathmlBuilder:Gn}),Qe({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler:function(f){S.contains(["gather","gather*"],f.envName)&&St(f);var m={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",addEqnNum:f.envName==="gather",emptySingleRow:!0,leqno:f.parser.settings.leqno};return It(f.parser,m,"display")},htmlBuilder:un,mathmlBuilder:Gn}),Qe({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:ka,htmlBuilder:un,mathmlBuilder:Gn}),Qe({type:"array",names:["equation","equation*"],props:{numArgs:0},handler:function(f){St(f);var m={addEqnNum:f.envName==="equation",emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:f.parser.settings.leqno};return It(f.parser,m,"display")},htmlBuilder:un,mathmlBuilder:Gn}),Qe({type:"array",names:["CD"],props:{numArgs:0},handler:function(f){return St(f),id(f.parser)},htmlBuilder:un,mathmlBuilder:Gn}),Ct({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler:function(f,m){throw new a(f.funcName+" valid only within array environment")}});var ad=Ae,sd=ad;Ct({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler:function(f,m){var g=f.parser,w=f.funcName,k=m[0];if(k.type!=="ordgroup")throw new a("Invalid environment name",k);for(var z="",W=0;W<k.body.length;++W)z+=qt(k.body[W],"textord").text;if(w==="\\begin"){if(!sd.hasOwnProperty(z))throw new a("No such environment: "+z,k);var ee=sd[z],ue=g.parseArguments("\\begin{"+z+"}",ee),Me=ue.args,Ue=ue.optArgs,lt={mode:g.mode,envName:z,parser:g},p=ee.handler(lt,Me,Ue);g.expect("\\end",!1);var y=g.nextToken,T=qt(g.parseFunction(),"environment");if(T.name!==z)throw new a("Mismatch: \\begin{"+z+"} matched by \\end{"+T.name+"}",y);return p}return{type:"environment",mode:g.mode,name:z,nameGroup:k}}});var Gf=Fe.makeSpan;function qf(N,f){var m=cr(N.body,f,!0);return Gf([N.mclass],m,f)}function jf(N,f){var m,g=Rr(N.body,f);return N.mclass==="minner"?_t.newDocumentFragment(g):(N.mclass==="mord"?N.isCharacterBox?(m=g[0],m.type="mi"):m=new _t.MathNode("mi",g):(N.isCharacterBox?(m=g[0],m.type="mo"):m=new _t.MathNode("mo",g),N.mclass==="mbin"?(m.attributes.lspace="0.22em",m.attributes.rspace="0.22em"):N.mclass==="mpunct"?(m.attributes.lspace="0em",m.attributes.rspace="0.17em"):(N.mclass==="mopen"||N.mclass==="mclose")&&(m.attributes.lspace="0em",m.attributes.rspace="0em")),m)}Ct({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler:function(f,m){var g=f.parser,w=f.funcName,k=m[0];return{type:"mclass",mode:g.mode,mclass:"m"+w.substr(5),body:zn(k),isCharacterBox:S.isCharacterBox(k)}},htmlBuilder:qf,mathmlBuilder:jf});var Uu=function(f){var m=f.type==="ordgroup"&&f.body.length?f.body[0]:f;return m.type==="atom"&&(m.family==="bin"||m.family==="rel")?"m"+m.family:"mord"};Ct({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler:function(f,m){var g=f.parser;return{type:"mclass",mode:g.mode,mclass:Uu(m[0]),body:zn(m[1]),isCharacterBox:S.isCharacterBox(m[1])}}}),Ct({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler:function(f,m){var g=f.parser,w=f.funcName,k=m[1],z=m[0],W;w!=="\\stackrel"?W=Uu(k):W="mrel";var ee={type:"op",mode:k.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:w!=="\\stackrel",body:zn(k)},ue={type:"supsub",mode:z.mode,base:ee,sup:w==="\\underset"?null:z,sub:w==="\\underset"?z:null};return{type:"mclass",mode:g.mode,mclass:W,body:[ue],isCharacterBox:S.isCharacterBox(ue)}},htmlBuilder:qf,mathmlBuilder:jf});var Xf=function(f,m){var g=f.font,w=m.withFont(g);return kn(f.body,w)},Kf=function(f,m){var g=f.font,w=m.withFont(g);return Hn(f.body,w)},Yf={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};Ct({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:function(f,m){var g=f.parser,w=f.funcName,k=Ps(m[0]),z=w;return z in Yf&&(z=Yf[z]),{type:"font",mode:g.mode,font:z.slice(1),body:k}},htmlBuilder:Xf,mathmlBuilder:Kf}),Ct({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:function(f,m){var g=f.parser,w=m[0],k=S.isCharacterBox(w);return{type:"mclass",mode:g.mode,mclass:Uu(w),body:[{type:"font",mode:g.mode,font:"boldsymbol",body:w}],isCharacterBox:k}}}),Ct({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:function(f,m){var g=f.parser,w=f.funcName,k=f.breakOnTokenText,z=g.mode,W=g.parseExpression(!0,k),ee="math"+w.slice(1);return{type:"font",mode:z,font:ee,body:{type:"ordgroup",mode:g.mode,body:W}}},htmlBuilder:Xf,mathmlBuilder:Kf});var Zf=function(f,m){var g=m;return f==="display"?g=g.id>=de.SCRIPT.id?g.text():de.DISPLAY:f==="text"&&g.size===de.DISPLAY.size?g=de.TEXT:f==="script"?g=de.SCRIPT:f==="scriptscript"&&(g=de.SCRIPTSCRIPT),g},$l=function(f,m){var g=Zf(f.size,m.style),w=g.fracNum(),k=g.fracDen(),z;z=m.havingStyle(w);var W=kn(f.numer,z,m);if(f.continued){var ee=8.5/m.fontMetrics().ptPerEm,ue=3.5/m.fontMetrics().ptPerEm;W.height=W.height<ee?ee:W.height,W.depth=W.depth<ue?ue:W.depth}z=m.havingStyle(k);var Me=kn(f.denom,z,m),Ue,lt,p;f.hasBarLine?(f.barSize?(lt=at(f.barSize,m),Ue=Fe.makeLineSpan("frac-line",m,lt)):Ue=Fe.makeLineSpan("frac-line",m),lt=Ue.height,p=Ue.height):(Ue=null,lt=0,p=m.fontMetrics().defaultRuleThickness);var y,T,$;g.size===de.DISPLAY.size||f.size==="display"?(y=m.fontMetrics().num1,lt>0?T=3*p:T=7*p,$=m.fontMetrics().denom1):(lt>0?(y=m.fontMetrics().num2,T=p):(y=m.fontMetrics().num3,T=3*p),$=m.fontMetrics().denom2);var F;if(Ue){var J=m.fontMetrics().axisHeight;y-W.depth-(J+.5*lt)<T&&(y+=T-(y-W.depth-(J+.5*lt))),J-.5*lt-(Me.height-$)<T&&($+=T-(J-.5*lt-(Me.height-$)));var oe=-(J-.5*lt);F=Fe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:Me,shift:$},{type:"elem",elem:Ue,shift:oe},{type:"elem",elem:W,shift:-y}]},m)}else{var q=y-W.depth-(Me.height-$);q<T&&(y+=.5*(T-q),$+=.5*(T-q)),F=Fe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:Me,shift:$},{type:"elem",elem:W,shift:-y}]},m)}z=m.havingStyle(g),F.height*=z.sizeMultiplier/m.sizeMultiplier,F.depth*=z.sizeMultiplier/m.sizeMultiplier;var Ce;g.size===de.DISPLAY.size?Ce=m.fontMetrics().delim1:g.size===de.SCRIPTSCRIPT.size?Ce=m.havingStyle(de.SCRIPT).fontMetrics().delim2:Ce=m.fontMetrics().delim2;var He,Ke;return f.leftDelim==null?He=Qa(m,["mopen"]):He=Di.customSizedDelim(f.leftDelim,Ce,!0,m.havingStyle(g),f.mode,["mopen"]),f.continued?Ke=Fe.makeSpan([]):f.rightDelim==null?Ke=Qa(m,["mclose"]):Ke=Di.customSizedDelim(f.rightDelim,Ce,!0,m.havingStyle(g),f.mode,["mclose"]),Fe.makeSpan(["mord"].concat(z.sizingClasses(m)),[He,Fe.makeSpan(["mfrac"],[F]),Ke],m)},od=function(f,m){var g=new _t.MathNode("mfrac",[Hn(f.numer,m),Hn(f.denom,m)]);if(!f.hasBarLine)g.setAttribute("linethickness","0px");else if(f.barSize){var w=at(f.barSize,m);g.setAttribute("linethickness",Le(w))}var k=Zf(f.size,m.style);if(k.size!==m.style.size){g=new _t.MathNode("mstyle",[g]);var z=k.size===de.DISPLAY.size?"true":"false";g.setAttribute("displaystyle",z),g.setAttribute("scriptlevel","0")}if(f.leftDelim!=null||f.rightDelim!=null){var W=[];if(f.leftDelim!=null){var ee=new _t.MathNode("mo",[new _t.TextNode(f.leftDelim.replace("\\",""))]);ee.setAttribute("fence","true"),W.push(ee)}if(W.push(g),f.rightDelim!=null){var ue=new _t.MathNode("mo",[new _t.TextNode(f.rightDelim.replace("\\",""))]);ue.setAttribute("fence","true"),W.push(ue)}return Ls(W)}return g};Ct({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:function(f,m){var g=f.parser,w=f.funcName,k=m[0],z=m[1],W,ee=null,ue=null,Me="auto";switch(w){case"\\dfrac":case"\\frac":case"\\tfrac":W=!0;break;case"\\\\atopfrac":W=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":W=!1,ee="(",ue=")";break;case"\\\\bracefrac":W=!1,ee="\\{",ue="\\}";break;case"\\\\brackfrac":W=!1,ee="[",ue="]";break;default:throw new Error("Unrecognized genfrac command")}switch(w){case"\\dfrac":case"\\dbinom":Me="display";break;case"\\tfrac":case"\\tbinom":Me="text";break}return{type:"genfrac",mode:g.mode,continued:!1,numer:k,denom:z,hasBarLine:W,leftDelim:ee,rightDelim:ue,size:Me,barSize:null}},htmlBuilder:$l,mathmlBuilder:od}),Ct({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:function(f,m){var g=f.parser;f.funcName;var w=m[0],k=m[1];return{type:"genfrac",mode:g.mode,continued:!0,numer:w,denom:k,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}}),Ct({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler:function(f){var m=f.parser,g=f.funcName,w=f.token,k;switch(g){case"\\over":k="\\frac";break;case"\\choose":k="\\binom";break;case"\\atop":k="\\\\atopfrac";break;case"\\brace":k="\\\\bracefrac";break;case"\\brack":k="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:m.mode,replaceWith:k,token:w}}});var Io=["display","text","script","scriptscript"],Jf=function(f){var m=null;return f.length>0&&(m=f,m=m==="."?null:m),m};Ct({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler:function(f,m){var g=f.parser,w=m[4],k=m[5],z=Ps(m[0]),W=z.type==="atom"&&z.family==="open"?Jf(z.text):null,ee=Ps(m[1]),ue=ee.type==="atom"&&ee.family==="close"?Jf(ee.text):null,Me=qt(m[2],"size"),Ue,lt=null;Me.isBlank?Ue=!0:(lt=Me.value,Ue=lt.number>0);var p="auto",y=m[3];if(y.type==="ordgroup"){if(y.body.length>0){var T=qt(y.body[0],"textord");p=Io[Number(T.text)]}}else y=qt(y,"textord"),p=Io[Number(y.text)];return{type:"genfrac",mode:g.mode,numer:w,denom:k,continued:!1,hasBarLine:Ue,barSize:lt,leftDelim:W,rightDelim:ue,size:p}},htmlBuilder:$l,mathmlBuilder:od}),Ct({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler:function(f,m){var g=f.parser;f.funcName;var w=f.token;return{type:"infix",mode:g.mode,replaceWith:"\\\\abovefrac",size:qt(m[0],"size").value,token:w}}}),Ct({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:function(f,m){var g=f.parser;f.funcName;var w=m[0],k=_(qt(m[1],"infix").size),z=m[2],W=k.number>0;return{type:"genfrac",mode:g.mode,numer:w,denom:z,continued:!1,hasBarLine:W,barSize:k,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:$l,mathmlBuilder:od});var Qf=function(f,m){var g=m.style,w,k;f.type==="supsub"?(w=f.sup?kn(f.sup,m.havingStyle(g.sup()),m):kn(f.sub,m.havingStyle(g.sub()),m),k=qt(f.base,"horizBrace")):k=qt(f,"horizBrace");var z=kn(k.base,m.havingBaseStyle(de.DISPLAY)),W=Tn.svgSpan(k,m),ee;if(k.isOver?(ee=Fe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:z},{type:"kern",size:.1},{type:"elem",elem:W}]},m),ee.children[0].children[0].children[1].classes.push("svg-align")):(ee=Fe.makeVList({positionType:"bottom",positionData:z.depth+.1+W.height,children:[{type:"elem",elem:W},{type:"kern",size:.1},{type:"elem",elem:z}]},m),ee.children[0].children[0].children[0].classes.push("svg-align")),w){var ue=Fe.makeSpan(["mord",k.isOver?"mover":"munder"],[ee],m);k.isOver?ee=Fe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:ue},{type:"kern",size:.2},{type:"elem",elem:w}]},m):ee=Fe.makeVList({positionType:"bottom",positionData:ue.depth+.2+w.height+w.depth,children:[{type:"elem",elem:w},{type:"kern",size:.2},{type:"elem",elem:ue}]},m)}return Fe.makeSpan(["mord",k.isOver?"mover":"munder"],[ee],m)},eh=function(f,m){var g=Tn.mathMLnode(f.label);return new _t.MathNode(f.isOver?"mover":"munder",[Hn(f.base,m),g])};Ct({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler:function(f,m){var g=f.parser,w=f.funcName;return{type:"horizBrace",mode:g.mode,label:w,isOver:/^\\over/.test(w),base:m[0]}},htmlBuilder:Qf,mathmlBuilder:eh}),Ct({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:function(f,m){var g=f.parser,w=m[1],k=qt(m[0],"url").url;return g.settings.isTrusted({command:"\\href",url:k})?{type:"href",mode:g.mode,href:k,body:zn(w)}:g.formatUnsupportedCmd("\\href")},htmlBuilder:function(f,m){var g=cr(f.body,m,!1);return Fe.makeAnchor(f.href,[],g,m)},mathmlBuilder:function(f,m){var g=qi(f.body,m);return g instanceof $r||(g=new $r("mrow",[g])),g.setAttribute("href",f.href),g}}),Ct({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:function(f,m){var g=f.parser,w=qt(m[0],"url").url;if(!g.settings.isTrusted({command:"\\url",url:w}))return g.formatUnsupportedCmd("\\url");for(var k=[],z=0;z<w.length;z++){var W=w[z];W==="~"&&(W="\\textasciitilde"),k.push({type:"textord",mode:"text",text:W})}var ee={type:"text",mode:g.mode,font:"\\texttt",body:k};return{type:"href",mode:g.mode,href:w,body:zn(ee)}}}),Ct({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler:function(f,m){var g=f.parser;return{type:"hbox",mode:g.mode,body:zn(m[0])}},htmlBuilder:function(f,m){var g=cr(f.body,m,!1);return Fe.makeFragment(g)},mathmlBuilder:function(f,m){return new _t.MathNode("mrow",Rr(f.body,m))}}),Ct({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:function(f,m){var g=f.parser,w=f.funcName;f.token;var k=qt(m[0],"raw").string,z=m[1];g.settings.strict&&g.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");var W,ee={};switch(w){case"\\htmlClass":ee.class=k,W={command:"\\htmlClass",class:k};break;case"\\htmlId":ee.id=k,W={command:"\\htmlId",id:k};break;case"\\htmlStyle":ee.style=k,W={command:"\\htmlStyle",style:k};break;case"\\htmlData":{for(var ue=k.split(","),Me=0;Me<ue.length;Me++){var Ue=ue[Me].split("=");if(Ue.length!==2)throw new a("Error parsing key-value for \\htmlData");ee["data-"+Ue[0].trim()]=Ue[1].trim()}W={command:"\\htmlData",attributes:ee};break}default:throw new Error("Unrecognized html command")}return g.settings.isTrusted(W)?{type:"html",mode:g.mode,attributes:ee,body:zn(z)}:g.formatUnsupportedCmd(w)},htmlBuilder:function(f,m){var g=cr(f.body,m,!1),w=["enclosing"];f.attributes.class&&w.push.apply(w,f.attributes.class.trim().split(/\s+/));var k=Fe.makeSpan(w,g,m);for(var z in f.attributes)z!=="class"&&f.attributes.hasOwnProperty(z)&&k.setAttribute(z,f.attributes[z]);return k},mathmlBuilder:function(f,m){return qi(f.body,m)}}),Ct({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:function(f,m){var g=f.parser;return{type:"htmlmathml",mode:g.mode,html:zn(m[0]),mathml:zn(m[1])}},htmlBuilder:function(f,m){var g=cr(f.html,m,!1);return Fe.makeFragment(g)},mathmlBuilder:function(f,m){return qi(f.mathml,m)}});var Vu=function(f){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(f))return{number:+f,unit:"bp"};var m=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(f);if(!m)throw new a("Invalid size: '"+f+"' in \\includegraphics");var g={number:+(m[1]+m[2]),unit:m[3]};if(!Ie(g))throw new a("Invalid unit: '"+g.unit+"' in \\includegraphics.");return g};Ct({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:function(f,m,g){var w=f.parser,k={number:0,unit:"em"},z={number:.9,unit:"em"},W={number:0,unit:"em"},ee="";if(g[0])for(var ue=qt(g[0],"raw").string,Me=ue.split(","),Ue=0;Ue<Me.length;Ue++){var lt=Me[Ue].split("=");if(lt.length===2){var p=lt[1].trim();switch(lt[0].trim()){case"alt":ee=p;break;case"width":k=Vu(p);break;case"height":z=Vu(p);break;case"totalheight":W=Vu(p);break;default:throw new a("Invalid key: '"+lt[0]+"' in \\includegraphics.")}}}var y=qt(m[0],"url").url;return ee===""&&(ee=y,ee=ee.replace(/^.*[\\/]/,""),ee=ee.substring(0,ee.lastIndexOf("."))),w.settings.isTrusted({command:"\\includegraphics",url:y})?{type:"includegraphics",mode:w.mode,alt:ee,width:k,height:z,totalheight:W,src:y}:w.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:function(f,m){var g=at(f.height,m),w=0;f.totalheight.number>0&&(w=at(f.totalheight,m)-g);var k=0;f.width.number>0&&(k=at(f.width,m));var z={height:Le(g+w)};k>0&&(z.width=Le(k)),w>0&&(z.verticalAlign=Le(-w));var W=new Re(f.src,f.alt,z);return W.height=g,W.depth=w,W},mathmlBuilder:function(f,m){var g=new _t.MathNode("mglyph",[]);g.setAttribute("alt",f.alt);var w=at(f.height,m),k=0;if(f.totalheight.number>0&&(k=at(f.totalheight,m)-w,g.setAttribute("valign",Le(-k))),g.setAttribute("height",Le(w+k)),f.width.number>0){var z=at(f.width,m);g.setAttribute("width",Le(z))}return g.setAttribute("src",f.src),g}}),Ct({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler:function(f,m){var g=f.parser,w=f.funcName,k=qt(m[0],"size");if(g.settings.strict){var z=w[1]==="m",W=k.value.unit==="mu";z?(W||g.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+w+" supports only mu units, "+("not "+k.value.unit+" units")),g.mode!=="math"&&g.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+w+" works only in math mode")):W&&g.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+w+" doesn't support mu units")}return{type:"kern",mode:g.mode,dimension:k.value}},htmlBuilder:function(f,m){return Fe.makeGlue(f.dimension,m)},mathmlBuilder:function(f,m){var g=at(f.dimension,m);return new _t.SpaceNode(g)}}),Ct({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:function(f,m){var g=f.parser,w=f.funcName,k=m[0];return{type:"lap",mode:g.mode,alignment:w.slice(5),body:k}},htmlBuilder:function(f,m){var g;f.alignment==="clap"?(g=Fe.makeSpan([],[kn(f.body,m)]),g=Fe.makeSpan(["inner"],[g],m)):g=Fe.makeSpan(["inner"],[kn(f.body,m)]);var w=Fe.makeSpan(["fix"],[]),k=Fe.makeSpan([f.alignment],[g,w],m),z=Fe.makeSpan(["strut"]);return z.style.height=Le(k.height+k.depth),k.depth&&(z.style.verticalAlign=Le(-k.depth)),k.children.unshift(z),k=Fe.makeSpan(["thinbox"],[k],m),Fe.makeSpan(["mord","vbox"],[k],m)},mathmlBuilder:function(f,m){var g=new _t.MathNode("mpadded",[Hn(f.body,m)]);if(f.alignment!=="rlap"){var w=f.alignment==="llap"?"-1":"-0.5";g.setAttribute("lspace",w+"width")}return g.setAttribute("width","0px"),g}}),Ct({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler:function(f,m){var g=f.funcName,w=f.parser,k=w.mode;w.switchMode("math");var z=g==="\\("?"\\)":"$",W=w.parseExpression(!1,z);return w.expect(z),w.switchMode(k),{type:"styling",mode:w.mode,style:"text",body:W}}}),Ct({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler:function(f,m){throw new a("Mismatched "+f.funcName)}});var th=function(f,m){switch(m.style.size){case de.DISPLAY.size:return f.display;case de.TEXT.size:return f.text;case de.SCRIPT.size:return f.script;case de.SCRIPTSCRIPT.size:return f.scriptscript;default:return f.text}};Ct({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:function(f,m){var g=f.parser;return{type:"mathchoice",mode:g.mode,display:zn(m[0]),text:zn(m[1]),script:zn(m[2]),scriptscript:zn(m[3])}},htmlBuilder:function(f,m){var g=th(f,m),w=cr(g,m,!1);return Fe.makeFragment(w)},mathmlBuilder:function(f,m){var g=th(f,m);return qi(g,m)}});var ld=function(f,m,g,w,k,z,W){f=Fe.makeSpan([],[f]);var ee=g&&S.isCharacterBox(g),ue,Me;if(m){var Ue=kn(m,w.havingStyle(k.sup()),w);Me={elem:Ue,kern:Math.max(w.fontMetrics().bigOpSpacing1,w.fontMetrics().bigOpSpacing3-Ue.depth)}}if(g){var lt=kn(g,w.havingStyle(k.sub()),w);ue={elem:lt,kern:Math.max(w.fontMetrics().bigOpSpacing2,w.fontMetrics().bigOpSpacing4-lt.height)}}var p;if(Me&&ue){var y=w.fontMetrics().bigOpSpacing5+ue.elem.height+ue.elem.depth+ue.kern+f.depth+W;p=Fe.makeVList({positionType:"bottom",positionData:y,children:[{type:"kern",size:w.fontMetrics().bigOpSpacing5},{type:"elem",elem:ue.elem,marginLeft:Le(-z)},{type:"kern",size:ue.kern},{type:"elem",elem:f},{type:"kern",size:Me.kern},{type:"elem",elem:Me.elem,marginLeft:Le(z)},{type:"kern",size:w.fontMetrics().bigOpSpacing5}]},w)}else if(ue){var T=f.height-W;p=Fe.makeVList({positionType:"top",positionData:T,children:[{type:"kern",size:w.fontMetrics().bigOpSpacing5},{type:"elem",elem:ue.elem,marginLeft:Le(-z)},{type:"kern",size:ue.kern},{type:"elem",elem:f}]},w)}else if(Me){var $=f.depth+W;p=Fe.makeVList({positionType:"bottom",positionData:$,children:[{type:"elem",elem:f},{type:"kern",size:Me.kern},{type:"elem",elem:Me.elem,marginLeft:Le(z)},{type:"kern",size:w.fontMetrics().bigOpSpacing5}]},w)}else return f;var F=[p];if(ue&&z!==0&&!ee){var q=Fe.makeSpan(["mspace"],[],w);q.style.marginRight=Le(z),F.unshift(q)}return Fe.makeSpan(["mop","op-limits"],F,w)},nh=["\\smallint"],$o=function(f,m){var g,w,k=!1,z;f.type==="supsub"?(g=f.sup,w=f.sub,z=qt(f.base,"op"),k=!0):z=qt(f,"op");var W=m.style,ee=!1;W.size===de.DISPLAY.size&&z.symbol&&!S.contains(nh,z.name)&&(ee=!0);var ue;if(z.symbol){var Me=ee?"Size2-Regular":"Size1-Regular",Ue="";if((z.name==="\\oiint"||z.name==="\\oiiint")&&(Ue=z.name.substr(1),z.name=Ue==="oiint"?"\\iint":"\\iiint"),ue=Fe.makeSymbol(z.name,Me,"math",m,["mop","op-symbol",ee?"large-op":"small-op"]),Ue.length>0){var lt=ue.italic,p=Fe.staticSvg(Ue+"Size"+(ee?"2":"1"),m);ue=Fe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:ue,shift:0},{type:"elem",elem:p,shift:ee?.08:0}]},m),z.name="\\"+Ue,ue.classes.unshift("mop"),ue.italic=lt}}else if(z.body){var y=cr(z.body,m,!0);y.length===1&&y[0]instanceof pt?(ue=y[0],ue.classes[0]="mop"):ue=Fe.makeSpan(["mop"],y,m)}else{for(var T=[],$=1;$<z.name.length;$++)T.push(Fe.mathsym(z.name[$],z.mode,m));ue=Fe.makeSpan(["mop"],T,m)}var F=0,q=0;return(ue instanceof pt||z.name==="\\oiint"||z.name==="\\oiiint")&&!z.suppressBaseShift&&(F=(ue.height-ue.depth)/2-m.fontMetrics().axisHeight,q=ue.italic),k?ld(ue,g,w,m,W,q,F):(F&&(ue.style.position="relative",ue.style.top=Le(F)),ue)},Pl=function(f,m){var g;if(f.symbol)g=new $r("mo",[Pr(f.name,f.mode)]),S.contains(nh,f.name)&&g.setAttribute("largeop","false");else if(f.body)g=new $r("mo",Rr(f.body,m));else{g=new $r("mi",[new es(f.name.slice(1))]);var w=new $r("mo",[Pr("⁡","text")]);f.parentIsSupSub?g=new $r("mrow",[g,w]):g=Cu([g,w])}return g},Rp={"∏":"\\prod","∐":"\\coprod","∑":"\\sum","⋀":"\\bigwedge","⋁":"\\bigvee","⋂":"\\bigcap","⋃":"\\bigcup","⨀":"\\bigodot","⨁":"\\bigoplus","⨂":"\\bigotimes","⨄":"\\biguplus","⨆":"\\bigsqcup"};Ct({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","∏","∐","∑","⋀","⋁","⋂","⋃","⨀","⨁","⨂","⨄","⨆"],props:{numArgs:0},handler:function(f,m){var g=f.parser,w=f.funcName,k=w;return k.length===1&&(k=Rp[k]),{type:"op",mode:g.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:k}},htmlBuilder:$o,mathmlBuilder:Pl}),Ct({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:function(f,m){var g=f.parser,w=m[0];return{type:"op",mode:g.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:zn(w)}},htmlBuilder:$o,mathmlBuilder:Pl});var Dp={"∫":"\\int","∬":"\\iint","∭":"\\iiint","∮":"\\oint","∯":"\\oiint","∰":"\\oiiint"};Ct({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler:function(f){var m=f.parser,g=f.funcName;return{type:"op",mode:m.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:g}},htmlBuilder:$o,mathmlBuilder:Pl}),Ct({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler:function(f){var m=f.parser,g=f.funcName;return{type:"op",mode:m.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:g}},htmlBuilder:$o,mathmlBuilder:Pl}),Ct({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","∫","∬","∭","∮","∯","∰"],props:{numArgs:0},handler:function(f){var m=f.parser,g=f.funcName,w=g;return w.length===1&&(w=Dp[w]),{type:"op",mode:m.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:w}},htmlBuilder:$o,mathmlBuilder:Pl});var rh={};function te(N,f){rh[N]=f}var ih=function(f,m){var g,w,k=!1,z;f.type==="supsub"?(g=f.sup,w=f.sub,z=qt(f.base,"operatorname"),k=!0):z=qt(f,"operatorname");var W;if(z.body.length>0){for(var ee=z.body.map(function(lt){var p=lt.text;return typeof p=="string"?{type:"textord",mode:lt.mode,text:p}:lt}),ue=cr(ee,m.withFont("mathrm"),!0),Me=0;Me<ue.length;Me++){var Ue=ue[Me];Ue instanceof pt&&(Ue.text=Ue.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}W=Fe.makeSpan(["mop"],ue,m)}else W=Fe.makeSpan(["mop"],[],m);return k?ld(W,g,w,m,m.style,0,0):W},Hu=function(f,m){for(var g=Rr(f.body,m.withFont("mathrm")),w=!0,k=0;k<g.length;k++){var z=g[k];if(!(z instanceof _t.SpaceNode))if(z instanceof _t.MathNode)switch(z.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":{var W=z.children[0];z.children.length===1&&W instanceof _t.TextNode?W.text=W.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):w=!1;break}default:w=!1}else w=!1}if(w){var ee=g.map(function(Ue){return Ue.toText()}).join("");g=[new _t.TextNode(ee)]}var ue=new _t.MathNode("mi",g);ue.setAttribute("mathvariant","normal");var Me=new _t.MathNode("mo",[Pr("⁡","text")]);return f.parentIsSupSub?new _t.MathNode("mrow",[ue,Me]):_t.newDocumentFragment([ue,Me])};Ct({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:function(f,m){var g=f.parser,w=f.funcName,k=m[0];return{type:"operatorname",mode:g.mode,body:zn(k),alwaysHandleSupSub:w==="\\operatornamewithlimits",limits:!1,parentIsSupSub:!1}},htmlBuilder:ih,mathmlBuilder:Hu}),te("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@"),pn({type:"ordgroup",htmlBuilder:function(f,m){return f.semisimple?Fe.makeFragment(cr(f.body,m,!1)):Fe.makeSpan(["mord"],cr(f.body,m,!0),m)},mathmlBuilder:function(f,m){return qi(f.body,m,!0)}}),Ct({type:"overline",names:["\\overline"],props:{numArgs:1},handler:function(f,m){var g=f.parser,w=m[0];return{type:"overline",mode:g.mode,body:w}},htmlBuilder:function(f,m){var g=kn(f.body,m.havingCrampedStyle()),w=Fe.makeLineSpan("overline-line",m),k=m.fontMetrics().defaultRuleThickness,z=Fe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:g},{type:"kern",size:3*k},{type:"elem",elem:w},{type:"kern",size:k}]},m);return Fe.makeSpan(["mord","overline"],[z],m)},mathmlBuilder:function(f,m){var g=new _t.MathNode("mo",[new _t.TextNode("‾")]);g.setAttribute("stretchy","true");var w=new _t.MathNode("mover",[Hn(f.body,m),g]);return w.setAttribute("accent","true"),w}}),Ct({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:function(f,m){var g=f.parser,w=m[0];return{type:"phantom",mode:g.mode,body:zn(w)}},htmlBuilder:function(f,m){var g=cr(f.body,m.withPhantom(),!1);return Fe.makeFragment(g)},mathmlBuilder:function(f,m){var g=Rr(f.body,m);return new _t.MathNode("mphantom",g)}}),Ct({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:function(f,m){var g=f.parser,w=m[0];return{type:"hphantom",mode:g.mode,body:w}},htmlBuilder:function(f,m){var g=Fe.makeSpan([],[kn(f.body,m.withPhantom())]);if(g.height=0,g.depth=0,g.children)for(var w=0;w<g.children.length;w++)g.children[w].height=0,g.children[w].depth=0;return g=Fe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:g}]},m),Fe.makeSpan(["mord"],[g],m)},mathmlBuilder:function(f,m){var g=Rr(zn(f.body),m),w=new _t.MathNode("mphantom",g),k=new _t.MathNode("mpadded",[w]);return k.setAttribute("height","0px"),k.setAttribute("depth","0px"),k}}),Ct({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:function(f,m){var g=f.parser,w=m[0];return{type:"vphantom",mode:g.mode,body:w}},htmlBuilder:function(f,m){var g=Fe.makeSpan(["inner"],[kn(f.body,m.withPhantom())]),w=Fe.makeSpan(["fix"],[]);return Fe.makeSpan(["mord","rlap"],[g,w],m)},mathmlBuilder:function(f,m){var g=Rr(zn(f.body),m),w=new _t.MathNode("mphantom",g),k=new _t.MathNode("mpadded",[w]);return k.setAttribute("width","0px"),k}}),Ct({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler:function(f,m){var g=f.parser,w=qt(m[0],"size").value,k=m[1];return{type:"raisebox",mode:g.mode,dy:w,body:k}},htmlBuilder:function(f,m){var g=kn(f.body,m),w=at(f.dy,m);return Fe.makeVList({positionType:"shift",positionData:-w,children:[{type:"elem",elem:g}]},m)},mathmlBuilder:function(f,m){var g=new _t.MathNode("mpadded",[Hn(f.body,m)]),w=f.dy.number+f.dy.unit;return g.setAttribute("voffset",w),g}}),Ct({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,argTypes:["size","size","size"]},handler:function(f,m,g){var w=f.parser,k=g[0],z=qt(m[0],"size"),W=qt(m[1],"size");return{type:"rule",mode:w.mode,shift:k&&qt(k,"size").value,width:z.value,height:W.value}},htmlBuilder:function(f,m){var g=Fe.makeSpan(["mord","rule"],[],m),w=at(f.width,m),k=at(f.height,m),z=f.shift?at(f.shift,m):0;return g.style.borderRightWidth=Le(w),g.style.borderTopWidth=Le(k),g.style.bottom=Le(z),g.width=w,g.height=k+z,g.depth=-z,g.maxFontSize=k*1.125*m.sizeMultiplier,g},mathmlBuilder:function(f,m){var g=at(f.width,m),w=at(f.height,m),k=f.shift?at(f.shift,m):0,z=m.color&&m.getColor()||"black",W=new _t.MathNode("mspace");W.setAttribute("mathbackground",z),W.setAttribute("width",Le(g)),W.setAttribute("height",Le(w));var ee=new _t.MathNode("mpadded",[W]);return k>=0?ee.setAttribute("height",Le(k)):(ee.setAttribute("height",Le(k)),ee.setAttribute("depth",Le(-k))),ee.setAttribute("voffset",Le(k)),ee}});function ah(N,f,m){for(var g=cr(N,f,!1),w=f.sizeMultiplier/m.sizeMultiplier,k=0;k<g.length;k++){var z=g[k].classes.indexOf("sizing");z<0?Array.prototype.push.apply(g[k].classes,f.sizingClasses(m)):g[k].classes[z+1]==="reset-size"+f.size&&(g[k].classes[z+1]="reset-size"+m.size),g[k].height*=w,g[k].depth*=w}return Fe.makeFragment(g)}var sh=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],Lp=function(f,m){var g=m.havingSize(f.size);return ah(f.body,g,m)};Ct({type:"sizing",names:sh,props:{numArgs:0,allowedInText:!0},handler:function(f,m){var g=f.breakOnTokenText,w=f.funcName,k=f.parser,z=k.parseExpression(!1,g);return{type:"sizing",mode:k.mode,size:sh.indexOf(w)+1,body:z}},htmlBuilder:Lp,mathmlBuilder:function(f,m){var g=m.havingSize(f.size),w=Rr(f.body,g),k=new _t.MathNode("mstyle",w);return k.setAttribute("mathsize",Le(g.sizeMultiplier)),k}}),Ct({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:function(f,m,g){var w=f.parser,k=!1,z=!1,W=g[0]&&qt(g[0],"ordgroup");if(W)for(var ee="",ue=0;ue<W.body.length;++ue){var Me=W.body[ue];if(ee=Me.text,ee==="t")k=!0;else if(ee==="b")z=!0;else{k=!1,z=!1;break}}else k=!0,z=!0;var Ue=m[0];return{type:"smash",mode:w.mode,body:Ue,smashHeight:k,smashDepth:z}},htmlBuilder:function(f,m){var g=Fe.makeSpan([],[kn(f.body,m)]);if(!f.smashHeight&&!f.smashDepth)return g;if(f.smashHeight&&(g.height=0,g.children))for(var w=0;w<g.children.length;w++)g.children[w].height=0;if(f.smashDepth&&(g.depth=0,g.children))for(var k=0;k<g.children.length;k++)g.children[k].depth=0;var z=Fe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:g}]},m);return Fe.makeSpan(["mord"],[z],m)},mathmlBuilder:function(f,m){var g=new _t.MathNode("mpadded",[Hn(f.body,m)]);return f.smashHeight&&g.setAttribute("height","0px"),f.smashDepth&&g.setAttribute("depth","0px"),g}}),Ct({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler:function(f,m,g){var w=f.parser,k=g[0],z=m[0];return{type:"sqrt",mode:w.mode,body:z,index:k}},htmlBuilder:function(f,m){var g=kn(f.body,m.havingCrampedStyle());g.height===0&&(g.height=m.fontMetrics().xHeight),g=Fe.wrapFragment(g,m);var w=m.fontMetrics(),k=w.defaultRuleThickness,z=k;m.style.id<de.TEXT.id&&(z=m.fontMetrics().xHeight);var W=k+z/4,ee=g.height+g.depth+W+k,ue=Di.sqrtImage(ee,m),Me=ue.span,Ue=ue.ruleWidth,lt=ue.advanceWidth,p=Me.height-Ue;p>g.height+g.depth+W&&(W=(W+p-g.height-g.depth)/2);var y=Me.height-g.height-W-Ue;g.style.paddingLeft=Le(lt);var T=Fe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:g,wrapperClasses:["svg-align"]},{type:"kern",size:-(g.height+y)},{type:"elem",elem:Me},{type:"kern",size:Ue}]},m);if(f.index){var $=m.havingStyle(de.SCRIPTSCRIPT),F=kn(f.index,$,m),q=.6*(T.height-T.depth),J=Fe.makeVList({positionType:"shift",positionData:-q,children:[{type:"elem",elem:F}]},m),oe=Fe.makeSpan(["root"],[J]);return Fe.makeSpan(["mord","sqrt"],[oe,T],m)}else return Fe.makeSpan(["mord","sqrt"],[T],m)},mathmlBuilder:function(f,m){var g=f.body,w=f.index;return w?new _t.MathNode("mroot",[Hn(g,m),Hn(w,m)]):new _t.MathNode("msqrt",[Hn(g,m)])}});var oh={display:de.DISPLAY,text:de.TEXT,script:de.SCRIPT,scriptscript:de.SCRIPTSCRIPT};Ct({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler:function(f,m){var g=f.breakOnTokenText,w=f.funcName,k=f.parser,z=k.parseExpression(!0,g),W=w.slice(1,w.length-5);return{type:"styling",mode:k.mode,style:W,body:z}},htmlBuilder:function(f,m){var g=oh[f.style],w=m.havingStyle(g).withFont("");return ah(f.body,w,m)},mathmlBuilder:function(f,m){var g=oh[f.style],w=m.havingStyle(g),k=Rr(f.body,w),z=new _t.MathNode("mstyle",k),W={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]},ee=W[f.style];return z.setAttribute("scriptlevel",ee[0]),z.setAttribute("displaystyle",ee[1]),z}});var zp=function(f,m){var g=f.base;if(g)if(g.type==="op"){var w=g.limits&&(m.style.size===de.DISPLAY.size||g.alwaysHandleSupSub);return w?$o:null}else if(g.type==="operatorname"){var k=g.alwaysHandleSupSub&&(m.style.size===de.DISPLAY.size||g.limits);return k?ih:null}else{if(g.type==="accent")return S.isCharacterBox(g.base)?fa:null;if(g.type==="horizBrace"){var z=!f.sub;return z===g.isOver?Qf:null}else return null}else return null};pn({type:"supsub",htmlBuilder:function(f,m){var g=zp(f,m);if(g)return g(f,m);var w=f.base,k=f.sup,z=f.sub,W=kn(w,m),ee,ue,Me=m.fontMetrics(),Ue=0,lt=0,p=w&&S.isCharacterBox(w);if(k){var y=m.havingStyle(m.style.sup());ee=kn(k,y,m),p||(Ue=W.height-y.fontMetrics().supDrop*y.sizeMultiplier/m.sizeMultiplier)}if(z){var T=m.havingStyle(m.style.sub());ue=kn(z,T,m),p||(lt=W.depth+T.fontMetrics().subDrop*T.sizeMultiplier/m.sizeMultiplier)}var $;m.style===de.DISPLAY?$=Me.sup1:m.style.cramped?$=Me.sup3:$=Me.sup2;var F=m.sizeMultiplier,q=Le(.5/Me.ptPerEm/F),J=null;if(ue){var oe=f.base&&f.base.type==="op"&&f.base.name&&(f.base.name==="\\oiint"||f.base.name==="\\oiiint");(W instanceof pt||oe)&&(J=Le(-W.italic))}var Ce;if(ee&&ue){Ue=Math.max(Ue,$,ee.depth+.25*Me.xHeight),lt=Math.max(lt,Me.sub2);var He=Me.defaultRuleThickness,Ke=4*He;if(Ue-ee.depth-(ue.height-lt)<Ke){lt=Ke-(Ue-ee.depth)+ue.height;var st=.8*Me.xHeight-(Ue-ee.depth);st>0&&(Ue+=st,lt-=st)}var wt=[{type:"elem",elem:ue,shift:lt,marginRight:q,marginLeft:J},{type:"elem",elem:ee,shift:-Ue,marginRight:q}];Ce=Fe.makeVList({positionType:"individualShift",children:wt},m)}else if(ue){lt=Math.max(lt,Me.sub1,ue.height-.8*Me.xHeight);var ot=[{type:"elem",elem:ue,marginLeft:J,marginRight:q}];Ce=Fe.makeVList({positionType:"shift",positionData:lt,children:ot},m)}else if(ee)Ue=Math.max(Ue,$,ee.depth+.25*Me.xHeight),Ce=Fe.makeVList({positionType:"shift",positionData:-Ue,children:[{type:"elem",elem:ee,marginRight:q}]},m);else throw new Error("supsub must have either sup or sub.");var $t=Rs(W,"right")||"mord";return Fe.makeSpan([$t],[W,Fe.makeSpan(["msupsub"],[Ce])],m)},mathmlBuilder:function(f,m){var g=!1,w,k;f.base&&f.base.type==="horizBrace"&&(k=!!f.sup,k===f.base.isOver&&(g=!0,w=f.base.isOver)),f.base&&(f.base.type==="op"||f.base.type==="operatorname")&&(f.base.parentIsSupSub=!0);var z=[Hn(f.base,m)];f.sub&&z.push(Hn(f.sub,m)),f.sup&&z.push(Hn(f.sup,m));var W;if(g)W=w?"mover":"munder";else if(f.sub)if(f.sup){var Me=f.base;Me&&Me.type==="op"&&Me.limits&&m.style===de.DISPLAY||Me&&Me.type==="operatorname"&&Me.alwaysHandleSupSub&&(m.style===de.DISPLAY||Me.limits)?W="munderover":W="msubsup"}else{var ue=f.base;ue&&ue.type==="op"&&ue.limits&&(m.style===de.DISPLAY||ue.alwaysHandleSupSub)||ue&&ue.type==="operatorname"&&ue.alwaysHandleSupSub&&(ue.limits||m.style===de.DISPLAY)?W="munder":W="msub"}else{var ee=f.base;ee&&ee.type==="op"&&ee.limits&&(m.style===de.DISPLAY||ee.alwaysHandleSupSub)||ee&&ee.type==="operatorname"&&ee.alwaysHandleSupSub&&(ee.limits||m.style===de.DISPLAY)?W="mover":W="msup"}return new _t.MathNode(W,z)}}),pn({type:"atom",htmlBuilder:function(f,m){return Fe.mathsym(f.text,f.mode,m,["m"+f.family])},mathmlBuilder:function(f,m){var g=new _t.MathNode("mo",[Pr(f.text,f.mode)]);if(f.family==="bin"){var w=zs(f,m);w==="bold-italic"&&g.setAttribute("mathvariant",w)}else f.family==="punct"?g.setAttribute("separator","true"):(f.family==="open"||f.family==="close")&&g.setAttribute("stretchy","false");return g}});var lh={mi:"italic",mn:"normal",mtext:"normal"};pn({type:"mathord",htmlBuilder:function(f,m){return Fe.makeOrd(f,m,"mathord")},mathmlBuilder:function(f,m){var g=new _t.MathNode("mi",[Pr(f.text,f.mode,m)]),w=zs(f,m)||"italic";return w!==lh[g.type]&&g.setAttribute("mathvariant",w),g}}),pn({type:"textord",htmlBuilder:function(f,m){return Fe.makeOrd(f,m,"textord")},mathmlBuilder:function(f,m){var g=Pr(f.text,f.mode,m),w=zs(f,m)||"normal",k;return f.mode==="text"?k=new _t.MathNode("mtext",[g]):/[0-9]/.test(f.text)?k=new _t.MathNode("mn",[g]):f.text==="\\prime"?k=new _t.MathNode("mo",[g]):k=new _t.MathNode("mi",[g]),w!==lh[k.type]&&k.setAttribute("mathvariant",w),k}});var ud={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},cd={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};pn({type:"spacing",htmlBuilder:function(f,m){if(cd.hasOwnProperty(f.text)){var g=cd[f.text].className||"";if(f.mode==="text"){var w=Fe.makeOrd(f,m,"textord");return w.classes.push(g),w}else return Fe.makeSpan(["mspace",g],[Fe.mathsym(f.text,f.mode,m)],m)}else{if(ud.hasOwnProperty(f.text))return Fe.makeSpan(["mspace",ud[f.text]],[],m);throw new a('Unknown type of space "'+f.text+'"')}},mathmlBuilder:function(f,m){var g;if(cd.hasOwnProperty(f.text))g=new _t.MathNode("mtext",[new _t.TextNode(" ")]);else{if(ud.hasOwnProperty(f.text))return new _t.MathNode("mspace");throw new a('Unknown type of space "'+f.text+'"')}return g}});var dd=function(){var f=new _t.MathNode("mtd",[]);return f.setAttribute("width","50%"),f};pn({type:"tag",mathmlBuilder:function(f,m){var g=new _t.MathNode("mtable",[new _t.MathNode("mtr",[dd(),new _t.MathNode("mtd",[qi(f.body,m)]),dd(),new _t.MathNode("mtd",[qi(f.tag,m)])])]);return g.setAttribute("width","100%"),g}});var uh={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},ch={"\\textbf":"textbf","\\textmd":"textmd"},Op={"\\textit":"textit","\\textup":"textup"},fd=function(f,m){var g=f.font;return g?uh[g]?m.withTextFontFamily(uh[g]):ch[g]?m.withTextFontWeight(ch[g]):m.withTextFontShape(Op[g]):m};Ct({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler:function(f,m){var g=f.parser,w=f.funcName,k=m[0];return{type:"text",mode:g.mode,body:zn(k),font:w}},htmlBuilder:function(f,m){var g=fd(f,m),w=cr(f.body,g,!0);return Fe.makeSpan(["mord","text"],w,g)},mathmlBuilder:function(f,m){var g=fd(f,m);return qi(f.body,g)}}),Ct({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler:function(f,m){var g=f.parser;return{type:"underline",mode:g.mode,body:m[0]}},htmlBuilder:function(f,m){var g=kn(f.body,m),w=Fe.makeLineSpan("underline-line",m),k=m.fontMetrics().defaultRuleThickness,z=Fe.makeVList({positionType:"top",positionData:g.height,children:[{type:"kern",size:k},{type:"elem",elem:w},{type:"kern",size:3*k},{type:"elem",elem:g}]},m);return Fe.makeSpan(["mord","underline"],[z],m)},mathmlBuilder:function(f,m){var g=new _t.MathNode("mo",[new _t.TextNode("‾")]);g.setAttribute("stretchy","true");var w=new _t.MathNode("munder",[Hn(f.body,m),g]);return w.setAttribute("accentunder","true"),w}}),Ct({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler:function(f,m){var g=f.parser;return{type:"vcenter",mode:g.mode,body:m[0]}},htmlBuilder:function(f,m){var g=kn(f.body,m),w=m.fontMetrics().axisHeight,k=.5*(g.height-w-(g.depth+w));return Fe.makeVList({positionType:"shift",positionData:k,children:[{type:"elem",elem:g}]},m)},mathmlBuilder:function(f,m){return new _t.MathNode("mpadded",[Hn(f.body,m)],["vcenter"])}}),Ct({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler:function(f,m,g){throw new a("\\verb ended by end of line instead of matching delimiter")},htmlBuilder:function(f,m){for(var g=ai(f),w=[],k=m.havingStyle(m.style.text()),z=0;z<g.length;z++){var W=g[z];W==="~"&&(W="\\textasciitilde"),w.push(Fe.makeSymbol(W,"Typewriter-Regular",f.mode,k,["mord","texttt"]))}return Fe.makeSpan(["mord","text"].concat(k.sizingClasses(m)),Fe.tryCombineChars(w),k)},mathmlBuilder:function(f,m){var g=new _t.TextNode(ai(f)),w=new _t.MathNode("mtext",[g]);return w.setAttribute("mathvariant","monospace"),w}});var ai=function(f){return f.body.replace(/ /g,f.star?"␣":" ")},Np=gl,os=Np,Li=function(){function N(f,m,g){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=f,this.start=m,this.end=g}return N.range=function(m,g){return g?!m||!m.loc||!g.loc||m.loc.lexer!==g.loc.lexer?null:new N(m.loc.lexer,m.loc.start,g.loc.end):m&&m.loc},N}(),Jr=function(){function N(m,g){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=m,this.loc=g}var f=N.prototype;return f.range=function(g,w){return new N(w,Li.range(this,g))},N}(),dh=`[ \r
	]`,fh="\\\\[a-zA-Z@]+",hh="\\\\[^\uD800-\uDFFF]",Jn="("+fh+")"+dh+"*",Bp=`\\\\(
|[ \r	]+
?)[ \r	]*`,hd="[̀-ͯ]",Fp=new RegExp(hd+"+$"),Up="("+dh+"+)|"+(Bp+"|")+"([!-\\[\\]-‧‪-퟿豈-￿]"+(hd+"*")+"|[\uD800-\uDBFF][\uDC00-\uDFFF]"+(hd+"*")+"|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5"+("|"+Jn)+("|"+hh+")"),pd=function(){function N(m,g){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=m,this.settings=g,this.tokenRegex=new RegExp(Up,"g"),this.catcodes={"%":14,"~":13}}var f=N.prototype;return f.setCatcode=function(g,w){this.catcodes[g]=w},f.lex=function(){var g=this.input,w=this.tokenRegex.lastIndex;if(w===g.length)return new Jr("EOF",new Li(this,w,w));var k=this.tokenRegex.exec(g);if(k===null||k.index!==w)throw new a("Unexpected character: '"+g[w]+"'",new Jr(g[w],new Li(this,w,w+1)));var z=k[6]||k[3]||(k[2]?"\\ ":" ");if(this.catcodes[z]===14){var W=g.indexOf(`
`,this.tokenRegex.lastIndex);return W===-1?(this.tokenRegex.lastIndex=g.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=W+1,this.lex()}return new Jr(z,new Li(this,w,this.tokenRegex.lastIndex))},N}(),ph=function(){function N(m,g){m===void 0&&(m={}),g===void 0&&(g={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=g,this.builtins=m,this.undefStack=[]}var f=N.prototype;return f.beginGroup=function(){this.undefStack.push({})},f.endGroup=function(){if(this.undefStack.length===0)throw new a("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");var g=this.undefStack.pop();for(var w in g)g.hasOwnProperty(w)&&(g[w]===void 0?delete this.current[w]:this.current[w]=g[w])},f.endGroups=function(){for(;this.undefStack.length>0;)this.endGroup()},f.has=function(g){return this.current.hasOwnProperty(g)||this.builtins.hasOwnProperty(g)},f.get=function(g){return this.current.hasOwnProperty(g)?this.current[g]:this.builtins[g]},f.set=function(g,w,k){if(k===void 0&&(k=!1),k){for(var z=0;z<this.undefStack.length;z++)delete this.undefStack[z][g];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][g]=w)}else{var W=this.undefStack[this.undefStack.length-1];W&&!W.hasOwnProperty(g)&&(W[g]=this.current[g])}this.current[g]=w},N}(),mh=rh,Vp=mh;te("\\noexpand",function(N){var f=N.popToken();return N.isExpandable(f.text)&&(f.noexpand=!0,f.treatAsRelax=!0),{tokens:[f],numArgs:0}}),te("\\expandafter",function(N){var f=N.popToken();return N.expandOnce(!0),{tokens:[f],numArgs:0}}),te("\\@firstoftwo",function(N){var f=N.consumeArgs(2);return{tokens:f[0],numArgs:0}}),te("\\@secondoftwo",function(N){var f=N.consumeArgs(2);return{tokens:f[1],numArgs:0}}),te("\\@ifnextchar",function(N){var f=N.consumeArgs(3);N.consumeSpaces();var m=N.future();return f[0].length===1&&f[0][0].text===m.text?{tokens:f[1],numArgs:0}:{tokens:f[2],numArgs:0}}),te("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}"),te("\\TextOrMath",function(N){var f=N.consumeArgs(2);return N.mode==="text"?{tokens:f[0],numArgs:0}:{tokens:f[1],numArgs:0}});var gh={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};te("\\char",function(N){var f=N.popToken(),m,g="";if(f.text==="'")m=8,f=N.popToken();else if(f.text==='"')m=16,f=N.popToken();else if(f.text==="`")if(f=N.popToken(),f.text[0]==="\\")g=f.text.charCodeAt(1);else{if(f.text==="EOF")throw new a("\\char` missing argument");g=f.text.charCodeAt(0)}else m=10;if(m){if(g=gh[f.text],g==null||g>=m)throw new a("Invalid base-"+m+" digit "+f.text);for(var w;(w=gh[N.future().text])!=null&&w<m;)g*=m,g+=w,N.popToken()}return"\\@char{"+g+"}"});var md=function(f,m,g){var w=f.consumeArg().tokens;if(w.length!==1)throw new a("\\newcommand's first argument must be a macro name");var k=w[0].text,z=f.isDefined(k);if(z&&!m)throw new a("\\newcommand{"+k+"} attempting to redefine "+(k+"; use \\renewcommand"));if(!z&&!g)throw new a("\\renewcommand{"+k+"} when command "+k+" does not yet exist; use \\newcommand");var W=0;if(w=f.consumeArg().tokens,w.length===1&&w[0].text==="["){for(var ee="",ue=f.expandNextToken();ue.text!=="]"&&ue.text!=="EOF";)ee+=ue.text,ue=f.expandNextToken();if(!ee.match(/^\s*[0-9]+\s*$/))throw new a("Invalid number of arguments: "+ee);W=parseInt(ee),w=f.consumeArg().tokens}return f.macros.set(k,{tokens:w,numArgs:W}),""};te("\\newcommand",function(N){return md(N,!1,!0)}),te("\\renewcommand",function(N){return md(N,!0,!1)}),te("\\providecommand",function(N){return md(N,!0,!0)}),te("\\message",function(N){var f=N.consumeArgs(1)[0];return console.log(f.reverse().map(function(m){return m.text}).join("")),""}),te("\\errmessage",function(N){var f=N.consumeArgs(1)[0];return console.error(f.reverse().map(function(m){return m.text}).join("")),""}),te("\\show",function(N){var f=N.popToken(),m=f.text;return console.log(f,N.macros.get(m),os[m],sn.math[m],sn.text[m]),""}),te("\\bgroup","{"),te("\\egroup","}"),te("~","\\nobreakspace"),te("\\lq","`"),te("\\rq","'"),te("\\aa","\\r a"),te("\\AA","\\r A"),te("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`©}"),te("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}"),te("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`®}"),te("ℬ","\\mathscr{B}"),te("ℰ","\\mathscr{E}"),te("ℱ","\\mathscr{F}"),te("ℋ","\\mathscr{H}"),te("ℐ","\\mathscr{I}"),te("ℒ","\\mathscr{L}"),te("ℳ","\\mathscr{M}"),te("ℛ","\\mathscr{R}"),te("ℭ","\\mathfrak{C}"),te("ℌ","\\mathfrak{H}"),te("ℨ","\\mathfrak{Z}"),te("\\Bbbk","\\Bbb{k}"),te("·","\\cdotp"),te("\\llap","\\mathllap{\\textrm{#1}}"),te("\\rlap","\\mathrlap{\\textrm{#1}}"),te("\\clap","\\mathclap{\\textrm{#1}}"),te("\\mathstrut","\\vphantom{(}"),te("\\underbar","\\underline{\\text{#1}}"),te("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}'),te("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`≠}}"),te("\\ne","\\neq"),te("≠","\\neq"),te("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`∉}}"),te("∉","\\notin"),te("≘","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`≘}}"),te("≙","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`≘}}"),te("≚","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`≚}}"),te("≛","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`≛}}"),te("≝","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`≝}}"),te("≞","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`≞}}"),te("≟","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`≟}}"),te("⟂","\\perp"),te("‼","\\mathclose{!\\mkern-0.8mu!}"),te("∌","\\notni"),te("⌜","\\ulcorner"),te("⌝","\\urcorner"),te("⌞","\\llcorner"),te("⌟","\\lrcorner"),te("©","\\copyright"),te("®","\\textregistered"),te("️","\\textregistered"),te("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}'),te("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}'),te("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}'),te("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}'),te("\\vdots","\\mathord{\\varvdots\\rule{0pt}{15pt}}"),te("⋮","\\vdots"),te("\\varGamma","\\mathit{\\Gamma}"),te("\\varDelta","\\mathit{\\Delta}"),te("\\varTheta","\\mathit{\\Theta}"),te("\\varLambda","\\mathit{\\Lambda}"),te("\\varXi","\\mathit{\\Xi}"),te("\\varPi","\\mathit{\\Pi}"),te("\\varSigma","\\mathit{\\Sigma}"),te("\\varUpsilon","\\mathit{\\Upsilon}"),te("\\varPhi","\\mathit{\\Phi}"),te("\\varPsi","\\mathit{\\Psi}"),te("\\varOmega","\\mathit{\\Omega}"),te("\\substack","\\begin{subarray}{c}#1\\end{subarray}"),te("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu"),te("\\boxed","\\fbox{$\\displaystyle{#1}$}"),te("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;"),te("\\implies","\\DOTSB\\;\\Longrightarrow\\;"),te("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");var vh={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};te("\\dots",function(N){var f="\\dotso",m=N.expandAfterFuture().text;return m in vh?f=vh[m]:(m.substr(0,4)==="\\not"||m in sn.math&&S.contains(["bin","rel"],sn.math[m].group))&&(f="\\dotsb"),f});var gd={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};te("\\dotso",function(N){var f=N.future().text;return f in gd?"\\ldots\\,":"\\ldots"}),te("\\dotsc",function(N){var f=N.future().text;return f in gd&&f!==","?"\\ldots\\,":"\\ldots"}),te("\\cdots",function(N){var f=N.future().text;return f in gd?"\\@cdots\\,":"\\@cdots"}),te("\\dotsb","\\cdots"),te("\\dotsm","\\cdots"),te("\\dotsi","\\!\\cdots"),te("\\dotsx","\\ldots\\,"),te("\\DOTSI","\\relax"),te("\\DOTSB","\\relax"),te("\\DOTSX","\\relax"),te("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax"),te("\\,","\\tmspace+{3mu}{.1667em}"),te("\\thinspace","\\,"),te("\\>","\\mskip{4mu}"),te("\\:","\\tmspace+{4mu}{.2222em}"),te("\\medspace","\\:"),te("\\;","\\tmspace+{5mu}{.2777em}"),te("\\thickspace","\\;"),te("\\!","\\tmspace-{3mu}{.1667em}"),te("\\negthinspace","\\!"),te("\\negmedspace","\\tmspace-{4mu}{.2222em}"),te("\\negthickspace","\\tmspace-{5mu}{.277em}"),te("\\enspace","\\kern.5em "),te("\\enskip","\\hskip.5em\\relax"),te("\\quad","\\hskip1em\\relax"),te("\\qquad","\\hskip2em\\relax"),te("\\tag","\\@ifstar\\tag@literal\\tag@paren"),te("\\tag@paren","\\tag@literal{({#1})}"),te("\\tag@literal",function(N){if(N.macros.get("\\df@tag"))throw new a("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"}),te("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}"),te("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)"),te("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}"),te("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1"),te("\\pmb","\\html@mathml{\\@binrel{#1}{\\mathrlap{#1}\\kern0.5px#1}}{\\mathbf{#1}}"),te("\\newline","\\\\\\relax"),te("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");var yh=Le(Ze["Main-Regular"][84][1]-.7*Ze["Main-Regular"][65][1]);te("\\LaTeX","\\textrm{\\html@mathml{"+("L\\kern-.36em\\raisebox{"+yh+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{LaTeX}}"),te("\\KaTeX","\\textrm{\\html@mathml{"+("K\\kern-.17em\\raisebox{"+yh+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{KaTeX}}"),te("\\hspace","\\@ifstar\\@hspacer\\@hspace"),te("\\@hspace","\\hskip #1\\relax"),te("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax"),te("\\ordinarycolon",":"),te("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}"),te("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}'),te("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}'),te("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}'),te("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}'),te("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}'),te("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}'),te("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}'),te("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}'),te("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}'),te("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}'),te("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}'),te("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}'),te("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}'),te("∷","\\dblcolon"),te("∹","\\eqcolon"),te("≔","\\coloneqq"),te("≕","\\eqqcolon"),te("⩴","\\Coloneqq"),te("\\ratio","\\vcentcolon"),te("\\coloncolon","\\dblcolon"),te("\\colonequals","\\coloneqq"),te("\\coloncolonequals","\\Coloneqq"),te("\\equalscolon","\\eqqcolon"),te("\\equalscoloncolon","\\Eqqcolon"),te("\\colonminus","\\coloneq"),te("\\coloncolonminus","\\Coloneq"),te("\\minuscolon","\\eqcolon"),te("\\minuscoloncolon","\\Eqcolon"),te("\\coloncolonapprox","\\Colonapprox"),te("\\coloncolonsim","\\Colonsim"),te("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}"),te("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}"),te("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}"),te("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}"),te("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`∌}}"),te("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}"),te("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}"),te("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}"),te("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}"),te("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}"),te("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}"),te("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}"),te("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}"),te("\\gvertneqq","\\html@mathml{\\@gvertneqq}{≩}"),te("\\lvertneqq","\\html@mathml{\\@lvertneqq}{≨}"),te("\\ngeqq","\\html@mathml{\\@ngeqq}{≱}"),te("\\ngeqslant","\\html@mathml{\\@ngeqslant}{≱}"),te("\\nleqq","\\html@mathml{\\@nleqq}{≰}"),te("\\nleqslant","\\html@mathml{\\@nleqslant}{≰}"),te("\\nshortmid","\\html@mathml{\\@nshortmid}{∤}"),te("\\nshortparallel","\\html@mathml{\\@nshortparallel}{∦}"),te("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{⊈}"),te("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{⊉}"),te("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{⊊}"),te("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{⫋}"),te("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{⊋}"),te("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{⫌}"),te("\\imath","\\html@mathml{\\@imath}{ı}"),te("\\jmath","\\html@mathml{\\@jmath}{ȷ}"),te("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`⟦}}"),te("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`⟧}}"),te("⟦","\\llbracket"),te("⟧","\\rrbracket"),te("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`⦃}}"),te("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`⦄}}"),te("⦃","\\lBrace"),te("⦄","\\rBrace"),te("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`⦵}}"),te("⦵","\\minuso"),te("\\darr","\\downarrow"),te("\\dArr","\\Downarrow"),te("\\Darr","\\Downarrow"),te("\\lang","\\langle"),te("\\rang","\\rangle"),te("\\uarr","\\uparrow"),te("\\uArr","\\Uparrow"),te("\\Uarr","\\Uparrow"),te("\\N","\\mathbb{N}"),te("\\R","\\mathbb{R}"),te("\\Z","\\mathbb{Z}"),te("\\alef","\\aleph"),te("\\alefsym","\\aleph"),te("\\Alpha","\\mathrm{A}"),te("\\Beta","\\mathrm{B}"),te("\\bull","\\bullet"),te("\\Chi","\\mathrm{X}"),te("\\clubs","\\clubsuit"),te("\\cnums","\\mathbb{C}"),te("\\Complex","\\mathbb{C}"),te("\\Dagger","\\ddagger"),te("\\diamonds","\\diamondsuit"),te("\\empty","\\emptyset"),te("\\Epsilon","\\mathrm{E}"),te("\\Eta","\\mathrm{H}"),te("\\exist","\\exists"),te("\\harr","\\leftrightarrow"),te("\\hArr","\\Leftrightarrow"),te("\\Harr","\\Leftrightarrow"),te("\\hearts","\\heartsuit"),te("\\image","\\Im"),te("\\infin","\\infty"),te("\\Iota","\\mathrm{I}"),te("\\isin","\\in"),te("\\Kappa","\\mathrm{K}"),te("\\larr","\\leftarrow"),te("\\lArr","\\Leftarrow"),te("\\Larr","\\Leftarrow"),te("\\lrarr","\\leftrightarrow"),te("\\lrArr","\\Leftrightarrow"),te("\\Lrarr","\\Leftrightarrow"),te("\\Mu","\\mathrm{M}"),te("\\natnums","\\mathbb{N}"),te("\\Nu","\\mathrm{N}"),te("\\Omicron","\\mathrm{O}"),te("\\plusmn","\\pm"),te("\\rarr","\\rightarrow"),te("\\rArr","\\Rightarrow"),te("\\Rarr","\\Rightarrow"),te("\\real","\\Re"),te("\\reals","\\mathbb{R}"),te("\\Reals","\\mathbb{R}"),te("\\Rho","\\mathrm{P}"),te("\\sdot","\\cdot"),te("\\sect","\\S"),te("\\spades","\\spadesuit"),te("\\sub","\\subset"),te("\\sube","\\subseteq"),te("\\supe","\\supseteq"),te("\\Tau","\\mathrm{T}"),te("\\thetasym","\\vartheta"),te("\\weierp","\\wp"),te("\\Zeta","\\mathrm{Z}"),te("\\argmin","\\DOTSB\\operatorname*{arg\\,min}"),te("\\argmax","\\DOTSB\\operatorname*{arg\\,max}"),te("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits"),te("\\bra","\\mathinner{\\langle{#1}|}"),te("\\ket","\\mathinner{|{#1}\\rangle}"),te("\\braket","\\mathinner{\\langle{#1}\\rangle}"),te("\\Bra","\\left\\langle#1\\right|"),te("\\Ket","\\left|#1\\right\\rangle"),te("\\angln","{\\angl n}"),te("\\blue","\\textcolor{##6495ed}{#1}"),te("\\orange","\\textcolor{##ffa500}{#1}"),te("\\pink","\\textcolor{##ff00af}{#1}"),te("\\red","\\textcolor{##df0030}{#1}"),te("\\green","\\textcolor{##28ae7b}{#1}"),te("\\gray","\\textcolor{gray}{#1}"),te("\\purple","\\textcolor{##9d38bd}{#1}"),te("\\blueA","\\textcolor{##ccfaff}{#1}"),te("\\blueB","\\textcolor{##80f6ff}{#1}"),te("\\blueC","\\textcolor{##63d9ea}{#1}"),te("\\blueD","\\textcolor{##11accd}{#1}"),te("\\blueE","\\textcolor{##0c7f99}{#1}"),te("\\tealA","\\textcolor{##94fff5}{#1}"),te("\\tealB","\\textcolor{##26edd5}{#1}"),te("\\tealC","\\textcolor{##01d1c1}{#1}"),te("\\tealD","\\textcolor{##01a995}{#1}"),te("\\tealE","\\textcolor{##208170}{#1}"),te("\\greenA","\\textcolor{##b6ffb0}{#1}"),te("\\greenB","\\textcolor{##8af281}{#1}"),te("\\greenC","\\textcolor{##74cf70}{#1}"),te("\\greenD","\\textcolor{##1fab54}{#1}"),te("\\greenE","\\textcolor{##0d923f}{#1}"),te("\\goldA","\\textcolor{##ffd0a9}{#1}"),te("\\goldB","\\textcolor{##ffbb71}{#1}"),te("\\goldC","\\textcolor{##ff9c39}{#1}"),te("\\goldD","\\textcolor{##e07d10}{#1}"),te("\\goldE","\\textcolor{##a75a05}{#1}"),te("\\redA","\\textcolor{##fca9a9}{#1}"),te("\\redB","\\textcolor{##ff8482}{#1}"),te("\\redC","\\textcolor{##f9685d}{#1}"),te("\\redD","\\textcolor{##e84d39}{#1}"),te("\\redE","\\textcolor{##bc2612}{#1}"),te("\\maroonA","\\textcolor{##ffbde0}{#1}"),te("\\maroonB","\\textcolor{##ff92c6}{#1}"),te("\\maroonC","\\textcolor{##ed5fa6}{#1}"),te("\\maroonD","\\textcolor{##ca337c}{#1}"),te("\\maroonE","\\textcolor{##9e034e}{#1}"),te("\\purpleA","\\textcolor{##ddd7ff}{#1}"),te("\\purpleB","\\textcolor{##c6b9fc}{#1}"),te("\\purpleC","\\textcolor{##aa87ff}{#1}"),te("\\purpleD","\\textcolor{##7854ab}{#1}"),te("\\purpleE","\\textcolor{##543b78}{#1}"),te("\\mintA","\\textcolor{##f5f9e8}{#1}"),te("\\mintB","\\textcolor{##edf2df}{#1}"),te("\\mintC","\\textcolor{##e0e5cc}{#1}"),te("\\grayA","\\textcolor{##f6f7f7}{#1}"),te("\\grayB","\\textcolor{##f0f1f2}{#1}"),te("\\grayC","\\textcolor{##e3e5e6}{#1}"),te("\\grayD","\\textcolor{##d6d8da}{#1}"),te("\\grayE","\\textcolor{##babec2}{#1}"),te("\\grayF","\\textcolor{##888d93}{#1}"),te("\\grayG","\\textcolor{##626569}{#1}"),te("\\grayH","\\textcolor{##3b3e40}{#1}"),te("\\grayI","\\textcolor{##21242c}{#1}"),te("\\kaBlue","\\textcolor{##314453}{#1}"),te("\\kaGreen","\\textcolor{##71B307}{#1}");var _h={"\\relax":!0,"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0},Hp=function(){function N(m,g,w){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=g,this.expansionCount=0,this.feed(m),this.macros=new ph(Vp,g.macros),this.mode=w,this.stack=[]}var f=N.prototype;return f.feed=function(g){this.lexer=new pd(g,this.settings)},f.switchMode=function(g){this.mode=g},f.beginGroup=function(){this.macros.beginGroup()},f.endGroup=function(){this.macros.endGroup()},f.endGroups=function(){this.macros.endGroups()},f.future=function(){return this.stack.length===0&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]},f.popToken=function(){return this.future(),this.stack.pop()},f.pushToken=function(g){this.stack.push(g)},f.pushTokens=function(g){var w;(w=this.stack).push.apply(w,g)},f.scanArgument=function(g){var w,k,z;if(g){if(this.consumeSpaces(),this.future().text!=="[")return null;w=this.popToken();var W=this.consumeArg(["]"]);z=W.tokens,k=W.end}else{var ee=this.consumeArg();z=ee.tokens,w=ee.start,k=ee.end}return this.pushToken(new Jr("EOF",k.loc)),this.pushTokens(z),w.range(k,"")},f.consumeSpaces=function(){for(;;){var g=this.future();if(g.text===" ")this.stack.pop();else break}},f.consumeArg=function(g){var w=[],k=g&&g.length>0;k||this.consumeSpaces();var z=this.future(),W,ee=0,ue=0;do{if(W=this.popToken(),w.push(W),W.text==="{")++ee;else if(W.text==="}"){if(--ee,ee===-1)throw new a("Extra }",W)}else if(W.text==="EOF")throw new a("Unexpected end of input in a macro argument, expected '"+(g&&k?g[ue]:"}")+"'",W);if(g&&k)if((ee===0||ee===1&&g[ue]==="{")&&W.text===g[ue]){if(++ue,ue===g.length){w.splice(-ue,ue);break}}else ue=0}while(ee!==0||k);return z.text==="{"&&w[w.length-1].text==="}"&&(w.pop(),w.shift()),w.reverse(),{tokens:w,start:z,end:W}},f.consumeArgs=function(g,w){if(w){if(w.length!==g+1)throw new a("The length of delimiters doesn't match the number of args!");for(var k=w[0],z=0;z<k.length;z++){var W=this.popToken();if(k[z]!==W.text)throw new a("Use of the macro doesn't match its definition",W)}}for(var ee=[],ue=0;ue<g;ue++)ee.push(this.consumeArg(w&&w[ue+1]).tokens);return ee},f.expandOnce=function(g){var w=this.popToken(),k=w.text,z=w.noexpand?null:this._getExpansion(k);if(z==null||g&&z.unexpandable){if(g&&z==null&&k[0]==="\\"&&!this.isDefined(k))throw new a("Undefined control sequence: "+k);return this.pushToken(w),w}if(this.expansionCount++,this.expansionCount>this.settings.maxExpand)throw new a("Too many expansions: infinite loop or need to increase maxExpand setting");var W=z.tokens,ee=this.consumeArgs(z.numArgs,z.delimiters);if(z.numArgs){W=W.slice();for(var ue=W.length-1;ue>=0;--ue){var Me=W[ue];if(Me.text==="#"){if(ue===0)throw new a("Incomplete placeholder at end of macro body",Me);if(Me=W[--ue],Me.text==="#")W.splice(ue+1,1);else if(/^[1-9]$/.test(Me.text)){var Ue;(Ue=W).splice.apply(Ue,[ue,2].concat(ee[+Me.text-1]))}else throw new a("Not a valid argument number",Me)}}}return this.pushTokens(W),W},f.expandAfterFuture=function(){return this.expandOnce(),this.future()},f.expandNextToken=function(){for(;;){var g=this.expandOnce();if(g instanceof Jr)if(g.text==="\\relax"||g.treatAsRelax)this.stack.pop();else return this.stack.pop()}throw new Error},f.expandMacro=function(g){return this.macros.has(g)?this.expandTokens([new Jr(g)]):void 0},f.expandTokens=function(g){var w=[],k=this.stack.length;for(this.pushTokens(g);this.stack.length>k;){var z=this.expandOnce(!0);z instanceof Jr&&(z.treatAsRelax&&(z.noexpand=!1,z.treatAsRelax=!1),w.push(this.stack.pop()))}return w},f.expandMacroAsText=function(g){var w=this.expandMacro(g);return w&&w.map(function(k){return k.text}).join("")},f._getExpansion=function(g){var w=this.macros.get(g);if(w==null)return w;if(g.length===1){var k=this.lexer.catcodes[g];if(k!=null&&k!==13)return}var z=typeof w=="function"?w(this):w;if(typeof z=="string"){var W=0;if(z.indexOf("#")!==-1)for(var ee=z.replace(/##/g,"");ee.indexOf("#"+(W+1))!==-1;)++W;for(var ue=new pd(z,this.settings),Me=[],Ue=ue.lex();Ue.text!=="EOF";)Me.push(Ue),Ue=ue.lex();Me.reverse();var lt={tokens:Me,numArgs:W};return lt}return z},f.isDefined=function(g){return this.macros.has(g)||os.hasOwnProperty(g)||sn.math.hasOwnProperty(g)||sn.text.hasOwnProperty(g)||_h.hasOwnProperty(g)},f.isExpandable=function(g){var w=this.macros.get(g);return w!=null?typeof w=="string"||typeof w=="function"||!w.unexpandable:os.hasOwnProperty(g)&&!os[g].primitive},N}(),vd={"́":{text:"\\'",math:"\\acute"},"̀":{text:"\\`",math:"\\grave"},"̈":{text:'\\"',math:"\\ddot"},"̃":{text:"\\~",math:"\\tilde"},"̄":{text:"\\=",math:"\\bar"},"̆":{text:"\\u",math:"\\breve"},"̌":{text:"\\v",math:"\\check"},"̂":{text:"\\^",math:"\\hat"},"̇":{text:"\\.",math:"\\dot"},"̊":{text:"\\r",math:"\\mathring"},"̋":{text:"\\H"},"̧":{text:"\\c"}},bh={á:"á",à:"à",ä:"ä",ǟ:"ǟ",ã:"ã",ā:"ā",ă:"ă",ắ:"ắ",ằ:"ằ",ẵ:"ẵ",ǎ:"ǎ",â:"â",ấ:"ấ",ầ:"ầ",ẫ:"ẫ",ȧ:"ȧ",ǡ:"ǡ",å:"å",ǻ:"ǻ",ḃ:"ḃ",ć:"ć",ḉ:"ḉ",č:"č",ĉ:"ĉ",ċ:"ċ",ç:"ç",ď:"ď",ḋ:"ḋ",ḑ:"ḑ",é:"é",è:"è",ë:"ë",ẽ:"ẽ",ē:"ē",ḗ:"ḗ",ḕ:"ḕ",ĕ:"ĕ",ḝ:"ḝ",ě:"ě",ê:"ê",ế:"ế",ề:"ề",ễ:"ễ",ė:"ė",ȩ:"ȩ",ḟ:"ḟ",ǵ:"ǵ",ḡ:"ḡ",ğ:"ğ",ǧ:"ǧ",ĝ:"ĝ",ġ:"ġ",ģ:"ģ",ḧ:"ḧ",ȟ:"ȟ",ĥ:"ĥ",ḣ:"ḣ",ḩ:"ḩ",í:"í",ì:"ì",ï:"ï",ḯ:"ḯ",ĩ:"ĩ",ī:"ī",ĭ:"ĭ",ǐ:"ǐ",î:"î",ǰ:"ǰ",ĵ:"ĵ",ḱ:"ḱ",ǩ:"ǩ",ķ:"ķ",ĺ:"ĺ",ľ:"ľ",ļ:"ļ",ḿ:"ḿ",ṁ:"ṁ",ń:"ń",ǹ:"ǹ",ñ:"ñ",ň:"ň",ṅ:"ṅ",ņ:"ņ",ó:"ó",ò:"ò",ö:"ö",ȫ:"ȫ",õ:"õ",ṍ:"ṍ",ṏ:"ṏ",ȭ:"ȭ",ō:"ō",ṓ:"ṓ",ṑ:"ṑ",ŏ:"ŏ",ǒ:"ǒ",ô:"ô",ố:"ố",ồ:"ồ",ỗ:"ỗ",ȯ:"ȯ",ȱ:"ȱ",ő:"ő",ṕ:"ṕ",ṗ:"ṗ",ŕ:"ŕ",ř:"ř",ṙ:"ṙ",ŗ:"ŗ",ś:"ś",ṥ:"ṥ",š:"š",ṧ:"ṧ",ŝ:"ŝ",ṡ:"ṡ",ş:"ş",ẗ:"ẗ",ť:"ť",ṫ:"ṫ",ţ:"ţ",ú:"ú",ù:"ù",ü:"ü",ǘ:"ǘ",ǜ:"ǜ",ǖ:"ǖ",ǚ:"ǚ",ũ:"ũ",ṹ:"ṹ",ū:"ū",ṻ:"ṻ",ŭ:"ŭ",ǔ:"ǔ",û:"û",ů:"ů",ű:"ű",ṽ:"ṽ",ẃ:"ẃ",ẁ:"ẁ",ẅ:"ẅ",ŵ:"ŵ",ẇ:"ẇ",ẘ:"ẘ",ẍ:"ẍ",ẋ:"ẋ",ý:"ý",ỳ:"ỳ",ÿ:"ÿ",ỹ:"ỹ",ȳ:"ȳ",ŷ:"ŷ",ẏ:"ẏ",ẙ:"ẙ",ź:"ź",ž:"ž",ẑ:"ẑ",ż:"ż",Á:"Á",À:"À",Ä:"Ä",Ǟ:"Ǟ",Ã:"Ã",Ā:"Ā",Ă:"Ă",Ắ:"Ắ",Ằ:"Ằ",Ẵ:"Ẵ",Ǎ:"Ǎ",Â:"Â",Ấ:"Ấ",Ầ:"Ầ",Ẫ:"Ẫ",Ȧ:"Ȧ",Ǡ:"Ǡ",Å:"Å",Ǻ:"Ǻ",Ḃ:"Ḃ",Ć:"Ć",Ḉ:"Ḉ",Č:"Č",Ĉ:"Ĉ",Ċ:"Ċ",Ç:"Ç",Ď:"Ď",Ḋ:"Ḋ",Ḑ:"Ḑ",É:"É",È:"È",Ë:"Ë",Ẽ:"Ẽ",Ē:"Ē",Ḗ:"Ḗ",Ḕ:"Ḕ",Ĕ:"Ĕ",Ḝ:"Ḝ",Ě:"Ě",Ê:"Ê",Ế:"Ế",Ề:"Ề",Ễ:"Ễ",Ė:"Ė",Ȩ:"Ȩ",Ḟ:"Ḟ",Ǵ:"Ǵ",Ḡ:"Ḡ",Ğ:"Ğ",Ǧ:"Ǧ",Ĝ:"Ĝ",Ġ:"Ġ",Ģ:"Ģ",Ḧ:"Ḧ",Ȟ:"Ȟ",Ĥ:"Ĥ",Ḣ:"Ḣ",Ḩ:"Ḩ",Í:"Í",Ì:"Ì",Ï:"Ï",Ḯ:"Ḯ",Ĩ:"Ĩ",Ī:"Ī",Ĭ:"Ĭ",Ǐ:"Ǐ",Î:"Î",İ:"İ",Ĵ:"Ĵ",Ḱ:"Ḱ",Ǩ:"Ǩ",Ķ:"Ķ",Ĺ:"Ĺ",Ľ:"Ľ",Ļ:"Ļ",Ḿ:"Ḿ",Ṁ:"Ṁ",Ń:"Ń",Ǹ:"Ǹ",Ñ:"Ñ",Ň:"Ň",Ṅ:"Ṅ",Ņ:"Ņ",Ó:"Ó",Ò:"Ò",Ö:"Ö",Ȫ:"Ȫ",Õ:"Õ",Ṍ:"Ṍ",Ṏ:"Ṏ",Ȭ:"Ȭ",Ō:"Ō",Ṓ:"Ṓ",Ṑ:"Ṑ",Ŏ:"Ŏ",Ǒ:"Ǒ",Ô:"Ô",Ố:"Ố",Ồ:"Ồ",Ỗ:"Ỗ",Ȯ:"Ȯ",Ȱ:"Ȱ",Ő:"Ő",Ṕ:"Ṕ",Ṗ:"Ṗ",Ŕ:"Ŕ",Ř:"Ř",Ṙ:"Ṙ",Ŗ:"Ŗ",Ś:"Ś",Ṥ:"Ṥ",Š:"Š",Ṧ:"Ṧ",Ŝ:"Ŝ",Ṡ:"Ṡ",Ş:"Ş",Ť:"Ť",Ṫ:"Ṫ",Ţ:"Ţ",Ú:"Ú",Ù:"Ù",Ü:"Ü",Ǘ:"Ǘ",Ǜ:"Ǜ",Ǖ:"Ǖ",Ǚ:"Ǚ",Ũ:"Ũ",Ṹ:"Ṹ",Ū:"Ū",Ṻ:"Ṻ",Ŭ:"Ŭ",Ǔ:"Ǔ",Û:"Û",Ů:"Ů",Ű:"Ű",Ṽ:"Ṽ",Ẃ:"Ẃ",Ẁ:"Ẁ",Ẅ:"Ẅ",Ŵ:"Ŵ",Ẇ:"Ẇ",Ẍ:"Ẍ",Ẋ:"Ẋ",Ý:"Ý",Ỳ:"Ỳ",Ÿ:"Ÿ",Ỹ:"Ỹ",Ȳ:"Ȳ",Ŷ:"Ŷ",Ẏ:"Ẏ",Ź:"Ź",Ž:"Ž",Ẑ:"Ẑ",Ż:"Ż",ά:"ά",ὰ:"ὰ",ᾱ:"ᾱ",ᾰ:"ᾰ",έ:"έ",ὲ:"ὲ",ή:"ή",ὴ:"ὴ",ί:"ί",ὶ:"ὶ",ϊ:"ϊ",ΐ:"ΐ",ῒ:"ῒ",ῑ:"ῑ",ῐ:"ῐ",ό:"ό",ὸ:"ὸ",ύ:"ύ",ὺ:"ὺ",ϋ:"ϋ",ΰ:"ΰ",ῢ:"ῢ",ῡ:"ῡ",ῠ:"ῠ",ώ:"ώ",ὼ:"ὼ",Ύ:"Ύ",Ὺ:"Ὺ",Ϋ:"Ϋ",Ῡ:"Ῡ",Ῠ:"Ῠ",Ώ:"Ώ",Ὼ:"Ὼ"},xh=function(){function N(m,g){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new Hp(m,g,this.mode),this.settings=g,this.leftrightDepth=0}var f=N.prototype;return f.expect=function(g,w){if(w===void 0&&(w=!0),this.fetch().text!==g)throw new a("Expected '"+g+"', got '"+this.fetch().text+"'",this.fetch());w&&this.consume()},f.consume=function(){this.nextToken=null},f.fetch=function(){return this.nextToken==null&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken},f.switchMode=function(g){this.mode=g,this.gullet.switchMode(g)},f.parse=function(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{var g=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),g}finally{this.gullet.endGroups()}},f.parseExpression=function(g,w){for(var k=[];;){this.mode==="math"&&this.consumeSpaces();var z=this.fetch();if(N.endOfExpression.indexOf(z.text)!==-1||w&&z.text===w||g&&os[z.text]&&os[z.text].infix)break;var W=this.parseAtom(w);if(W){if(W.type==="internal")continue}else break;k.push(W)}return this.mode==="text"&&this.formLigatures(k),this.handleInfixNodes(k)},f.handleInfixNodes=function(g){for(var w=-1,k,z=0;z<g.length;z++)if(g[z].type==="infix"){if(w!==-1)throw new a("only one infix operator per group",g[z].token);w=z,k=g[z].replaceWith}if(w!==-1&&k){var W,ee,ue=g.slice(0,w),Me=g.slice(w+1);ue.length===1&&ue[0].type==="ordgroup"?W=ue[0]:W={type:"ordgroup",mode:this.mode,body:ue},Me.length===1&&Me[0].type==="ordgroup"?ee=Me[0]:ee={type:"ordgroup",mode:this.mode,body:Me};var Ue;return k==="\\\\abovefrac"?Ue=this.callFunction(k,[W,g[w],ee],[]):Ue=this.callFunction(k,[W,ee],[]),[Ue]}else return g},f.handleSupSubscript=function(g){var w=this.fetch(),k=w.text;this.consume(),this.consumeSpaces();var z=this.parseGroup(g);if(!z)throw new a("Expected group after '"+k+"'",w);return z},f.formatUnsupportedCmd=function(g){for(var w=[],k=0;k<g.length;k++)w.push({type:"textord",mode:"text",text:g[k]});var z={type:"text",mode:this.mode,body:w},W={type:"color",mode:this.mode,color:this.settings.errorColor,body:[z]};return W},f.parseAtom=function(g){var w=this.parseGroup("atom",g);if(this.mode==="text")return w;for(var k,z;;){this.consumeSpaces();var W=this.fetch();if(W.text==="\\limits"||W.text==="\\nolimits"){if(w&&w.type==="op"){var ee=W.text==="\\limits";w.limits=ee,w.alwaysHandleSupSub=!0}else if(w&&w.type==="operatorname")w.alwaysHandleSupSub&&(w.limits=W.text==="\\limits");else throw new a("Limit controls must follow a math operator",W);this.consume()}else if(W.text==="^"){if(k)throw new a("Double superscript",W);k=this.handleSupSubscript("superscript")}else if(W.text==="_"){if(z)throw new a("Double subscript",W);z=this.handleSupSubscript("subscript")}else if(W.text==="'"){if(k)throw new a("Double superscript",W);var ue={type:"textord",mode:this.mode,text:"\\prime"},Me=[ue];for(this.consume();this.fetch().text==="'";)Me.push(ue),this.consume();this.fetch().text==="^"&&Me.push(this.handleSupSubscript("superscript")),k={type:"ordgroup",mode:this.mode,body:Me}}else break}return k||z?{type:"supsub",mode:this.mode,base:w,sup:k,sub:z}:w},f.parseFunction=function(g,w){var k=this.fetch(),z=k.text,W=os[z];if(!W)return null;if(this.consume(),w&&w!=="atom"&&!W.allowedInArgument)throw new a("Got function '"+z+"' with no arguments"+(w?" as "+w:""),k);if(this.mode==="text"&&!W.allowedInText)throw new a("Can't use function '"+z+"' in text mode",k);if(this.mode==="math"&&W.allowedInMath===!1)throw new a("Can't use function '"+z+"' in math mode",k);var ee=this.parseArguments(z,W),ue=ee.args,Me=ee.optArgs;return this.callFunction(z,ue,Me,k,g)},f.callFunction=function(g,w,k,z,W){var ee={funcName:g,parser:this,token:z,breakOnTokenText:W},ue=os[g];if(ue&&ue.handler)return ue.handler(ee,w,k);throw new a("No function handler for "+g)},f.parseArguments=function(g,w){var k=w.numArgs+w.numOptionalArgs;if(k===0)return{args:[],optArgs:[]};for(var z=[],W=[],ee=0;ee<k;ee++){var ue=w.argTypes&&w.argTypes[ee],Me=ee<w.numOptionalArgs;(w.primitive&&ue==null||w.type==="sqrt"&&ee===1&&W[0]==null)&&(ue="primitive");var Ue=this.parseGroupOfType("argument to '"+g+"'",ue,Me);if(Me)W.push(Ue);else if(Ue!=null)z.push(Ue);else throw new a("Null argument, please report this as a bug")}return{args:z,optArgs:W}},f.parseGroupOfType=function(g,w,k){switch(w){case"color":return this.parseColorGroup(k);case"size":return this.parseSizeGroup(k);case"url":return this.parseUrlGroup(k);case"math":case"text":return this.parseArgumentGroup(k,w);case"hbox":{var z=this.parseArgumentGroup(k,"text");return z!=null?{type:"styling",mode:z.mode,body:[z],style:"text"}:null}case"raw":{var W=this.parseStringGroup("raw",k);return W!=null?{type:"raw",mode:"text",string:W.text}:null}case"primitive":{if(k)throw new a("A primitive argument cannot be optional");var ee=this.parseGroup(g);if(ee==null)throw new a("Expected group as "+g,this.fetch());return ee}case"original":case null:case void 0:return this.parseArgumentGroup(k);default:throw new a("Unknown group type as "+g,this.fetch())}},f.consumeSpaces=function(){for(;this.fetch().text===" ";)this.consume()},f.parseStringGroup=function(g,w){var k=this.gullet.scanArgument(w);if(k==null)return null;for(var z="",W;(W=this.fetch()).text!=="EOF";)z+=W.text,this.consume();return this.consume(),k.text=z,k},f.parseRegexGroup=function(g,w){for(var k=this.fetch(),z=k,W="",ee;(ee=this.fetch()).text!=="EOF"&&g.test(W+ee.text);)z=ee,W+=z.text,this.consume();if(W==="")throw new a("Invalid "+w+": '"+k.text+"'",k);return k.range(z,W)},f.parseColorGroup=function(g){var w=this.parseStringGroup("color",g);if(w==null)return null;var k=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i.exec(w.text);if(!k)throw new a("Invalid color: '"+w.text+"'",w);var z=k[0];return/^[0-9a-f]{6}$/i.test(z)&&(z="#"+z),{type:"color-token",mode:this.mode,color:z}},f.parseSizeGroup=function(g){var w,k=!1;if(this.gullet.consumeSpaces(),!g&&this.gullet.future().text!=="{"?w=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size"):w=this.parseStringGroup("size",g),!w)return null;!g&&w.text.length===0&&(w.text="0pt",k=!0);var z=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(w.text);if(!z)throw new a("Invalid size: '"+w.text+"'",w);var W={number:+(z[1]+z[2]),unit:z[3]};if(!Ie(W))throw new a("Invalid unit: '"+W.unit+"'",w);return{type:"size",mode:this.mode,value:W,isBlank:k}},f.parseUrlGroup=function(g){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);var w=this.parseStringGroup("url",g);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),w==null)return null;var k=w.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:k}},f.parseArgumentGroup=function(g,w){var k=this.gullet.scanArgument(g);if(k==null)return null;var z=this.mode;w&&this.switchMode(w),this.gullet.beginGroup();var W=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();var ee={type:"ordgroup",mode:this.mode,loc:k.loc,body:W};return w&&this.switchMode(z),ee},f.parseGroup=function(g,w){var k=this.fetch(),z=k.text,W;if(z==="{"||z==="\\begingroup"){this.consume();var ee=z==="{"?"}":"\\endgroup";this.gullet.beginGroup();var ue=this.parseExpression(!1,ee),Me=this.fetch();this.expect(ee),this.gullet.endGroup(),W={type:"ordgroup",mode:this.mode,loc:Li.range(k,Me),body:ue,semisimple:z==="\\begingroup"||void 0}}else if(W=this.parseFunction(w,g)||this.parseSymbol(),W==null&&z[0]==="\\"&&!_h.hasOwnProperty(z)){if(this.settings.throwOnError)throw new a("Undefined control sequence: "+z,k);W=this.formatUnsupportedCmd(z),this.consume()}return W},f.formLigatures=function(g){for(var w=g.length-1,k=0;k<w;++k){var z=g[k],W=z.text;W==="-"&&g[k+1].text==="-"&&(k+1<w&&g[k+2].text==="-"?(g.splice(k,3,{type:"textord",mode:"text",loc:Li.range(z,g[k+2]),text:"---"}),w-=2):(g.splice(k,2,{type:"textord",mode:"text",loc:Li.range(z,g[k+1]),text:"--"}),w-=1)),(W==="'"||W==="`")&&g[k+1].text===W&&(g.splice(k,2,{type:"textord",mode:"text",loc:Li.range(z,g[k+1]),text:W+W}),w-=1)}},f.parseSymbol=function(){var g=this.fetch(),w=g.text;if(/^\\verb[^a-zA-Z]/.test(w)){this.consume();var k=w.slice(5),z=k.charAt(0)==="*";if(z&&(k=k.slice(1)),k.length<2||k.charAt(0)!==k.slice(-1))throw new a(`\\verb assertion failed --
                    please report what input caused this bug`);return k=k.slice(1,-1),{type:"verb",mode:"text",body:k,star:z}}bh.hasOwnProperty(w[0])&&!sn[this.mode][w[0]]&&(this.settings.strict&&this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+w[0]+'" used in math mode',g),w=bh[w[0]]+w.substr(1));var W=Fp.exec(w);W&&(w=w.substring(0,W.index),w==="i"?w="ı":w==="j"&&(w="ȷ"));var ee;if(sn[this.mode][w]){this.settings.strict&&this.mode==="math"&&Ma.indexOf(w)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+w[0]+'" used in math mode',g);var ue=sn[this.mode][w].group,Me=Li.range(g),Ue;if(bn.hasOwnProperty(ue)){var lt=ue;Ue={type:"atom",mode:this.mode,family:lt,loc:Me,text:w}}else Ue={type:ue,mode:this.mode,loc:Me,text:w};ee=Ue}else if(w.charCodeAt(0)>=128)this.settings.strict&&(Pe(w.charCodeAt(0))?this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+w[0]+'" used in math mode',g):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+w[0]+'"'+(" ("+w.charCodeAt(0)+")"),g)),ee={type:"textord",mode:"text",loc:Li.range(g),text:w};else return null;if(this.consume(),W)for(var p=0;p<W[0].length;p++){var y=W[0][p];if(!vd[y])throw new a("Unknown accent ' "+y+"'",g);var T=vd[y][this.mode]||vd[y].text;if(!T)throw new a("Accent "+y+" unsupported in "+this.mode+" mode",g);ee={type:"accent",mode:this.mode,loc:Li.range(g),label:T,isStretchy:!1,isShifty:!0,base:ee}}return ee},N}();xh.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var Wp=function(f,m){if(!(typeof f=="string"||f instanceof String))throw new TypeError("KaTeX can only parse string typed expression");var g=new xh(f,m);delete g.gullet.macros.current["\\df@tag"];var w=g.parse();if(delete g.gullet.macros.current["\\current@color"],delete g.gullet.macros.current["\\color"],g.gullet.macros.get("\\df@tag")){if(!m.displayMode)throw new a("\\tag works only in display equations");g.gullet.feed("\\df@tag"),w=[{type:"tag",mode:"text",body:w,tag:g.parse()}]}return w},yd=Wp,wh=function(f,m,g){m.textContent="";var w=_d(f,g).toNode();m.appendChild(w)};typeof document<"u"&&document.compatMode!=="CSS1Compat"&&(typeof console<"u"&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."),wh=function(){throw new a("KaTeX doesn't work in quirks mode.")});var Gp=function(f,m){var g=_d(f,m).toMarkup();return g},qp=function(f,m){var g=new E(m);return yd(f,g)},Sh=function(f,m,g){if(g.throwOnError||!(f instanceof a))throw f;var w=Fe.makeSpan(["katex-error"],[new pt(m)]);return w.setAttribute("title",f.toString()),w.setAttribute("style","color:"+g.errorColor),w},_d=function(f,m){var g=new E(m);try{var w=yd(f,g);return Iu(w,f,g)}catch(k){return Sh(k,f,g)}},jp=function(f,m){var g=new E(m);try{var w=yd(f,g);return Os(w,f,g)}catch(k){return Sh(k,f,g)}},Xp={version:"0.13.24",render:wh,renderToString:Gp,ParseError:a,__parse:qp,__renderToDomTree:_d,__renderToHTMLTree:jp,__setFontMetrics:ht,__defineSymbol:R,__defineMacro:te,__domTree:{Span:on,Anchor:Mn,SymbolNode:pt,SvgNode:Tt,PathNode:Rt,LineNode:$n}},Kp=Xp;return r=r.default,r}()})}(S0)),S0.exports}var rR=nR();const iR=eR(rR),aR=(t,e={},n)=>{const{props:r,domProps:i,on:a,...s}=e,o={...s,...r,...i,...(l=>l?Object.entries(l).reduce((u,[c,d])=>({...u,[c=`on${c=c.charAt(0).toUpperCase()+c.slice(1)}`]:d}),{}):null)(a)};return qa(t,o,n)};var M0=hp({name:"VueLatex",props:{fontsize:{type:Number,default:16},expression:{type:String,required:!0},displayMode:{type:Boolean,default:!1},throwOnError:{type:Boolean,default:!1},errorColor:{type:String,default:void 0},minRuleThickness:{type:Number,default:.04},macros:{type:Object,default:void 0},colorIsTextColor:{type:Boolean,default:void 0},maxSize:{type:Number,default:void 0},maxExpand:{type:Number,default:void 0},allowedProtocols:{type:Array,default:void 0},strict:{type:[Boolean,String,Function],default:void 0}},setup:t=>({html:Be(()=>iR.renderToString(t.expression,t))}),render(){return aR(this.displayMode?"div":"span",{domProps:{innerHTML:this.html},style:{"font-size":`${this.fontsize}px`}})}});M0.install=t=>{t.component(M0.name,M0)};const sR="/facet/assets/FACET%20Website%20Head-B2JVgyKT.mp4",oR="/facet/assets/head.drawio-Dhm01EW4.png",lR="/facet/assets/demo-Dm3In2dS.mp4",uR="/facet/assets/imp_ctrl-CFH5YFy9.gif",cR="/facet/assets/method-left.drawio-BEYdQTGK.png",dR="/facet/assets/method-right.drawio-BYdVMEY5.png",fR="/facet/assets/teacher-student.drawio-DhY5S2bK.png",hR="/facet/assets/survival-nQoMfc0A.png",pR="/facet/assets/traj_impulse-5jdImLFb.png",mR="/facet/assets/impulse_dist-Bu5zvlh8.png",gR=Et({...In(),...VI({fullHeight:!0}),...Kr()},"VApp"),w8=Jt()({name:"VApp",props:gR(),setup(t,e){let{slots:n}=e;const r=Ri(t),{layoutClasses:i,getLayoutItem:a,items:s,layoutRef:o}=jI(t),{rtlClasses:l}=Sa();return vn(()=>{var u;return Te("div",{ref:o,class:Wt(["v-application",r.themeClasses.value,i.value,l.value,t.class]),style:yn([t.style])},[Te("div",{class:"v-application__wrap"},[(u=n.default)==null?void 0:u.call(n)])])}),{getLayoutItem:a,items:s,theme:r}}}),vR=Et({app:Boolean,color:String,height:{type:[Number,String],default:"auto"},...ll(),...In(),...cl(),...HI(),...ja(),...br({tag:"footer"}),...Kr()},"VFooter"),yR=Jt()({name:"VFooter",props:vR(),setup(t,e){let{slots:n}=e;const r=cn(),{themeClasses:i}=Ri(t),{backgroundColorClasses:a,backgroundColorStyles:s}=ra(()=>t.color),{borderClasses:o}=ul(t),{elevationClasses:l}=dl(t),{roundedClasses:u}=Xa(t),c=rn(32),{resizeRef:d}=Sf(v=>{v.length&&(c.value=v[0].target.clientHeight)}),h=Be(()=>t.height==="auto"?c.value:parseInt(t.height,10));return du(()=>t.app,()=>{const v=GI({id:t.name,order:Be(()=>parseInt(t.order,10)),position:dt(()=>"bottom"),layoutSize:h,elementSize:Be(()=>t.height==="auto"?void 0:h.value),active:dt(()=>t.app),absolute:dt(()=>t.absolute)});lo(()=>{r.value=v.layoutItemStyles.value})}),vn(()=>le(t.tag,{ref:d,class:Wt(["v-footer",i.value,a.value,o.value,l.value,u.value,t.class]),style:yn([s.value,t.app?r.value:{height:nn(t.height)},t.style])},n)),{}}}),Rv=Symbol.for("vuetify:list");function S8(){let{filterable:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{filterable:!1};const e=Fn(Rv,{filterable:!1,hasPrepend:rn(!1),updateHasPrepend:()=>null}),n={filterable:e.filterable||t,hasPrepend:rn(!1),updateHasPrepend:r=>{r&&(n.hasPrepend.value=r)}};return Lr(Rv,n),e}function M8(){return Fn(Rv,null)}const X1=t=>{const e={activate:n=>{let{id:r,value:i,activated:a}=n;return r=en(r),t&&!i&&a.size===1&&a.has(r)||(i?a.add(r):a.delete(r)),a},in:(n,r,i)=>{let a=new Set;if(n!=null)for(const s of xs(n))a=e.activate({id:s,value:!0,activated:new Set(a),children:r,parents:i});return a},out:n=>Array.from(n)};return e},E8=t=>{const e=X1(t);return{activate:r=>{let{activated:i,id:a,...s}=r;a=en(a);const o=i.has(a)?new Set([a]):new Set;return e.activate({...s,id:a,activated:o})},in:(r,i,a)=>{let s=new Set;if(r!=null){const o=xs(r);o.length&&(s=e.in(o.slice(0,1),i,a))}return s},out:(r,i,a)=>e.out(r,i,a)}},_R=t=>{const e=X1(t);return{activate:r=>{let{id:i,activated:a,children:s,...o}=r;return i=en(i),s.has(i)?a:e.activate({id:i,activated:a,children:s,...o})},in:e.in,out:e.out}},bR=t=>{const e=E8(t);return{activate:r=>{let{id:i,activated:a,children:s,...o}=r;return i=en(i),s.has(i)?a:e.activate({id:i,activated:a,children:s,...o})},in:e.in,out:e.out}},xR={open:t=>{let{id:e,value:n,opened:r,parents:i}=t;if(n){const a=new Set;a.add(e);let s=i.get(e);for(;s!=null;)a.add(s),s=i.get(s);return a}else return r.delete(e),r},select:()=>null},T8={open:t=>{let{id:e,value:n,opened:r,parents:i}=t;if(n){let a=i.get(e);for(r.add(e);a!=null&&a!==e;)r.add(a),a=i.get(a);return r}else r.delete(e);return r},select:()=>null},wR={open:T8.open,select:t=>{let{id:e,value:n,opened:r,parents:i}=t;if(!n)return r;const a=[];let s=i.get(e);for(;s!=null;)a.push(s),s=i.get(s);return new Set(a)}},K1=t=>{const e={select:n=>{let{id:r,value:i,selected:a}=n;if(r=en(r),t&&!i){const s=Array.from(a.entries()).reduce((o,l)=>{let[u,c]=l;return c==="on"&&o.push(u),o},[]);if(s.length===1&&s[0]===r)return a}return a.set(r,i?"on":"off"),a},in:(n,r,i,a)=>{const s=new Map;for(const o of n||[])e.select({id:o,value:!0,selected:s,children:r,parents:i,disabled:a});return s},out:n=>{const r=[];for(const[i,a]of n.entries())a==="on"&&r.push(i);return r}};return e},C8=t=>{const e=K1(t);return{select:r=>{let{selected:i,id:a,...s}=r;a=en(a);const o=i.has(a)?new Map([[a,i.get(a)]]):new Map;return e.select({...s,id:a,selected:o})},in:(r,i,a,s)=>r!=null&&r.length?e.in(r.slice(0,1),i,a,s):new Map,out:(r,i,a)=>e.out(r,i,a)}},SR=t=>{const e=K1(t);return{select:r=>{let{id:i,selected:a,children:s,...o}=r;return i=en(i),s.has(i)?a:e.select({id:i,selected:a,children:s,...o})},in:e.in,out:e.out}},MR=t=>{const e=C8(t);return{select:r=>{let{id:i,selected:a,children:s,...o}=r;return i=en(i),s.has(i)?a:e.select({id:i,selected:a,children:s,...o})},in:e.in,out:e.out}},A8=t=>{const e={select:n=>{let{id:r,value:i,selected:a,children:s,parents:o,disabled:l}=n;r=en(r);const u=new Map(a),c=[r];for(;c.length;){const h=c.shift();l.has(h)||a.set(en(h),i?"on":"off"),s.has(h)&&c.push(...s.get(h))}let d=en(o.get(r));for(;d;){let h=!0,v=!0;for(const x of s.get(d)){const _=en(x);if(!l.has(_)&&(a.get(_)!=="on"&&(h=!1),a.has(_)&&a.get(_)!=="off"&&(v=!1),!h&&!v))break}a.set(d,h?"on":v?"off":"indeterminate"),d=en(o.get(d))}return t&&!i&&Array.from(a.entries()).reduce((v,x)=>{let[_,b]=x;return b==="on"&&v.push(_),v},[]).length===0?u:a},in:(n,r,i,a)=>{let s=new Map;for(const o of n||[])s=e.select({id:o,value:!0,selected:s,children:r,parents:i,disabled:a});return s},out:(n,r)=>{const i=[];for(const[a,s]of n.entries())s==="on"&&!r.has(a)&&i.push(a);return i}};return e},ER=t=>{const e=A8(t);return{select:e.select,in:e.in,out:(r,i,a)=>{const s=[];for(const[o,l]of r.entries())if(l==="on"){if(a.has(o)){const u=a.get(o);if(r.get(u)==="on")continue}s.push(o)}return s}}},kf=Symbol.for("vuetify:nested"),k8={id:rn(),root:{register:()=>null,unregister:()=>null,children:cn(new Map),parents:cn(new Map),disabled:cn(new Set),open:()=>null,openOnSelect:()=>null,activate:()=>null,select:()=>null,activatable:cn(!1),selectable:cn(!1),opened:cn(new Set),activated:cn(new Set),selected:cn(new Map),selectedValues:cn([]),getPath:()=>[]}},TR=Et({activatable:Boolean,selectable:Boolean,activeStrategy:[String,Function,Object],selectStrategy:[String,Function,Object],openStrategy:[String,Object],opened:null,activated:null,selected:null,mandatory:Boolean},"nested"),CR=t=>{let e=!1;const n=rn(new Map),r=rn(new Map),i=rn(new Set),a=jr(t,"opened",t.opened,_=>new Set(Array.isArray(_)?_.map(b=>en(b)):_),_=>[..._.values()]),s=Be(()=>{if(typeof t.activeStrategy=="object")return t.activeStrategy;if(typeof t.activeStrategy=="function")return t.activeStrategy(t.mandatory);switch(t.activeStrategy){case"leaf":return _R(t.mandatory);case"single-leaf":return bR(t.mandatory);case"independent":return X1(t.mandatory);case"single-independent":default:return E8(t.mandatory)}}),o=Be(()=>{if(typeof t.selectStrategy=="object")return t.selectStrategy;if(typeof t.selectStrategy=="function")return t.selectStrategy(t.mandatory);switch(t.selectStrategy){case"single-leaf":return MR(t.mandatory);case"leaf":return SR(t.mandatory);case"independent":return K1(t.mandatory);case"single-independent":return C8(t.mandatory);case"trunk":return ER(t.mandatory);case"classic":default:return A8(t.mandatory)}}),l=Be(()=>{if(typeof t.openStrategy=="object")return t.openStrategy;switch(t.openStrategy){case"list":return wR;case"single":return xR;case"multiple":default:return T8}}),u=jr(t,"activated",t.activated,_=>s.value.in(_,n.value,r.value),_=>s.value.out(_,n.value,r.value)),c=jr(t,"selected",t.selected,_=>o.value.in(_,n.value,r.value,i.value),_=>o.value.out(_,n.value,r.value));sa(()=>{e=!0});function d(_){const b=[];let S=en(_);for(;S!=null;)b.unshift(S),S=r.value.get(S);return b}const h=kr("nested"),v=new Set,x={id:rn(),root:{opened:a,activatable:dt(()=>t.activatable),selectable:dt(()=>t.selectable),activated:u,selected:c,selectedValues:Be(()=>{const _=[];for(const[b,S]of c.value.entries())S==="on"&&_.push(b);return _}),register:(_,b,S,E)=>{if(v.has(_)){d(_).map(String).join(" -> "),d(b).concat(_).map(String).join(" -> ");return}else v.add(_);b&&_!==b&&r.value.set(_,b),S&&i.value.add(_),E&&n.value.set(_,[]),b!=null&&n.value.set(b,[...n.value.get(b)||[],_])},unregister:_=>{if(e)return;v.delete(_),n.value.delete(_),i.value.delete(_);const b=r.value.get(_);if(b){const S=n.value.get(b)??[];n.value.set(b,S.filter(E=>E!==_))}r.value.delete(_)},open:(_,b,S)=>{h.emit("click:open",{id:_,value:b,path:d(_),event:S});const E=l.value.open({id:_,value:b,opened:new Set(a.value),children:n.value,parents:r.value,event:S});E&&(a.value=E)},openOnSelect:(_,b,S)=>{const E=l.value.select({id:_,value:b,selected:new Map(c.value),opened:new Set(a.value),children:n.value,parents:r.value,event:S});E&&(a.value=E)},select:(_,b,S)=>{h.emit("click:select",{id:_,value:b,path:d(_),event:S});const E=o.value.select({id:_,value:b,selected:new Map(c.value),children:n.value,parents:r.value,disabled:i.value,event:S});E&&(c.value=E),x.root.openOnSelect(_,b,S)},activate:(_,b,S)=>{if(!t.activatable)return x.root.select(_,!0,S);h.emit("click:activate",{id:_,value:b,path:d(_),event:S});const E=s.value.activate({id:_,value:b,activated:new Set(u.value),children:n.value,parents:r.value,event:S});if(E.size!==u.value.size)u.value=E;else{for(const C of E)if(!u.value.has(C)){u.value=E;return}for(const C of u.value)if(!E.has(C)){u.value=E;return}}},children:n,parents:r,disabled:i,getPath:d}};return Lr(kf,x),x.root},I8=(t,e,n)=>{const r=Fn(kf,k8),i=Symbol("nested item"),a=Be(()=>en(Ms(t))??i),s={...r,id:a,open:(o,l)=>r.root.open(a.value,o,l),openOnSelect:(o,l)=>r.root.openOnSelect(a.value,o,l),isOpen:Be(()=>r.root.opened.value.has(a.value)),parent:Be(()=>r.root.parents.value.get(a.value)),activate:(o,l)=>r.root.activate(a.value,o,l),isActivated:Be(()=>r.root.activated.value.has(a.value)),select:(o,l)=>r.root.select(a.value,o,l),isSelected:Be(()=>r.root.selected.value.get(a.value)==="on"),isIndeterminate:Be(()=>r.root.selected.value.get(a.value)==="indeterminate"),isLeaf:Be(()=>!r.root.children.value.get(a.value)),isGroupActivator:r.isGroupActivator};return Of(()=>{r.isGroupActivator||r.root.register(a.value,r.id.value,Ms(e),n)}),sa(()=>{r.isGroupActivator||r.root.unregister(a.value)}),n&&Lr(kf,s),s},AR=()=>{const t=Fn(kf,k8);Lr(kf,{...t,isGroupActivator:!0})};function Y1(){const t=rn(!1);return ol(()=>{window.requestAnimationFrame(()=>{t.value=!0})}),{ssrBootStyles:dt(()=>t.value?void 0:{transition:"none !important"}),isBooted:Lf(t)}}const kR=Gc({name:"VListGroupActivator",setup(t,e){let{slots:n}=e;return AR(),()=>{var r;return(r=n.default)==null?void 0:r.call(n)}}}),IR=Et({activeColor:String,baseColor:String,color:String,collapseIcon:{type:pr,default:"$collapse"},disabled:Boolean,expandIcon:{type:pr,default:"$expand"},rawId:[String,Number],prependIcon:pr,appendIcon:pr,fluid:Boolean,subgroup:Boolean,title:String,value:null,...In(),...br()},"VListGroup"),j_=Jt()({name:"VListGroup",props:IR(),setup(t,e){let{slots:n}=e;const{isOpen:r,open:i,id:a}=I8(()=>t.value,()=>t.disabled,!0),s=Be(()=>`v-list-group--id-${String(t.rawId??a.value)}`),o=M8(),{isBooted:l}=Y1();function u(v){var x;["INPUT","TEXTAREA"].includes((x=v.target)==null?void 0:x.tagName)||i(!r.value,v)}const c=Be(()=>({onClick:u,class:"v-list-group__header",id:s.value})),d=Be(()=>r.value?t.collapseIcon:t.expandIcon),h=Be(()=>({VListItem:{activeColor:t.activeColor,baseColor:t.baseColor,color:t.color,prependIcon:t.prependIcon||t.subgroup&&d.value,appendIcon:t.appendIcon||!t.subgroup&&d.value,title:t.title,value:t.value}}));return vn(()=>le(t.tag,{class:Wt(["v-list-group",{"v-list-group--prepend":o==null?void 0:o.hasPrepend.value,"v-list-group--fluid":t.fluid,"v-list-group--subgroup":t.subgroup,"v-list-group--open":r.value},t.class]),style:yn(t.style)},{default:()=>[n.activator&&le(Ua,{defaults:h.value},{default:()=>[le(kR,null,{default:()=>[n.activator({props:c.value,isOpen:r.value})]})]}),le(Ko,{transition:{component:b8},disabled:!l.value},{default:()=>{var v;return[Hi(Te("div",{class:"v-list-group__items",role:"group","aria-labelledby":s.value},[(v=n.default)==null?void 0:v.call(n)]),[[yu,r.value]])]}})]})),{isOpen:r}}}),$R=Et({opacity:[Number,String],...In(),...br()},"VListItemSubtitle"),PR=Jt()({name:"VListItemSubtitle",props:$R(),setup(t,e){let{slots:n}=e;return vn(()=>le(t.tag,{class:Wt(["v-list-item-subtitle",t.class]),style:yn([{"--v-list-item-subtitle-opacity":t.opacity},t.style])},n)),{}}}),RR=R1("v-list-item-title"),DR=Et({active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:pr,baseColor:String,disabled:Boolean,lines:[Boolean,String],link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:pr,ripple:{type:[Boolean,Object],default:!0},slim:Boolean,subtitle:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},value:null,onClick:to(),onClickOnce:to(),...ll(),...In(),...As(),...ks(),...cl(),...ja(),...W1(),...br(),...Kr(),...qc({variant:"text"})},"VListItem"),uf=Jt()({name:"VListItem",directives:{vRipple:io},props:DR(),emits:{click:t=>!0},setup(t,e){let{attrs:n,slots:r,emit:i}=e;const a=H1(t,n),s=Be(()=>t.value===void 0?a.href.value:t.value),{activate:o,isActivated:l,select:u,isOpen:c,isSelected:d,isIndeterminate:h,isGroupActivator:v,root:x,parent:_,openOnSelect:b,id:S}=I8(s,()=>t.disabled,!1),E=M8(),C=Be(()=>{var ne;return t.active!==!1&&(t.active||((ne=a.isActive)==null?void 0:ne.value)||(x.activatable.value?l.value:d.value))}),A=dt(()=>t.link!==!1&&a.isLink.value),D=Be(()=>!!E&&(x.selectable.value||x.activatable.value||t.value!=null)),O=Be(()=>!t.disabled&&t.link!==!1&&(t.link||a.isClickable.value||D.value)),V=dt(()=>t.rounded||t.nav),P=dt(()=>t.color??t.activeColor),U=dt(()=>({color:C.value?P.value??t.baseColor:t.baseColor,variant:t.variant}));An(()=>{var ne;return(ne=a.isActive)==null?void 0:ne.value},ne=>{ne&&Y()}),Of(()=>{var ne;(ne=a.isActive)!=null&&ne.value&&Y()});function Y(){_.value!=null&&x.open(_.value,!0),b(!0)}const{themeClasses:fe}=Ri(t),{borderClasses:Q}=ul(t),{colorClasses:G,colorStyles:re,variantClasses:he}=wp(U),{densityClasses:ye}=uo(t),{dimensionStyles:$e}=Is(t),{elevationClasses:_e}=dl(t),{roundedClasses:de}=Xa(V),Oe=dt(()=>t.lines?`v-list-item--${t.lines}-line`:void 0),ve=dt(()=>t.ripple!==void 0&&t.ripple&&(E!=null&&E.filterable)?{keys:["Enter"]}:t.ripple),ie=Be(()=>({isActive:C.value,select:u,isOpen:c.value,isSelected:d.value,isIndeterminate:h.value}));function Pe(ne){var qe,ge;i("click",ne),!["INPUT","TEXTAREA"].includes((qe=ne.target)==null?void 0:qe.tagName)&&O.value&&((ge=a.navigate)==null||ge.call(a,ne),!v&&(x.activatable.value?o(!l.value,ne):(x.selectable.value||t.value!=null)&&u(!d.value,ne)))}function et(ne){const qe=ne.target;["INPUT","TEXTAREA"].includes(qe.tagName)||(ne.key==="Enter"||ne.key===" "&&!(E!=null&&E.filterable))&&(ne.preventDefault(),ne.stopPropagation(),ne.target.dispatchEvent(new MouseEvent("click",ne)))}return vn(()=>{const ne=A.value?"a":t.tag,qe=r.title||t.title!=null,ge=r.subtitle||t.subtitle!=null,xe=!!(t.appendAvatar||t.appendIcon),ze=!!(xe||r.append),Ge=!!(t.prependAvatar||t.prependIcon),ut=!!(Ge||r.prepend);return E==null||E.updateHasPrepend(ut),t.activeColor&&i6("active-color",["color","base-color"]),Hi(le(ne,Rn({class:["v-list-item",{"v-list-item--active":C.value,"v-list-item--disabled":t.disabled,"v-list-item--link":O.value,"v-list-item--nav":t.nav,"v-list-item--prepend":!ut&&(E==null?void 0:E.hasPrepend.value),"v-list-item--slim":t.slim,[`${t.activeClass}`]:t.activeClass&&C.value},fe.value,Q.value,G.value,ye.value,_e.value,Oe.value,de.value,he.value,t.class],style:[re.value,$e.value,t.style],tabindex:O.value?E?-2:0:void 0,"aria-selected":D.value?x.activatable.value?l.value:x.selectable.value?d.value:C.value:void 0,onClick:Pe,onKeydown:O.value&&!A.value&&et},a.linkProps),{default:()=>{var ce;return[xp(O.value||C.value,"v-list-item"),ut&&Te("div",{key:"prepend",class:"v-list-item__prepend"},[r.prepend?le(Ua,{key:"prepend-defaults",disabled:!Ge,defaults:{VAvatar:{density:t.density,image:t.prependAvatar},VIcon:{density:t.density,icon:t.prependIcon},VListItemAction:{start:!0}}},{default:()=>{var me;return[(me=r.prepend)==null?void 0:me.call(r,ie.value)]}}):Te(On,null,[t.prependAvatar&&le(Af,{key:"prepend-avatar",density:t.density,image:t.prependAvatar},null),t.prependIcon&&le(yr,{key:"prepend-icon",density:t.density,icon:t.prependIcon},null)]),Te("div",{class:"v-list-item__spacer"},null)]),Te("div",{class:"v-list-item__content","data-no-activator":""},[qe&&le(RR,{key:"title"},{default:()=>{var me;return[((me=r.title)==null?void 0:me.call(r,{title:t.title}))??fr(t.title)]}}),ge&&le(PR,{key:"subtitle"},{default:()=>{var me;return[((me=r.subtitle)==null?void 0:me.call(r,{subtitle:t.subtitle}))??fr(t.subtitle)]}}),(ce=r.default)==null?void 0:ce.call(r,ie.value)]),ze&&Te("div",{key:"append",class:"v-list-item__append"},[r.append?le(Ua,{key:"append-defaults",disabled:!xe,defaults:{VAvatar:{density:t.density,image:t.appendAvatar},VIcon:{density:t.density,icon:t.appendIcon},VListItemAction:{end:!0}}},{default:()=>{var me;return[(me=r.append)==null?void 0:me.call(r,ie.value)]}}):Te(On,null,[t.appendIcon&&le(yr,{key:"append-icon",density:t.density,icon:t.appendIcon},null),t.appendAvatar&&le(Af,{key:"append-avatar",density:t.density,image:t.appendAvatar},null)]),Te("div",{class:"v-list-item__spacer"},null)])]}}),[[io,O.value&&ve.value]])}),{activate:o,isActivated:l,isGroupActivator:v,isSelected:d,list:E,select:u,root:x,id:S,link:a}}}),LR=Et({color:String,inset:Boolean,sticky:Boolean,title:String,...In(),...br()},"VListSubheader"),zR=Jt()({name:"VListSubheader",props:LR(),setup(t,e){let{slots:n}=e;const{textColorClasses:r,textColorStyles:i}=Es(()=>t.color);return vn(()=>{const a=!!(n.default||t.title);return le(t.tag,{class:Wt(["v-list-subheader",{"v-list-subheader--inset":t.inset,"v-list-subheader--sticky":t.sticky},r.value,t.class]),style:yn([{textColorStyles:i},t.style])},{default:()=>{var s;return[a&&Te("div",{class:"v-list-subheader__text"},[((s=n.default)==null?void 0:s.call(n))??t.title])]}})}),{}}}),OR=Et({items:Array,returnObject:Boolean},"VListChildren"),$8=Jt()({name:"VListChildren",props:OR(),setup(t,e){let{slots:n}=e;return S8(),()=>{var r,i;return((r=n.default)==null?void 0:r.call(n))??((i=t.items)==null?void 0:i.map(a=>{var h,v;let{children:s,props:o,type:l,raw:u}=a;if(l==="divider")return((h=n.divider)==null?void 0:h.call(n,{props:o}))??le(lf,o,null);if(l==="subheader")return((v=n.subheader)==null?void 0:v.call(n,{props:o}))??le(zR,o,null);const c={subtitle:n.subtitle?x=>{var _;return(_=n.subtitle)==null?void 0:_.call(n,{...x,item:u})}:void 0,prepend:n.prepend?x=>{var _;return(_=n.prepend)==null?void 0:_.call(n,{...x,item:u})}:void 0,append:n.append?x=>{var _;return(_=n.append)==null?void 0:_.call(n,{...x,item:u})}:void 0,title:n.title?x=>{var _;return(_=n.title)==null?void 0:_.call(n,{...x,item:u})}:void 0},d=j_.filterProps(o);return s?le(j_,Rn(d,{value:t.returnObject?u:o==null?void 0:o.value,rawId:o==null?void 0:o.value}),{activator:x=>{let{props:_}=x;const b=Rn(o,_,{value:t.returnObject?u:o.value});return n.header?n.header({props:b}):le(uf,b,c)},default:()=>le($8,{items:s,returnObject:t.returnObject},n)}):n.item?n.item({props:o}):le(uf,Rn(o,{value:t.returnObject?u:o.value}),c)}))}}}),NR=Et({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},itemType:{type:[Boolean,String,Array,Function],default:"type"},returnObject:Boolean,valueComparator:Function},"list-items"),BR=new Set(["item","divider","subheader"]);function FR(t,e){const n=H2(e)?e:Md(e,t.itemTitle),r=H2(e)?e:Md(e,t.itemValue,void 0),i=Md(e,t.itemChildren),a=t.itemProps===!0?Hc(e,["children"]):Md(e,t.itemProps);let s=Md(e,t.itemType,"item");BR.has(s)||(s="item");const o={title:n,value:r,...a};return{type:s,title:o.title,value:o.value,props:o,children:s==="item"&&i?P8(t,i):void 0,raw:e}}function P8(t,e){const n=[];for(const r of e)n.push(FR(t,r));return n}function UR(t){return{items:Be(()=>P8(t,t.items))}}const VR=Et({baseColor:String,activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,filterable:Boolean,expandIcon:pr,collapseIcon:pr,lines:{type:[Boolean,String],default:"one"},slim:Boolean,nav:Boolean,"onClick:open":to(),"onClick:select":to(),"onUpdate:opened":to(),...TR({selectStrategy:"single-leaf",openStrategy:"list"}),...ll(),...In(),...As(),...ks(),...cl(),...NR(),...ja(),...br(),...Kr(),...qc({variant:"text"})},"VList"),HR=Jt()({name:"VList",props:VR(),emits:{"update:selected":t=>!0,"update:activated":t=>!0,"update:opened":t=>!0,"click:open":t=>!0,"click:activate":t=>!0,"click:select":t=>!0},setup(t,e){let{slots:n}=e;const{items:r}=UR(t),{themeClasses:i}=Ri(t),{backgroundColorClasses:a,backgroundColorStyles:s}=ra(()=>t.bgColor),{borderClasses:o}=ul(t),{densityClasses:l}=uo(t),{dimensionStyles:u}=Is(t),{elevationClasses:c}=dl(t),{roundedClasses:d}=Xa(t),{children:h,open:v,parents:x,select:_,getPath:b}=CR(t),S=dt(()=>t.lines?`v-list--${t.lines}-line`:void 0),E=dt(()=>t.activeColor),C=dt(()=>t.baseColor),A=dt(()=>t.color);S8({filterable:t.filterable}),Wc({VListGroup:{activeColor:E,baseColor:C,color:A,expandIcon:dt(()=>t.expandIcon),collapseIcon:dt(()=>t.collapseIcon)},VListItem:{activeClass:dt(()=>t.activeClass),activeColor:E,baseColor:C,color:A,density:dt(()=>t.density),disabled:dt(()=>t.disabled),lines:dt(()=>t.lines),nav:dt(()=>t.nav),slim:dt(()=>t.slim),variant:dt(()=>t.variant)}});const D=rn(!1),O=cn();function V(G){D.value=!0}function P(G){D.value=!1}function U(G){var re;!D.value&&!(G.relatedTarget&&((re=O.value)!=null&&re.contains(G.relatedTarget)))&&Q()}function Y(G){const re=G.target;if(!(!O.value||re.tagName==="INPUT"&&["Home","End"].includes(G.key)||re.tagName==="TEXTAREA")){if(G.key==="ArrowDown")Q("next");else if(G.key==="ArrowUp")Q("prev");else if(G.key==="Home")Q("first");else if(G.key==="End")Q("last");else return;G.preventDefault()}}function fe(G){D.value=!0}function Q(G){if(O.value)return Q5(O.value,G)}return vn(()=>le(t.tag,{ref:O,class:Wt(["v-list",{"v-list--disabled":t.disabled,"v-list--nav":t.nav,"v-list--slim":t.slim},i.value,a.value,o.value,l.value,c.value,S.value,d.value,t.class]),style:yn([s.value,u.value,t.style]),tabindex:t.disabled?-1:0,role:"listbox","aria-activedescendant":void 0,onFocusin:V,onFocusout:P,onFocus:U,onKeydown:Y,onMousedown:fe},{default:()=>[le($8,{items:r.value,returnObject:t.returnObject},n)]})),{open:v,select:_,focus:Q,children:h,parents:x,getPath:b}}}),WR=Et({color:String,...ll(),...In(),...ks(),...cl(),...Ep(),...U1(),...ja(),...br(),...Kr()},"VSheet"),xm=Jt()({name:"VSheet",props:WR(),setup(t,e){let{slots:n}=e;const{themeClasses:r}=Ri(t),{backgroundColorClasses:i,backgroundColorStyles:a}=ra(()=>t.color),{borderClasses:s}=ul(t),{dimensionStyles:o}=Is(t),{elevationClasses:l}=dl(t),{locationStyles:u}=Tp(t),{positionClasses:c}=V1(t),{roundedClasses:d}=Xa(t);return vn(()=>le(t.tag,{class:Wt(["v-sheet",r.value,i.value,s.value,l.value,c.value,d.value,t.class]),style:yn([a.value,o.value,u.value,t.style])},n)),{}}}),GR={name:"App",components:{LazyVideo:x8,VueLatex:M0},data(){return{isHeroVisible:!0,navigationItems:[{text:" Introduction",icon:"mdi-information",target:"introduction"},{text:" Method",icon:"mdi-cog",target:"method"},{text:" Simulation",icon:"mdi-video",target:"simulation"},{text:" Results",icon:"mdi-chart-bar",target:"real-world"},{text:" Ablation",icon:"mdi-microscope",target:"ablation"},{text:" Team",icon:"mdi-account-group",target:"team"}],simulationVideos:[{id:1,src:new URL("/facet/assets/FACET%20B1Z1%20Demo%20(with%20caption)-k9BwiJbz.mp4",import.meta.url).href,title:"B1+Z1 Demo"},{id:2,src:new URL("/facet/assets/g1_impulse_multiple-z2lWKecf.mp4",import.meta.url).href,title:"G1 Impulse"},{id:3,src:new URL("/facet/assets/FACET%20Go2%20Training%20Dist%20(with%20caption)-C8rl9n0H.mp4",import.meta.url).href,title:"Go2 Training"},{id:4,src:new URL("/facet/assets/b1z1_training-CcrKgQeN.mp4",import.meta.url).href,title:"B1+Z1 Training"}],headerLinks:[{text:"ARXIV",icon:"mdi-file-document",href:"https://arxiv.org/abs/2505.06883",disabled:!1},{text:"VIDEO",icon:"mdi-video",href:"https://www.youtube.com/watch?v=T-hyKhv44yg&list=PLrCqEKTrDjGIK4JGnYhJh7SKP152IDDaK&index=2",disabled:!1},{text:"CODE",icon:"mdi-github",href:"https://github.com/btx0424/active-adaptation",disabled:!1}],show_step:1,selectedSimVideo:1,isSnapping:!1,expanded:!1,scrollTimeout:null,observer:null,teamMembers:[{name:"Botian Xu",school:"Tsinghua University",link:"https://btx0424.github.io/",star:!0,avatar:new URL("/facet/assets/botian-UNqNXkiC.jpg",import.meta.url).href},{name:"Haoyang Weng",school:"Tsinghua University",link:"https://egalahad.github.io/",star:!0,avatar:new URL("/facet/assets/haoyang-Cc0ls-ES.jpg",import.meta.url).href},{name:"Qingzhou Lu",school:"Tsinghua University",link:"https://me.axell.top/",star:!0,avatar:new URL("/facet/assets/qingzhou-n7xbePd4.png",import.meta.url).href},{name:"Yang Gao",school:"Tsinghua University<br/>Shanghai Qizhi Institute<br/>Shanghai AI Lab",link:"https://yang-gao.weebly.com/",star:!1,avatar:new URL("/facet/assets/yanggao-DinQXR7a.jpg",import.meta.url).href},{name:"Huazhe Xu",school:"Tsinghua University<br/>Shanghai Qizhi Institute<br/>Shanghai AI Lab",link:"http://hxu.rocks/",star:!1,avatar:new URL("/facet/assets/huazhexu-Dx0V7r2i.png",import.meta.url).href}],realWorldRows:[[{title:"Compliant to Perturb and Pushes (FACET Policy)",src:new URL("/facet/assets/facet-push-compliant-D-gOIBq-.mp4",import.meta.url).href},{title:"Stiff Response of Baselines (Robust Policy)",src:new URL("/facet/assets/velocity-push-stiff-guQNfOFW.mp4",import.meta.url).href}],[{title:"Robust to Large Forces (0.3x)",src:new URL("/facet/assets/facet-side_pull-success-0.3x-DXOQDKWv.mp4",import.meta.url).href},{title:"Failures of Baselines (0.3x)",src:new URL("/facet/assets/default-side_pull-fail-0.3x-DVbfrOPF.mp4",import.meta.url).href}],[{title:"Compliant Following",src:new URL("/facet/assets/compliant_following-BVlP6wLF.mp4",import.meta.url).href},{title:"Large Force Pulling",src:new URL("/facet/assets/large_force_pulling-MZMdZLiE.mp4",import.meta.url).href}]]}},mounted(){window.addEventListener("scroll",this.handleScroll,{passive:!0}),window.addEventListener("wheel",this.preventScroll,{passive:!1}),window.addEventListener("touchmove",this.preventScroll,{passive:!1}),this.observer=new IntersectionObserver(([t])=>{this.isHeroVisible=t.isIntersecting,console.log(this.isHeroVisible)},{threshold:.1}),this.observer.observe(this.$refs.heroSection)},beforeDestroy(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("wheel",this.preventScroll),window.removeEventListener("touchmove",this.preventScroll),this.observer&&this.observer.disconnect()},methods:{openLiveDemo(){this.$router.push("/demo")},scrollToSection(t){const e=document.getElementById(t);e&&e.scrollIntoView({behavior:"smooth",block:"start"})},preventScroll(t){this.isSnapping&&t.preventDefault()},handleScroll(){this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{this.checkVisibilityAndSnap()},1e3)},checkVisibilityAndSnap(){if(this.isSnapping)return;const t=this.$refs.simulationSection.$el.getBoundingClientRect(),e=window.innerHeight,n=Math.min(t.bottom,e)-Math.max(t.top,0),r=t.height;n/r>=.75&&this.doSnap()},doSnap(){this.isSnapping=!0,this.$refs.simulationSection.$el.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{this.isSnapping=!1},600)}}},qR={ref:"heroSection"},jR={key:0,style:{position:"fixed",left:"20px",top:"50%",transform:"translateY(-50%)","z-index":"11"}},XR={class:"cta-content text-center"},KR={style:{width:"100%"}},YR={style:{position:"relative","z-index":"3",height:"100%"}},ZR={key:0,style:{position:"fixed",top:"20px",right:"20px","z-index":"10"}},JR={class:"mt-6 mb-4 text-center text-h6"},QR={key:0},eD={class:"pa-4"},tD={class:"mb-4"},nD={class:"position-relative",style:{height:"100vh"}},rD=["src"],iD={class:"position-absolute d-flex justify-center",style:{bottom:"40px",left:"0",right:"0","z-index":"1"}},aD={class:"text-h6"},sD=["src"],oD=["href"],lD={class:"text-h6"},uD={key:0},cD=["innerHTML"];function dD(t,e,n,r,i,a){const s=x8,o=h5("VueLatex"),l=YP;return Pn(),Oi(w8,null,{default:Ne(()=>[Te("section",qR,[le(us,{fluid:"",class:"hero-section pa-0",style:{height:"100vh",position:"relative"}},{default:Ne(()=>[le(s,{showLoading:!1,playsinline:"",autoplay:"",muted:"",loop:"",class:"hero-video",style:{position:"absolute","min-width":"100%","min-height":"100%",width:"auto",height:"auto","z-index":"1"}},{default:Ne(()=>e[6]||(e[6]=[Te("source",{src:sR,type:"video/mp4"},null,-1)])),_:1,__:[6]}),e[14]||(e[14]=Te("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%","background-color":"rgba(100, 100, 100, 0.4)","z-index":"2"}},null,-1)),t.$vuetify.display.mdAndUp?(Pn(),vr("div",jR,[(Pn(!0),vr(On,null,Po(i.navigationItems,(u,c)=>(Pn(),Oi(Ci,{key:c,text:"",block:"",class:"mb-2 justify-start text-start",onClick:d=>a.scrollToSection(u.target)},{default:Ne(()=>[le(yr,{left:""},{default:Ne(()=>[Mt(fr(u.icon),1)]),_:2},1024),Mt(" "+fr(u.text),1)]),_:2},1032,["onClick"]))),128))])):Qi("",!0),t.$vuetify.display.mdAndUp?(Pn(),vr("div",{key:1,class:"hero-cta",onClick:e[0]||(e[0]=(...u)=>a.openLiveDemo&&a.openLiveDemo(...u))},[e[9]||(e[9]=Te("div",{class:"gradient-mask"},null,-1)),Te("div",XR,[e[8]||(e[8]=Te("div",{style:{width:"100%"}},[Te("p",{class:"cta-text"},[Mt("Play FACET"),Te("br"),Mt("In Your Browser")])],-1)),Te("div",KR,[le(yr,{class:"arrow-icon",large:""},{default:Ne(()=>e[7]||(e[7]=[Mt("mdi-arrow-right-bold",-1)])),_:1,__:[7]})])])])):Qi("",!0),Te("div",YR,[le(us,{class:"d-flex flex-column justify-center align-center text-center",style:{height:"100%"},fluid:""},{default:Ne(()=>[e[10]||(e[10]=Te("h1",{style:{"font-size":"20vw","line-height":"0.95","user-select":"none","-webkit-user-select":"none","-ms-user-select":"none"},class:"font-weight-light mb-4 text-white text-shadow"},"FACET ",-1)),e[11]||(e[11]=Te("h2",{class:"text-h2 font-weight-light mb-8 text-white text-shadow",style:{"font-size":"3.3vw !important"}},[Te("span",{class:"highlight-letter"},"F"),Mt("orce-"),Te("span",{class:"highlight-letter"},"A"),Mt("daptive "),Te("span",{class:"highlight-letter"},"C"),Mt("ontrol via Imp"),Te("span",{class:"highlight-letter"},"e"),Mt("dance"),Te("br"),Mt(" Reference "),Te("span",{class:"highlight-letter"},"T"),Mt("racking for Legged Robots ")],-1)),Te("div",null,[le(si,{class:"d-flex",style:{"flex-wrap":"wrap"},justify:"center"},{default:Ne(()=>[(Pn(!0),vr(On,null,Po(i.headerLinks,(u,c)=>(Pn(),Oi(Mr,{key:c,cols:"auto"},{default:Ne(()=>[le(Ci,{color:"primary",rounded:"",size:t.$vuetify.display.mdAndUp?"x-large":"default",href:u.href,target:"_blank",text:"",disabled:u.disabled},{default:Ne(()=>[le(yr,{left:""},{default:Ne(()=>[Mt(fr(u.icon),1)]),_:2},1024),Mt(" "+fr(u.text),1)]),_:2},1032,["size","href","disabled"])]),_:2},1024))),128))]),_:1})])]),_:1,__:[10,11]})]),le(K0,null,{default:Ne(()=>[t.$vuetify.display.mdAndUp&&!i.isHeroVisible?(Pn(),vr("div",ZR,[le(Ci,{color:"primary",class:"mx-1",onClick:a.openLiveDemo},{default:Ne(()=>[le(yr,{left:""},{default:Ne(()=>e[12]||(e[12]=[Mt("mdi-play-circle",-1)])),_:1,__:[12]}),e[13]||(e[13]=Mt(" Play FACET ",-1))]),_:1,__:[13]},8,["onClick"]),(Pn(!0),vr(On,null,Po(i.headerLinks,(u,c)=>(Pn(),Oi(Ci,{key:c,href:u.href,target:"_blank",text:"",disabled:u.disabled,class:"mx-1"},{default:Ne(()=>[le(yr,{left:""},{default:Ne(()=>[Mt(fr(u.icon),1)]),_:2},1024),Mt(" "+fr(u.text),1)]),_:2},1032,["href","disabled"]))),128))])):Qi("",!0)]),_:1})]),_:1,__:[14]})],512),le(us,{class:"py-12",id:"introduction"},{default:Ne(()=>[le(si,{justify:"center"},{default:Ne(()=>[le(Mr,{cols:"12",md:"10"},{default:Ne(()=>[e[16]||(e[16]=Te("p",{class:"text-h4 text-center mb-6"},"Introduction",-1)),le(si,{justify:"center"},{default:Ne(()=>[le(Mr,{cols:"12",md:"12",lg:"12"},{default:Ne(()=>[le(ya,{src:oR,contain:""})]),_:1})]),_:1}),le(si,null,{default:Ne(()=>[le(Mr,{cols:"12",md:"12",lg:"12"},{default:Ne(()=>e[15]||(e[15]=[Te("div",{class:"text-body-1"},[Te("p",{class:"mb-4"}," Recent advances in reinforcement learning (RL) for robotics have shown incredibly agile movements such as parkour, dancing. However, most control policies overlook one crucial aspect: responding adaptively and compliantly to external forces during object manipulation and human interaction. "),Te("p",{class:"mb-4"},[Te("strong",null,"FACET"),Mt(" introduces a framework for force-adaptive control of legged robots. Inspired by impedance control, "),Te("strong",null,"FACET"),Mt(" trains a control policy to imitate a virtual mass-spring-damper system with RL, allowing fine-grained control under external forces by manipulating the virtual spring, and smoothly transition between compliant behavior and forceful actions. ")]),Te("p",{class:"mb-4"}," Such intuitive interface enables a wide range of applications. A high compliance allows the robot to be stopped or kinesthetically guided with ease (a), while a high stiffness allows the robot to exert large forces when pushing/pulling a payload (b). The framework applies to different morphologies and more complex configurations (c). ")],-1)])),_:1,__:[15]})]),_:1})]),_:1,__:[16]})]),_:1}),le(si,{justify:"center"},{default:Ne(()=>[le(Mr,{cols:"12",md:"10",class:"text-body-1"},{default:Ne(()=>[le(xm,{color:"rgb(210, 227, 252)",class:"pa-4"},{default:Ne(()=>[e[23]||(e[23]=Te("p",{class:"mb-4"}," Key Capabilities: ",-1)),le(HR,{"bg-color":"transparent"},{default:Ne(()=>[le(uf,null,{default:Ne(()=>[le(yr,{color:"primary",class:"mr-2"},{default:Ne(()=>e[17]||(e[17]=[Mt("mdi-shield-check",-1)])),_:1,__:[17]}),e[18]||(e[18]=Te("span",null,"Enhanced Safety: Responds naturally to external forces, reducing collision impacts by up to 80%",-1))]),_:1,__:[18]}),le(uf,null,{default:Ne(()=>[le(yr,{color:"primary",class:"mr-2"},{default:Ne(()=>e[19]||(e[19]=[Mt("mdi-arm-flex",-1)])),_:1,__:[19]}),e[20]||(e[20]=Te("span",null,"Adaptive Strength: Handles significant forces - from gentle guidance to pulling 10kg loads",-1))]),_:1,__:[20]}),le(uf,null,{default:Ne(()=>[le(yr,{color:"primary",class:"mr-2"},{default:Ne(()=>e[21]||(e[21]=[Mt("mdi-robot",-1)])),_:1,__:[21]}),e[22]||(e[22]=Te("span",null,"Versatile Application: Successfully implemented across quadrupeds, humanoids, and loco-manipulator systems",-1))]),_:1,__:[22]})]),_:1})]),_:1,__:[23]})]),_:1})]),_:1})]),_:1}),le(us,{class:"py-12",id:"online-demo"},{default:Ne(()=>[le(si,{justify:"center"},{default:Ne(()=>[le(Mr,{cols:"12",md:"10",lg:"8",xl:"6",class:"text-center"},{default:Ne(()=>[e[30]||(e[30]=Te("p",{class:"text-h4 text-center mb-6"},"Online Demo",-1)),le(xm,{color:"grey lighten-2",class:"d-flex align-center justify-center mt-6"},{default:Ne(()=>[le(s,{width:"100%",height:"100%",autoplay:"",loop:"",muted:""},{default:Ne(()=>e[24]||(e[24]=[Te("source",{src:lR,type:"video/mp4"},null,-1)])),_:1,__:[24]})]),_:1}),Te("div",JR,[e[25]||(e[25]=Te("strong",null,"Experience FACET in Action! No installation required.",-1)),e[26]||(e[26]=Mt()),e[27]||(e[27]=Te("br",null,null,-1)),t.$vuetify.display.smAndUp?Qi("",!0):(Pn(),vr("strong",QR,"Larger screen recommended."))]),le(Ci,{color:"primary",class:"mx-auto",onClick:a.openLiveDemo,large:""},{default:Ne(()=>[le(yr,{left:""},{default:Ne(()=>e[28]||(e[28]=[Mt("mdi-play-circle",-1)])),_:1,__:[28]}),e[29]||(e[29]=Mt(" Play FACET in Your Browser ",-1))]),_:1,__:[29]},8,["onClick"])]),_:1,__:[30]})]),_:1})]),_:1}),le(us,{class:"py-12 grey lighten-4",id:"method"},{default:Ne(()=>[le(si,{justify:"center"},{default:Ne(()=>[le(Mr,{cols:"12",md:"10"},{default:Ne(()=>[e[66]||(e[66]=Te("h2",{class:"text-h4 text-center mb-6"},"Method",-1)),le(si,null,{default:Ne(()=>[le(Mr,{cols:"12",sm:"6",md:"6"},{default:Ne(()=>[le(l,{expanded:i.expanded,"onUpdate:expanded":e[1]||(e[1]=u=>i.expanded=u)},{media:Ne(()=>[le(ya,{src:uR,height:"300px",contain:"",class:"grey lighten-3"})]),title:Ne(()=>e[31]||(e[31]=[Mt("Impedance Control for Fixed-Base Manipulators",-1)])),subtitle:Ne(()=>e[32]||(e[32]=[Te("strong",null,"FACET",-1),Mt(" is inspired by impedance control. You control the robot by manipulating one end of a virtual spring. The robot behaves like a mass connected on the other end of the spring. ",-1)])),default:Ne(()=>[e[37]||(e[37]=Te("p",null,"Imagine controlling a robot like you're handling a mass connected to a spring: you drag around the other end of the spring, and the mass moves in response. When external forces are applied, the mass will move in the opposite direction of the force, and the spring will push back.",-1)),e[38]||(e[38]=Te("p",null,"The input to an impedance controller is the specifications for a virtual mass-spring-damper system. The robot acts as if tethered to a virtual spring - it can flex and adapt when external forces are applied.",-1)),le(o,{expression:"f_{spring} = K_p(x_{des} - x) + K_d(\\dot{x}_{des} - \\dot{x})","display-mode":""}),Te("p",null,[e[33]||(e[33]=Mt("where ",-1)),le(o,{expression:"K_p"}),e[34]||(e[34]=Mt(" is spring stiffness, ",-1)),le(o,{expression:"K_d"}),e[35]||(e[35]=Mt(" is damping, and ",-1)),le(o,{expression:"\\mathbf{x}_{des}, \\dot{\\mathbf{x}}_{des}"}),e[36]||(e[36]=Mt(" are desired position and velocity. ",-1))])]),_:1,__:[37,38]},8,["expanded"])]),_:1}),le(Mr,{cols:"12",sm:"6",md:"6"},{default:Ne(()=>[le(l,{expanded:i.expanded,"onUpdate:expanded":e[2]||(e[2]=u=>i.expanded=u)},{media:Ne(()=>[le(ya,{src:cR,height:"300px",contain:"",class:"grey lighten-3"})]),title:Ne(()=>e[39]||(e[39]=[Mt("Impedance Reference Model Tracking",-1)])),subtitle:Ne(()=>e[40]||(e[40]=[Te("strong",null,"FACET",-1),Mt(" uses a virtual mass-spring-damper system as a reference model to guide the robot's center of mass motion - the robot learns to imitate this reference model with reinforcement learning. ",-1)])),default:Ne(()=>[e[41]||(e[41]=Te("p",null,[Te("strong",null,"FACET"),Mt(" leverages a virtual mass-spring-damper system as a reference model to guide the robot's center of mass (CoM) motion.")],-1)),e[42]||(e[42]=Te("p",null,'This model defines how the robot should respond to external forces - maintaining a "soft" tracking of its target position while naturally responding to forces.',-1)),le(o,{expression:"m\\ddot{\\mathbf{x}}_{\\text{ref}} = K_p(\\mathbf{x}_{\\text{des}} - \\mathbf{x}_{\\text{ref}}) + K_d(\\dot{\\mathbf{x}}_{\\text{des}} - \\dot{\\mathbf{x}}_{\\text{ref}}) + f_{\\text{ext}}","display-mode":""}),e[43]||(e[43]=Te("p",null,"The robot learns to match this reference behavior through reinforcement learning, enabling control of the robot's CoM behavior by manipulating the virtual spring.",-1))]),_:1,__:[41,42,43]},8,["expanded"])]),_:1}),le(Mr,{cols:"12",sm:"6",md:"6"},{default:Ne(()=>[le(l,{expanded:i.expanded,"onUpdate:expanded":e[3]||(e[3]=u=>i.expanded=u)},{media:Ne(()=>[le(ya,{src:dR,height:"300px",contain:"",class:"grey lighten-3"})]),title:Ne(()=>e[44]||(e[44]=[Mt("Temporal Smoothing of Tracking Targets",-1)])),subtitle:Ne(()=>e[45]||(e[45]=[Te("strong",null,"FACET",-1),Mt(" uses temporal smoothing to balance between open-loop and closed-loop tracking of the reference model.",-1)])),default:Ne(()=>[Te("p",null,[e[46]||(e[46]=Mt("Concretely, the reference state at time ",-1)),le(o,{expression:"t"}),e[47]||(e[47]=Mt(" is obtained by integrating from an initial time ",-1)),le(o,{expression:"t'"}),e[48]||(e[48]=Mt(":",-1))]),le(o,{expression:"\\begin{cases} \\mathbf{x}_{\\text{ref}}(t) = \\mathbf{x}_{\\text{sim}}(t') + \\int_{t'}^t \\dot{\\mathbf{x}}_{\\text{ref}}(t)dt \\\\ \\dot{\\mathbf{x}}_{\\text{ref}}(t) = \\dot{\\mathbf{x}}_{\\text{sim}}(t') + \\int_{t'}^t \\ddot{\\mathbf{x}}_{\\text{ref}}(t)dt \\end{cases}","display-mode":""}),e[58]||(e[58]=Te("p",null,"This approach addresses key challenges: ",-1)),Te("ul",eD,[Te("li",null,[e[49]||(e[49]=Mt("Open-loop tracking (",-1)),le(o,{expression:"t' = 0"}),e[50]||(e[50]=Mt(") follows ideal dynamics but ignores physical constraints, leading to diverging tracking targets that are hard to follow, ",-1))]),Te("li",null,[e[51]||(e[51]=Mt("closed-loop tracking (",-1)),le(o,{expression:"t' = t - \\Delta t"}),e[52]||(e[52]=Mt(") is adaptive but can be noisy.",-1))])]),Te("p",tD,[e[53]||(e[53]=Mt(" The final reward combines multiple tracking targets from different starting points ",-1)),le(o,{expression:"t'"}),e[54]||(e[54]=Mt(": ",-1))]),le(o,{expression:"r_t = \\frac{1}{M} \\sum_{t'} \\exp(-||\\mathbf{x}_{\\text{sim}}(t) - \\mathbf{x}^{t'}_{\\text{ref}}(t)||^2_2) \\\\ + \\exp(-||\\dot{\\mathbf{x}}_{\\text{sim}}(t) - \\dot{\\mathbf{x}}^{t'}_{\\text{ref}}(t)||^2_2)","display-mode":""}),Te("p",null,[e[55]||(e[55]=Mt(" , where ",-1)),le(o,{expression:"t' \\in \\{t-8\\Delta t, t-16\\Delta t, t-32\\Delta t\\}"}),e[56]||(e[56]=Mt(" in our implementation, with ",-1)),le(o,{expression:"\\Delta t = 0.02s"}),e[57]||(e[57]=Mt(" being the control interval. ",-1))])]),_:1,__:[58]},8,["expanded"])]),_:1}),le(Mr,{cols:"12",sm:"6",md:"6"},{default:Ne(()=>[le(l,{expanded:i.expanded,"onUpdate:expanded":e[4]||(e[4]=u=>i.expanded=u)},{media:Ne(()=>[le(ya,{src:fR,height:"300px",contain:"",class:"grey lighten-3"})]),title:Ne(()=>e[59]||(e[59]=[Mt("Two-Stage Teacher-Student Training",-1)])),subtitle:Ne(()=>e[60]||(e[60]=[Te("strong",null,"FACET",-1),Mt(" uses a two-stage teacher-student training approach to facilitate learning and ensure successful sim2real transfer. ",-1)])),default:Ne(()=>[Te("p",null,[e[61]||(e[61]=Mt("In the first stage, we train a teacher policy ",-1)),le(o,{expression:"\\pi^{\\text{teacher}}"}),e[62]||(e[62]=Mt(" with access to privileged information alongside a state estimator ",-1)),le(o,{expression:"\\mathcal{E}^{\\text{est}}(o_{:t})"}),e[63]||(e[63]=Mt(" that predicts features from available sensors.",-1))]),Te("p",null,[e[64]||(e[64]=Mt("In the second stage, a student policy ",-1)),le(o,{expression:"\\pi^{\\text{student}}"}),e[65]||(e[65]=Mt(" is initialized from the teacher's parameters and fine-tuned using PPO to work with the estimated features.",-1))])]),_:1},8,["expanded"])]),_:1})]),_:1})]),_:1,__:[66]})]),_:1})]),_:1}),Hi(le(us,{ref:"simulationSection",fluid:"",class:"pa-0",id:"simulation"},{default:Ne(()=>[le(si,{"no-gutters":""},{default:Ne(()=>[le(Mr,{cols:"12"},{default:Ne(()=>[Te("div",nD,[(Pn(!0),vr(On,null,Po(i.simulationVideos,u=>(Pn(),vr("div",{key:u.id},[le(K0,null,{default:Ne(()=>[i.selectedSimVideo==u.id?(Pn(),Oi(s,{key:0,width:"100%",height:"100%",autoplay:"",loop:"",muted:"",style:{"object-fit":"cover",position:"absolute",top:"0",left:"0"}},{default:Ne(()=>[Te("source",{src:u.src,type:"video/mp4"},null,8,rD)]),_:2},1024)):Qi("",!0)]),_:2},1024)]))),128)),Te("div",iD,[le(aP,{modelValue:i.selectedSimVideo,"onUpdate:modelValue":e[5]||(e[5]=u=>i.selectedSimVideo=u),mandatory:"",rounded:"","background-color":"rgba(0, 0, 0, 0.5)",class:"elevation-4"},{default:Ne(()=>[(Pn(!0),vr(On,null,Po(i.simulationVideos,u=>(Pn(),Oi(Ci,{key:u.id,value:u.id,class:"px-6"},{default:Ne(()=>[Te("span",null,fr(u.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])])]),_:1})]),_:1})]),_:1},512),[[yu,t.$vuetify.display.smAndUp]]),le(us,{class:"py-12",id:"real-world"},{default:Ne(()=>[le(si,{justify:"center"},{default:Ne(()=>[le(Mr,{cols:"12",md:"10"},{default:Ne(()=>[e[67]||(e[67]=Te("h2",{class:"text-h4 text-center mb-6"},"Real-World Results",-1)),(Pn(!0),vr(On,null,Po(i.realWorldRows,(u,c)=>(Pn(),Oi(si,{key:c},{default:Ne(()=>[(Pn(!0),vr(On,null,Po(u,(d,h)=>(Pn(),Oi(Mr,{key:h,cols:"12",md:"6"},{default:Ne(()=>[Te("h3",aD,fr(d.title),1),le(xm,{color:"grey lighten-2",class:"d-flex align-center justify-center mb-4"},{default:Ne(()=>[le(s,{width:"100%",height:"100%",autoplay:"",loop:"",muted:""},{default:Ne(()=>[Te("source",{src:d.src,type:"video/mp4"},null,8,sD)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024))),128))]),_:1,__:[67]})]),_:1})]),_:1}),le(us,{class:"py-12 grey lighten-4",id:"ablation"},{default:Ne(()=>[le(si,{justify:"center"},{default:Ne(()=>[le(Mr,{cols:"12",md:"10"},{default:Ne(()=>[e[74]||(e[74]=Te("h2",{class:"text-h4 text-center mb-6"},"Ablation Study",-1)),le(si,null,{default:Ne(()=>[le(Mr,{cols:"12",sm:"12",md:"6",lg:"4"},{default:Ne(()=>[le(su,{elevation:"2",class:"pa-4 mb-4 h-100"},{default:Ne(()=>[e[68]||(e[68]=Te("h3",{class:"text-h6 mb-3"},"Success Rate vs Peak Impact Force",-1)),le(ya,{src:hR,contain:"",class:"mb-4"}),e[69]||(e[69]=Te("p",{class:"text-body-2"}," FACET demonstrates superior robustness to large impulses compared to baseline policies trained with velocity tracking (vanilla) and with random impulse perturbations (robust). The success rate remains high even under significant impact forces. ",-1))]),_:1,__:[68,69]})]),_:1}),le(Mr,{cols:"12",sm:"12",md:"6",lg:"4"},{default:Ne(()=>[le(su,{elevation:"2",class:"pa-4 mb-4 h-100"},{default:Ne(()=>[e[70]||(e[70]=Te("h3",{class:"text-h6 mb-3"},"Planar Trajectory Upon Impulse",-1)),le(ya,{src:pR,contain:"",class:"mb-4"}),e[71]||(e[71]=Te("p",{class:"text-body-2"}," Planar (xy) trajectory of robot CoM under a 100 Ns lateral impulse with a 400 N peak force. FACET can compliantly follow the impulse, adapting its velocity to keep balance, unlike the stiffer responses or failures of the baselines. ",-1))]),_:1,__:[70,71]})]),_:1}),le(Mr,{cols:"12",sm:"12",md:"6",lg:"4"},{default:Ne(()=>[le(su,{elevation:"2",class:"pa-4 mb-4 h-100"},{default:Ne(()=>[e[72]||(e[72]=Te("h3",{class:"text-h6 mb-3"},"Distribution of Collision Impulse",-1)),le(ya,{src:mR,contain:"",class:"mb-4"}),e[73]||(e[73]=Te("p",{class:"text-body-2"}," Distribution of collision impulse when the robot walks into a virtual wall. FACET achieves a significantly lower collision impulse, and this can be modulated by adjusting the impedance parameter Kp, indicating enhanced safety during physical interaction. ",-1))]),_:1,__:[72,73]})]),_:1})]),_:1})]),_:1,__:[74]})]),_:1})]),_:1}),le(us,{class:"py-12 grey lighten-4",id:"team"},{default:Ne(()=>[le(si,{justify:"center"},{default:Ne(()=>[le(Mr,{cols:"12",md:"8"},{default:Ne(()=>[e[75]||(e[75]=Te("h2",{class:"text-h4 text-center mb-6"},"Our Team",-1)),le(si,{justify:"center"},{default:Ne(()=>[(Pn(!0),vr(On,null,Po(i.teamMembers,(u,c)=>(Pn(),Oi(Mr,{key:c,cols:"12",sm:"4",class:"text-center"},{default:Ne(()=>[Te("a",{href:u.link,target:"_blank",class:"text-decoration-none"},[le(Af,{size:"120",color:"grey lighten-2",class:"mb-4"},{default:Ne(()=>[le(ya,{src:u.avatar,contain:""},null,8,["src"])]),_:2},1024),Te("h3",lD,[Mt(fr(u.name),1),u.star?(Pn(),vr("span",uD," *")):Qi("",!0)]),Te("p",{class:"caption",innerHTML:u.school},null,8,cD)],8,oD)]),_:2},1024))),128))]),_:1})]),_:1,__:[75]})]),_:1})]),_:1}),le(yR,{padless:""},{default:Ne(()=>[le(us,null,{default:Ne(()=>[le(si,{justify:"center"},{default:Ne(()=>[le(Mr,{cols:"12",md:"8",class:"text-center"},{default:Ne(()=>e[76]||(e[76]=[Te("p",{class:"mb-4"},[Mt(" © 2025 The FACET Team, Tsinghua University."),Te("br"),Mt(" Built with "),Te("a",{href:"https://vuetifyjs.com/en/",target:"_blank"},"Vuetify"),Mt(", "),Te("a",{href:"https://github.com/Axellwppr/mujoco_wasm_332",target:"_blank"},"MuJoCo WASM"),Mt(", and "),Te("a",{href:"https://www.npmjs.com/package/onnxruntime-web",target:"_blank"},"ONNX Runtime Web"),Mt(". "),Te("br"),Te("a",{href:"https://github.com/Facet-Team/facet",target:"_blank"},"Website content"),Mt(" licensed under MIT License. Third-party libraries retain their original licenses. ")],-1)])),_:1,__:[76]})]),_:1})]),_:1})]),_:1})]),_:1})}const fD=Cp(GR,[["render",dD]]);/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Z1="150",Zu={ROTATE:0,DOLLY:1,PAN:2},Ju={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},hD=0,X_=1,pD=2,R8=1,D8=2,qd=3,nl=0,ia=1,Yo=2,Qo=0,kc=1,K_=2,Y_=3,Z_=4,mD=5,gc=100,gD=101,vD=102,J_=103,Q_=104,yD=200,_D=201,bD=202,xD=203,L8=204,z8=205,wD=206,SD=207,MD=208,ED=209,TD=210,CD=0,AD=1,kD=2,Dv=3,ID=4,$D=5,PD=6,RD=7,J1=0,DD=1,LD=2,Ss=0,zD=1,OD=2,ND=3,BD=4,FD=5,O8=300,zc=301,Oc=302,Lv=303,zv=304,Ap=306,Jl=1e3,Ba=1001,Ov=1002,ti=1003,eb=1004,wm=1005,ba=1006,UD=1007,If=1008,rl=1009,VD=1010,HD=1011,N8=1012,WD=1013,Ql=1014,eu=1015,Nc=1016,GD=1017,qD=1018,Ic=1020,jD=1021,xa=1023,XD=1024,KD=1025,ou=1026,Bc=1027,YD=1028,ZD=1029,JD=1030,QD=1031,eL=1033,Sm=33776,Mm=33777,Em=33778,Tm=33779,tb=35840,nb=35841,rb=35842,ib=35843,tL=36196,ab=37492,sb=37496,ob=37808,lb=37809,ub=37810,cb=37811,db=37812,fb=37813,hb=37814,pb=37815,mb=37816,gb=37817,vb=37818,yb=37819,_b=37820,bb=37821,Cm=36492,nL=36283,xb=36284,wb=36285,Sb=36286,il=3e3,sr=3001,rL=3200,iL=3201,Q1=0,aL=1,gs="srgb",$f="srgb-linear",B8="display-p3",Am=7680,sL=519,Mb=35044,Eb="300 es",Nv=1035;class _u{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const a=i.indexOf(n);a!==-1&&i.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let a=0,s=i.length;a<s;a++)i[a].call(this,e);e.target=null}}}const oi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],km=Math.PI/180,Bv=180/Math.PI;function Vf(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(oi[t&255]+oi[t>>8&255]+oi[t>>16&255]+oi[t>>24&255]+"-"+oi[e&255]+oi[e>>8&255]+"-"+oi[e>>16&15|64]+oi[e>>24&255]+"-"+oi[n&63|128]+oi[n>>8&255]+"-"+oi[n>>16&255]+oi[n>>24&255]+oi[r&255]+oi[r>>8&255]+oi[r>>16&255]+oi[r>>24&255]).toLowerCase()}function Gr(t,e,n){return Math.max(e,Math.min(n,t))}function oL(t,e){return(t%e+e)%e}function Im(t,e,n){return(1-n)*t+n*e}function Tb(t){return(t&t-1)===0&&t!==0}function lL(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Lh(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Ki(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}class Lt{constructor(e=0,n=0){Lt.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,r=this.y,i=e.elements;return this.x=i[0]*n+i[3]*r+i[6],this.y=i[1]*n+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const r=Math.cos(n),i=Math.sin(n),a=this.x-e.x,s=this.y-e.y;return this.x=a*r-s*i+e.x,this.y=a*i+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ii{constructor(){Ii.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,n,r,i,a,s,o,l,u){const c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=n,c[4]=a,c[5]=l,c[6]=r,c[7]=s,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(e,n,r){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,a=this.elements,s=r[0],o=r[3],l=r[6],u=r[1],c=r[4],d=r[7],h=r[2],v=r[5],x=r[8],_=i[0],b=i[3],S=i[6],E=i[1],C=i[4],A=i[7],D=i[2],O=i[5],V=i[8];return a[0]=s*_+o*E+l*D,a[3]=s*b+o*C+l*O,a[6]=s*S+o*A+l*V,a[1]=u*_+c*E+d*D,a[4]=u*b+c*C+d*O,a[7]=u*S+c*A+d*V,a[2]=h*_+v*E+x*D,a[5]=h*b+v*C+x*O,a[8]=h*S+v*A+x*V,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8];return n*s*c-n*o*u-r*a*c+r*o*l+i*a*u-i*s*l}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],d=c*s-o*u,h=o*l-c*a,v=u*a-s*l,x=n*d+r*h+i*v;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/x;return e[0]=d*_,e[1]=(i*u-c*r)*_,e[2]=(o*r-i*s)*_,e[3]=h*_,e[4]=(c*n-i*l)*_,e[5]=(i*a-o*n)*_,e[6]=v*_,e[7]=(r*l-u*n)*_,e[8]=(s*n-r*a)*_,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,r,i,a,s,o){const l=Math.cos(a),u=Math.sin(a);return this.set(r*l,r*u,-r*(l*s+u*o)+s+e,-i*u,i*l,-i*(-u*s+l*o)+o+n,0,0,1),this}scale(e,n){return this.premultiply($m.makeScale(e,n)),this}rotate(e){return this.premultiply($m.makeRotation(-e)),this}translate(e,n){return this.premultiply($m.makeTranslation(e,n)),this}makeTranslation(e,n){return this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<9;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<9;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const $m=new Ii;function F8(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function Y0(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}class Ai{constructor(e=0,n=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=i}static slerpFlat(e,n,r,i,a,s,o){let l=r[i+0],u=r[i+1],c=r[i+2],d=r[i+3];const h=a[s+0],v=a[s+1],x=a[s+2],_=a[s+3];if(o===0){e[n+0]=l,e[n+1]=u,e[n+2]=c,e[n+3]=d;return}if(o===1){e[n+0]=h,e[n+1]=v,e[n+2]=x,e[n+3]=_;return}if(d!==_||l!==h||u!==v||c!==x){let b=1-o;const S=l*h+u*v+c*x+d*_,E=S>=0?1:-1,C=1-S*S;if(C>Number.EPSILON){const D=Math.sqrt(C),O=Math.atan2(D,S*E);b=Math.sin(b*O)/D,o=Math.sin(o*O)/D}const A=o*E;if(l=l*b+h*A,u=u*b+v*A,c=c*b+x*A,d=d*b+_*A,b===1-o){const D=1/Math.sqrt(l*l+u*u+c*c+d*d);l*=D,u*=D,c*=D,d*=D}}e[n]=l,e[n+1]=u,e[n+2]=c,e[n+3]=d}static multiplyQuaternionsFlat(e,n,r,i,a,s){const o=r[i],l=r[i+1],u=r[i+2],c=r[i+3],d=a[s],h=a[s+1],v=a[s+2],x=a[s+3];return e[n]=o*x+c*d+l*v-u*h,e[n+1]=l*x+c*h+u*d-o*v,e[n+2]=u*x+c*v+o*h-l*d,e[n+3]=c*x-o*d-l*h-u*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,r,i){return this._x=e,this._y=n,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n){const r=e._x,i=e._y,a=e._z,s=e._order,o=Math.cos,l=Math.sin,u=o(r/2),c=o(i/2),d=o(a/2),h=l(r/2),v=l(i/2),x=l(a/2);switch(s){case"XYZ":this._x=h*c*d+u*v*x,this._y=u*v*d-h*c*x,this._z=u*c*x+h*v*d,this._w=u*c*d-h*v*x;break;case"YXZ":this._x=h*c*d+u*v*x,this._y=u*v*d-h*c*x,this._z=u*c*x-h*v*d,this._w=u*c*d+h*v*x;break;case"ZXY":this._x=h*c*d-u*v*x,this._y=u*v*d+h*c*x,this._z=u*c*x+h*v*d,this._w=u*c*d-h*v*x;break;case"ZYX":this._x=h*c*d-u*v*x,this._y=u*v*d+h*c*x,this._z=u*c*x-h*v*d,this._w=u*c*d+h*v*x;break;case"YZX":this._x=h*c*d+u*v*x,this._y=u*v*d+h*c*x,this._z=u*c*x-h*v*d,this._w=u*c*d-h*v*x;break;case"XZY":this._x=h*c*d-u*v*x,this._y=u*v*d-h*c*x,this._z=u*c*x+h*v*d,this._w=u*c*d+h*v*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const r=n/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,r=n[0],i=n[4],a=n[8],s=n[1],o=n[5],l=n[9],u=n[2],c=n[6],d=n[10],h=r+o+d;if(h>0){const v=.5/Math.sqrt(h+1);this._w=.25/v,this._x=(c-l)*v,this._y=(a-u)*v,this._z=(s-i)*v}else if(r>o&&r>d){const v=2*Math.sqrt(1+r-o-d);this._w=(c-l)/v,this._x=.25*v,this._y=(i+s)/v,this._z=(a+u)/v}else if(o>d){const v=2*Math.sqrt(1+o-r-d);this._w=(a-u)/v,this._x=(i+s)/v,this._y=.25*v,this._z=(l+c)/v}else{const v=2*Math.sqrt(1+d-r-o);this._w=(s-i)/v,this._x=(a+u)/v,this._y=(l+c)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Gr(this.dot(e),-1,1)))}rotateTowards(e,n){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,n/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const r=e._x,i=e._y,a=e._z,s=e._w,o=n._x,l=n._y,u=n._z,c=n._w;return this._x=r*c+s*o+i*u-a*l,this._y=i*c+s*l+a*o-r*u,this._z=a*c+s*u+r*l-i*o,this._w=s*c-r*o-i*l-a*u,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const r=this._x,i=this._y,a=this._z,s=this._w;let o=s*e._w+r*e._x+i*e._y+a*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=r,this._y=i,this._z=a,this;const l=1-o*o;if(l<=Number.EPSILON){const v=1-n;return this._w=v*s+n*this._w,this._x=v*r+n*this._x,this._y=v*i+n*this._y,this._z=v*a+n*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(l),c=Math.atan2(u,o),d=Math.sin((1-n)*c)/u,h=Math.sin(n*c)/u;return this._w=s*d+this._w*h,this._x=r*d+this._x*h,this._y=i*d+this._y*h,this._z=a*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,n,r){return this.copy(e).slerp(n,r)}random(){const e=Math.random(),n=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(n*Math.cos(i),r*Math.sin(a),r*Math.cos(a),n*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ee{constructor(e=0,n=0,r=0){Ee.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}set(e,n,r){return r===void 0&&(r=this.z),this.x=e,this.y=n,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(Cb.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(Cb.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,r=this.y,i=this.z,a=e.elements;return this.x=a[0]*n+a[3]*r+a[6]*i,this.y=a[1]*n+a[4]*r+a[7]*i,this.z=a[2]*n+a[5]*r+a[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,a=e.elements,s=1/(a[3]*n+a[7]*r+a[11]*i+a[15]);return this.x=(a[0]*n+a[4]*r+a[8]*i+a[12])*s,this.y=(a[1]*n+a[5]*r+a[9]*i+a[13])*s,this.z=(a[2]*n+a[6]*r+a[10]*i+a[14])*s,this}applyQuaternion(e){const n=this.x,r=this.y,i=this.z,a=e.x,s=e.y,o=e.z,l=e.w,u=l*n+s*i-o*r,c=l*r+o*n-a*i,d=l*i+a*r-s*n,h=-a*n-s*r-o*i;return this.x=u*l+h*-a+c*-o-d*-s,this.y=c*l+h*-s+d*-a-u*-o,this.z=d*l+h*-o+u*-s-c*-a,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,r=this.y,i=this.z,a=e.elements;return this.x=a[0]*n+a[4]*r+a[8]*i,this.y=a[1]*n+a[5]*r+a[9]*i,this.z=a[2]*n+a[6]*r+a[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const r=e.x,i=e.y,a=e.z,s=n.x,o=n.y,l=n.z;return this.x=i*l-a*o,this.y=a*s-r*l,this.z=r*o-i*s,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const r=e.dot(this)/n;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Pm.copy(this).projectOnVector(e),this.sub(Pm)}reflect(e){return this.sub(Pm.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Gr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return n*n+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,r){const i=Math.sin(n)*e;return this.x=i*Math.sin(r),this.y=Math.cos(n)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,r){return this.x=e*Math.sin(n),this.y=r,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=i,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(n),this.y=r*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Pm=new Ee,Cb=new Ai;function $c(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Rm(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}const uL=new Ii().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),cL=new Ii().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Zo=new Ee;function dL(t){return t.convertSRGBToLinear(),Zo.set(t.r,t.g,t.b).applyMatrix3(cL),t.setRGB(Zo.x,Zo.y,Zo.z)}function fL(t){return Zo.set(t.r,t.g,t.b).applyMatrix3(uL),t.setRGB(Zo.x,Zo.y,Zo.z).convertLinearToSRGB()}const hL={[$f]:t=>t,[gs]:t=>t.convertSRGBToLinear(),[B8]:dL},pL={[$f]:t=>t,[gs]:t=>t.convertLinearToSRGB(),[B8]:fL},bi={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(t){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!t},get workingColorSpace(){return $f},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,n){if(this.enabled===!1||e===n||!e||!n)return t;const r=hL[e],i=pL[n];if(r===void 0||i===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${n}".`);return i(r(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}};let Qu;class U8{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Qu===void 0&&(Qu=Y0("canvas")),Qu.width=e.width,Qu.height=e.height;const r=Qu.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=Qu}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=Y0("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),a=i.data;for(let s=0;s<a.length;s++)a[s]=$c(a[s]/255)*255;return r.putImageData(i,0,0),n}else if(e.data){const n=e.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor($c(n[r]/255)*255):n[r]=$c(n[r]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class V8{constructor(e=null){this.isSource=!0,this.uuid=Vf(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let a;if(Array.isArray(i)){a=[];for(let s=0,o=i.length;s<o;s++)i[s].isDataTexture?a.push(Dm(i[s].image)):a.push(Dm(i[s]))}else a=Dm(i);r.url=a}return n||(e.images[this.uuid]=r),r}}function Dm(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?U8.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let mL=0;class Fi extends _u{constructor(e=Fi.DEFAULT_IMAGE,n=Fi.DEFAULT_MAPPING,r=Ba,i=Ba,a=ba,s=If,o=xa,l=rl,u=Fi.DEFAULT_ANISOTROPY,c=il){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:mL++}),this.uuid=Vf(),this.name="",this.source=new V8(e),this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=i,this.magFilter=a,this.minFilter=s,this.anisotropy=u,this.format=o,this.internalFormat=null,this.type=l,this.offset=new Lt(0,0),this.repeat=new Lt(1,1),this.center=new Lt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ii,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==O8)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Jl:e.x=e.x-Math.floor(e.x);break;case Ba:e.x=e.x<0?0:1;break;case Ov:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Jl:e.y=e.y-Math.floor(e.y);break;case Ba:e.y=e.y<0?0:1;break;case Ov:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}Fi.DEFAULT_IMAGE=null;Fi.DEFAULT_MAPPING=O8;Fi.DEFAULT_ANISOTROPY=1;class Cr{constructor(e=0,n=0,r=0,i=1){Cr.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,r,i){return this.x=e,this.y=n,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,a=this.w,s=e.elements;return this.x=s[0]*n+s[4]*r+s[8]*i+s[12]*a,this.y=s[1]*n+s[5]*r+s[9]*i+s[13]*a,this.z=s[2]*n+s[6]*r+s[10]*i+s[14]*a,this.w=s[3]*n+s[7]*r+s[11]*i+s[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,r,i,a;const l=e.elements,u=l[0],c=l[4],d=l[8],h=l[1],v=l[5],x=l[9],_=l[2],b=l[6],S=l[10];if(Math.abs(c-h)<.01&&Math.abs(d-_)<.01&&Math.abs(x-b)<.01){if(Math.abs(c+h)<.1&&Math.abs(d+_)<.1&&Math.abs(x+b)<.1&&Math.abs(u+v+S-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const C=(u+1)/2,A=(v+1)/2,D=(S+1)/2,O=(c+h)/4,V=(d+_)/4,P=(x+b)/4;return C>A&&C>D?C<.01?(r=0,i=.707106781,a=.707106781):(r=Math.sqrt(C),i=O/r,a=V/r):A>D?A<.01?(r=.707106781,i=0,a=.707106781):(i=Math.sqrt(A),r=O/i,a=P/i):D<.01?(r=.707106781,i=.707106781,a=0):(a=Math.sqrt(D),r=V/a,i=P/a),this.set(r,i,a,n),this}let E=Math.sqrt((b-x)*(b-x)+(d-_)*(d-_)+(h-c)*(h-c));return Math.abs(E)<.001&&(E=1),this.x=(b-x)/E,this.y=(d-_)/E,this.z=(h-c)/E,this.w=Math.acos((u+v+S-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this.w=e.w+(n.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class al extends _u{constructor(e=1,n=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new Cr(0,0,e,n),this.scissorTest=!1,this.viewport=new Cr(0,0,e,n);const i={width:e,height:n,depth:1};this.texture=new Fi(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:ba,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,n,r=1){(this.width!==e||this.height!==n||this.depth!==r)&&(this.width=e,this.height=n,this.depth=r,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new V8(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class H8 extends Fi{constructor(e=null,n=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=ti,this.minFilter=ti,this.wrapR=Ba,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class gL extends Fi{constructor(e=null,n=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=ti,this.minFilter=ti,this.wrapR=Ba,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Hf{constructor(e=new Ee(1/0,1/0,1/0),n=new Ee(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){let n=1/0,r=1/0,i=1/0,a=-1/0,s=-1/0,o=-1/0;for(let l=0,u=e.length;l<u;l+=3){const c=e[l],d=e[l+1],h=e[l+2];c<n&&(n=c),d<r&&(r=d),h<i&&(i=h),c>a&&(a=c),d>s&&(s=d),h>o&&(o=h)}return this.min.set(n,r,i),this.max.set(a,s,o),this}setFromBufferAttribute(e){let n=1/0,r=1/0,i=1/0,a=-1/0,s=-1/0,o=-1/0;for(let l=0,u=e.count;l<u;l++){const c=e.getX(l),d=e.getY(l),h=e.getZ(l);c<n&&(n=c),d<r&&(r=d),h<i&&(i=h),c>a&&(a=c),d>s&&(s=d),h>o&&(o=h)}return this.min.set(n,r,i),this.max.set(a,s,o),this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=Nl.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0)if(n&&r.attributes!=null&&r.attributes.position!==void 0){const a=r.attributes.position;for(let s=0,o=a.count;s<o;s++)Nl.fromBufferAttribute(a,s).applyMatrix4(e.matrixWorld),this.expandByPoint(Nl)}else r.boundingBox===null&&r.computeBoundingBox(),Lm.copy(r.boundingBox),Lm.applyMatrix4(e.matrixWorld),this.union(Lm);const i=e.children;for(let a=0,s=i.length;a<s;a++)this.expandByObject(i[a],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Nl),Nl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Td),zh.subVectors(this.max,Td),ec.subVectors(e.a,Td),tc.subVectors(e.b,Td),nc.subVectors(e.c,Td),Lo.subVectors(tc,ec),zo.subVectors(nc,tc),Bl.subVectors(ec,nc);let n=[0,-Lo.z,Lo.y,0,-zo.z,zo.y,0,-Bl.z,Bl.y,Lo.z,0,-Lo.x,zo.z,0,-zo.x,Bl.z,0,-Bl.x,-Lo.y,Lo.x,0,-zo.y,zo.x,0,-Bl.y,Bl.x,0];return!zm(n,ec,tc,nc,zh)||(n=[1,0,0,0,1,0,0,0,1],!zm(n,ec,tc,nc,zh))?!1:(Oh.crossVectors(Lo,zo),n=[Oh.x,Oh.y,Oh.z],zm(n,ec,tc,nc,zh))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Nl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Nl).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Gs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Gs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Gs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Gs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Gs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Gs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Gs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Gs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Gs),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Gs=[new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee],Nl=new Ee,Lm=new Hf,ec=new Ee,tc=new Ee,nc=new Ee,Lo=new Ee,zo=new Ee,Bl=new Ee,Td=new Ee,zh=new Ee,Oh=new Ee,Fl=new Ee;function zm(t,e,n,r,i){for(let a=0,s=t.length-3;a<=s;a+=3){Fl.fromArray(t,a);const o=i.x*Math.abs(Fl.x)+i.y*Math.abs(Fl.y)+i.z*Math.abs(Fl.z),l=e.dot(Fl),u=n.dot(Fl),c=r.dot(Fl);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>o)return!1}return!0}const vL=new Hf,Cd=new Ee,Om=new Ee;class kp{constructor(e=new Ee,n=-1){this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const r=this.center;n!==void 0?r.copy(n):vL.setFromPoints(e).getCenter(r);let i=0;for(let a=0,s=e.length;a<s;a++)i=Math.max(i,r.distanceToSquared(e[a]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const r=this.center.distanceToSquared(e);return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Cd.subVectors(e,this.center);const n=Cd.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),i=(r-this.radius)*.5;this.center.addScaledVector(Cd,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Om.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Cd.copy(e.center).add(Om)),this.expandByPoint(Cd.copy(e.center).sub(Om))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const qs=new Ee,Nm=new Ee,Nh=new Ee,Oo=new Ee,Bm=new Ee,Bh=new Ee,Fm=new Ee;class ey{constructor(e=new Ee,n=new Ee(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,qs)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=qs.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(qs.copy(this.origin).addScaledVector(this.direction,n),qs.distanceToSquared(e))}distanceSqToSegment(e,n,r,i){Nm.copy(e).add(n).multiplyScalar(.5),Nh.copy(n).sub(e).normalize(),Oo.copy(this.origin).sub(Nm);const a=e.distanceTo(n)*.5,s=-this.direction.dot(Nh),o=Oo.dot(this.direction),l=-Oo.dot(Nh),u=Oo.lengthSq(),c=Math.abs(1-s*s);let d,h,v,x;if(c>0)if(d=s*l-o,h=s*o-l,x=a*c,d>=0)if(h>=-x)if(h<=x){const _=1/c;d*=_,h*=_,v=d*(d+s*h+2*o)+h*(s*d+h+2*l)+u}else h=a,d=Math.max(0,-(s*h+o)),v=-d*d+h*(h+2*l)+u;else h=-a,d=Math.max(0,-(s*h+o)),v=-d*d+h*(h+2*l)+u;else h<=-x?(d=Math.max(0,-(-s*a+o)),h=d>0?-a:Math.min(Math.max(-a,-l),a),v=-d*d+h*(h+2*l)+u):h<=x?(d=0,h=Math.min(Math.max(-a,-l),a),v=h*(h+2*l)+u):(d=Math.max(0,-(s*a+o)),h=d>0?a:Math.min(Math.max(-a,-l),a),v=-d*d+h*(h+2*l)+u);else h=s>0?-a:a,d=Math.max(0,-(s*h+o)),v=-d*d+h*(h+2*l)+u;return r&&r.copy(this.origin).addScaledVector(this.direction,d),i&&i.copy(Nm).addScaledVector(Nh,h),v}intersectSphere(e,n){qs.subVectors(e.center,this.origin);const r=qs.dot(this.direction),i=qs.dot(qs)-r*r,a=e.radius*e.radius;if(i>a)return null;const s=Math.sqrt(a-i),o=r-s,l=r+s;return l<0?null:o<0?this.at(l,n):this.at(o,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null}intersectPlane(e,n){const r=this.distanceToPlane(e);return r===null?null:this.at(r,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let r,i,a,s,o,l;const u=1/this.direction.x,c=1/this.direction.y,d=1/this.direction.z,h=this.origin;return u>=0?(r=(e.min.x-h.x)*u,i=(e.max.x-h.x)*u):(r=(e.max.x-h.x)*u,i=(e.min.x-h.x)*u),c>=0?(a=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(a=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),r>s||a>i||((a>r||isNaN(r))&&(r=a),(s<i||isNaN(i))&&(i=s),d>=0?(o=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(o=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),r>l||o>i)||((o>r||r!==r)&&(r=o),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,n)}intersectsBox(e){return this.intersectBox(e,qs)!==null}intersectTriangle(e,n,r,i,a){Bm.subVectors(n,e),Bh.subVectors(r,e),Fm.crossVectors(Bm,Bh);let s=this.direction.dot(Fm),o;if(s>0){if(i)return null;o=1}else if(s<0)o=-1,s=-s;else return null;Oo.subVectors(this.origin,e);const l=o*this.direction.dot(Bh.crossVectors(Oo,Bh));if(l<0)return null;const u=o*this.direction.dot(Bm.cross(Oo));if(u<0||l+u>s)return null;const c=-o*Oo.dot(Fm);return c<0?null:this.at(c/s,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class tr{constructor(){tr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,n,r,i,a,s,o,l,u,c,d,h,v,x,_,b){const S=this.elements;return S[0]=e,S[4]=n,S[8]=r,S[12]=i,S[1]=a,S[5]=s,S[9]=o,S[13]=l,S[2]=u,S[6]=c,S[10]=d,S[14]=h,S[3]=v,S[7]=x,S[11]=_,S[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new tr().fromArray(this.elements)}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(e){const n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,r=e.elements,i=1/rc.setFromMatrixColumn(e,0).length(),a=1/rc.setFromMatrixColumn(e,1).length(),s=1/rc.setFromMatrixColumn(e,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*a,n[5]=r[5]*a,n[6]=r[6]*a,n[7]=0,n[8]=r[8]*s,n[9]=r[9]*s,n[10]=r[10]*s,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,r=e.x,i=e.y,a=e.z,s=Math.cos(r),o=Math.sin(r),l=Math.cos(i),u=Math.sin(i),c=Math.cos(a),d=Math.sin(a);if(e.order==="XYZ"){const h=s*c,v=s*d,x=o*c,_=o*d;n[0]=l*c,n[4]=-l*d,n[8]=u,n[1]=v+x*u,n[5]=h-_*u,n[9]=-o*l,n[2]=_-h*u,n[6]=x+v*u,n[10]=s*l}else if(e.order==="YXZ"){const h=l*c,v=l*d,x=u*c,_=u*d;n[0]=h+_*o,n[4]=x*o-v,n[8]=s*u,n[1]=s*d,n[5]=s*c,n[9]=-o,n[2]=v*o-x,n[6]=_+h*o,n[10]=s*l}else if(e.order==="ZXY"){const h=l*c,v=l*d,x=u*c,_=u*d;n[0]=h-_*o,n[4]=-s*d,n[8]=x+v*o,n[1]=v+x*o,n[5]=s*c,n[9]=_-h*o,n[2]=-s*u,n[6]=o,n[10]=s*l}else if(e.order==="ZYX"){const h=s*c,v=s*d,x=o*c,_=o*d;n[0]=l*c,n[4]=x*u-v,n[8]=h*u+_,n[1]=l*d,n[5]=_*u+h,n[9]=v*u-x,n[2]=-u,n[6]=o*l,n[10]=s*l}else if(e.order==="YZX"){const h=s*l,v=s*u,x=o*l,_=o*u;n[0]=l*c,n[4]=_-h*d,n[8]=x*d+v,n[1]=d,n[5]=s*c,n[9]=-o*c,n[2]=-u*c,n[6]=v*d+x,n[10]=h-_*d}else if(e.order==="XZY"){const h=s*l,v=s*u,x=o*l,_=o*u;n[0]=l*c,n[4]=-d,n[8]=u*c,n[1]=h*d+_,n[5]=s*c,n[9]=v*d-x,n[2]=x*d-v,n[6]=o*c,n[10]=_*d+h}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(yL,e,_L)}lookAt(e,n,r){const i=this.elements;return Yi.subVectors(e,n),Yi.lengthSq()===0&&(Yi.z=1),Yi.normalize(),No.crossVectors(r,Yi),No.lengthSq()===0&&(Math.abs(r.z)===1?Yi.x+=1e-4:Yi.z+=1e-4,Yi.normalize(),No.crossVectors(r,Yi)),No.normalize(),Fh.crossVectors(Yi,No),i[0]=No.x,i[4]=Fh.x,i[8]=Yi.x,i[1]=No.y,i[5]=Fh.y,i[9]=Yi.y,i[2]=No.z,i[6]=Fh.z,i[10]=Yi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,a=this.elements,s=r[0],o=r[4],l=r[8],u=r[12],c=r[1],d=r[5],h=r[9],v=r[13],x=r[2],_=r[6],b=r[10],S=r[14],E=r[3],C=r[7],A=r[11],D=r[15],O=i[0],V=i[4],P=i[8],U=i[12],Y=i[1],fe=i[5],Q=i[9],G=i[13],re=i[2],he=i[6],ye=i[10],$e=i[14],_e=i[3],de=i[7],Oe=i[11],ve=i[15];return a[0]=s*O+o*Y+l*re+u*_e,a[4]=s*V+o*fe+l*he+u*de,a[8]=s*P+o*Q+l*ye+u*Oe,a[12]=s*U+o*G+l*$e+u*ve,a[1]=c*O+d*Y+h*re+v*_e,a[5]=c*V+d*fe+h*he+v*de,a[9]=c*P+d*Q+h*ye+v*Oe,a[13]=c*U+d*G+h*$e+v*ve,a[2]=x*O+_*Y+b*re+S*_e,a[6]=x*V+_*fe+b*he+S*de,a[10]=x*P+_*Q+b*ye+S*Oe,a[14]=x*U+_*G+b*$e+S*ve,a[3]=E*O+C*Y+A*re+D*_e,a[7]=E*V+C*fe+A*he+D*de,a[11]=E*P+C*Q+A*ye+D*Oe,a[15]=E*U+C*G+A*$e+D*ve,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[4],i=e[8],a=e[12],s=e[1],o=e[5],l=e[9],u=e[13],c=e[2],d=e[6],h=e[10],v=e[14],x=e[3],_=e[7],b=e[11],S=e[15];return x*(+a*l*d-i*u*d-a*o*h+r*u*h+i*o*v-r*l*v)+_*(+n*l*v-n*u*h+a*s*h-i*s*v+i*u*c-a*l*c)+b*(+n*u*d-n*o*v-a*s*d+r*s*v+a*o*c-r*u*c)+S*(-i*o*c-n*l*d+n*o*h+i*s*d-r*s*h+r*l*c)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=n,i[14]=r),this}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],d=e[9],h=e[10],v=e[11],x=e[12],_=e[13],b=e[14],S=e[15],E=d*b*u-_*h*u+_*l*v-o*b*v-d*l*S+o*h*S,C=x*h*u-c*b*u-x*l*v+s*b*v+c*l*S-s*h*S,A=c*_*u-x*d*u+x*o*v-s*_*v-c*o*S+s*d*S,D=x*d*l-c*_*l-x*o*h+s*_*h+c*o*b-s*d*b,O=n*E+r*C+i*A+a*D;if(O===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const V=1/O;return e[0]=E*V,e[1]=(_*h*a-d*b*a-_*i*v+r*b*v+d*i*S-r*h*S)*V,e[2]=(o*b*a-_*l*a+_*i*u-r*b*u-o*i*S+r*l*S)*V,e[3]=(d*l*a-o*h*a-d*i*u+r*h*u+o*i*v-r*l*v)*V,e[4]=C*V,e[5]=(c*b*a-x*h*a+x*i*v-n*b*v-c*i*S+n*h*S)*V,e[6]=(x*l*a-s*b*a-x*i*u+n*b*u+s*i*S-n*l*S)*V,e[7]=(s*h*a-c*l*a+c*i*u-n*h*u-s*i*v+n*l*v)*V,e[8]=A*V,e[9]=(x*d*a-c*_*a-x*r*v+n*_*v+c*r*S-n*d*S)*V,e[10]=(s*_*a-x*o*a+x*r*u-n*_*u-s*r*S+n*o*S)*V,e[11]=(c*o*a-s*d*a-c*r*u+n*d*u+s*r*v-n*o*v)*V,e[12]=D*V,e[13]=(c*_*i-x*d*i+x*r*h-n*_*h-c*r*b+n*d*b)*V,e[14]=(x*o*i-s*_*i-x*r*l+n*_*l+s*r*b-n*o*b)*V,e[15]=(s*d*i-c*o*i+c*r*l-n*d*l-s*r*h+n*o*h)*V,this}scale(e){const n=this.elements,r=e.x,i=e.y,a=e.z;return n[0]*=r,n[4]*=i,n[8]*=a,n[1]*=r,n[5]*=i,n[9]*=a,n[2]*=r,n[6]*=i,n[10]*=a,n[3]*=r,n[7]*=i,n[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,i))}makeTranslation(e,n,r){return this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const r=Math.cos(n),i=Math.sin(n),a=1-r,s=e.x,o=e.y,l=e.z,u=a*s,c=a*o;return this.set(u*s+r,u*o-i*l,u*l+i*o,0,u*o+i*l,c*o+r,c*l-i*s,0,u*l-i*o,c*l+i*s,a*l*l+r,0,0,0,0,1),this}makeScale(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,n,r,i,a,s){return this.set(1,r,a,0,e,1,s,0,n,i,1,0,0,0,0,1),this}compose(e,n,r){const i=this.elements,a=n._x,s=n._y,o=n._z,l=n._w,u=a+a,c=s+s,d=o+o,h=a*u,v=a*c,x=a*d,_=s*c,b=s*d,S=o*d,E=l*u,C=l*c,A=l*d,D=r.x,O=r.y,V=r.z;return i[0]=(1-(_+S))*D,i[1]=(v+A)*D,i[2]=(x-C)*D,i[3]=0,i[4]=(v-A)*O,i[5]=(1-(h+S))*O,i[6]=(b+E)*O,i[7]=0,i[8]=(x+C)*V,i[9]=(b-E)*V,i[10]=(1-(h+_))*V,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,n,r){const i=this.elements;let a=rc.set(i[0],i[1],i[2]).length();const s=rc.set(i[4],i[5],i[6]).length(),o=rc.set(i[8],i[9],i[10]).length();this.determinant()<0&&(a=-a),e.x=i[12],e.y=i[13],e.z=i[14],$a.copy(this);const u=1/a,c=1/s,d=1/o;return $a.elements[0]*=u,$a.elements[1]*=u,$a.elements[2]*=u,$a.elements[4]*=c,$a.elements[5]*=c,$a.elements[6]*=c,$a.elements[8]*=d,$a.elements[9]*=d,$a.elements[10]*=d,n.setFromRotationMatrix($a),r.x=a,r.y=s,r.z=o,this}makePerspective(e,n,r,i,a,s){const o=this.elements,l=2*a/(n-e),u=2*a/(r-i),c=(n+e)/(n-e),d=(r+i)/(r-i),h=-(s+a)/(s-a),v=-2*s*a/(s-a);return o[0]=l,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=u,o[9]=d,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=v,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,n,r,i,a,s){const o=this.elements,l=1/(n-e),u=1/(r-i),c=1/(s-a),d=(n+e)*l,h=(r+i)*u,v=(s+a)*c;return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-d,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-v,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<16;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<16;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}}const rc=new Ee,$a=new tr,yL=new Ee(0,0,0),_L=new Ee(1,1,1),No=new Ee,Fh=new Ee,Yi=new Ee,Ab=new tr,kb=new Ai;class lu{constructor(e=0,n=0,r=0,i=lu.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,i=this._order){return this._x=e,this._y=n,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const i=e.elements,a=i[0],s=i[4],o=i[8],l=i[1],u=i[5],c=i[9],d=i[2],h=i[6],v=i[10];switch(n){case"XYZ":this._y=Math.asin(Gr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,v),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Gr(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,v),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-d,a),this._z=0);break;case"ZXY":this._x=Math.asin(Gr(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,v),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(l,a));break;case"ZYX":this._y=Math.asin(-Gr(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,v),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-s,u));break;case"YZX":this._z=Math.asin(Gr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-d,a)):(this._x=0,this._y=Math.atan2(o,v));break;case"XZY":this._z=Math.asin(-Gr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(o,a)):(this._x=Math.atan2(-c,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return Ab.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Ab,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return kb.setFromEuler(this),this.setFromQuaternion(kb,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}lu.DEFAULT_ORDER="XYZ";class ty{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let bL=0;const Ib=new Ee,ic=new Ai,js=new tr,Uh=new Ee,Ad=new Ee,xL=new Ee,wL=new Ai,$b=new Ee(1,0,0),Pb=new Ee(0,1,0),Rb=new Ee(0,0,1),SL={type:"added"},Db={type:"removed"};class Ar extends _u{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:bL++}),this.uuid=Vf(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ar.DEFAULT_UP.clone();const e=new Ee,n=new lu,r=new Ai,i=new Ee(1,1,1);function a(){r.setFromEuler(n,!1)}function s(){n.setFromQuaternion(r,void 0,!1)}n._onChange(a),r._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new tr},normalMatrix:{value:new Ii}}),this.matrix=new tr,this.matrixWorld=new tr,this.matrixAutoUpdate=Ar.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Ar.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new ty,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return ic.setFromAxisAngle(e,n),this.quaternion.multiply(ic),this}rotateOnWorldAxis(e,n){return ic.setFromAxisAngle(e,n),this.quaternion.premultiply(ic),this}rotateX(e){return this.rotateOnAxis($b,e)}rotateY(e){return this.rotateOnAxis(Pb,e)}rotateZ(e){return this.rotateOnAxis(Rb,e)}translateOnAxis(e,n){return Ib.copy(e).applyQuaternion(this.quaternion),this.position.add(Ib.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis($b,e)}translateY(e){return this.translateOnAxis(Pb,e)}translateZ(e){return this.translateOnAxis(Rb,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(js.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?Uh.copy(e):Uh.set(e,n,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Ad.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?js.lookAt(Ad,Uh,this.up):js.lookAt(Uh,Ad,this.up),this.quaternion.setFromRotationMatrix(js),i&&(js.extractRotation(i.matrixWorld),ic.setFromRotationMatrix(js),this.quaternion.premultiply(ic.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(SL)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Db)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const n=this.children[e];n.parent=null,n.dispatchEvent(Db)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),js.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),js.multiply(e.parent.matrixWorld)),e.applyMatrix4(js),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,i=this.children.length;r<i;r++){const s=this.children[r].getObjectByProperty(e,n);if(s!==void 0)return s}}getObjectsByProperty(e,n){let r=[];this[e]===n&&r.push(this);for(let i=0,a=this.children.length;i<a;i++){const s=this.children[i].getObjectsByProperty(e,n);s.length>0&&(r=r.concat(s))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ad,e,xL),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ad,wL,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,i=n.length;r<i;r++){const a=n[r];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const i=this.children;for(let a=0,s=i.length;a<s;a++){const o=i[a];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function a(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const d=l[u];a(e.shapes,d)}else a(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,u=this.material.length;l<u;l++)o.push(a(e.materials,this.material[l]));i.material=o}else i.material=a(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];i.animations.push(a(e.animations,l))}}if(n){const o=s(e.geometries),l=s(e.materials),u=s(e.textures),c=s(e.images),d=s(e.shapes),h=s(e.skeletons),v=s(e.animations),x=s(e.nodes);o.length>0&&(r.geometries=o),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),c.length>0&&(r.images=c),d.length>0&&(r.shapes=d),h.length>0&&(r.skeletons=h),v.length>0&&(r.animations=v),x.length>0&&(r.nodes=x)}return r.object=i,r;function s(o){const l=[];for(const u in o){const c=o[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Ar.DEFAULT_UP=new Ee(0,1,0);Ar.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ar.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Pa=new Ee,Xs=new Ee,Um=new Ee,Ks=new Ee,ac=new Ee,sc=new Ee,Lb=new Ee,Vm=new Ee,Hm=new Ee,Wm=new Ee;class eo{constructor(e=new Ee,n=new Ee,r=new Ee){this.a=e,this.b=n,this.c=r}static getNormal(e,n,r,i){i.subVectors(r,n),Pa.subVectors(e,n),i.cross(Pa);const a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}static getBarycoord(e,n,r,i,a){Pa.subVectors(i,n),Xs.subVectors(r,n),Um.subVectors(e,n);const s=Pa.dot(Pa),o=Pa.dot(Xs),l=Pa.dot(Um),u=Xs.dot(Xs),c=Xs.dot(Um),d=s*u-o*o;if(d===0)return a.set(-2,-1,-1);const h=1/d,v=(u*l-o*c)*h,x=(s*c-o*l)*h;return a.set(1-v-x,x,v)}static containsPoint(e,n,r,i){return this.getBarycoord(e,n,r,i,Ks),Ks.x>=0&&Ks.y>=0&&Ks.x+Ks.y<=1}static getUV(e,n,r,i,a,s,o,l){return this.getBarycoord(e,n,r,i,Ks),l.set(0,0),l.addScaledVector(a,Ks.x),l.addScaledVector(s,Ks.y),l.addScaledVector(o,Ks.z),l}static isFrontFacing(e,n,r,i){return Pa.subVectors(r,n),Xs.subVectors(e,n),Pa.cross(Xs).dot(i)<0}set(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(e,n,r,i){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,n,r,i){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Pa.subVectors(this.c,this.b),Xs.subVectors(this.a,this.b),Pa.cross(Xs).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return eo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return eo.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,r,i,a){return eo.getUV(e,this.a,this.b,this.c,n,r,i,a)}containsPoint(e){return eo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return eo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const r=this.a,i=this.b,a=this.c;let s,o;ac.subVectors(i,r),sc.subVectors(a,r),Vm.subVectors(e,r);const l=ac.dot(Vm),u=sc.dot(Vm);if(l<=0&&u<=0)return n.copy(r);Hm.subVectors(e,i);const c=ac.dot(Hm),d=sc.dot(Hm);if(c>=0&&d<=c)return n.copy(i);const h=l*d-c*u;if(h<=0&&l>=0&&c<=0)return s=l/(l-c),n.copy(r).addScaledVector(ac,s);Wm.subVectors(e,a);const v=ac.dot(Wm),x=sc.dot(Wm);if(x>=0&&v<=x)return n.copy(a);const _=v*u-l*x;if(_<=0&&u>=0&&x<=0)return o=u/(u-x),n.copy(r).addScaledVector(sc,o);const b=c*x-v*d;if(b<=0&&d-c>=0&&v-x>=0)return Lb.subVectors(a,i),o=(d-c)/(d-c+(v-x)),n.copy(i).addScaledVector(Lb,o);const S=1/(b+_+h);return s=_*S,o=h*S,n.copy(r).addScaledVector(ac,s).addScaledVector(sc,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let ML=0;class bu extends _u{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ML++}),this.uuid=Vf(),this.name="",this.type="Material",this.blending=kc,this.side=nl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=L8,this.blendDst=z8,this.blendEquation=gc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Dv,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=sL,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Am,this.stencilZFail=Am,this.stencilZPass=Am,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const r=e[n];if(r===void 0){console.warn("THREE.Material: '"+n+"' parameter is undefined.");continue}const i=this[n];if(i===void 0){console.warn("THREE."+this.type+": '"+n+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==kc&&(r.blending=this.blending),this.side!==nl&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(r.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(a){const s=[];for(const o in a){const l=a[o];delete l.metadata,s.push(l)}return s}if(n){const a=i(e.textures),s=i(e.images);a.length>0&&(r.textures=a),s.length>0&&(r.images=s)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let r=null;if(n!==null){const i=n.length;r=new Array(i);for(let a=0;a!==i;++a)r[a]=n[a].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const W8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ra={h:0,s:0,l:0},Vh={h:0,s:0,l:0};function Gm(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class Sn{constructor(e,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,n===void 0&&r===void 0?this.set(e):this.setRGB(e,n,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=gs){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,bi.toWorkingColorSpace(this,n),this}setRGB(e,n,r,i=bi.workingColorSpace){return this.r=e,this.g=n,this.b=r,bi.toWorkingColorSpace(this,i),this}setHSL(e,n,r,i=bi.workingColorSpace){if(e=oL(e,1),n=Gr(n,0,1),r=Gr(r,0,1),n===0)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+n):r+n-r*n,s=2*r-a;this.r=Gm(s,a,e+1/3),this.g=Gm(s,a,e),this.b=Gm(s,a,e-1/3)}return bi.toWorkingColorSpace(this,i),this}setStyle(e,n=gs){function r(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const s=i[1],o=i[2];switch(s){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,bi.toWorkingColorSpace(this,n),r(a[4]),this;if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,bi.toWorkingColorSpace(this,n),r(a[4]),this;break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const l=parseFloat(a[1])/360,u=parseFloat(a[2])/100,c=parseFloat(a[3])/100;return r(a[4]),this.setHSL(l,u,c,n)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=i[1],s=a.length;if(s===3)return this.r=parseInt(a.charAt(0)+a.charAt(0),16)/255,this.g=parseInt(a.charAt(1)+a.charAt(1),16)/255,this.b=parseInt(a.charAt(2)+a.charAt(2),16)/255,bi.toWorkingColorSpace(this,n),this;if(s===6)return this.r=parseInt(a.charAt(0)+a.charAt(1),16)/255,this.g=parseInt(a.charAt(2)+a.charAt(3),16)/255,this.b=parseInt(a.charAt(4)+a.charAt(5),16)/255,bi.toWorkingColorSpace(this,n),this;console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=gs){const r=W8[e.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=$c(e.r),this.g=$c(e.g),this.b=$c(e.b),this}copyLinearToSRGB(e){return this.r=Rm(e.r),this.g=Rm(e.g),this.b=Rm(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=gs){return bi.fromWorkingColorSpace(li.copy(this),e),Gr(li.r*255,0,255)<<16^Gr(li.g*255,0,255)<<8^Gr(li.b*255,0,255)<<0}getHexString(e=gs){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=bi.workingColorSpace){bi.fromWorkingColorSpace(li.copy(this),n);const r=li.r,i=li.g,a=li.b,s=Math.max(r,i,a),o=Math.min(r,i,a);let l,u;const c=(o+s)/2;if(o===s)l=0,u=0;else{const d=s-o;switch(u=c<=.5?d/(s+o):d/(2-s-o),s){case r:l=(i-a)/d+(i<a?6:0);break;case i:l=(a-r)/d+2;break;case a:l=(r-i)/d+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,n=bi.workingColorSpace){return bi.fromWorkingColorSpace(li.copy(this),n),e.r=li.r,e.g=li.g,e.b=li.b,e}getStyle(e=gs){bi.fromWorkingColorSpace(li.copy(this),e);const n=li.r,r=li.g,i=li.b;return e!==gs?`color(${e} ${n.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${n*255|0},${r*255|0},${i*255|0})`}offsetHSL(e,n,r){return this.getHSL(Ra),Ra.h+=e,Ra.s+=n,Ra.l+=r,this.setHSL(Ra.h,Ra.s,Ra.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL(Ra),e.getHSL(Vh);const r=Im(Ra.h,Vh.h,n),i=Im(Ra.s,Vh.s,n),a=Im(Ra.l,Vh.l,n);return this.setHSL(r,i,a),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const li=new Sn;Sn.NAMES=W8;class ny extends bu{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Sn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Tr=new Ee,Hh=new Lt;class Ui{constructor(e,n,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=r,this.usage=Mb,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,n,r){e*=this.itemSize,r*=n.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[e+i]=n.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)Hh.fromBufferAttribute(this,n),Hh.applyMatrix3(e),this.setXY(n,Hh.x,Hh.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)Tr.fromBufferAttribute(this,n),Tr.applyMatrix3(e),this.setXYZ(n,Tr.x,Tr.y,Tr.z);return this}applyMatrix4(e){for(let n=0,r=this.count;n<r;n++)Tr.fromBufferAttribute(this,n),Tr.applyMatrix4(e),this.setXYZ(n,Tr.x,Tr.y,Tr.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)Tr.fromBufferAttribute(this,n),Tr.applyNormalMatrix(e),this.setXYZ(n,Tr.x,Tr.y,Tr.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)Tr.fromBufferAttribute(this,n),Tr.transformDirection(e),this.setXYZ(n,Tr.x,Tr.y,Tr.z);return this}set(e,n=0){return this.array.set(e,n),this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Lh(n,this.array)),n}setX(e,n){return this.normalized&&(n=Ki(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Lh(n,this.array)),n}setY(e,n){return this.normalized&&(n=Ki(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Lh(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Ki(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Lh(n,this.array)),n}setW(e,n){return this.normalized&&(n=Ki(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=Ki(n,this.array),r=Ki(r,this.array)),this.array[e+0]=n,this.array[e+1]=r,this}setXYZ(e,n,r,i){return e*=this.itemSize,this.normalized&&(n=Ki(n,this.array),r=Ki(r,this.array),i=Ki(i,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,n,r,i,a){return e*=this.itemSize,this.normalized&&(n=Ki(n,this.array),r=Ki(r,this.array),i=Ki(i,this.array),a=Ki(a,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Mb&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class G8 extends Ui{constructor(e,n,r){super(new Uint16Array(e),n,r)}}class q8 extends Ui{constructor(e,n,r){super(new Uint32Array(e),n,r)}}class Xr extends Ui{constructor(e,n,r){super(new Float32Array(e),n,r)}}let EL=0;const va=new tr,qm=new Ar,oc=new Ee,Zi=new Hf,kd=new Hf,Hr=new Ee;class la extends _u{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:EL++}),this.uuid=Vf(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(F8(e)?q8:G8)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,r=0){this.groups.push({start:e,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const a=new Ii().getNormalMatrix(e);r.applyNormalMatrix(a),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return va.makeRotationFromQuaternion(e),this.applyMatrix4(va),this}rotateX(e){return va.makeRotationX(e),this.applyMatrix4(va),this}rotateY(e){return va.makeRotationY(e),this.applyMatrix4(va),this}rotateZ(e){return va.makeRotationZ(e),this.applyMatrix4(va),this}translate(e,n,r){return va.makeTranslation(e,n,r),this.applyMatrix4(va),this}scale(e,n,r){return va.makeScale(e,n,r),this.applyMatrix4(va),this}lookAt(e){return qm.lookAt(e),qm.updateMatrix(),this.applyMatrix4(qm.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(oc).negate(),this.translate(oc.x,oc.y,oc.z),this}setFromPoints(e){const n=[];for(let r=0,i=e.length;r<i;r++){const a=e[r];n.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new Xr(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Hf);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Ee(-1/0,-1/0,-1/0),new Ee(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let r=0,i=n.length;r<i;r++){const a=n[r];Zi.setFromBufferAttribute(a),this.morphTargetsRelative?(Hr.addVectors(this.boundingBox.min,Zi.min),this.boundingBox.expandByPoint(Hr),Hr.addVectors(this.boundingBox.max,Zi.max),this.boundingBox.expandByPoint(Hr)):(this.boundingBox.expandByPoint(Zi.min),this.boundingBox.expandByPoint(Zi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new kp);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Ee,1/0);return}if(e){const r=this.boundingSphere.center;if(Zi.setFromBufferAttribute(e),n)for(let a=0,s=n.length;a<s;a++){const o=n[a];kd.setFromBufferAttribute(o),this.morphTargetsRelative?(Hr.addVectors(Zi.min,kd.min),Zi.expandByPoint(Hr),Hr.addVectors(Zi.max,kd.max),Zi.expandByPoint(Hr)):(Zi.expandByPoint(kd.min),Zi.expandByPoint(kd.max))}Zi.getCenter(r);let i=0;for(let a=0,s=e.count;a<s;a++)Hr.fromBufferAttribute(e,a),i=Math.max(i,r.distanceToSquared(Hr));if(n)for(let a=0,s=n.length;a<s;a++){const o=n[a],l=this.morphTargetsRelative;for(let u=0,c=o.count;u<c;u++)Hr.fromBufferAttribute(o,u),l&&(oc.fromBufferAttribute(e,u),Hr.add(oc)),i=Math.max(i,r.distanceToSquared(Hr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=n.position.array,a=n.normal.array,s=n.uv.array,o=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ui(new Float32Array(4*o),4));const l=this.getAttribute("tangent").array,u=[],c=[];for(let Y=0;Y<o;Y++)u[Y]=new Ee,c[Y]=new Ee;const d=new Ee,h=new Ee,v=new Ee,x=new Lt,_=new Lt,b=new Lt,S=new Ee,E=new Ee;function C(Y,fe,Q){d.fromArray(i,Y*3),h.fromArray(i,fe*3),v.fromArray(i,Q*3),x.fromArray(s,Y*2),_.fromArray(s,fe*2),b.fromArray(s,Q*2),h.sub(d),v.sub(d),_.sub(x),b.sub(x);const G=1/(_.x*b.y-b.x*_.y);isFinite(G)&&(S.copy(h).multiplyScalar(b.y).addScaledVector(v,-_.y).multiplyScalar(G),E.copy(v).multiplyScalar(_.x).addScaledVector(h,-b.x).multiplyScalar(G),u[Y].add(S),u[fe].add(S),u[Q].add(S),c[Y].add(E),c[fe].add(E),c[Q].add(E))}let A=this.groups;A.length===0&&(A=[{start:0,count:r.length}]);for(let Y=0,fe=A.length;Y<fe;++Y){const Q=A[Y],G=Q.start,re=Q.count;for(let he=G,ye=G+re;he<ye;he+=3)C(r[he+0],r[he+1],r[he+2])}const D=new Ee,O=new Ee,V=new Ee,P=new Ee;function U(Y){V.fromArray(a,Y*3),P.copy(V);const fe=u[Y];D.copy(fe),D.sub(V.multiplyScalar(V.dot(fe))).normalize(),O.crossVectors(P,fe);const G=O.dot(c[Y])<0?-1:1;l[Y*4]=D.x,l[Y*4+1]=D.y,l[Y*4+2]=D.z,l[Y*4+3]=G}for(let Y=0,fe=A.length;Y<fe;++Y){const Q=A[Y],G=Q.start,re=Q.count;for(let he=G,ye=G+re;he<ye;he+=3)U(r[he+0]),U(r[he+1]),U(r[he+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ui(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let h=0,v=r.count;h<v;h++)r.setXYZ(h,0,0,0);const i=new Ee,a=new Ee,s=new Ee,o=new Ee,l=new Ee,u=new Ee,c=new Ee,d=new Ee;if(e)for(let h=0,v=e.count;h<v;h+=3){const x=e.getX(h+0),_=e.getX(h+1),b=e.getX(h+2);i.fromBufferAttribute(n,x),a.fromBufferAttribute(n,_),s.fromBufferAttribute(n,b),c.subVectors(s,a),d.subVectors(i,a),c.cross(d),o.fromBufferAttribute(r,x),l.fromBufferAttribute(r,_),u.fromBufferAttribute(r,b),o.add(c),l.add(c),u.add(c),r.setXYZ(x,o.x,o.y,o.z),r.setXYZ(_,l.x,l.y,l.z),r.setXYZ(b,u.x,u.y,u.z)}else for(let h=0,v=n.count;h<v;h+=3)i.fromBufferAttribute(n,h+0),a.fromBufferAttribute(n,h+1),s.fromBufferAttribute(n,h+2),c.subVectors(s,a),d.subVectors(i,a),c.cross(d),r.setXYZ(h+0,c.x,c.y,c.z),r.setXYZ(h+1,c.x,c.y,c.z),r.setXYZ(h+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let n=0,r=e.count;n<r;n++)Hr.fromBufferAttribute(e,n),Hr.normalize(),e.setXYZ(n,Hr.x,Hr.y,Hr.z)}toNonIndexed(){function e(o,l){const u=o.array,c=o.itemSize,d=o.normalized,h=new u.constructor(l.length*c);let v=0,x=0;for(let _=0,b=l.length;_<b;_++){o.isInterleavedBufferAttribute?v=l[_]*o.data.stride+o.offset:v=l[_]*c;for(let S=0;S<c;S++)h[x++]=u[v++]}return new Ui(h,c,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new la,r=this.index.array,i=this.attributes;for(const o in i){const l=i[o],u=e(l,r);n.setAttribute(o,u)}const a=this.morphAttributes;for(const o in a){const l=[],u=a[o];for(let c=0,d=u.length;c<d;c++){const h=u[c],v=e(h,r);l.push(v)}n.morphAttributes[o]=l}n.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,l=s.length;o<l;o++){const u=s[o];n.addGroup(u.start,u.count,u.materialIndex)}return n}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const l in r){const u=r[l];e.data.attributes[l]=u.toJSON(e.data)}const i={};let a=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let d=0,h=u.length;d<h;d++){const v=u[d];c.push(v.toJSON(e.data))}c.length>0&&(i[l]=c,a=!0)}a&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(n));const i=e.attributes;for(const u in i){const c=i[u];this.setAttribute(u,c.clone(n))}const a=e.morphAttributes;for(const u in a){const c=[],d=a[u];for(let h=0,v=d.length;h<v;h++)c.push(d[h].clone(n));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let u=0,c=s.length;u<c;u++){const d=s[u];this.addGroup(d.start,d.count,d.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const zb=new tr,cs=new ey,Wh=new kp,Ob=new Ee,Id=new Ee,$d=new Ee,Pd=new Ee,jm=new Ee,Gh=new Ee,qh=new Lt,jh=new Lt,Xh=new Lt,Xm=new Ee,Kh=new Ee;class $i extends Ar{constructor(e=new la,n=new ny){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,s=i.length;a<s;a++){const o=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}getVertexPosition(e,n){const r=this.geometry,i=r.attributes.position,a=r.morphAttributes.position,s=r.morphTargetsRelative;n.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(a&&o){Gh.set(0,0,0);for(let l=0,u=a.length;l<u;l++){const c=o[l],d=a[l];c!==0&&(jm.fromBufferAttribute(d,e),s?Gh.addScaledVector(jm,c):Gh.addScaledVector(jm.sub(n),c))}n.add(Gh)}return this.isSkinnedMesh&&this.boneTransform(e,n),n}raycast(e,n){const r=this.geometry,i=this.material,a=this.matrixWorld;if(i===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),Wh.copy(r.boundingSphere),Wh.applyMatrix4(a),cs.copy(e.ray).recast(e.near),Wh.containsPoint(cs.origin)===!1&&(cs.intersectSphere(Wh,Ob)===null||cs.origin.distanceToSquared(Ob)>(e.far-e.near)**2))||(zb.copy(a).invert(),cs.copy(e.ray).applyMatrix4(zb),r.boundingBox!==null&&cs.intersectsBox(r.boundingBox)===!1))return;let s;const o=r.index,l=r.attributes.position,u=r.attributes.uv,c=r.attributes.uv2,d=r.groups,h=r.drawRange;if(o!==null)if(Array.isArray(i))for(let v=0,x=d.length;v<x;v++){const _=d[v],b=i[_.materialIndex],S=Math.max(_.start,h.start),E=Math.min(o.count,Math.min(_.start+_.count,h.start+h.count));for(let C=S,A=E;C<A;C+=3){const D=o.getX(C),O=o.getX(C+1),V=o.getX(C+2);s=Yh(this,b,e,cs,u,c,D,O,V),s&&(s.faceIndex=Math.floor(C/3),s.face.materialIndex=_.materialIndex,n.push(s))}}else{const v=Math.max(0,h.start),x=Math.min(o.count,h.start+h.count);for(let _=v,b=x;_<b;_+=3){const S=o.getX(_),E=o.getX(_+1),C=o.getX(_+2);s=Yh(this,i,e,cs,u,c,S,E,C),s&&(s.faceIndex=Math.floor(_/3),n.push(s))}}else if(l!==void 0)if(Array.isArray(i))for(let v=0,x=d.length;v<x;v++){const _=d[v],b=i[_.materialIndex],S=Math.max(_.start,h.start),E=Math.min(l.count,Math.min(_.start+_.count,h.start+h.count));for(let C=S,A=E;C<A;C+=3){const D=C,O=C+1,V=C+2;s=Yh(this,b,e,cs,u,c,D,O,V),s&&(s.faceIndex=Math.floor(C/3),s.face.materialIndex=_.materialIndex,n.push(s))}}else{const v=Math.max(0,h.start),x=Math.min(l.count,h.start+h.count);for(let _=v,b=x;_<b;_+=3){const S=_,E=_+1,C=_+2;s=Yh(this,i,e,cs,u,c,S,E,C),s&&(s.faceIndex=Math.floor(_/3),n.push(s))}}}}function TL(t,e,n,r,i,a,s,o){let l;if(e.side===ia?l=r.intersectTriangle(s,a,i,!0,o):l=r.intersectTriangle(i,a,s,e.side===nl,o),l===null)return null;Kh.copy(o),Kh.applyMatrix4(t.matrixWorld);const u=n.ray.origin.distanceTo(Kh);return u<n.near||u>n.far?null:{distance:u,point:Kh.clone(),object:t}}function Yh(t,e,n,r,i,a,s,o,l){t.getVertexPosition(s,Id),t.getVertexPosition(o,$d),t.getVertexPosition(l,Pd);const u=TL(t,e,n,r,Id,$d,Pd,Xm);if(u){i&&(qh.fromBufferAttribute(i,s),jh.fromBufferAttribute(i,o),Xh.fromBufferAttribute(i,l),u.uv=eo.getUV(Xm,Id,$d,Pd,qh,jh,Xh,new Lt)),a&&(qh.fromBufferAttribute(a,s),jh.fromBufferAttribute(a,o),Xh.fromBufferAttribute(a,l),u.uv2=eo.getUV(Xm,Id,$d,Pd,qh,jh,Xh,new Lt));const c={a:s,b:o,c:l,normal:new Ee,materialIndex:0};eo.getNormal(Id,$d,Pd,c.normal),u.face=c}return u}class jc extends la{constructor(e=1,n=1,r=1,i=1,a=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:r,widthSegments:i,heightSegments:a,depthSegments:s};const o=this;i=Math.floor(i),a=Math.floor(a),s=Math.floor(s);const l=[],u=[],c=[],d=[];let h=0,v=0;x("z","y","x",-1,-1,r,n,e,s,a,0),x("z","y","x",1,-1,r,n,-e,s,a,1),x("x","z","y",1,1,e,r,n,i,s,2),x("x","z","y",1,-1,e,r,-n,i,s,3),x("x","y","z",1,-1,e,n,r,i,a,4),x("x","y","z",-1,-1,e,n,-r,i,a,5),this.setIndex(l),this.setAttribute("position",new Xr(u,3)),this.setAttribute("normal",new Xr(c,3)),this.setAttribute("uv",new Xr(d,2));function x(_,b,S,E,C,A,D,O,V,P,U){const Y=A/V,fe=D/P,Q=A/2,G=D/2,re=O/2,he=V+1,ye=P+1;let $e=0,_e=0;const de=new Ee;for(let Oe=0;Oe<ye;Oe++){const ve=Oe*fe-G;for(let ie=0;ie<he;ie++){const Pe=ie*Y-Q;de[_]=Pe*E,de[b]=ve*C,de[S]=re,u.push(de.x,de.y,de.z),de[_]=0,de[b]=0,de[S]=O>0?1:-1,c.push(de.x,de.y,de.z),d.push(ie/V),d.push(1-Oe/P),$e+=1}}for(let Oe=0;Oe<P;Oe++)for(let ve=0;ve<V;ve++){const ie=h+ve+he*Oe,Pe=h+ve+he*(Oe+1),et=h+(ve+1)+he*(Oe+1),ne=h+(ve+1)+he*Oe;l.push(ie,Pe,ne),l.push(Pe,et,ne),_e+=6}o.addGroup(v,_e,U),v+=_e,h+=$e}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Fc(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function Si(t){const e={};for(let n=0;n<t.length;n++){const r=Fc(t[n]);for(const i in r)e[i]=r[i]}return e}function CL(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function j8(t){return t.getRenderTarget()===null&&t.outputEncoding===sr?gs:$f}const AL={clone:Fc,merge:Si};var kL=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,IL=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class fu extends bu{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=kL,this.fragmentShader=IL,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Fc(e.uniforms),this.uniformsGroups=CL(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const i in this.uniforms){const s=this.uniforms[i].value;s&&s.isTexture?n.uniforms[i]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?n.uniforms[i]={type:"c",value:s.getHex()}:s&&s.isVector2?n.uniforms[i]={type:"v2",value:s.toArray()}:s&&s.isVector3?n.uniforms[i]={type:"v3",value:s.toArray()}:s&&s.isVector4?n.uniforms[i]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?n.uniforms[i]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?n.uniforms[i]={type:"m4",value:s.toArray()}:n.uniforms[i]={value:s}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class X8 extends Ar{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new tr,this.projectionMatrix=new tr,this.projectionMatrixInverse=new tr}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(-n[8],-n[9],-n[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Ni extends X8{constructor(e=50,n=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Bv*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(km*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Bv*2*Math.atan(Math.tan(km*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,n,r,i,a,s){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(km*.5*this.fov)/this.zoom,r=2*n,i=this.aspect*r,a=-.5*i;const s=this.view;if(this.view!==null&&this.view.enabled){const l=s.fullWidth,u=s.fullHeight;a+=s.offsetX*i/l,n-=s.offsetY*r/u,i*=s.width/l,r*=s.height/u}const o=this.filmOffset;o!==0&&(a+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,n,n-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const lc=-90,uc=1;class $L extends Ar{constructor(e,n,r){super(),this.type="CubeCamera",this.renderTarget=r;const i=new Ni(lc,uc,e,n);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);const a=new Ni(lc,uc,e,n);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(-1,0,0),this.add(a);const s=new Ni(lc,uc,e,n);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);const o=new Ni(lc,uc,e,n);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);const l=new Ni(lc,uc,e,n);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const u=new Ni(lc,uc,e,n);u.layers=this.layers,u.up.set(0,1,0),u.lookAt(0,0,-1),this.add(u)}update(e,n){this.parent===null&&this.updateMatrixWorld();const r=this.renderTarget,[i,a,s,o,l,u]=this.children,c=e.getRenderTarget(),d=e.toneMapping,h=e.xr.enabled;e.toneMapping=Ss,e.xr.enabled=!1;const v=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(n,i),e.setRenderTarget(r,1),e.render(n,a),e.setRenderTarget(r,2),e.render(n,s),e.setRenderTarget(r,3),e.render(n,o),e.setRenderTarget(r,4),e.render(n,l),r.texture.generateMipmaps=v,e.setRenderTarget(r,5),e.render(n,u),e.setRenderTarget(c),e.toneMapping=d,e.xr.enabled=h,r.texture.needsPMREMUpdate=!0}}class K8 extends Fi{constructor(e,n,r,i,a,s,o,l,u,c){e=e!==void 0?e:[],n=n!==void 0?n:zc,super(e,n,r,i,a,s,o,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class PL extends al{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new K8(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:ba}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.encoding=n.encoding,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new jc(5,5,5),a=new fu({name:"CubemapFromEquirect",uniforms:Fc(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:ia,blending:Qo});a.uniforms.tEquirect.value=n;const s=new $i(i,a),o=n.minFilter;return n.minFilter===If&&(n.minFilter=ba),new $L(1,10,this).update(e,s),n.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(e,n,r,i){const a=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(n,r,i);e.setRenderTarget(a)}}const Km=new Ee,RL=new Ee,DL=new Ii;class Xo{constructor(e=new Ee(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,r,i){return this.normal.set(e,n,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,r){const i=Km.subVectors(r,n).cross(RL.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const r=e.delta(Km),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/i;return a<0||a>1?null:n.copy(e.start).addScaledVector(r,a)}intersectsLine(e){const n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const r=n||DL.getNormalMatrix(e),i=this.coplanarPoint(Km).applyMatrix4(e),a=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const cc=new kp,Zh=new Ee;class ry{constructor(e=new Xo,n=new Xo,r=new Xo,i=new Xo,a=new Xo,s=new Xo){this.planes=[e,n,r,i,a,s]}set(e,n,r,i,a,s){const o=this.planes;return o[0].copy(e),o[1].copy(n),o[2].copy(r),o[3].copy(i),o[4].copy(a),o[5].copy(s),this}copy(e){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){const n=this.planes,r=e.elements,i=r[0],a=r[1],s=r[2],o=r[3],l=r[4],u=r[5],c=r[6],d=r[7],h=r[8],v=r[9],x=r[10],_=r[11],b=r[12],S=r[13],E=r[14],C=r[15];return n[0].setComponents(o-i,d-l,_-h,C-b).normalize(),n[1].setComponents(o+i,d+l,_+h,C+b).normalize(),n[2].setComponents(o+a,d+u,_+v,C+S).normalize(),n[3].setComponents(o-a,d-u,_-v,C-S).normalize(),n[4].setComponents(o-s,d-c,_-x,C-E).normalize(),n[5].setComponents(o+s,d+c,_+x,C+E).normalize(),this}intersectsObject(e){const n=e.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),cc.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(cc)}intersectsSprite(e){return cc.center.set(0,0,0),cc.radius=.7071067811865476,cc.applyMatrix4(e.matrixWorld),this.intersectsSphere(cc)}intersectsSphere(e){const n=this.planes,r=e.center,i=-e.radius;for(let a=0;a<6;a++)if(n[a].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const n=this.planes;for(let r=0;r<6;r++){const i=n[r];if(Zh.x=i.normal.x>0?e.max.x:e.min.x,Zh.y=i.normal.y>0?e.max.y:e.min.y,Zh.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Zh)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Y8(){let t=null,e=!1,n=null,r=null;function i(a,s){n(a,s),r=t.requestAnimationFrame(i)}return{start:function(){e!==!0&&n!==null&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(a){n=a},setContext:function(a){t=a}}}function LL(t,e){const n=e.isWebGL2,r=new WeakMap;function i(u,c){const d=u.array,h=u.usage,v=t.createBuffer();t.bindBuffer(c,v),t.bufferData(c,d,h),u.onUploadCallback();let x;if(d instanceof Float32Array)x=5126;else if(d instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(n)x=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else x=5123;else if(d instanceof Int16Array)x=5122;else if(d instanceof Uint32Array)x=5125;else if(d instanceof Int32Array)x=5124;else if(d instanceof Int8Array)x=5120;else if(d instanceof Uint8Array)x=5121;else if(d instanceof Uint8ClampedArray)x=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:v,type:x,bytesPerElement:d.BYTES_PER_ELEMENT,version:u.version}}function a(u,c,d){const h=c.array,v=c.updateRange;t.bindBuffer(d,u),v.count===-1?t.bufferSubData(d,0,h):(n?t.bufferSubData(d,v.offset*h.BYTES_PER_ELEMENT,h,v.offset,v.count):t.bufferSubData(d,v.offset*h.BYTES_PER_ELEMENT,h.subarray(v.offset,v.offset+v.count)),v.count=-1),c.onUploadCallback()}function s(u){return u.isInterleavedBufferAttribute&&(u=u.data),r.get(u)}function o(u){u.isInterleavedBufferAttribute&&(u=u.data);const c=r.get(u);c&&(t.deleteBuffer(c.buffer),r.delete(u))}function l(u,c){if(u.isGLBufferAttribute){const h=r.get(u);(!h||h.version<u.version)&&r.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const d=r.get(u);d===void 0?r.set(u,i(u,c)):d.version<u.version&&(a(d.buffer,u,c),d.version=u.version)}return{get:s,remove:o,update:l}}class Ip extends la{constructor(e=1,n=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:r,heightSegments:i};const a=e/2,s=n/2,o=Math.floor(r),l=Math.floor(i),u=o+1,c=l+1,d=e/o,h=n/l,v=[],x=[],_=[],b=[];for(let S=0;S<c;S++){const E=S*h-s;for(let C=0;C<u;C++){const A=C*d-a;x.push(A,-E,0),_.push(0,0,1),b.push(C/o),b.push(1-S/l)}}for(let S=0;S<l;S++)for(let E=0;E<o;E++){const C=E+u*S,A=E+u*(S+1),D=E+1+u*(S+1),O=E+1+u*S;v.push(C,A,O),v.push(A,D,O)}this.setIndex(v),this.setAttribute("position",new Xr(x,3)),this.setAttribute("normal",new Xr(_,3)),this.setAttribute("uv",new Xr(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ip(e.width,e.height,e.widthSegments,e.heightSegments)}}var zL=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,OL=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,NL=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,BL=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,FL=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,UL=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,VL="vec3 transformed = vec3( position );",HL=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,WL=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,GL=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,qL=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,jL=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,XL=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,KL=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,YL=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,ZL=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,JL=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,QL=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,ez=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,tz=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,nz=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,rz=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,iz=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,az=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,sz=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,oz=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,lz="gl_FragColor = linearToOutputTexel( gl_FragColor );",uz=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,cz=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,dz=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,fz=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,hz=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,pz=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,mz=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,gz=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,vz=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,yz=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,_z=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,bz=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,xz=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,wz=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Sz=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Mz=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Ez=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,Tz=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Cz=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Az=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,kz=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Iz=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,$z=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Pz=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Rz=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Dz=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Lz=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,zz=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Oz=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Nz=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Bz=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Fz=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Uz=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Vz=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Hz=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Wz=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Gz=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,qz=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,jz=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Xz=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Kz=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Yz=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Zz=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Jz=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Qz=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,eO=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,tO=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,nO=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,rO=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,iO=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,aO=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,sO=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,oO=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,lO=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,uO=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,cO=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,dO=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,fO=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,hO=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,pO=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,mO=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,gO=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,vO=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,yO=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,_O=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,bO=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,xO=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,wO=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,SO=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,MO=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,EO=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,TO=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		
		vec2 lodFudge = pow( 1.95, lod ) / fullSize;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec2 fullSize = vec2( textureSize( sampler, 0 ) );
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,CO=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,AO=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,kO=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,IO=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,$O=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,PO=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,RO=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const DO=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,LO=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,zO=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,OO=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,NO=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,BO=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,FO=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,UO=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,VO=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,HO=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,WO=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,GO=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,qO=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,jO=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,XO=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,KO=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,YO=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ZO=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,JO=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,QO=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,eN=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,tN=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,nN=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,rN=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iN=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,aN=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sN=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,oN=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lN=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,uN=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,cN=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,dN=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,fN=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,hN=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Cn={alphamap_fragment:zL,alphamap_pars_fragment:OL,alphatest_fragment:NL,alphatest_pars_fragment:BL,aomap_fragment:FL,aomap_pars_fragment:UL,begin_vertex:VL,beginnormal_vertex:HL,bsdfs:WL,iridescence_fragment:GL,bumpmap_pars_fragment:qL,clipping_planes_fragment:jL,clipping_planes_pars_fragment:XL,clipping_planes_pars_vertex:KL,clipping_planes_vertex:YL,color_fragment:ZL,color_pars_fragment:JL,color_pars_vertex:QL,color_vertex:ez,common:tz,cube_uv_reflection_fragment:nz,defaultnormal_vertex:rz,displacementmap_pars_vertex:iz,displacementmap_vertex:az,emissivemap_fragment:sz,emissivemap_pars_fragment:oz,encodings_fragment:lz,encodings_pars_fragment:uz,envmap_fragment:cz,envmap_common_pars_fragment:dz,envmap_pars_fragment:fz,envmap_pars_vertex:hz,envmap_physical_pars_fragment:Ez,envmap_vertex:pz,fog_vertex:mz,fog_pars_vertex:gz,fog_fragment:vz,fog_pars_fragment:yz,gradientmap_pars_fragment:_z,lightmap_fragment:bz,lightmap_pars_fragment:xz,lights_lambert_fragment:wz,lights_lambert_pars_fragment:Sz,lights_pars_begin:Mz,lights_toon_fragment:Tz,lights_toon_pars_fragment:Cz,lights_phong_fragment:Az,lights_phong_pars_fragment:kz,lights_physical_fragment:Iz,lights_physical_pars_fragment:$z,lights_fragment_begin:Pz,lights_fragment_maps:Rz,lights_fragment_end:Dz,logdepthbuf_fragment:Lz,logdepthbuf_pars_fragment:zz,logdepthbuf_pars_vertex:Oz,logdepthbuf_vertex:Nz,map_fragment:Bz,map_pars_fragment:Fz,map_particle_fragment:Uz,map_particle_pars_fragment:Vz,metalnessmap_fragment:Hz,metalnessmap_pars_fragment:Wz,morphcolor_vertex:Gz,morphnormal_vertex:qz,morphtarget_pars_vertex:jz,morphtarget_vertex:Xz,normal_fragment_begin:Kz,normal_fragment_maps:Yz,normal_pars_fragment:Zz,normal_pars_vertex:Jz,normal_vertex:Qz,normalmap_pars_fragment:eO,clearcoat_normal_fragment_begin:tO,clearcoat_normal_fragment_maps:nO,clearcoat_pars_fragment:rO,iridescence_pars_fragment:iO,output_fragment:aO,packing:sO,premultiplied_alpha_fragment:oO,project_vertex:lO,dithering_fragment:uO,dithering_pars_fragment:cO,roughnessmap_fragment:dO,roughnessmap_pars_fragment:fO,shadowmap_pars_fragment:hO,shadowmap_pars_vertex:pO,shadowmap_vertex:mO,shadowmask_pars_fragment:gO,skinbase_vertex:vO,skinning_pars_vertex:yO,skinning_vertex:_O,skinnormal_vertex:bO,specularmap_fragment:xO,specularmap_pars_fragment:wO,tonemapping_fragment:SO,tonemapping_pars_fragment:MO,transmission_fragment:EO,transmission_pars_fragment:TO,uv_pars_fragment:CO,uv_pars_vertex:AO,uv_vertex:kO,uv2_pars_fragment:IO,uv2_pars_vertex:$O,uv2_vertex:PO,worldpos_vertex:RO,background_vert:DO,background_frag:LO,backgroundCube_vert:zO,backgroundCube_frag:OO,cube_vert:NO,cube_frag:BO,depth_vert:FO,depth_frag:UO,distanceRGBA_vert:VO,distanceRGBA_frag:HO,equirect_vert:WO,equirect_frag:GO,linedashed_vert:qO,linedashed_frag:jO,meshbasic_vert:XO,meshbasic_frag:KO,meshlambert_vert:YO,meshlambert_frag:ZO,meshmatcap_vert:JO,meshmatcap_frag:QO,meshnormal_vert:eN,meshnormal_frag:tN,meshphong_vert:nN,meshphong_frag:rN,meshphysical_vert:iN,meshphysical_frag:aN,meshtoon_vert:sN,meshtoon_frag:oN,points_vert:lN,points_frag:uN,shadow_vert:cN,shadow_frag:dN,sprite_vert:fN,sprite_frag:hN},Pt={common:{diffuse:{value:new Sn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ii},uv2Transform:{value:new Ii},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Lt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Sn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Sn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ii}},sprite:{diffuse:{value:new Sn(16777215)},opacity:{value:1},center:{value:new Lt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ii}}},ys={basic:{uniforms:Si([Pt.common,Pt.specularmap,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.fog]),vertexShader:Cn.meshbasic_vert,fragmentShader:Cn.meshbasic_frag},lambert:{uniforms:Si([Pt.common,Pt.specularmap,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.emissivemap,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,Pt.fog,Pt.lights,{emissive:{value:new Sn(0)}}]),vertexShader:Cn.meshlambert_vert,fragmentShader:Cn.meshlambert_frag},phong:{uniforms:Si([Pt.common,Pt.specularmap,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.emissivemap,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,Pt.fog,Pt.lights,{emissive:{value:new Sn(0)},specular:{value:new Sn(1118481)},shininess:{value:30}}]),vertexShader:Cn.meshphong_vert,fragmentShader:Cn.meshphong_frag},standard:{uniforms:Si([Pt.common,Pt.envmap,Pt.aomap,Pt.lightmap,Pt.emissivemap,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,Pt.roughnessmap,Pt.metalnessmap,Pt.fog,Pt.lights,{emissive:{value:new Sn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Cn.meshphysical_vert,fragmentShader:Cn.meshphysical_frag},toon:{uniforms:Si([Pt.common,Pt.aomap,Pt.lightmap,Pt.emissivemap,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,Pt.gradientmap,Pt.fog,Pt.lights,{emissive:{value:new Sn(0)}}]),vertexShader:Cn.meshtoon_vert,fragmentShader:Cn.meshtoon_frag},matcap:{uniforms:Si([Pt.common,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,Pt.fog,{matcap:{value:null}}]),vertexShader:Cn.meshmatcap_vert,fragmentShader:Cn.meshmatcap_frag},points:{uniforms:Si([Pt.points,Pt.fog]),vertexShader:Cn.points_vert,fragmentShader:Cn.points_frag},dashed:{uniforms:Si([Pt.common,Pt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Cn.linedashed_vert,fragmentShader:Cn.linedashed_frag},depth:{uniforms:Si([Pt.common,Pt.displacementmap]),vertexShader:Cn.depth_vert,fragmentShader:Cn.depth_frag},normal:{uniforms:Si([Pt.common,Pt.bumpmap,Pt.normalmap,Pt.displacementmap,{opacity:{value:1}}]),vertexShader:Cn.meshnormal_vert,fragmentShader:Cn.meshnormal_frag},sprite:{uniforms:Si([Pt.sprite,Pt.fog]),vertexShader:Cn.sprite_vert,fragmentShader:Cn.sprite_frag},background:{uniforms:{uvTransform:{value:new Ii},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Cn.background_vert,fragmentShader:Cn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Cn.backgroundCube_vert,fragmentShader:Cn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Cn.cube_vert,fragmentShader:Cn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Cn.equirect_vert,fragmentShader:Cn.equirect_frag},distanceRGBA:{uniforms:Si([Pt.common,Pt.displacementmap,{referencePosition:{value:new Ee},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Cn.distanceRGBA_vert,fragmentShader:Cn.distanceRGBA_frag},shadow:{uniforms:Si([Pt.lights,Pt.fog,{color:{value:new Sn(0)},opacity:{value:1}}]),vertexShader:Cn.shadow_vert,fragmentShader:Cn.shadow_frag}};ys.physical={uniforms:Si([ys.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Lt(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Sn(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Lt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Sn(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Sn(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Cn.meshphysical_vert,fragmentShader:Cn.meshphysical_frag};const Jh={r:0,b:0,g:0};function pN(t,e,n,r,i,a,s){const o=new Sn(0);let l=a===!0?0:1,u,c,d=null,h=0,v=null;function x(b,S){let E=!1,C=S.isScene===!0?S.background:null;C&&C.isTexture&&(C=(S.backgroundBlurriness>0?n:e).get(C));const A=t.xr,D=A.getSession&&A.getSession();D&&D.environmentBlendMode==="additive"&&(C=null),C===null?_(o,l):C&&C.isColor&&(_(C,1),E=!0),(t.autoClear||E)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),C&&(C.isCubeTexture||C.mapping===Ap)?(c===void 0&&(c=new $i(new jc(1,1,1),new fu({name:"BackgroundCubeMaterial",uniforms:Fc(ys.backgroundCube.uniforms),vertexShader:ys.backgroundCube.vertexShader,fragmentShader:ys.backgroundCube.fragmentShader,side:ia,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(O,V,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),c.material.uniforms.envMap.value=C,c.material.uniforms.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=S.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,c.material.toneMapped=C.encoding!==sr,(d!==C||h!==C.version||v!==t.toneMapping)&&(c.material.needsUpdate=!0,d=C,h=C.version,v=t.toneMapping),c.layers.enableAll(),b.unshift(c,c.geometry,c.material,0,0,null)):C&&C.isTexture&&(u===void 0&&(u=new $i(new Ip(2,2),new fu({name:"BackgroundMaterial",uniforms:Fc(ys.background.uniforms),vertexShader:ys.background.vertexShader,fragmentShader:ys.background.fragmentShader,side:nl,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=C,u.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,u.material.toneMapped=C.encoding!==sr,C.matrixAutoUpdate===!0&&C.updateMatrix(),u.material.uniforms.uvTransform.value.copy(C.matrix),(d!==C||h!==C.version||v!==t.toneMapping)&&(u.material.needsUpdate=!0,d=C,h=C.version,v=t.toneMapping),u.layers.enableAll(),b.unshift(u,u.geometry,u.material,0,0,null))}function _(b,S){b.getRGB(Jh,j8(t)),r.buffers.color.setClear(Jh.r,Jh.g,Jh.b,S,s)}return{getClearColor:function(){return o},setClearColor:function(b,S=1){o.set(b),l=S,_(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(b){l=b,_(o,l)},render:x}}function mN(t,e,n,r){const i=t.getParameter(34921),a=r.isWebGL2?null:e.get("OES_vertex_array_object"),s=r.isWebGL2||a!==null,o={},l=b(null);let u=l,c=!1;function d(re,he,ye,$e,_e){let de=!1;if(s){const Oe=_($e,ye,he);u!==Oe&&(u=Oe,v(u.object)),de=S(re,$e,ye,_e),de&&E(re,$e,ye,_e)}else{const Oe=he.wireframe===!0;(u.geometry!==$e.id||u.program!==ye.id||u.wireframe!==Oe)&&(u.geometry=$e.id,u.program=ye.id,u.wireframe=Oe,de=!0)}_e!==null&&n.update(_e,34963),(de||c)&&(c=!1,P(re,he,ye,$e),_e!==null&&t.bindBuffer(34963,n.get(_e).buffer))}function h(){return r.isWebGL2?t.createVertexArray():a.createVertexArrayOES()}function v(re){return r.isWebGL2?t.bindVertexArray(re):a.bindVertexArrayOES(re)}function x(re){return r.isWebGL2?t.deleteVertexArray(re):a.deleteVertexArrayOES(re)}function _(re,he,ye){const $e=ye.wireframe===!0;let _e=o[re.id];_e===void 0&&(_e={},o[re.id]=_e);let de=_e[he.id];de===void 0&&(de={},_e[he.id]=de);let Oe=de[$e];return Oe===void 0&&(Oe=b(h()),de[$e]=Oe),Oe}function b(re){const he=[],ye=[],$e=[];for(let _e=0;_e<i;_e++)he[_e]=0,ye[_e]=0,$e[_e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:he,enabledAttributes:ye,attributeDivisors:$e,object:re,attributes:{},index:null}}function S(re,he,ye,$e){const _e=u.attributes,de=he.attributes;let Oe=0;const ve=ye.getAttributes();for(const ie in ve)if(ve[ie].location>=0){const et=_e[ie];let ne=de[ie];if(ne===void 0&&(ie==="instanceMatrix"&&re.instanceMatrix&&(ne=re.instanceMatrix),ie==="instanceColor"&&re.instanceColor&&(ne=re.instanceColor)),et===void 0||et.attribute!==ne||ne&&et.data!==ne.data)return!0;Oe++}return u.attributesNum!==Oe||u.index!==$e}function E(re,he,ye,$e){const _e={},de=he.attributes;let Oe=0;const ve=ye.getAttributes();for(const ie in ve)if(ve[ie].location>=0){let et=de[ie];et===void 0&&(ie==="instanceMatrix"&&re.instanceMatrix&&(et=re.instanceMatrix),ie==="instanceColor"&&re.instanceColor&&(et=re.instanceColor));const ne={};ne.attribute=et,et&&et.data&&(ne.data=et.data),_e[ie]=ne,Oe++}u.attributes=_e,u.attributesNum=Oe,u.index=$e}function C(){const re=u.newAttributes;for(let he=0,ye=re.length;he<ye;he++)re[he]=0}function A(re){D(re,0)}function D(re,he){const ye=u.newAttributes,$e=u.enabledAttributes,_e=u.attributeDivisors;ye[re]=1,$e[re]===0&&(t.enableVertexAttribArray(re),$e[re]=1),_e[re]!==he&&((r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](re,he),_e[re]=he)}function O(){const re=u.newAttributes,he=u.enabledAttributes;for(let ye=0,$e=he.length;ye<$e;ye++)he[ye]!==re[ye]&&(t.disableVertexAttribArray(ye),he[ye]=0)}function V(re,he,ye,$e,_e,de){r.isWebGL2===!0&&(ye===5124||ye===5125)?t.vertexAttribIPointer(re,he,ye,_e,de):t.vertexAttribPointer(re,he,ye,$e,_e,de)}function P(re,he,ye,$e){if(r.isWebGL2===!1&&(re.isInstancedMesh||$e.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;C();const _e=$e.attributes,de=ye.getAttributes(),Oe=he.defaultAttributeValues;for(const ve in de){const ie=de[ve];if(ie.location>=0){let Pe=_e[ve];if(Pe===void 0&&(ve==="instanceMatrix"&&re.instanceMatrix&&(Pe=re.instanceMatrix),ve==="instanceColor"&&re.instanceColor&&(Pe=re.instanceColor)),Pe!==void 0){const et=Pe.normalized,ne=Pe.itemSize,qe=n.get(Pe);if(qe===void 0)continue;const ge=qe.buffer,xe=qe.type,ze=qe.bytesPerElement;if(Pe.isInterleavedBufferAttribute){const Ge=Pe.data,ut=Ge.stride,ce=Pe.offset;if(Ge.isInstancedInterleavedBuffer){for(let me=0;me<ie.locationSize;me++)D(ie.location+me,Ge.meshPerAttribute);re.isInstancedMesh!==!0&&$e._maxInstanceCount===void 0&&($e._maxInstanceCount=Ge.meshPerAttribute*Ge.count)}else for(let me=0;me<ie.locationSize;me++)A(ie.location+me);t.bindBuffer(34962,ge);for(let me=0;me<ie.locationSize;me++)V(ie.location+me,ne/ie.locationSize,xe,et,ut*ze,(ce+ne/ie.locationSize*me)*ze)}else{if(Pe.isInstancedBufferAttribute){for(let Ge=0;Ge<ie.locationSize;Ge++)D(ie.location+Ge,Pe.meshPerAttribute);re.isInstancedMesh!==!0&&$e._maxInstanceCount===void 0&&($e._maxInstanceCount=Pe.meshPerAttribute*Pe.count)}else for(let Ge=0;Ge<ie.locationSize;Ge++)A(ie.location+Ge);t.bindBuffer(34962,ge);for(let Ge=0;Ge<ie.locationSize;Ge++)V(ie.location+Ge,ne/ie.locationSize,xe,et,ne*ze,ne/ie.locationSize*Ge*ze)}}else if(Oe!==void 0){const et=Oe[ve];if(et!==void 0)switch(et.length){case 2:t.vertexAttrib2fv(ie.location,et);break;case 3:t.vertexAttrib3fv(ie.location,et);break;case 4:t.vertexAttrib4fv(ie.location,et);break;default:t.vertexAttrib1fv(ie.location,et)}}}}O()}function U(){Q();for(const re in o){const he=o[re];for(const ye in he){const $e=he[ye];for(const _e in $e)x($e[_e].object),delete $e[_e];delete he[ye]}delete o[re]}}function Y(re){if(o[re.id]===void 0)return;const he=o[re.id];for(const ye in he){const $e=he[ye];for(const _e in $e)x($e[_e].object),delete $e[_e];delete he[ye]}delete o[re.id]}function fe(re){for(const he in o){const ye=o[he];if(ye[re.id]===void 0)continue;const $e=ye[re.id];for(const _e in $e)x($e[_e].object),delete $e[_e];delete ye[re.id]}}function Q(){G(),c=!0,u!==l&&(u=l,v(u.object))}function G(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:d,reset:Q,resetDefaultState:G,dispose:U,releaseStatesOfGeometry:Y,releaseStatesOfProgram:fe,initAttributes:C,enableAttribute:A,disableUnusedAttributes:O}}function gN(t,e,n,r){const i=r.isWebGL2;let a;function s(u){a=u}function o(u,c){t.drawArrays(a,u,c),n.update(c,a,1)}function l(u,c,d){if(d===0)return;let h,v;if(i)h=t,v="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),v="drawArraysInstancedANGLE",h===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}h[v](a,u,c,d),n.update(c,a,d)}this.setMode=s,this.render=o,this.renderInstances=l}function vN(t,e,n){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const V=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(V.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(V){if(V==="highp"){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";V="mediump"}return V==="mediump"&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext;let o=n.precision!==void 0?n.precision:"highp";const l=a(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);const u=s||e.has("WEBGL_draw_buffers"),c=n.logarithmicDepthBuffer===!0,d=t.getParameter(34930),h=t.getParameter(35660),v=t.getParameter(3379),x=t.getParameter(34076),_=t.getParameter(34921),b=t.getParameter(36347),S=t.getParameter(36348),E=t.getParameter(36349),C=h>0,A=s||e.has("OES_texture_float"),D=C&&A,O=s?t.getParameter(36183):0;return{isWebGL2:s,drawBuffers:u,getMaxAnisotropy:i,getMaxPrecision:a,precision:o,logarithmicDepthBuffer:c,maxTextures:d,maxVertexTextures:h,maxTextureSize:v,maxCubemapSize:x,maxAttributes:_,maxVertexUniforms:b,maxVaryings:S,maxFragmentUniforms:E,vertexTextures:C,floatFragmentTextures:A,floatVertexTextures:D,maxSamples:O}}function yN(t){const e=this;let n=null,r=0,i=!1,a=!1;const s=new Xo,o=new Ii,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const v=d.length!==0||h||r!==0||i;return i=h,r=d.length,v},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(d,h){n=c(d,h,0)},this.setState=function(d,h,v){const x=d.clippingPlanes,_=d.clipIntersection,b=d.clipShadows,S=t.get(d);if(!i||x===null||x.length===0||a&&!b)a?c(null):u();else{const E=a?0:r,C=E*4;let A=S.clippingState||null;l.value=A,A=c(x,h,C,v);for(let D=0;D!==C;++D)A[D]=n[D];S.clippingState=A,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=E}};function u(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function c(d,h,v,x){const _=d!==null?d.length:0;let b=null;if(_!==0){if(b=l.value,x!==!0||b===null){const S=v+_*4,E=h.matrixWorldInverse;o.getNormalMatrix(E),(b===null||b.length<S)&&(b=new Float32Array(S));for(let C=0,A=v;C!==_;++C,A+=4)s.copy(d[C]).applyMatrix4(E,o),s.normal.toArray(b,A),b[A+3]=s.constant}l.value=b,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,b}}function _N(t){let e=new WeakMap;function n(s,o){return o===Lv?s.mapping=zc:o===zv&&(s.mapping=Oc),s}function r(s){if(s&&s.isTexture&&s.isRenderTargetTexture===!1){const o=s.mapping;if(o===Lv||o===zv)if(e.has(s)){const l=e.get(s).texture;return n(l,s.mapping)}else{const l=s.image;if(l&&l.height>0){const u=new PL(l.height/2);return u.fromEquirectangularTexture(t,s),e.set(s,u),s.addEventListener("dispose",i),n(u.texture,s.mapping)}else return null}}return s}function i(s){const o=s.target;o.removeEventListener("dispose",i);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function a(){e=new WeakMap}return{get:r,dispose:a}}class Z8 extends X8{constructor(e=-1,n=1,r=1,i=-1,a=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=r,this.bottom=i,this.near=a,this.far=s,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,r,i,a,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let a=r-e,s=r+e,o=i+n,l=i-n;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=u*this.view.offsetX,s=a+u*this.view.width,o-=c*this.view.offsetY,l=o-c*this.view.height}this.projectionMatrix.makeOrthographic(a,s,o,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const bc=4,Nb=[.125,.215,.35,.446,.526,.582],Xl=20,Ym=new Z8,Bb=new Sn;let Zm=null;const ql=(1+Math.sqrt(5))/2,dc=1/ql,Fb=[new Ee(1,1,1),new Ee(-1,1,1),new Ee(1,1,-1),new Ee(-1,1,-1),new Ee(0,ql,dc),new Ee(0,ql,-dc),new Ee(dc,0,ql),new Ee(-dc,0,ql),new Ee(ql,dc,0),new Ee(-ql,dc,0)];class Ub{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,r=.1,i=100){Zm=this._renderer.getRenderTarget(),this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,r,i,a),n>0&&this._blur(a,0,0,n),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Wb(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Hb(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Zm),e.scissorTest=!1,Qh(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===zc||e.mapping===Oc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Zm=this._renderer.getRenderTarget();const r=n||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:ba,minFilter:ba,generateMipmaps:!1,type:Nc,format:xa,encoding:il,depthBuffer:!1},i=Vb(e,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Vb(e,n,r);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=bN(a)),this._blurMaterial=xN(a,e,n)}return i}_compileMaterial(e){const n=new $i(this._lodPlanes[0],e);this._renderer.compile(n,Ym)}_sceneToCubeUV(e,n,r,i){const o=new Ni(90,1,n,r),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],c=this._renderer,d=c.autoClear,h=c.toneMapping;c.getClearColor(Bb),c.toneMapping=Ss,c.autoClear=!1;const v=new ny({name:"PMREM.Background",side:ia,depthWrite:!1,depthTest:!1}),x=new $i(new jc,v);let _=!1;const b=e.background;b?b.isColor&&(v.color.copy(b),e.background=null,_=!0):(v.color.copy(Bb),_=!0);for(let S=0;S<6;S++){const E=S%3;E===0?(o.up.set(0,l[S],0),o.lookAt(u[S],0,0)):E===1?(o.up.set(0,0,l[S]),o.lookAt(0,u[S],0)):(o.up.set(0,l[S],0),o.lookAt(0,0,u[S]));const C=this._cubeSize;Qh(i,E*C,S>2?C:0,C,C),c.setRenderTarget(i),_&&c.render(x,o),c.render(e,o)}x.geometry.dispose(),x.material.dispose(),c.toneMapping=h,c.autoClear=d,e.background=b}_textureToCubeUV(e,n){const r=this._renderer,i=e.mapping===zc||e.mapping===Oc;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=Wb()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Hb());const a=i?this._cubemapMaterial:this._equirectMaterial,s=new $i(this._lodPlanes[0],a),o=a.uniforms;o.envMap.value=e;const l=this._cubeSize;Qh(n,0,0,3*l,2*l),r.setRenderTarget(n),r.render(s,Ym)}_applyPMREM(e){const n=this._renderer,r=n.autoClear;n.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const a=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),s=Fb[(i-1)%Fb.length];this._blur(e,i-1,i,a,s)}n.autoClear=r}_blur(e,n,r,i,a){const s=this._pingPongRenderTarget;this._halfBlur(e,s,n,r,i,"latitudinal",a),this._halfBlur(s,e,r,r,i,"longitudinal",a)}_halfBlur(e,n,r,i,a,s,o){const l=this._renderer,u=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,d=new $i(this._lodPlanes[i],u),h=u.uniforms,v=this._sizeLods[r]-1,x=isFinite(a)?Math.PI/(2*v):2*Math.PI/(2*Xl-1),_=a/x,b=isFinite(a)?1+Math.floor(c*_):Xl;b>Xl&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${b} samples when the maximum is set to ${Xl}`);const S=[];let E=0;for(let V=0;V<Xl;++V){const P=V/_,U=Math.exp(-P*P/2);S.push(U),V===0?E+=U:V<b&&(E+=2*U)}for(let V=0;V<S.length;V++)S[V]=S[V]/E;h.envMap.value=e.texture,h.samples.value=b,h.weights.value=S,h.latitudinal.value=s==="latitudinal",o&&(h.poleAxis.value=o);const{_lodMax:C}=this;h.dTheta.value=x,h.mipInt.value=C-r;const A=this._sizeLods[i],D=3*A*(i>C-bc?i-C+bc:0),O=4*(this._cubeSize-A);Qh(n,D,O,3*A,2*A),l.setRenderTarget(n),l.render(d,Ym)}}function bN(t){const e=[],n=[],r=[];let i=t;const a=t-bc+1+Nb.length;for(let s=0;s<a;s++){const o=Math.pow(2,i);n.push(o);let l=1/o;s>t-bc?l=Nb[s-t+bc-1]:s===0&&(l=0),r.push(l);const u=1/(o-2),c=-u,d=1+u,h=[c,c,d,c,d,d,c,c,d,d,c,d],v=6,x=6,_=3,b=2,S=1,E=new Float32Array(_*x*v),C=new Float32Array(b*x*v),A=new Float32Array(S*x*v);for(let O=0;O<v;O++){const V=O%3*2/3-1,P=O>2?0:-1,U=[V,P,0,V+2/3,P,0,V+2/3,P+1,0,V,P,0,V+2/3,P+1,0,V,P+1,0];E.set(U,_*x*O),C.set(h,b*x*O);const Y=[O,O,O,O,O,O];A.set(Y,S*x*O)}const D=new la;D.setAttribute("position",new Ui(E,_)),D.setAttribute("uv",new Ui(C,b)),D.setAttribute("faceIndex",new Ui(A,S)),e.push(D),i>bc&&i--}return{lodPlanes:e,sizeLods:n,sigmas:r}}function Vb(t,e,n){const r=new al(t,e,n);return r.texture.mapping=Ap,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Qh(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function xN(t,e,n){const r=new Float32Array(Xl),i=new Ee(0,1,0);return new fu({name:"SphericalGaussianBlur",defines:{n:Xl,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:iy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Qo,depthTest:!1,depthWrite:!1})}function Hb(){return new fu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:iy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Qo,depthTest:!1,depthWrite:!1})}function Wb(){return new fu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:iy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Qo,depthTest:!1,depthWrite:!1})}function iy(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function wN(t){let e=new WeakMap,n=null;function r(o){if(o&&o.isTexture){const l=o.mapping,u=l===Lv||l===zv,c=l===zc||l===Oc;if(u||c)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let d=e.get(o);return n===null&&(n=new Ub(t)),d=u?n.fromEquirectangular(o,d):n.fromCubemap(o,d),e.set(o,d),d.texture}else{if(e.has(o))return e.get(o).texture;{const d=o.image;if(u&&d&&d.height>0||c&&d&&i(d)){n===null&&(n=new Ub(t));const h=u?n.fromEquirectangular(o):n.fromCubemap(o);return e.set(o,h),o.addEventListener("dispose",a),h.texture}else return null}}}return o}function i(o){let l=0;const u=6;for(let c=0;c<u;c++)o[c]!==void 0&&l++;return l===u}function a(o){const l=o.target;l.removeEventListener("dispose",a);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function s(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:s}}function SN(t){const e={};function n(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(r)}return e[r]=i,i}return{has:function(r){return n(r)!==null},init:function(r){r.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(r){const i=n(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function MN(t,e,n,r){const i={},a=new WeakMap;function s(d){const h=d.target;h.index!==null&&e.remove(h.index);for(const x in h.attributes)e.remove(h.attributes[x]);h.removeEventListener("dispose",s),delete i[h.id];const v=a.get(h);v&&(e.remove(v),a.delete(h)),r.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,n.memory.geometries--}function o(d,h){return i[h.id]===!0||(h.addEventListener("dispose",s),i[h.id]=!0,n.memory.geometries++),h}function l(d){const h=d.attributes;for(const x in h)e.update(h[x],34962);const v=d.morphAttributes;for(const x in v){const _=v[x];for(let b=0,S=_.length;b<S;b++)e.update(_[b],34962)}}function u(d){const h=[],v=d.index,x=d.attributes.position;let _=0;if(v!==null){const E=v.array;_=v.version;for(let C=0,A=E.length;C<A;C+=3){const D=E[C+0],O=E[C+1],V=E[C+2];h.push(D,O,O,V,V,D)}}else{const E=x.array;_=x.version;for(let C=0,A=E.length/3-1;C<A;C+=3){const D=C+0,O=C+1,V=C+2;h.push(D,O,O,V,V,D)}}const b=new(F8(h)?q8:G8)(h,1);b.version=_;const S=a.get(d);S&&e.remove(S),a.set(d,b)}function c(d){const h=a.get(d);if(h){const v=d.index;v!==null&&h.version<v.version&&u(d)}else u(d);return a.get(d)}return{get:o,update:l,getWireframeAttribute:c}}function EN(t,e,n,r){const i=r.isWebGL2;let a;function s(h){a=h}let o,l;function u(h){o=h.type,l=h.bytesPerElement}function c(h,v){t.drawElements(a,v,o,h*l),n.update(v,a,1)}function d(h,v,x){if(x===0)return;let _,b;if(i)_=t,b="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),b="drawElementsInstancedANGLE",_===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}_[b](a,v,o,h*l,x),n.update(v,a,x)}this.setMode=s,this.setIndex=u,this.render=c,this.renderInstances=d}function TN(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(a,s,o){switch(n.calls++,s){case 4:n.triangles+=o*(a/3);break;case 1:n.lines+=o*(a/2);break;case 3:n.lines+=o*(a-1);break;case 2:n.lines+=o*a;break;case 0:n.points+=o*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s);break}}function i(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:i,update:r}}function CN(t,e){return t[0]-e[0]}function AN(t,e){return Math.abs(e[1])-Math.abs(t[1])}function kN(t,e,n){const r={},i=new Float32Array(8),a=new WeakMap,s=new Cr,o=[];for(let u=0;u<8;u++)o[u]=[u,0];function l(u,c,d){const h=u.morphTargetInfluences;if(e.isWebGL2===!0){const v=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,x=v!==void 0?v.length:0;let _=a.get(c);if(_===void 0||_.count!==x){let re=function(){Q.dispose(),a.delete(c),c.removeEventListener("dispose",re)};_!==void 0&&_.texture.dispose();const E=c.morphAttributes.position!==void 0,C=c.morphAttributes.normal!==void 0,A=c.morphAttributes.color!==void 0,D=c.morphAttributes.position||[],O=c.morphAttributes.normal||[],V=c.morphAttributes.color||[];let P=0;E===!0&&(P=1),C===!0&&(P=2),A===!0&&(P=3);let U=c.attributes.position.count*P,Y=1;U>e.maxTextureSize&&(Y=Math.ceil(U/e.maxTextureSize),U=e.maxTextureSize);const fe=new Float32Array(U*Y*4*x),Q=new H8(fe,U,Y,x);Q.type=eu,Q.needsUpdate=!0;const G=P*4;for(let he=0;he<x;he++){const ye=D[he],$e=O[he],_e=V[he],de=U*Y*4*he;for(let Oe=0;Oe<ye.count;Oe++){const ve=Oe*G;E===!0&&(s.fromBufferAttribute(ye,Oe),fe[de+ve+0]=s.x,fe[de+ve+1]=s.y,fe[de+ve+2]=s.z,fe[de+ve+3]=0),C===!0&&(s.fromBufferAttribute($e,Oe),fe[de+ve+4]=s.x,fe[de+ve+5]=s.y,fe[de+ve+6]=s.z,fe[de+ve+7]=0),A===!0&&(s.fromBufferAttribute(_e,Oe),fe[de+ve+8]=s.x,fe[de+ve+9]=s.y,fe[de+ve+10]=s.z,fe[de+ve+11]=_e.itemSize===4?s.w:1)}}_={count:x,texture:Q,size:new Lt(U,Y)},a.set(c,_),c.addEventListener("dispose",re)}let b=0;for(let E=0;E<h.length;E++)b+=h[E];const S=c.morphTargetsRelative?1:1-b;d.getUniforms().setValue(t,"morphTargetBaseInfluence",S),d.getUniforms().setValue(t,"morphTargetInfluences",h),d.getUniforms().setValue(t,"morphTargetsTexture",_.texture,n),d.getUniforms().setValue(t,"morphTargetsTextureSize",_.size)}else{const v=h===void 0?0:h.length;let x=r[c.id];if(x===void 0||x.length!==v){x=[];for(let C=0;C<v;C++)x[C]=[C,0];r[c.id]=x}for(let C=0;C<v;C++){const A=x[C];A[0]=C,A[1]=h[C]}x.sort(AN);for(let C=0;C<8;C++)C<v&&x[C][1]?(o[C][0]=x[C][0],o[C][1]=x[C][1]):(o[C][0]=Number.MAX_SAFE_INTEGER,o[C][1]=0);o.sort(CN);const _=c.morphAttributes.position,b=c.morphAttributes.normal;let S=0;for(let C=0;C<8;C++){const A=o[C],D=A[0],O=A[1];D!==Number.MAX_SAFE_INTEGER&&O?(_&&c.getAttribute("morphTarget"+C)!==_[D]&&c.setAttribute("morphTarget"+C,_[D]),b&&c.getAttribute("morphNormal"+C)!==b[D]&&c.setAttribute("morphNormal"+C,b[D]),i[C]=O,S+=O):(_&&c.hasAttribute("morphTarget"+C)===!0&&c.deleteAttribute("morphTarget"+C),b&&c.hasAttribute("morphNormal"+C)===!0&&c.deleteAttribute("morphNormal"+C),i[C]=0)}const E=c.morphTargetsRelative?1:1-S;d.getUniforms().setValue(t,"morphTargetBaseInfluence",E),d.getUniforms().setValue(t,"morphTargetInfluences",i)}}return{update:l}}function IN(t,e,n,r){let i=new WeakMap;function a(l){const u=r.render.frame,c=l.geometry,d=e.get(l,c);return i.get(d)!==u&&(e.update(d),i.set(d,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),n.update(l.instanceMatrix,34962),l.instanceColor!==null&&n.update(l.instanceColor,34962)),d}function s(){i=new WeakMap}function o(l){const u=l.target;u.removeEventListener("dispose",o),n.remove(u.instanceMatrix),u.instanceColor!==null&&n.remove(u.instanceColor)}return{update:a,dispose:s}}const J8=new Fi,Q8=new H8,e7=new gL,t7=new K8,Gb=[],qb=[],jb=new Float32Array(16),Xb=new Float32Array(9),Kb=new Float32Array(4);function Xc(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let a=Gb[i];if(a===void 0&&(a=new Float32Array(i),Gb[i]=a),e!==0){r.toArray(a,0);for(let s=1,o=0;s!==e;++s)o+=n,t[s].toArray(a,o)}return a}function Nr(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Br(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function $p(t,e){let n=qb[e];n===void 0&&(n=new Int32Array(e),qb[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function $N(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function PN(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Nr(n,e))return;t.uniform2fv(this.addr,e),Br(n,e)}}function RN(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Nr(n,e))return;t.uniform3fv(this.addr,e),Br(n,e)}}function DN(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Nr(n,e))return;t.uniform4fv(this.addr,e),Br(n,e)}}function LN(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(Nr(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Br(n,e)}else{if(Nr(n,r))return;Kb.set(r),t.uniformMatrix2fv(this.addr,!1,Kb),Br(n,r)}}function zN(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(Nr(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Br(n,e)}else{if(Nr(n,r))return;Xb.set(r),t.uniformMatrix3fv(this.addr,!1,Xb),Br(n,r)}}function ON(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(Nr(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Br(n,e)}else{if(Nr(n,r))return;jb.set(r),t.uniformMatrix4fv(this.addr,!1,jb),Br(n,r)}}function NN(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function BN(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Nr(n,e))return;t.uniform2iv(this.addr,e),Br(n,e)}}function FN(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Nr(n,e))return;t.uniform3iv(this.addr,e),Br(n,e)}}function UN(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Nr(n,e))return;t.uniform4iv(this.addr,e),Br(n,e)}}function VN(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function HN(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Nr(n,e))return;t.uniform2uiv(this.addr,e),Br(n,e)}}function WN(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Nr(n,e))return;t.uniform3uiv(this.addr,e),Br(n,e)}}function GN(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Nr(n,e))return;t.uniform4uiv(this.addr,e),Br(n,e)}}function qN(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(e||J8,i)}function jN(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||e7,i)}function XN(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(e||t7,i)}function KN(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||Q8,i)}function YN(t){switch(t){case 5126:return $N;case 35664:return PN;case 35665:return RN;case 35666:return DN;case 35674:return LN;case 35675:return zN;case 35676:return ON;case 5124:case 35670:return NN;case 35667:case 35671:return BN;case 35668:case 35672:return FN;case 35669:case 35673:return UN;case 5125:return VN;case 36294:return HN;case 36295:return WN;case 36296:return GN;case 35678:case 36198:case 36298:case 36306:case 35682:return qN;case 35679:case 36299:case 36307:return jN;case 35680:case 36300:case 36308:case 36293:return XN;case 36289:case 36303:case 36311:case 36292:return KN}}function ZN(t,e){t.uniform1fv(this.addr,e)}function JN(t,e){const n=Xc(e,this.size,2);t.uniform2fv(this.addr,n)}function QN(t,e){const n=Xc(e,this.size,3);t.uniform3fv(this.addr,n)}function eB(t,e){const n=Xc(e,this.size,4);t.uniform4fv(this.addr,n)}function tB(t,e){const n=Xc(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function nB(t,e){const n=Xc(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function rB(t,e){const n=Xc(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function iB(t,e){t.uniform1iv(this.addr,e)}function aB(t,e){t.uniform2iv(this.addr,e)}function sB(t,e){t.uniform3iv(this.addr,e)}function oB(t,e){t.uniform4iv(this.addr,e)}function lB(t,e){t.uniform1uiv(this.addr,e)}function uB(t,e){t.uniform2uiv(this.addr,e)}function cB(t,e){t.uniform3uiv(this.addr,e)}function dB(t,e){t.uniform4uiv(this.addr,e)}function fB(t,e,n){const r=this.cache,i=e.length,a=$p(n,i);Nr(r,a)||(t.uniform1iv(this.addr,a),Br(r,a));for(let s=0;s!==i;++s)n.setTexture2D(e[s]||J8,a[s])}function hB(t,e,n){const r=this.cache,i=e.length,a=$p(n,i);Nr(r,a)||(t.uniform1iv(this.addr,a),Br(r,a));for(let s=0;s!==i;++s)n.setTexture3D(e[s]||e7,a[s])}function pB(t,e,n){const r=this.cache,i=e.length,a=$p(n,i);Nr(r,a)||(t.uniform1iv(this.addr,a),Br(r,a));for(let s=0;s!==i;++s)n.setTextureCube(e[s]||t7,a[s])}function mB(t,e,n){const r=this.cache,i=e.length,a=$p(n,i);Nr(r,a)||(t.uniform1iv(this.addr,a),Br(r,a));for(let s=0;s!==i;++s)n.setTexture2DArray(e[s]||Q8,a[s])}function gB(t){switch(t){case 5126:return ZN;case 35664:return JN;case 35665:return QN;case 35666:return eB;case 35674:return tB;case 35675:return nB;case 35676:return rB;case 5124:case 35670:return iB;case 35667:case 35671:return aB;case 35668:case 35672:return sB;case 35669:case 35673:return oB;case 5125:return lB;case 36294:return uB;case 36295:return cB;case 36296:return dB;case 35678:case 36198:case 36298:case 36306:case 35682:return fB;case 35679:case 36299:case 36307:return hB;case 35680:case 36300:case 36308:case 36293:return pB;case 36289:case 36303:case 36311:case 36292:return mB}}class vB{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.setValue=YN(n.type)}}class yB{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.size=n.size,this.setValue=gB(n.type)}}class _B{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,r){const i=this.seq;for(let a=0,s=i.length;a!==s;++a){const o=i[a];o.setValue(e,n[o.id],r)}}}const Jm=/(\w+)(\])?(\[|\.)?/g;function Yb(t,e){t.seq.push(e),t.map[e.id]=e}function bB(t,e,n){const r=t.name,i=r.length;for(Jm.lastIndex=0;;){const a=Jm.exec(r),s=Jm.lastIndex;let o=a[1];const l=a[2]==="]",u=a[3];if(l&&(o=o|0),u===void 0||u==="["&&s+2===i){Yb(n,u===void 0?new vB(o,t,e):new yB(o,t,e));break}else{let d=n.map[o];d===void 0&&(d=new _B(o),Yb(n,d)),n=d}}}class E0{constructor(e,n){this.seq=[],this.map={};const r=e.getProgramParameter(n,35718);for(let i=0;i<r;++i){const a=e.getActiveUniform(n,i),s=e.getUniformLocation(n,a.name);bB(a,s,this)}}setValue(e,n,r,i){const a=this.map[n];a!==void 0&&a.setValue(e,r,i)}setOptional(e,n,r){const i=n[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,n,r,i){for(let a=0,s=n.length;a!==s;++a){const o=n[a],l=r[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,i)}}static seqWithValue(e,n){const r=[];for(let i=0,a=e.length;i!==a;++i){const s=e[i];s.id in n&&r.push(s)}return r}}function Zb(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}let xB=0;function wB(t,e){const n=t.split(`
`),r=[],i=Math.max(e-6,0),a=Math.min(e+6,n.length);for(let s=i;s<a;s++){const o=s+1;r.push(`${o===e?">":" "} ${o}: ${n[s]}`)}return r.join(`
`)}function SB(t){switch(t){case il:return["Linear","( value )"];case sr:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function Jb(t,e,n){const r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();if(r&&i==="")return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const s=parseInt(a[1]);return n.toUpperCase()+`

`+i+`

`+wB(t.getShaderSource(e),s)}else return i}function MB(t,e){const n=SB(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function EB(t,e){let n;switch(e){case zD:n="Linear";break;case OD:n="Reinhard";break;case ND:n="OptimizedCineon";break;case BD:n="ACESFilmic";break;case FD:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function TB(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(jd).join(`
`)}function CB(t){const e=[];for(const n in t){const r=t[n];r!==!1&&e.push("#define "+n+" "+r)}return e.join(`
`)}function AB(t,e){const n={},r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){const a=t.getActiveAttrib(e,i),s=a.name;let o=1;a.type===35674&&(o=2),a.type===35675&&(o=3),a.type===35676&&(o=4),n[s]={type:a.type,location:t.getAttribLocation(e,s),locationSize:o}}return n}function jd(t){return t!==""}function Qb(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function e3(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const kB=/^[ \t]*#include +<([\w\d./]+)>/gm;function Fv(t){return t.replace(kB,IB)}function IB(t,e){const n=Cn[e];if(n===void 0)throw new Error("Can not resolve #include <"+e+">");return Fv(n)}const $B=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function t3(t){return t.replace($B,PB)}function PB(t,e,n,r){let i="";for(let a=parseInt(e);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function n3(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function RB(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===R8?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===D8?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===qd&&(e="SHADOWMAP_TYPE_VSM"),e}function DB(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case zc:case Oc:e="ENVMAP_TYPE_CUBE";break;case Ap:e="ENVMAP_TYPE_CUBE_UV";break}return e}function LB(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Oc:e="ENVMAP_MODE_REFRACTION";break}return e}function zB(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case J1:e="ENVMAP_BLENDING_MULTIPLY";break;case DD:e="ENVMAP_BLENDING_MIX";break;case LD:e="ENVMAP_BLENDING_ADD";break}return e}function OB(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}function NB(t,e,n,r){const i=t.getContext(),a=n.defines;let s=n.vertexShader,o=n.fragmentShader;const l=RB(n),u=DB(n),c=LB(n),d=zB(n),h=OB(n),v=n.isWebGL2?"":TB(n),x=CB(a),_=i.createProgram();let b,S,E=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(b=[x].filter(jd).join(`
`),b.length>0&&(b+=`
`),S=[v,x].filter(jd).join(`
`),S.length>0&&(S+=`
`)):(b=[n3(n),"#define SHADER_NAME "+n.shaderName,x,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(jd).join(`
`),S=[v,n3(n),"#define SHADER_NAME "+n.shaderName,x,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+c:"",n.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ss?"#define TONE_MAPPING":"",n.toneMapping!==Ss?Cn.tonemapping_pars_fragment:"",n.toneMapping!==Ss?EB("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Cn.encodings_pars_fragment,MB("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(jd).join(`
`)),s=Fv(s),s=Qb(s,n),s=e3(s,n),o=Fv(o),o=Qb(o,n),o=e3(o,n),s=t3(s),o=t3(o),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(E=`#version 300 es
`,b=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+b,S=["#define varying in",n.glslVersion===Eb?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Eb?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const C=E+b+s,A=E+S+o,D=Zb(i,35633,C),O=Zb(i,35632,A);if(i.attachShader(_,D),i.attachShader(_,O),n.index0AttributeName!==void 0?i.bindAttribLocation(_,0,n.index0AttributeName):n.morphTargets===!0&&i.bindAttribLocation(_,0,"position"),i.linkProgram(_),t.debug.checkShaderErrors){const U=i.getProgramInfoLog(_).trim(),Y=i.getShaderInfoLog(D).trim(),fe=i.getShaderInfoLog(O).trim();let Q=!0,G=!0;if(i.getProgramParameter(_,35714)===!1){Q=!1;const re=Jb(i,D,"vertex"),he=Jb(i,O,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(_,35715)+`

Program Info Log: `+U+`
`+re+`
`+he)}else U!==""?console.warn("THREE.WebGLProgram: Program Info Log:",U):(Y===""||fe==="")&&(G=!1);G&&(this.diagnostics={runnable:Q,programLog:U,vertexShader:{log:Y,prefix:b},fragmentShader:{log:fe,prefix:S}})}i.deleteShader(D),i.deleteShader(O);let V;this.getUniforms=function(){return V===void 0&&(V=new E0(i,_)),V};let P;return this.getAttributes=function(){return P===void 0&&(P=AB(i,_)),P},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(_),this.program=void 0},this.name=n.shaderName,this.id=xB++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=D,this.fragmentShader=O,this}let BB=0;class FB{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(n),a=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return s.has(i)===!1&&(s.add(i),i.usedTimes++),s.has(a)===!1&&(s.add(a),a.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let r=n.get(e);return r===void 0&&(r=new Set,n.set(e,r)),r}_getShaderStage(e){const n=this.shaderCache;let r=n.get(e);return r===void 0&&(r=new UB(e),n.set(e,r)),r}}class UB{constructor(e){this.id=BB++,this.code=e,this.usedTimes=0}}function VB(t,e,n,r,i,a,s){const o=new ty,l=new FB,u=[],c=i.isWebGL2,d=i.logarithmicDepthBuffer,h=i.vertexTextures;let v=i.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(P,U,Y,fe,Q){const G=fe.fog,re=Q.geometry,he=P.isMeshStandardMaterial?fe.environment:null,ye=(P.isMeshStandardMaterial?n:e).get(P.envMap||he),$e=ye&&ye.mapping===Ap?ye.image.height:null,_e=x[P.type];P.precision!==null&&(v=i.getMaxPrecision(P.precision),v!==P.precision&&console.warn("THREE.WebGLProgram.getParameters:",P.precision,"not supported, using",v,"instead."));const de=re.morphAttributes.position||re.morphAttributes.normal||re.morphAttributes.color,Oe=de!==void 0?de.length:0;let ve=0;re.morphAttributes.position!==void 0&&(ve=1),re.morphAttributes.normal!==void 0&&(ve=2),re.morphAttributes.color!==void 0&&(ve=3);let ie,Pe,et,ne;if(_e){const ut=ys[_e];ie=ut.vertexShader,Pe=ut.fragmentShader}else ie=P.vertexShader,Pe=P.fragmentShader,l.update(P),et=l.getVertexShaderID(P),ne=l.getFragmentShaderID(P);const qe=t.getRenderTarget(),ge=P.alphaTest>0,xe=P.clearcoat>0,ze=P.iridescence>0;return{isWebGL2:c,shaderID:_e,shaderName:P.type,vertexShader:ie,fragmentShader:Pe,defines:P.defines,customVertexShaderID:et,customFragmentShaderID:ne,isRawShaderMaterial:P.isRawShaderMaterial===!0,glslVersion:P.glslVersion,precision:v,instancing:Q.isInstancedMesh===!0,instancingColor:Q.isInstancedMesh===!0&&Q.instanceColor!==null,supportsVertexTextures:h,outputEncoding:qe===null?t.outputEncoding:qe.isXRRenderTarget===!0?qe.texture.encoding:il,map:!!P.map,matcap:!!P.matcap,envMap:!!ye,envMapMode:ye&&ye.mapping,envMapCubeUVHeight:$e,lightMap:!!P.lightMap,aoMap:!!P.aoMap,emissiveMap:!!P.emissiveMap,bumpMap:!!P.bumpMap,normalMap:!!P.normalMap,objectSpaceNormalMap:P.normalMapType===aL,tangentSpaceNormalMap:P.normalMapType===Q1,decodeVideoTexture:!!P.map&&P.map.isVideoTexture===!0&&P.map.encoding===sr,clearcoat:xe,clearcoatMap:xe&&!!P.clearcoatMap,clearcoatRoughnessMap:xe&&!!P.clearcoatRoughnessMap,clearcoatNormalMap:xe&&!!P.clearcoatNormalMap,iridescence:ze,iridescenceMap:ze&&!!P.iridescenceMap,iridescenceThicknessMap:ze&&!!P.iridescenceThicknessMap,displacementMap:!!P.displacementMap,roughnessMap:!!P.roughnessMap,metalnessMap:!!P.metalnessMap,specularMap:!!P.specularMap,specularIntensityMap:!!P.specularIntensityMap,specularColorMap:!!P.specularColorMap,opaque:P.transparent===!1&&P.blending===kc,alphaMap:!!P.alphaMap,alphaTest:ge,gradientMap:!!P.gradientMap,sheen:P.sheen>0,sheenColorMap:!!P.sheenColorMap,sheenRoughnessMap:!!P.sheenRoughnessMap,transmission:P.transmission>0,transmissionMap:!!P.transmissionMap,thicknessMap:!!P.thicknessMap,combine:P.combine,vertexTangents:!!P.normalMap&&!!re.attributes.tangent,vertexColors:P.vertexColors,vertexAlphas:P.vertexColors===!0&&!!re.attributes.color&&re.attributes.color.itemSize===4,vertexUvs:!!P.map||!!P.bumpMap||!!P.normalMap||!!P.specularMap||!!P.alphaMap||!!P.emissiveMap||!!P.roughnessMap||!!P.metalnessMap||!!P.clearcoatMap||!!P.clearcoatRoughnessMap||!!P.clearcoatNormalMap||!!P.iridescenceMap||!!P.iridescenceThicknessMap||!!P.displacementMap||!!P.transmissionMap||!!P.thicknessMap||!!P.specularIntensityMap||!!P.specularColorMap||!!P.sheenColorMap||!!P.sheenRoughnessMap,uvsVertexOnly:!(P.map||P.bumpMap||P.normalMap||P.specularMap||P.alphaMap||P.emissiveMap||P.roughnessMap||P.metalnessMap||P.clearcoatNormalMap||P.iridescenceMap||P.iridescenceThicknessMap||P.transmission>0||P.transmissionMap||P.thicknessMap||P.specularIntensityMap||P.specularColorMap||P.sheen>0||P.sheenColorMap||P.sheenRoughnessMap)&&!!P.displacementMap,fog:!!G,useFog:P.fog===!0,fogExp2:G&&G.isFogExp2,flatShading:!!P.flatShading,sizeAttenuation:P.sizeAttenuation,logarithmicDepthBuffer:d,skinning:Q.isSkinnedMesh===!0,morphTargets:re.morphAttributes.position!==void 0,morphNormals:re.morphAttributes.normal!==void 0,morphColors:re.morphAttributes.color!==void 0,morphTargetsCount:Oe,morphTextureStride:ve,numDirLights:U.directional.length,numPointLights:U.point.length,numSpotLights:U.spot.length,numSpotLightMaps:U.spotLightMap.length,numRectAreaLights:U.rectArea.length,numHemiLights:U.hemi.length,numDirLightShadows:U.directionalShadowMap.length,numPointLightShadows:U.pointShadowMap.length,numSpotLightShadows:U.spotShadowMap.length,numSpotLightShadowsWithMaps:U.numSpotLightShadowsWithMaps,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:P.dithering,shadowMapEnabled:t.shadowMap.enabled&&Y.length>0,shadowMapType:t.shadowMap.type,toneMapping:P.toneMapped?t.toneMapping:Ss,useLegacyLights:t.useLegacyLights,premultipliedAlpha:P.premultipliedAlpha,doubleSided:P.side===Yo,flipSided:P.side===ia,useDepthPacking:!!P.depthPacking,depthPacking:P.depthPacking||0,index0AttributeName:P.index0AttributeName,extensionDerivatives:P.extensions&&P.extensions.derivatives,extensionFragDepth:P.extensions&&P.extensions.fragDepth,extensionDrawBuffers:P.extensions&&P.extensions.drawBuffers,extensionShaderTextureLOD:P.extensions&&P.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||r.has("EXT_shader_texture_lod"),customProgramCacheKey:P.customProgramCacheKey()}}function b(P){const U=[];if(P.shaderID?U.push(P.shaderID):(U.push(P.customVertexShaderID),U.push(P.customFragmentShaderID)),P.defines!==void 0)for(const Y in P.defines)U.push(Y),U.push(P.defines[Y]);return P.isRawShaderMaterial===!1&&(S(U,P),E(U,P),U.push(t.outputEncoding)),U.push(P.customProgramCacheKey),U.join()}function S(P,U){P.push(U.precision),P.push(U.outputEncoding),P.push(U.envMapMode),P.push(U.envMapCubeUVHeight),P.push(U.combine),P.push(U.vertexUvs),P.push(U.fogExp2),P.push(U.sizeAttenuation),P.push(U.morphTargetsCount),P.push(U.morphAttributeCount),P.push(U.numDirLights),P.push(U.numPointLights),P.push(U.numSpotLights),P.push(U.numSpotLightMaps),P.push(U.numHemiLights),P.push(U.numRectAreaLights),P.push(U.numDirLightShadows),P.push(U.numPointLightShadows),P.push(U.numSpotLightShadows),P.push(U.numSpotLightShadowsWithMaps),P.push(U.shadowMapType),P.push(U.toneMapping),P.push(U.numClippingPlanes),P.push(U.numClipIntersection),P.push(U.depthPacking)}function E(P,U){o.disableAll(),U.isWebGL2&&o.enable(0),U.supportsVertexTextures&&o.enable(1),U.instancing&&o.enable(2),U.instancingColor&&o.enable(3),U.map&&o.enable(4),U.matcap&&o.enable(5),U.envMap&&o.enable(6),U.lightMap&&o.enable(7),U.aoMap&&o.enable(8),U.emissiveMap&&o.enable(9),U.bumpMap&&o.enable(10),U.normalMap&&o.enable(11),U.objectSpaceNormalMap&&o.enable(12),U.tangentSpaceNormalMap&&o.enable(13),U.clearcoat&&o.enable(14),U.clearcoatMap&&o.enable(15),U.clearcoatRoughnessMap&&o.enable(16),U.clearcoatNormalMap&&o.enable(17),U.iridescence&&o.enable(18),U.iridescenceMap&&o.enable(19),U.iridescenceThicknessMap&&o.enable(20),U.displacementMap&&o.enable(21),U.specularMap&&o.enable(22),U.roughnessMap&&o.enable(23),U.metalnessMap&&o.enable(24),U.gradientMap&&o.enable(25),U.alphaMap&&o.enable(26),U.alphaTest&&o.enable(27),U.vertexColors&&o.enable(28),U.vertexAlphas&&o.enable(29),U.vertexUvs&&o.enable(30),U.vertexTangents&&o.enable(31),U.uvsVertexOnly&&o.enable(32),P.push(o.mask),o.disableAll(),U.fog&&o.enable(0),U.useFog&&o.enable(1),U.flatShading&&o.enable(2),U.logarithmicDepthBuffer&&o.enable(3),U.skinning&&o.enable(4),U.morphTargets&&o.enable(5),U.morphNormals&&o.enable(6),U.morphColors&&o.enable(7),U.premultipliedAlpha&&o.enable(8),U.shadowMapEnabled&&o.enable(9),U.useLegacyLights&&o.enable(10),U.doubleSided&&o.enable(11),U.flipSided&&o.enable(12),U.useDepthPacking&&o.enable(13),U.dithering&&o.enable(14),U.specularIntensityMap&&o.enable(15),U.specularColorMap&&o.enable(16),U.transmission&&o.enable(17),U.transmissionMap&&o.enable(18),U.thicknessMap&&o.enable(19),U.sheen&&o.enable(20),U.sheenColorMap&&o.enable(21),U.sheenRoughnessMap&&o.enable(22),U.decodeVideoTexture&&o.enable(23),U.opaque&&o.enable(24),P.push(o.mask)}function C(P){const U=x[P.type];let Y;if(U){const fe=ys[U];Y=AL.clone(fe.uniforms)}else Y=P.uniforms;return Y}function A(P,U){let Y;for(let fe=0,Q=u.length;fe<Q;fe++){const G=u[fe];if(G.cacheKey===U){Y=G,++Y.usedTimes;break}}return Y===void 0&&(Y=new NB(t,U,P,a),u.push(Y)),Y}function D(P){if(--P.usedTimes===0){const U=u.indexOf(P);u[U]=u[u.length-1],u.pop(),P.destroy()}}function O(P){l.remove(P)}function V(){l.dispose()}return{getParameters:_,getProgramCacheKey:b,getUniforms:C,acquireProgram:A,releaseProgram:D,releaseShaderCache:O,programs:u,dispose:V}}function HB(){let t=new WeakMap;function e(a){let s=t.get(a);return s===void 0&&(s={},t.set(a,s)),s}function n(a){t.delete(a)}function r(a,s,o){t.get(a)[s]=o}function i(){t=new WeakMap}return{get:e,remove:n,update:r,dispose:i}}function WB(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function r3(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function i3(){const t=[];let e=0;const n=[],r=[],i=[];function a(){e=0,n.length=0,r.length=0,i.length=0}function s(d,h,v,x,_,b){let S=t[e];return S===void 0?(S={id:d.id,object:d,geometry:h,material:v,groupOrder:x,renderOrder:d.renderOrder,z:_,group:b},t[e]=S):(S.id=d.id,S.object=d,S.geometry=h,S.material=v,S.groupOrder=x,S.renderOrder=d.renderOrder,S.z=_,S.group=b),e++,S}function o(d,h,v,x,_,b){const S=s(d,h,v,x,_,b);v.transmission>0?r.push(S):v.transparent===!0?i.push(S):n.push(S)}function l(d,h,v,x,_,b){const S=s(d,h,v,x,_,b);v.transmission>0?r.unshift(S):v.transparent===!0?i.unshift(S):n.unshift(S)}function u(d,h){n.length>1&&n.sort(d||WB),r.length>1&&r.sort(h||r3),i.length>1&&i.sort(h||r3)}function c(){for(let d=e,h=t.length;d<h;d++){const v=t[d];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:n,transmissive:r,transparent:i,init:a,push:o,unshift:l,finish:c,sort:u}}function GB(){let t=new WeakMap;function e(r,i){const a=t.get(r);let s;return a===void 0?(s=new i3,t.set(r,[s])):i>=a.length?(s=new i3,a.push(s)):s=a[i],s}function n(){t=new WeakMap}return{get:e,dispose:n}}function qB(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Ee,color:new Sn};break;case"SpotLight":n={position:new Ee,direction:new Ee,color:new Sn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Ee,color:new Sn,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Ee,skyColor:new Sn,groundColor:new Sn};break;case"RectAreaLight":n={color:new Sn,position:new Ee,halfWidth:new Ee,halfHeight:new Ee};break}return t[e.id]=n,n}}}function jB(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Lt};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Lt};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Lt,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let XB=0;function KB(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function YB(t,e){const n=new qB,r=jB(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let c=0;c<9;c++)i.probe.push(new Ee);const a=new Ee,s=new tr,o=new tr;function l(c,d){let h=0,v=0,x=0;for(let fe=0;fe<9;fe++)i.probe[fe].set(0,0,0);let _=0,b=0,S=0,E=0,C=0,A=0,D=0,O=0,V=0,P=0;c.sort(KB);const U=d===!0?Math.PI:1;for(let fe=0,Q=c.length;fe<Q;fe++){const G=c[fe],re=G.color,he=G.intensity,ye=G.distance,$e=G.shadow&&G.shadow.map?G.shadow.map.texture:null;if(G.isAmbientLight)h+=re.r*he*U,v+=re.g*he*U,x+=re.b*he*U;else if(G.isLightProbe)for(let _e=0;_e<9;_e++)i.probe[_e].addScaledVector(G.sh.coefficients[_e],he);else if(G.isDirectionalLight){const _e=n.get(G);if(_e.color.copy(G.color).multiplyScalar(G.intensity*U),G.castShadow){const de=G.shadow,Oe=r.get(G);Oe.shadowBias=de.bias,Oe.shadowNormalBias=de.normalBias,Oe.shadowRadius=de.radius,Oe.shadowMapSize=de.mapSize,i.directionalShadow[_]=Oe,i.directionalShadowMap[_]=$e,i.directionalShadowMatrix[_]=G.shadow.matrix,A++}i.directional[_]=_e,_++}else if(G.isSpotLight){const _e=n.get(G);_e.position.setFromMatrixPosition(G.matrixWorld),_e.color.copy(re).multiplyScalar(he*U),_e.distance=ye,_e.coneCos=Math.cos(G.angle),_e.penumbraCos=Math.cos(G.angle*(1-G.penumbra)),_e.decay=G.decay,i.spot[S]=_e;const de=G.shadow;if(G.map&&(i.spotLightMap[V]=G.map,V++,de.updateMatrices(G),G.castShadow&&P++),i.spotLightMatrix[S]=de.matrix,G.castShadow){const Oe=r.get(G);Oe.shadowBias=de.bias,Oe.shadowNormalBias=de.normalBias,Oe.shadowRadius=de.radius,Oe.shadowMapSize=de.mapSize,i.spotShadow[S]=Oe,i.spotShadowMap[S]=$e,O++}S++}else if(G.isRectAreaLight){const _e=n.get(G);_e.color.copy(re).multiplyScalar(he),_e.halfWidth.set(G.width*.5,0,0),_e.halfHeight.set(0,G.height*.5,0),i.rectArea[E]=_e,E++}else if(G.isPointLight){const _e=n.get(G);if(_e.color.copy(G.color).multiplyScalar(G.intensity*U),_e.distance=G.distance,_e.decay=G.decay,G.castShadow){const de=G.shadow,Oe=r.get(G);Oe.shadowBias=de.bias,Oe.shadowNormalBias=de.normalBias,Oe.shadowRadius=de.radius,Oe.shadowMapSize=de.mapSize,Oe.shadowCameraNear=de.camera.near,Oe.shadowCameraFar=de.camera.far,i.pointShadow[b]=Oe,i.pointShadowMap[b]=$e,i.pointShadowMatrix[b]=G.shadow.matrix,D++}i.point[b]=_e,b++}else if(G.isHemisphereLight){const _e=n.get(G);_e.skyColor.copy(G.color).multiplyScalar(he*U),_e.groundColor.copy(G.groundColor).multiplyScalar(he*U),i.hemi[C]=_e,C++}}E>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Pt.LTC_FLOAT_1,i.rectAreaLTC2=Pt.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=Pt.LTC_HALF_1,i.rectAreaLTC2=Pt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=h,i.ambient[1]=v,i.ambient[2]=x;const Y=i.hash;(Y.directionalLength!==_||Y.pointLength!==b||Y.spotLength!==S||Y.rectAreaLength!==E||Y.hemiLength!==C||Y.numDirectionalShadows!==A||Y.numPointShadows!==D||Y.numSpotShadows!==O||Y.numSpotMaps!==V)&&(i.directional.length=_,i.spot.length=S,i.rectArea.length=E,i.point.length=b,i.hemi.length=C,i.directionalShadow.length=A,i.directionalShadowMap.length=A,i.pointShadow.length=D,i.pointShadowMap.length=D,i.spotShadow.length=O,i.spotShadowMap.length=O,i.directionalShadowMatrix.length=A,i.pointShadowMatrix.length=D,i.spotLightMatrix.length=O+V-P,i.spotLightMap.length=V,i.numSpotLightShadowsWithMaps=P,Y.directionalLength=_,Y.pointLength=b,Y.spotLength=S,Y.rectAreaLength=E,Y.hemiLength=C,Y.numDirectionalShadows=A,Y.numPointShadows=D,Y.numSpotShadows=O,Y.numSpotMaps=V,i.version=XB++)}function u(c,d){let h=0,v=0,x=0,_=0,b=0;const S=d.matrixWorldInverse;for(let E=0,C=c.length;E<C;E++){const A=c[E];if(A.isDirectionalLight){const D=i.directional[h];D.direction.setFromMatrixPosition(A.matrixWorld),a.setFromMatrixPosition(A.target.matrixWorld),D.direction.sub(a),D.direction.transformDirection(S),h++}else if(A.isSpotLight){const D=i.spot[x];D.position.setFromMatrixPosition(A.matrixWorld),D.position.applyMatrix4(S),D.direction.setFromMatrixPosition(A.matrixWorld),a.setFromMatrixPosition(A.target.matrixWorld),D.direction.sub(a),D.direction.transformDirection(S),x++}else if(A.isRectAreaLight){const D=i.rectArea[_];D.position.setFromMatrixPosition(A.matrixWorld),D.position.applyMatrix4(S),o.identity(),s.copy(A.matrixWorld),s.premultiply(S),o.extractRotation(s),D.halfWidth.set(A.width*.5,0,0),D.halfHeight.set(0,A.height*.5,0),D.halfWidth.applyMatrix4(o),D.halfHeight.applyMatrix4(o),_++}else if(A.isPointLight){const D=i.point[v];D.position.setFromMatrixPosition(A.matrixWorld),D.position.applyMatrix4(S),v++}else if(A.isHemisphereLight){const D=i.hemi[b];D.direction.setFromMatrixPosition(A.matrixWorld),D.direction.transformDirection(S),b++}}}return{setup:l,setupView:u,state:i}}function a3(t,e){const n=new YB(t,e),r=[],i=[];function a(){r.length=0,i.length=0}function s(d){r.push(d)}function o(d){i.push(d)}function l(d){n.setup(r,d)}function u(d){n.setupView(r,d)}return{init:a,state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:l,setupLightsView:u,pushLight:s,pushShadow:o}}function ZB(t,e){let n=new WeakMap;function r(a,s=0){const o=n.get(a);let l;return o===void 0?(l=new a3(t,e),n.set(a,[l])):s>=o.length?(l=new a3(t,e),o.push(l)):l=o[s],l}function i(){n=new WeakMap}return{get:r,dispose:i}}class JB extends bu{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=rL,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class QB extends bu{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Ee,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const eF=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,tF=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function nF(t,e,n){let r=new ry;const i=new Lt,a=new Lt,s=new Cr,o=new JB({depthPacking:iL}),l=new QB,u={},c=n.maxTextureSize,d={[nl]:ia,[ia]:nl,[Yo]:Yo},h=new fu({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Lt},radius:{value:4}},vertexShader:eF,fragmentShader:tF}),v=h.clone();v.defines.HORIZONTAL_PASS=1;const x=new la;x.setAttribute("position",new Ui(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new $i(x,h),b=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=R8,this.render=function(A,D,O){if(b.enabled===!1||b.autoUpdate===!1&&b.needsUpdate===!1||A.length===0)return;const V=t.getRenderTarget(),P=t.getActiveCubeFace(),U=t.getActiveMipmapLevel(),Y=t.state;Y.setBlending(Qo),Y.buffers.color.setClear(1,1,1,1),Y.buffers.depth.setTest(!0),Y.setScissorTest(!1);for(let fe=0,Q=A.length;fe<Q;fe++){const G=A[fe],re=G.shadow;if(re===void 0){console.warn("THREE.WebGLShadowMap:",G,"has no shadow.");continue}if(re.autoUpdate===!1&&re.needsUpdate===!1)continue;i.copy(re.mapSize);const he=re.getFrameExtents();if(i.multiply(he),a.copy(re.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(a.x=Math.floor(c/he.x),i.x=a.x*he.x,re.mapSize.x=a.x),i.y>c&&(a.y=Math.floor(c/he.y),i.y=a.y*he.y,re.mapSize.y=a.y)),re.map===null){const $e=this.type!==qd?{minFilter:ti,magFilter:ti}:{};re.map=new al(i.x,i.y,$e),re.map.texture.name=G.name+".shadowMap",re.camera.updateProjectionMatrix()}t.setRenderTarget(re.map),t.clear();const ye=re.getViewportCount();for(let $e=0;$e<ye;$e++){const _e=re.getViewport($e);s.set(a.x*_e.x,a.y*_e.y,a.x*_e.z,a.y*_e.w),Y.viewport(s),re.updateMatrices(G,$e),r=re.getFrustum(),C(D,O,re.camera,G,this.type)}re.isPointLightShadow!==!0&&this.type===qd&&S(re,O),re.needsUpdate=!1}b.needsUpdate=!1,t.setRenderTarget(V,P,U)};function S(A,D){const O=e.update(_);h.defines.VSM_SAMPLES!==A.blurSamples&&(h.defines.VSM_SAMPLES=A.blurSamples,v.defines.VSM_SAMPLES=A.blurSamples,h.needsUpdate=!0,v.needsUpdate=!0),A.mapPass===null&&(A.mapPass=new al(i.x,i.y)),h.uniforms.shadow_pass.value=A.map.texture,h.uniforms.resolution.value=A.mapSize,h.uniforms.radius.value=A.radius,t.setRenderTarget(A.mapPass),t.clear(),t.renderBufferDirect(D,null,O,h,_,null),v.uniforms.shadow_pass.value=A.mapPass.texture,v.uniforms.resolution.value=A.mapSize,v.uniforms.radius.value=A.radius,t.setRenderTarget(A.map),t.clear(),t.renderBufferDirect(D,null,O,v,_,null)}function E(A,D,O,V,P,U){let Y=null;const fe=O.isPointLight===!0?A.customDistanceMaterial:A.customDepthMaterial;if(fe!==void 0)Y=fe;else if(Y=O.isPointLight===!0?l:o,t.localClippingEnabled&&D.clipShadows===!0&&Array.isArray(D.clippingPlanes)&&D.clippingPlanes.length!==0||D.displacementMap&&D.displacementScale!==0||D.alphaMap&&D.alphaTest>0||D.map&&D.alphaTest>0){const Q=Y.uuid,G=D.uuid;let re=u[Q];re===void 0&&(re={},u[Q]=re);let he=re[G];he===void 0&&(he=Y.clone(),re[G]=he),Y=he}return Y.visible=D.visible,Y.wireframe=D.wireframe,U===qd?Y.side=D.shadowSide!==null?D.shadowSide:D.side:Y.side=D.shadowSide!==null?D.shadowSide:d[D.side],Y.alphaMap=D.alphaMap,Y.alphaTest=D.alphaTest,Y.map=D.map,Y.clipShadows=D.clipShadows,Y.clippingPlanes=D.clippingPlanes,Y.clipIntersection=D.clipIntersection,Y.displacementMap=D.displacementMap,Y.displacementScale=D.displacementScale,Y.displacementBias=D.displacementBias,Y.wireframeLinewidth=D.wireframeLinewidth,Y.linewidth=D.linewidth,O.isPointLight===!0&&Y.isMeshDistanceMaterial===!0&&(Y.referencePosition.setFromMatrixPosition(O.matrixWorld),Y.nearDistance=V,Y.farDistance=P),Y}function C(A,D,O,V,P){if(A.visible===!1)return;if(A.layers.test(D.layers)&&(A.isMesh||A.isLine||A.isPoints)&&(A.castShadow||A.receiveShadow&&P===qd)&&(!A.frustumCulled||r.intersectsObject(A))){A.modelViewMatrix.multiplyMatrices(O.matrixWorldInverse,A.matrixWorld);const fe=e.update(A),Q=A.material;if(Array.isArray(Q)){const G=fe.groups;for(let re=0,he=G.length;re<he;re++){const ye=G[re],$e=Q[ye.materialIndex];if($e&&$e.visible){const _e=E(A,$e,V,O.near,O.far,P);t.renderBufferDirect(O,null,fe,_e,A,ye)}}}else if(Q.visible){const G=E(A,Q,V,O.near,O.far,P);t.renderBufferDirect(O,null,fe,G,A,null)}}const Y=A.children;for(let fe=0,Q=Y.length;fe<Q;fe++)C(Y[fe],D,O,V,P)}}function rF(t,e,n){const r=n.isWebGL2;function i(){let Re=!1;const it=new Cr;let pt=null;const Tt=new Cr(0,0,0,0);return{setMask:function(Rt){pt!==Rt&&!Re&&(t.colorMask(Rt,Rt,Rt,Rt),pt=Rt)},setLocked:function(Rt){Re=Rt},setClear:function(Rt,$n,nr,mr,bn){bn===!0&&(Rt*=mr,$n*=mr,nr*=mr),it.set(Rt,$n,nr,mr),Tt.equals(it)===!1&&(t.clearColor(Rt,$n,nr,mr),Tt.copy(it))},reset:function(){Re=!1,pt=null,Tt.set(-1,0,0,0)}}}function a(){let Re=!1,it=null,pt=null,Tt=null;return{setTest:function(Rt){Rt?ge(2929):xe(2929)},setMask:function(Rt){it!==Rt&&!Re&&(t.depthMask(Rt),it=Rt)},setFunc:function(Rt){if(pt!==Rt){switch(Rt){case CD:t.depthFunc(512);break;case AD:t.depthFunc(519);break;case kD:t.depthFunc(513);break;case Dv:t.depthFunc(515);break;case ID:t.depthFunc(514);break;case $D:t.depthFunc(518);break;case PD:t.depthFunc(516);break;case RD:t.depthFunc(517);break;default:t.depthFunc(515)}pt=Rt}},setLocked:function(Rt){Re=Rt},setClear:function(Rt){Tt!==Rt&&(t.clearDepth(Rt),Tt=Rt)},reset:function(){Re=!1,it=null,pt=null,Tt=null}}}function s(){let Re=!1,it=null,pt=null,Tt=null,Rt=null,$n=null,nr=null,mr=null,bn=null;return{setTest:function(Yt){Re||(Yt?ge(2960):xe(2960))},setMask:function(Yt){it!==Yt&&!Re&&(t.stencilMask(Yt),it=Yt)},setFunc:function(Yt,ln,sn){(pt!==Yt||Tt!==ln||Rt!==sn)&&(t.stencilFunc(Yt,ln,sn),pt=Yt,Tt=ln,Rt=sn)},setOp:function(Yt,ln,sn){($n!==Yt||nr!==ln||mr!==sn)&&(t.stencilOp(Yt,ln,sn),$n=Yt,nr=ln,mr=sn)},setLocked:function(Yt){Re=Yt},setClear:function(Yt){bn!==Yt&&(t.clearStencil(Yt),bn=Yt)},reset:function(){Re=!1,it=null,pt=null,Tt=null,Rt=null,$n=null,nr=null,mr=null,bn=null}}}const o=new i,l=new a,u=new s,c=new WeakMap,d=new WeakMap;let h={},v={},x=new WeakMap,_=[],b=null,S=!1,E=null,C=null,A=null,D=null,O=null,V=null,P=null,U=!1,Y=null,fe=null,Q=null,G=null,re=null;const he=t.getParameter(35661);let ye=!1,$e=0;const _e=t.getParameter(7938);_e.indexOf("WebGL")!==-1?($e=parseFloat(/^WebGL (\d)/.exec(_e)[1]),ye=$e>=1):_e.indexOf("OpenGL ES")!==-1&&($e=parseFloat(/^OpenGL ES (\d)/.exec(_e)[1]),ye=$e>=2);let de=null,Oe={};const ve=t.getParameter(3088),ie=t.getParameter(2978),Pe=new Cr().fromArray(ve),et=new Cr().fromArray(ie);function ne(Re,it,pt){const Tt=new Uint8Array(4),Rt=t.createTexture();t.bindTexture(Re,Rt),t.texParameteri(Re,10241,9728),t.texParameteri(Re,10240,9728);for(let $n=0;$n<pt;$n++)t.texImage2D(it+$n,0,6408,1,1,0,6408,5121,Tt);return Rt}const qe={};qe[3553]=ne(3553,3553,1),qe[34067]=ne(34067,34069,6),o.setClear(0,0,0,1),l.setClear(1),u.setClear(0),ge(2929),l.setFunc(Dv),Ze(!1),We(X_),ge(2884),ke(Qo);function ge(Re){h[Re]!==!0&&(t.enable(Re),h[Re]=!0)}function xe(Re){h[Re]!==!1&&(t.disable(Re),h[Re]=!1)}function ze(Re,it){return v[Re]!==it?(t.bindFramebuffer(Re,it),v[Re]=it,r&&(Re===36009&&(v[36160]=it),Re===36160&&(v[36009]=it)),!0):!1}function Ge(Re,it){let pt=_,Tt=!1;if(Re)if(pt=x.get(it),pt===void 0&&(pt=[],x.set(it,pt)),Re.isWebGLMultipleRenderTargets){const Rt=Re.texture;if(pt.length!==Rt.length||pt[0]!==36064){for(let $n=0,nr=Rt.length;$n<nr;$n++)pt[$n]=36064+$n;pt.length=Rt.length,Tt=!0}}else pt[0]!==36064&&(pt[0]=36064,Tt=!0);else pt[0]!==1029&&(pt[0]=1029,Tt=!0);Tt&&(n.isWebGL2?t.drawBuffers(pt):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(pt))}function ut(Re){return b!==Re?(t.useProgram(Re),b=Re,!0):!1}const ce={[gc]:32774,[gD]:32778,[vD]:32779};if(r)ce[J_]=32775,ce[Q_]=32776;else{const Re=e.get("EXT_blend_minmax");Re!==null&&(ce[J_]=Re.MIN_EXT,ce[Q_]=Re.MAX_EXT)}const me={[yD]:0,[_D]:1,[bD]:768,[L8]:770,[TD]:776,[MD]:774,[wD]:772,[xD]:769,[z8]:771,[ED]:775,[SD]:773};function ke(Re,it,pt,Tt,Rt,$n,nr,mr){if(Re===Qo){S===!0&&(xe(3042),S=!1);return}if(S===!1&&(ge(3042),S=!0),Re!==mD){if(Re!==E||mr!==U){if((C!==gc||O!==gc)&&(t.blendEquation(32774),C=gc,O=gc),mr)switch(Re){case kc:t.blendFuncSeparate(1,771,1,771);break;case K_:t.blendFunc(1,1);break;case Y_:t.blendFuncSeparate(0,769,0,1);break;case Z_:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Re);break}else switch(Re){case kc:t.blendFuncSeparate(770,771,1,771);break;case K_:t.blendFunc(770,1);break;case Y_:t.blendFuncSeparate(0,769,0,1);break;case Z_:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Re);break}A=null,D=null,V=null,P=null,E=Re,U=mr}return}Rt=Rt||it,$n=$n||pt,nr=nr||Tt,(it!==C||Rt!==O)&&(t.blendEquationSeparate(ce[it],ce[Rt]),C=it,O=Rt),(pt!==A||Tt!==D||$n!==V||nr!==P)&&(t.blendFuncSeparate(me[pt],me[Tt],me[$n],me[nr]),A=pt,D=Tt,V=$n,P=nr),E=Re,U=!1}function Xe(Re,it){Re.side===Yo?xe(2884):ge(2884);let pt=Re.side===ia;it&&(pt=!pt),Ze(pt),Re.blending===kc&&Re.transparent===!1?ke(Qo):ke(Re.blending,Re.blendEquation,Re.blendSrc,Re.blendDst,Re.blendEquationAlpha,Re.blendSrcAlpha,Re.blendDstAlpha,Re.premultipliedAlpha),l.setFunc(Re.depthFunc),l.setTest(Re.depthTest),l.setMask(Re.depthWrite),o.setMask(Re.colorWrite);const Tt=Re.stencilWrite;u.setTest(Tt),Tt&&(u.setMask(Re.stencilWriteMask),u.setFunc(Re.stencilFunc,Re.stencilRef,Re.stencilFuncMask),u.setOp(Re.stencilFail,Re.stencilZFail,Re.stencilZPass)),ht(Re.polygonOffset,Re.polygonOffsetFactor,Re.polygonOffsetUnits),Re.alphaToCoverage===!0?ge(32926):xe(32926)}function Ze(Re){Y!==Re&&(Re?t.frontFace(2304):t.frontFace(2305),Y=Re)}function We(Re){Re!==hD?(ge(2884),Re!==fe&&(Re===X_?t.cullFace(1029):Re===pD?t.cullFace(1028):t.cullFace(1032))):xe(2884),fe=Re}function gt(Re){Re!==Q&&(ye&&t.lineWidth(Re),Q=Re)}function ht(Re,it,pt){Re?(ge(32823),(G!==it||re!==pt)&&(t.polygonOffset(it,pt),G=it,re=pt)):xe(32823)}function vt(Re){Re?ge(3089):xe(3089)}function ct(Re){Re===void 0&&(Re=33984+he-1),de!==Re&&(t.activeTexture(Re),de=Re)}function se(Re,it,pt){pt===void 0&&(de===null?pt=33984+he-1:pt=de);let Tt=Oe[pt];Tt===void 0&&(Tt={type:void 0,texture:void 0},Oe[pt]=Tt),(Tt.type!==Re||Tt.texture!==it)&&(de!==pt&&(t.activeTexture(pt),de=pt),t.bindTexture(Re,it||qe[Re]),Tt.type=Re,Tt.texture=it)}function K(){const Re=Oe[de];Re!==void 0&&Re.type!==void 0&&(t.bindTexture(Re.type,null),Re.type=void 0,Re.texture=void 0)}function De(){try{t.compressedTexImage2D.apply(t,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}function Je(){try{t.compressedTexImage3D.apply(t,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}function tt(){try{t.texSubImage2D.apply(t,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}function nt(){try{t.texSubImage3D.apply(t,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}function xt(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}function be(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}function Ie(){try{t.texStorage2D.apply(t,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}function at(){try{t.texStorage3D.apply(t,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}function Le(){try{t.texImage2D.apply(t,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}function kt(){try{t.texImage3D.apply(t,arguments)}catch(Re){console.error("THREE.WebGLState:",Re)}}function Dt(Re){Pe.equals(Re)===!1&&(t.scissor(Re.x,Re.y,Re.z,Re.w),Pe.copy(Re))}function At(Re){et.equals(Re)===!1&&(t.viewport(Re.x,Re.y,Re.z,Re.w),et.copy(Re))}function Kt(Re,it){let pt=d.get(it);pt===void 0&&(pt=new WeakMap,d.set(it,pt));let Tt=pt.get(Re);Tt===void 0&&(Tt=t.getUniformBlockIndex(it,Re.name),pt.set(Re,Tt))}function on(Re,it){const Tt=d.get(it).get(Re);c.get(it)!==Tt&&(t.uniformBlockBinding(it,Tt,Re.__bindingPointIndex),c.set(it,Tt))}function Mn(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),r===!0&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),h={},de=null,Oe={},v={},x=new WeakMap,_=[],b=null,S=!1,E=null,C=null,A=null,D=null,O=null,V=null,P=null,U=!1,Y=null,fe=null,Q=null,G=null,re=null,Pe.set(0,0,t.canvas.width,t.canvas.height),et.set(0,0,t.canvas.width,t.canvas.height),o.reset(),l.reset(),u.reset()}return{buffers:{color:o,depth:l,stencil:u},enable:ge,disable:xe,bindFramebuffer:ze,drawBuffers:Ge,useProgram:ut,setBlending:ke,setMaterial:Xe,setFlipSided:Ze,setCullFace:We,setLineWidth:gt,setPolygonOffset:ht,setScissorTest:vt,activeTexture:ct,bindTexture:se,unbindTexture:K,compressedTexImage2D:De,compressedTexImage3D:Je,texImage2D:Le,texImage3D:kt,updateUBOMapping:Kt,uniformBlockBinding:on,texStorage2D:Ie,texStorage3D:at,texSubImage2D:tt,texSubImage3D:nt,compressedTexSubImage2D:xt,compressedTexSubImage3D:be,scissor:Dt,viewport:At,reset:Mn}}function iF(t,e,n,r,i,a,s){const o=i.isWebGL2,l=i.maxTextures,u=i.maxCubemapSize,c=i.maxTextureSize,d=i.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,v=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),x=new WeakMap;let _;const b=new WeakMap;let S=!1;try{S=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function E(se,K){return S?new OffscreenCanvas(se,K):Y0("canvas")}function C(se,K,De,Je){let tt=1;if((se.width>Je||se.height>Je)&&(tt=Je/Math.max(se.width,se.height)),tt<1||K===!0)if(typeof HTMLImageElement<"u"&&se instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&se instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&se instanceof ImageBitmap){const nt=K?lL:Math.floor,xt=nt(tt*se.width),be=nt(tt*se.height);_===void 0&&(_=E(xt,be));const Ie=De?E(xt,be):_;return Ie.width=xt,Ie.height=be,Ie.getContext("2d").drawImage(se,0,0,xt,be),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+se.width+"x"+se.height+") to ("+xt+"x"+be+")."),Ie}else return"data"in se&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+se.width+"x"+se.height+")."),se;return se}function A(se){return Tb(se.width)&&Tb(se.height)}function D(se){return o?!1:se.wrapS!==Ba||se.wrapT!==Ba||se.minFilter!==ti&&se.minFilter!==ba}function O(se,K){return se.generateMipmaps&&K&&se.minFilter!==ti&&se.minFilter!==ba}function V(se){t.generateMipmap(se)}function P(se,K,De,Je,tt=!1){if(o===!1)return K;if(se!==null){if(t[se]!==void 0)return t[se];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+se+"'")}let nt=K;return K===6403&&(De===5126&&(nt=33326),De===5131&&(nt=33325),De===5121&&(nt=33321)),K===33319&&(De===5126&&(nt=33328),De===5131&&(nt=33327),De===5121&&(nt=33323)),K===6408&&(De===5126&&(nt=34836),De===5131&&(nt=34842),De===5121&&(nt=Je===sr&&tt===!1?35907:32856),De===32819&&(nt=32854),De===32820&&(nt=32855)),(nt===33325||nt===33326||nt===33327||nt===33328||nt===34842||nt===34836)&&e.get("EXT_color_buffer_float"),nt}function U(se,K,De){return O(se,De)===!0||se.isFramebufferTexture&&se.minFilter!==ti&&se.minFilter!==ba?Math.log2(Math.max(K.width,K.height))+1:se.mipmaps!==void 0&&se.mipmaps.length>0?se.mipmaps.length:se.isCompressedTexture&&Array.isArray(se.image)?K.mipmaps.length:1}function Y(se){return se===ti||se===eb||se===wm?9728:9729}function fe(se){const K=se.target;K.removeEventListener("dispose",fe),G(K),K.isVideoTexture&&x.delete(K)}function Q(se){const K=se.target;K.removeEventListener("dispose",Q),he(K)}function G(se){const K=r.get(se);if(K.__webglInit===void 0)return;const De=se.source,Je=b.get(De);if(Je){const tt=Je[K.__cacheKey];tt.usedTimes--,tt.usedTimes===0&&re(se),Object.keys(Je).length===0&&b.delete(De)}r.remove(se)}function re(se){const K=r.get(se);t.deleteTexture(K.__webglTexture);const De=se.source,Je=b.get(De);delete Je[K.__cacheKey],s.memory.textures--}function he(se){const K=se.texture,De=r.get(se),Je=r.get(K);if(Je.__webglTexture!==void 0&&(t.deleteTexture(Je.__webglTexture),s.memory.textures--),se.depthTexture&&se.depthTexture.dispose(),se.isWebGLCubeRenderTarget)for(let tt=0;tt<6;tt++)t.deleteFramebuffer(De.__webglFramebuffer[tt]),De.__webglDepthbuffer&&t.deleteRenderbuffer(De.__webglDepthbuffer[tt]);else{if(t.deleteFramebuffer(De.__webglFramebuffer),De.__webglDepthbuffer&&t.deleteRenderbuffer(De.__webglDepthbuffer),De.__webglMultisampledFramebuffer&&t.deleteFramebuffer(De.__webglMultisampledFramebuffer),De.__webglColorRenderbuffer)for(let tt=0;tt<De.__webglColorRenderbuffer.length;tt++)De.__webglColorRenderbuffer[tt]&&t.deleteRenderbuffer(De.__webglColorRenderbuffer[tt]);De.__webglDepthRenderbuffer&&t.deleteRenderbuffer(De.__webglDepthRenderbuffer)}if(se.isWebGLMultipleRenderTargets)for(let tt=0,nt=K.length;tt<nt;tt++){const xt=r.get(K[tt]);xt.__webglTexture&&(t.deleteTexture(xt.__webglTexture),s.memory.textures--),r.remove(K[tt])}r.remove(K),r.remove(se)}let ye=0;function $e(){ye=0}function _e(){const se=ye;return se>=l&&console.warn("THREE.WebGLTextures: Trying to use "+se+" texture units while this GPU supports only "+l),ye+=1,se}function de(se){const K=[];return K.push(se.wrapS),K.push(se.wrapT),K.push(se.wrapR||0),K.push(se.magFilter),K.push(se.minFilter),K.push(se.anisotropy),K.push(se.internalFormat),K.push(se.format),K.push(se.type),K.push(se.generateMipmaps),K.push(se.premultiplyAlpha),K.push(se.flipY),K.push(se.unpackAlignment),K.push(se.encoding),K.join()}function Oe(se,K){const De=r.get(se);if(se.isVideoTexture&&vt(se),se.isRenderTargetTexture===!1&&se.version>0&&De.__version!==se.version){const Je=se.image;if(Je===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Je.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{xe(De,se,K);return}}n.bindTexture(3553,De.__webglTexture,33984+K)}function ve(se,K){const De=r.get(se);if(se.version>0&&De.__version!==se.version){xe(De,se,K);return}n.bindTexture(35866,De.__webglTexture,33984+K)}function ie(se,K){const De=r.get(se);if(se.version>0&&De.__version!==se.version){xe(De,se,K);return}n.bindTexture(32879,De.__webglTexture,33984+K)}function Pe(se,K){const De=r.get(se);if(se.version>0&&De.__version!==se.version){ze(De,se,K);return}n.bindTexture(34067,De.__webglTexture,33984+K)}const et={[Jl]:10497,[Ba]:33071,[Ov]:33648},ne={[ti]:9728,[eb]:9984,[wm]:9986,[ba]:9729,[UD]:9985,[If]:9987};function qe(se,K,De){if(De?(t.texParameteri(se,10242,et[K.wrapS]),t.texParameteri(se,10243,et[K.wrapT]),(se===32879||se===35866)&&t.texParameteri(se,32882,et[K.wrapR]),t.texParameteri(se,10240,ne[K.magFilter]),t.texParameteri(se,10241,ne[K.minFilter])):(t.texParameteri(se,10242,33071),t.texParameteri(se,10243,33071),(se===32879||se===35866)&&t.texParameteri(se,32882,33071),(K.wrapS!==Ba||K.wrapT!==Ba)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(se,10240,Y(K.magFilter)),t.texParameteri(se,10241,Y(K.minFilter)),K.minFilter!==ti&&K.minFilter!==ba&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const Je=e.get("EXT_texture_filter_anisotropic");if(K.magFilter===ti||K.minFilter!==wm&&K.minFilter!==If||K.type===eu&&e.has("OES_texture_float_linear")===!1||o===!1&&K.type===Nc&&e.has("OES_texture_half_float_linear")===!1)return;(K.anisotropy>1||r.get(K).__currentAnisotropy)&&(t.texParameterf(se,Je.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(K.anisotropy,i.getMaxAnisotropy())),r.get(K).__currentAnisotropy=K.anisotropy)}}function ge(se,K){let De=!1;se.__webglInit===void 0&&(se.__webglInit=!0,K.addEventListener("dispose",fe));const Je=K.source;let tt=b.get(Je);tt===void 0&&(tt={},b.set(Je,tt));const nt=de(K);if(nt!==se.__cacheKey){tt[nt]===void 0&&(tt[nt]={texture:t.createTexture(),usedTimes:0},s.memory.textures++,De=!0),tt[nt].usedTimes++;const xt=tt[se.__cacheKey];xt!==void 0&&(tt[se.__cacheKey].usedTimes--,xt.usedTimes===0&&re(K)),se.__cacheKey=nt,se.__webglTexture=tt[nt].texture}return De}function xe(se,K,De){let Je=3553;(K.isDataArrayTexture||K.isCompressedArrayTexture)&&(Je=35866),K.isData3DTexture&&(Je=32879);const tt=ge(se,K),nt=K.source;n.bindTexture(Je,se.__webglTexture,33984+De);const xt=r.get(nt);if(nt.version!==xt.__version||tt===!0){n.activeTexture(33984+De),t.pixelStorei(37440,K.flipY),t.pixelStorei(37441,K.premultiplyAlpha),t.pixelStorei(3317,K.unpackAlignment),t.pixelStorei(37443,0);const be=D(K)&&A(K.image)===!1;let Ie=C(K.image,be,!1,c);Ie=ct(K,Ie);const at=A(Ie)||o,Le=a.convert(K.format,K.encoding);let kt=a.convert(K.type),Dt=P(K.internalFormat,Le,kt,K.encoding,K.isVideoTexture);qe(Je,K,at);let At;const Kt=K.mipmaps,on=o&&K.isVideoTexture!==!0,Mn=xt.__version===void 0||tt===!0,Re=U(K,Ie,at);if(K.isDepthTexture)Dt=6402,o?K.type===eu?Dt=36012:K.type===Ql?Dt=33190:K.type===Ic?Dt=35056:Dt=33189:K.type===eu&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),K.format===ou&&Dt===6402&&K.type!==N8&&K.type!==Ql&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),K.type=Ql,kt=a.convert(K.type)),K.format===Bc&&Dt===6402&&(Dt=34041,K.type!==Ic&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),K.type=Ic,kt=a.convert(K.type))),Mn&&(on?n.texStorage2D(3553,1,Dt,Ie.width,Ie.height):n.texImage2D(3553,0,Dt,Ie.width,Ie.height,0,Le,kt,null));else if(K.isDataTexture)if(Kt.length>0&&at){on&&Mn&&n.texStorage2D(3553,Re,Dt,Kt[0].width,Kt[0].height);for(let it=0,pt=Kt.length;it<pt;it++)At=Kt[it],on?n.texSubImage2D(3553,it,0,0,At.width,At.height,Le,kt,At.data):n.texImage2D(3553,it,Dt,At.width,At.height,0,Le,kt,At.data);K.generateMipmaps=!1}else on?(Mn&&n.texStorage2D(3553,Re,Dt,Ie.width,Ie.height),n.texSubImage2D(3553,0,0,0,Ie.width,Ie.height,Le,kt,Ie.data)):n.texImage2D(3553,0,Dt,Ie.width,Ie.height,0,Le,kt,Ie.data);else if(K.isCompressedTexture)if(K.isCompressedArrayTexture){on&&Mn&&n.texStorage3D(35866,Re,Dt,Kt[0].width,Kt[0].height,Ie.depth);for(let it=0,pt=Kt.length;it<pt;it++)At=Kt[it],K.format!==xa?Le!==null?on?n.compressedTexSubImage3D(35866,it,0,0,0,At.width,At.height,Ie.depth,Le,At.data,0,0):n.compressedTexImage3D(35866,it,Dt,At.width,At.height,Ie.depth,0,At.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):on?n.texSubImage3D(35866,it,0,0,0,At.width,At.height,Ie.depth,Le,kt,At.data):n.texImage3D(35866,it,Dt,At.width,At.height,Ie.depth,0,Le,kt,At.data)}else{on&&Mn&&n.texStorage2D(3553,Re,Dt,Kt[0].width,Kt[0].height);for(let it=0,pt=Kt.length;it<pt;it++)At=Kt[it],K.format!==xa?Le!==null?on?n.compressedTexSubImage2D(3553,it,0,0,At.width,At.height,Le,At.data):n.compressedTexImage2D(3553,it,Dt,At.width,At.height,0,At.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):on?n.texSubImage2D(3553,it,0,0,At.width,At.height,Le,kt,At.data):n.texImage2D(3553,it,Dt,At.width,At.height,0,Le,kt,At.data)}else if(K.isDataArrayTexture)on?(Mn&&n.texStorage3D(35866,Re,Dt,Ie.width,Ie.height,Ie.depth),n.texSubImage3D(35866,0,0,0,0,Ie.width,Ie.height,Ie.depth,Le,kt,Ie.data)):n.texImage3D(35866,0,Dt,Ie.width,Ie.height,Ie.depth,0,Le,kt,Ie.data);else if(K.isData3DTexture)on?(Mn&&n.texStorage3D(32879,Re,Dt,Ie.width,Ie.height,Ie.depth),n.texSubImage3D(32879,0,0,0,0,Ie.width,Ie.height,Ie.depth,Le,kt,Ie.data)):n.texImage3D(32879,0,Dt,Ie.width,Ie.height,Ie.depth,0,Le,kt,Ie.data);else if(K.isFramebufferTexture){if(Mn)if(on)n.texStorage2D(3553,Re,Dt,Ie.width,Ie.height);else{let it=Ie.width,pt=Ie.height;for(let Tt=0;Tt<Re;Tt++)n.texImage2D(3553,Tt,Dt,it,pt,0,Le,kt,null),it>>=1,pt>>=1}}else if(Kt.length>0&&at){on&&Mn&&n.texStorage2D(3553,Re,Dt,Kt[0].width,Kt[0].height);for(let it=0,pt=Kt.length;it<pt;it++)At=Kt[it],on?n.texSubImage2D(3553,it,0,0,Le,kt,At):n.texImage2D(3553,it,Dt,Le,kt,At);K.generateMipmaps=!1}else on?(Mn&&n.texStorage2D(3553,Re,Dt,Ie.width,Ie.height),n.texSubImage2D(3553,0,0,0,Le,kt,Ie)):n.texImage2D(3553,0,Dt,Le,kt,Ie);O(K,at)&&V(Je),xt.__version=nt.version,K.onUpdate&&K.onUpdate(K)}se.__version=K.version}function ze(se,K,De){if(K.image.length!==6)return;const Je=ge(se,K),tt=K.source;n.bindTexture(34067,se.__webglTexture,33984+De);const nt=r.get(tt);if(tt.version!==nt.__version||Je===!0){n.activeTexture(33984+De),t.pixelStorei(37440,K.flipY),t.pixelStorei(37441,K.premultiplyAlpha),t.pixelStorei(3317,K.unpackAlignment),t.pixelStorei(37443,0);const xt=K.isCompressedTexture||K.image[0].isCompressedTexture,be=K.image[0]&&K.image[0].isDataTexture,Ie=[];for(let it=0;it<6;it++)!xt&&!be?Ie[it]=C(K.image[it],!1,!0,u):Ie[it]=be?K.image[it].image:K.image[it],Ie[it]=ct(K,Ie[it]);const at=Ie[0],Le=A(at)||o,kt=a.convert(K.format,K.encoding),Dt=a.convert(K.type),At=P(K.internalFormat,kt,Dt,K.encoding),Kt=o&&K.isVideoTexture!==!0,on=nt.__version===void 0||Je===!0;let Mn=U(K,at,Le);qe(34067,K,Le);let Re;if(xt){Kt&&on&&n.texStorage2D(34067,Mn,At,at.width,at.height);for(let it=0;it<6;it++){Re=Ie[it].mipmaps;for(let pt=0;pt<Re.length;pt++){const Tt=Re[pt];K.format!==xa?kt!==null?Kt?n.compressedTexSubImage2D(34069+it,pt,0,0,Tt.width,Tt.height,kt,Tt.data):n.compressedTexImage2D(34069+it,pt,At,Tt.width,Tt.height,0,Tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Kt?n.texSubImage2D(34069+it,pt,0,0,Tt.width,Tt.height,kt,Dt,Tt.data):n.texImage2D(34069+it,pt,At,Tt.width,Tt.height,0,kt,Dt,Tt.data)}}}else{Re=K.mipmaps,Kt&&on&&(Re.length>0&&Mn++,n.texStorage2D(34067,Mn,At,Ie[0].width,Ie[0].height));for(let it=0;it<6;it++)if(be){Kt?n.texSubImage2D(34069+it,0,0,0,Ie[it].width,Ie[it].height,kt,Dt,Ie[it].data):n.texImage2D(34069+it,0,At,Ie[it].width,Ie[it].height,0,kt,Dt,Ie[it].data);for(let pt=0;pt<Re.length;pt++){const Rt=Re[pt].image[it].image;Kt?n.texSubImage2D(34069+it,pt+1,0,0,Rt.width,Rt.height,kt,Dt,Rt.data):n.texImage2D(34069+it,pt+1,At,Rt.width,Rt.height,0,kt,Dt,Rt.data)}}else{Kt?n.texSubImage2D(34069+it,0,0,0,kt,Dt,Ie[it]):n.texImage2D(34069+it,0,At,kt,Dt,Ie[it]);for(let pt=0;pt<Re.length;pt++){const Tt=Re[pt];Kt?n.texSubImage2D(34069+it,pt+1,0,0,kt,Dt,Tt.image[it]):n.texImage2D(34069+it,pt+1,At,kt,Dt,Tt.image[it])}}}O(K,Le)&&V(34067),nt.__version=tt.version,K.onUpdate&&K.onUpdate(K)}se.__version=K.version}function Ge(se,K,De,Je,tt){const nt=a.convert(De.format,De.encoding),xt=a.convert(De.type),be=P(De.internalFormat,nt,xt,De.encoding);r.get(K).__hasExternalTextures||(tt===32879||tt===35866?n.texImage3D(tt,0,be,K.width,K.height,K.depth,0,nt,xt,null):n.texImage2D(tt,0,be,K.width,K.height,0,nt,xt,null)),n.bindFramebuffer(36160,se),ht(K)?h.framebufferTexture2DMultisampleEXT(36160,Je,tt,r.get(De).__webglTexture,0,gt(K)):(tt===3553||tt>=34069&&tt<=34074)&&t.framebufferTexture2D(36160,Je,tt,r.get(De).__webglTexture,0),n.bindFramebuffer(36160,null)}function ut(se,K,De){if(t.bindRenderbuffer(36161,se),K.depthBuffer&&!K.stencilBuffer){let Je=33189;if(De||ht(K)){const tt=K.depthTexture;tt&&tt.isDepthTexture&&(tt.type===eu?Je=36012:tt.type===Ql&&(Je=33190));const nt=gt(K);ht(K)?h.renderbufferStorageMultisampleEXT(36161,nt,Je,K.width,K.height):t.renderbufferStorageMultisample(36161,nt,Je,K.width,K.height)}else t.renderbufferStorage(36161,Je,K.width,K.height);t.framebufferRenderbuffer(36160,36096,36161,se)}else if(K.depthBuffer&&K.stencilBuffer){const Je=gt(K);De&&ht(K)===!1?t.renderbufferStorageMultisample(36161,Je,35056,K.width,K.height):ht(K)?h.renderbufferStorageMultisampleEXT(36161,Je,35056,K.width,K.height):t.renderbufferStorage(36161,34041,K.width,K.height),t.framebufferRenderbuffer(36160,33306,36161,se)}else{const Je=K.isWebGLMultipleRenderTargets===!0?K.texture:[K.texture];for(let tt=0;tt<Je.length;tt++){const nt=Je[tt],xt=a.convert(nt.format,nt.encoding),be=a.convert(nt.type),Ie=P(nt.internalFormat,xt,be,nt.encoding),at=gt(K);De&&ht(K)===!1?t.renderbufferStorageMultisample(36161,at,Ie,K.width,K.height):ht(K)?h.renderbufferStorageMultisampleEXT(36161,at,Ie,K.width,K.height):t.renderbufferStorage(36161,Ie,K.width,K.height)}}t.bindRenderbuffer(36161,null)}function ce(se,K){if(K&&K.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,se),!(K.depthTexture&&K.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(K.depthTexture).__webglTexture||K.depthTexture.image.width!==K.width||K.depthTexture.image.height!==K.height)&&(K.depthTexture.image.width=K.width,K.depthTexture.image.height=K.height,K.depthTexture.needsUpdate=!0),Oe(K.depthTexture,0);const Je=r.get(K.depthTexture).__webglTexture,tt=gt(K);if(K.depthTexture.format===ou)ht(K)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,Je,0,tt):t.framebufferTexture2D(36160,36096,3553,Je,0);else if(K.depthTexture.format===Bc)ht(K)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,Je,0,tt):t.framebufferTexture2D(36160,33306,3553,Je,0);else throw new Error("Unknown depthTexture format")}function me(se){const K=r.get(se),De=se.isWebGLCubeRenderTarget===!0;if(se.depthTexture&&!K.__autoAllocateDepthBuffer){if(De)throw new Error("target.depthTexture not supported in Cube render targets");ce(K.__webglFramebuffer,se)}else if(De){K.__webglDepthbuffer=[];for(let Je=0;Je<6;Je++)n.bindFramebuffer(36160,K.__webglFramebuffer[Je]),K.__webglDepthbuffer[Je]=t.createRenderbuffer(),ut(K.__webglDepthbuffer[Je],se,!1)}else n.bindFramebuffer(36160,K.__webglFramebuffer),K.__webglDepthbuffer=t.createRenderbuffer(),ut(K.__webglDepthbuffer,se,!1);n.bindFramebuffer(36160,null)}function ke(se,K,De){const Je=r.get(se);K!==void 0&&Ge(Je.__webglFramebuffer,se,se.texture,36064,3553),De!==void 0&&me(se)}function Xe(se){const K=se.texture,De=r.get(se),Je=r.get(K);se.addEventListener("dispose",Q),se.isWebGLMultipleRenderTargets!==!0&&(Je.__webglTexture===void 0&&(Je.__webglTexture=t.createTexture()),Je.__version=K.version,s.memory.textures++);const tt=se.isWebGLCubeRenderTarget===!0,nt=se.isWebGLMultipleRenderTargets===!0,xt=A(se)||o;if(tt){De.__webglFramebuffer=[];for(let be=0;be<6;be++)De.__webglFramebuffer[be]=t.createFramebuffer()}else{if(De.__webglFramebuffer=t.createFramebuffer(),nt)if(i.drawBuffers){const be=se.texture;for(let Ie=0,at=be.length;Ie<at;Ie++){const Le=r.get(be[Ie]);Le.__webglTexture===void 0&&(Le.__webglTexture=t.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&se.samples>0&&ht(se)===!1){const be=nt?K:[K];De.__webglMultisampledFramebuffer=t.createFramebuffer(),De.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,De.__webglMultisampledFramebuffer);for(let Ie=0;Ie<be.length;Ie++){const at=be[Ie];De.__webglColorRenderbuffer[Ie]=t.createRenderbuffer(),t.bindRenderbuffer(36161,De.__webglColorRenderbuffer[Ie]);const Le=a.convert(at.format,at.encoding),kt=a.convert(at.type),Dt=P(at.internalFormat,Le,kt,at.encoding,se.isXRRenderTarget===!0),At=gt(se);t.renderbufferStorageMultisample(36161,At,Dt,se.width,se.height),t.framebufferRenderbuffer(36160,36064+Ie,36161,De.__webglColorRenderbuffer[Ie])}t.bindRenderbuffer(36161,null),se.depthBuffer&&(De.__webglDepthRenderbuffer=t.createRenderbuffer(),ut(De.__webglDepthRenderbuffer,se,!0)),n.bindFramebuffer(36160,null)}}if(tt){n.bindTexture(34067,Je.__webglTexture),qe(34067,K,xt);for(let be=0;be<6;be++)Ge(De.__webglFramebuffer[be],se,K,36064,34069+be);O(K,xt)&&V(34067),n.unbindTexture()}else if(nt){const be=se.texture;for(let Ie=0,at=be.length;Ie<at;Ie++){const Le=be[Ie],kt=r.get(Le);n.bindTexture(3553,kt.__webglTexture),qe(3553,Le,xt),Ge(De.__webglFramebuffer,se,Le,36064+Ie,3553),O(Le,xt)&&V(3553)}n.unbindTexture()}else{let be=3553;(se.isWebGL3DRenderTarget||se.isWebGLArrayRenderTarget)&&(o?be=se.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(be,Je.__webglTexture),qe(be,K,xt),Ge(De.__webglFramebuffer,se,K,36064,be),O(K,xt)&&V(be),n.unbindTexture()}se.depthBuffer&&me(se)}function Ze(se){const K=A(se)||o,De=se.isWebGLMultipleRenderTargets===!0?se.texture:[se.texture];for(let Je=0,tt=De.length;Je<tt;Je++){const nt=De[Je];if(O(nt,K)){const xt=se.isWebGLCubeRenderTarget?34067:3553,be=r.get(nt).__webglTexture;n.bindTexture(xt,be),V(xt),n.unbindTexture()}}}function We(se){if(o&&se.samples>0&&ht(se)===!1){const K=se.isWebGLMultipleRenderTargets?se.texture:[se.texture],De=se.width,Je=se.height;let tt=16384;const nt=[],xt=se.stencilBuffer?33306:36096,be=r.get(se),Ie=se.isWebGLMultipleRenderTargets===!0;if(Ie)for(let at=0;at<K.length;at++)n.bindFramebuffer(36160,be.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+at,36161,null),n.bindFramebuffer(36160,be.__webglFramebuffer),t.framebufferTexture2D(36009,36064+at,3553,null,0);n.bindFramebuffer(36008,be.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,be.__webglFramebuffer);for(let at=0;at<K.length;at++){nt.push(36064+at),se.depthBuffer&&nt.push(xt);const Le=be.__ignoreDepthValues!==void 0?be.__ignoreDepthValues:!1;if(Le===!1&&(se.depthBuffer&&(tt|=256),se.stencilBuffer&&(tt|=1024)),Ie&&t.framebufferRenderbuffer(36008,36064,36161,be.__webglColorRenderbuffer[at]),Le===!0&&(t.invalidateFramebuffer(36008,[xt]),t.invalidateFramebuffer(36009,[xt])),Ie){const kt=r.get(K[at]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,kt,0)}t.blitFramebuffer(0,0,De,Je,0,0,De,Je,tt,9728),v&&t.invalidateFramebuffer(36008,nt)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),Ie)for(let at=0;at<K.length;at++){n.bindFramebuffer(36160,be.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+at,36161,be.__webglColorRenderbuffer[at]);const Le=r.get(K[at]).__webglTexture;n.bindFramebuffer(36160,be.__webglFramebuffer),t.framebufferTexture2D(36009,36064+at,3553,Le,0)}n.bindFramebuffer(36009,be.__webglMultisampledFramebuffer)}}function gt(se){return Math.min(d,se.samples)}function ht(se){const K=r.get(se);return o&&se.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&K.__useRenderToTexture!==!1}function vt(se){const K=s.render.frame;x.get(se)!==K&&(x.set(se,K),se.update())}function ct(se,K){const De=se.encoding,Je=se.format,tt=se.type;return se.isCompressedTexture===!0||se.isVideoTexture===!0||se.format===Nv||De!==il&&(De===sr?o===!1?e.has("EXT_sRGB")===!0&&Je===xa?(se.format=Nv,se.minFilter=ba,se.generateMipmaps=!1):K=U8.sRGBToLinear(K):(Je!==xa||tt!==rl)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",De)),K}this.allocateTextureUnit=_e,this.resetTextureUnits=$e,this.setTexture2D=Oe,this.setTexture2DArray=ve,this.setTexture3D=ie,this.setTextureCube=Pe,this.rebindTextures=ke,this.setupRenderTarget=Xe,this.updateRenderTargetMipmap=Ze,this.updateMultisampleRenderTarget=We,this.setupDepthRenderbuffer=me,this.setupFrameBufferTexture=Ge,this.useMultisampledRTT=ht}function aF(t,e,n){const r=n.isWebGL2;function i(a,s=null){let o;if(a===rl)return 5121;if(a===GD)return 32819;if(a===qD)return 32820;if(a===VD)return 5120;if(a===HD)return 5122;if(a===N8)return 5123;if(a===WD)return 5124;if(a===Ql)return 5125;if(a===eu)return 5126;if(a===Nc)return r?5131:(o=e.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(a===jD)return 6406;if(a===xa)return 6408;if(a===XD)return 6409;if(a===KD)return 6410;if(a===ou)return 6402;if(a===Bc)return 34041;if(a===Nv)return o=e.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(a===YD)return 6403;if(a===ZD)return 36244;if(a===JD)return 33319;if(a===QD)return 33320;if(a===eL)return 36249;if(a===Sm||a===Mm||a===Em||a===Tm)if(s===sr)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(a===Sm)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===Mm)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===Em)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===Tm)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(a===Sm)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===Mm)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===Em)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===Tm)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===tb||a===nb||a===rb||a===ib)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(a===tb)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===nb)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===rb)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===ib)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===tL)return o=e.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===ab||a===sb)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(a===ab)return s===sr?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(a===sb)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===ob||a===lb||a===ub||a===cb||a===db||a===fb||a===hb||a===pb||a===mb||a===gb||a===vb||a===yb||a===_b||a===bb)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(a===ob)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===lb)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===ub)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===cb)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===db)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===fb)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===hb)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===pb)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===mb)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===gb)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===vb)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===yb)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===_b)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===bb)return s===sr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===Cm)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(a===Cm)return s===sr?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(a===nL||a===xb||a===wb||a===Sb)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(a===Cm)return o.COMPRESSED_RED_RGTC1_EXT;if(a===xb)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(a===wb)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(a===Sb)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return a===Ic?r?34042:(o=e.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):t[a]!==void 0?t[a]:null}return{convert:i}}class sF extends Ni{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class tu extends Ar{constructor(){super(),this.isGroup=!0,this.type="Group"}}const oF={type:"move"};class Qm{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new tu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new tu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ee,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ee),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new tu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ee,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ee),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const r of e.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,r){let i=null,a=null,s=null;const o=this._targetRay,l=this._grip,u=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(u&&e.hand){s=!0;for(const _ of e.hand.values()){const b=n.getJointPose(_,r),S=this._getHandJoint(u,_);b!==null&&(S.matrix.fromArray(b.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.jointRadius=b.radius),S.visible=b!==null}const c=u.joints["index-finger-tip"],d=u.joints["thumb-tip"],h=c.position.distanceTo(d.position),v=.02,x=.005;u.inputState.pinching&&h>v+x?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&h<=v-x&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(a=n.getPose(e.gripSpace,r),a!==null&&(l.matrix.fromArray(a.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),a.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(a.linearVelocity)):l.hasLinearVelocity=!1,a.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(a.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(i=n.getPose(e.targetRaySpace,r),i===null&&a!==null&&(i=a),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(oF)))}return o!==null&&(o.visible=i!==null),l!==null&&(l.visible=a!==null),u!==null&&(u.visible=s!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const r=new tu;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[n.jointName]=r,e.add(r)}return e.joints[n.jointName]}}class lF extends Fi{constructor(e,n,r,i,a,s,o,l,u,c){if(c=c!==void 0?c:ou,c!==ou&&c!==Bc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===ou&&(r=Ql),r===void 0&&c===Bc&&(r=Ic),super(null,i,a,s,o,l,c,r,u),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=o!==void 0?o:ti,this.minFilter=l!==void 0?l:ti,this.flipY=!1,this.generateMipmaps=!1}}class uF extends _u{constructor(e,n){super();const r=this;let i=null,a=1,s=null,o="local-floor",l=1,u=null,c=null,d=null,h=null,v=null,x=null;const _=n.getContextAttributes();let b=null,S=null;const E=[],C=[],A=new Set,D=new Map,O=new Ni;O.layers.enable(1),O.viewport=new Cr;const V=new Ni;V.layers.enable(2),V.viewport=new Cr;const P=[O,V],U=new sF;U.layers.enable(1),U.layers.enable(2);let Y=null,fe=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ie){let Pe=E[ie];return Pe===void 0&&(Pe=new Qm,E[ie]=Pe),Pe.getTargetRaySpace()},this.getControllerGrip=function(ie){let Pe=E[ie];return Pe===void 0&&(Pe=new Qm,E[ie]=Pe),Pe.getGripSpace()},this.getHand=function(ie){let Pe=E[ie];return Pe===void 0&&(Pe=new Qm,E[ie]=Pe),Pe.getHandSpace()};function Q(ie){const Pe=C.indexOf(ie.inputSource);if(Pe===-1)return;const et=E[Pe];et!==void 0&&et.dispatchEvent({type:ie.type,data:ie.inputSource})}function G(){i.removeEventListener("select",Q),i.removeEventListener("selectstart",Q),i.removeEventListener("selectend",Q),i.removeEventListener("squeeze",Q),i.removeEventListener("squeezestart",Q),i.removeEventListener("squeezeend",Q),i.removeEventListener("end",G),i.removeEventListener("inputsourceschange",re);for(let ie=0;ie<E.length;ie++){const Pe=C[ie];Pe!==null&&(C[ie]=null,E[ie].disconnect(Pe))}Y=null,fe=null,e.setRenderTarget(b),v=null,h=null,d=null,i=null,S=null,ve.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ie){a=ie,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ie){o=ie,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||s},this.setReferenceSpace=function(ie){u=ie},this.getBaseLayer=function(){return h!==null?h:v},this.getBinding=function(){return d},this.getFrame=function(){return x},this.getSession=function(){return i},this.setSession=async function(ie){if(i=ie,i!==null){if(b=e.getRenderTarget(),i.addEventListener("select",Q),i.addEventListener("selectstart",Q),i.addEventListener("selectend",Q),i.addEventListener("squeeze",Q),i.addEventListener("squeezestart",Q),i.addEventListener("squeezeend",Q),i.addEventListener("end",G),i.addEventListener("inputsourceschange",re),_.xrCompatible!==!0&&await n.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Pe={antialias:i.renderState.layers===void 0?_.antialias:!0,alpha:_.alpha,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:a};v=new XRWebGLLayer(i,n,Pe),i.updateRenderState({baseLayer:v}),S=new al(v.framebufferWidth,v.framebufferHeight,{format:xa,type:rl,encoding:e.outputEncoding,stencilBuffer:_.stencil})}else{let Pe=null,et=null,ne=null;_.depth&&(ne=_.stencil?35056:33190,Pe=_.stencil?Bc:ou,et=_.stencil?Ic:Ql);const qe={colorFormat:32856,depthFormat:ne,scaleFactor:a};d=new XRWebGLBinding(i,n),h=d.createProjectionLayer(qe),i.updateRenderState({layers:[h]}),S=new al(h.textureWidth,h.textureHeight,{format:xa,type:rl,depthTexture:new lF(h.textureWidth,h.textureHeight,et,void 0,void 0,void 0,void 0,void 0,void 0,Pe),stencilBuffer:_.stencil,encoding:e.outputEncoding,samples:_.antialias?4:0});const ge=e.properties.get(S);ge.__ignoreDepthValues=h.ignoreDepthValues}S.isXRRenderTarget=!0,this.setFoveation(l),u=null,s=await i.requestReferenceSpace(o),ve.setContext(i),ve.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function re(ie){for(let Pe=0;Pe<ie.removed.length;Pe++){const et=ie.removed[Pe],ne=C.indexOf(et);ne>=0&&(C[ne]=null,E[ne].disconnect(et))}for(let Pe=0;Pe<ie.added.length;Pe++){const et=ie.added[Pe];let ne=C.indexOf(et);if(ne===-1){for(let ge=0;ge<E.length;ge++)if(ge>=C.length){C.push(et),ne=ge;break}else if(C[ge]===null){C[ge]=et,ne=ge;break}if(ne===-1)break}const qe=E[ne];qe&&qe.connect(et)}}const he=new Ee,ye=new Ee;function $e(ie,Pe,et){he.setFromMatrixPosition(Pe.matrixWorld),ye.setFromMatrixPosition(et.matrixWorld);const ne=he.distanceTo(ye),qe=Pe.projectionMatrix.elements,ge=et.projectionMatrix.elements,xe=qe[14]/(qe[10]-1),ze=qe[14]/(qe[10]+1),Ge=(qe[9]+1)/qe[5],ut=(qe[9]-1)/qe[5],ce=(qe[8]-1)/qe[0],me=(ge[8]+1)/ge[0],ke=xe*ce,Xe=xe*me,Ze=ne/(-ce+me),We=Ze*-ce;Pe.matrixWorld.decompose(ie.position,ie.quaternion,ie.scale),ie.translateX(We),ie.translateZ(Ze),ie.matrixWorld.compose(ie.position,ie.quaternion,ie.scale),ie.matrixWorldInverse.copy(ie.matrixWorld).invert();const gt=xe+Ze,ht=ze+Ze,vt=ke-We,ct=Xe+(ne-We),se=Ge*ze/ht*gt,K=ut*ze/ht*gt;ie.projectionMatrix.makePerspective(vt,ct,se,K,gt,ht)}function _e(ie,Pe){Pe===null?ie.matrixWorld.copy(ie.matrix):ie.matrixWorld.multiplyMatrices(Pe.matrixWorld,ie.matrix),ie.matrixWorldInverse.copy(ie.matrixWorld).invert()}this.updateCamera=function(ie){if(i===null)return;U.near=V.near=O.near=ie.near,U.far=V.far=O.far=ie.far,(Y!==U.near||fe!==U.far)&&(i.updateRenderState({depthNear:U.near,depthFar:U.far}),Y=U.near,fe=U.far);const Pe=ie.parent,et=U.cameras;_e(U,Pe);for(let qe=0;qe<et.length;qe++)_e(et[qe],Pe);U.matrixWorld.decompose(U.position,U.quaternion,U.scale),ie.matrix.copy(U.matrix),ie.matrix.decompose(ie.position,ie.quaternion,ie.scale);const ne=ie.children;for(let qe=0,ge=ne.length;qe<ge;qe++)ne[qe].updateMatrixWorld(!0);et.length===2?$e(U,O,V):U.projectionMatrix.copy(O.projectionMatrix)},this.getCamera=function(){return U},this.getFoveation=function(){if(!(h===null&&v===null))return l},this.setFoveation=function(ie){l=ie,h!==null&&(h.fixedFoveation=ie),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=ie)},this.getPlanes=function(){return A};let de=null;function Oe(ie,Pe){if(c=Pe.getViewerPose(u||s),x=Pe,c!==null){const et=c.views;v!==null&&(e.setRenderTargetFramebuffer(S,v.framebuffer),e.setRenderTarget(S));let ne=!1;et.length!==U.cameras.length&&(U.cameras.length=0,ne=!0);for(let qe=0;qe<et.length;qe++){const ge=et[qe];let xe=null;if(v!==null)xe=v.getViewport(ge);else{const Ge=d.getViewSubImage(h,ge);xe=Ge.viewport,qe===0&&(e.setRenderTargetTextures(S,Ge.colorTexture,h.ignoreDepthValues?void 0:Ge.depthStencilTexture),e.setRenderTarget(S))}let ze=P[qe];ze===void 0&&(ze=new Ni,ze.layers.enable(qe),ze.viewport=new Cr,P[qe]=ze),ze.matrix.fromArray(ge.transform.matrix),ze.projectionMatrix.fromArray(ge.projectionMatrix),ze.viewport.set(xe.x,xe.y,xe.width,xe.height),qe===0&&U.matrix.copy(ze.matrix),ne===!0&&U.cameras.push(ze)}}for(let et=0;et<E.length;et++){const ne=C[et],qe=E[et];ne!==null&&qe!==void 0&&qe.update(ne,Pe,u||s)}if(de&&de(ie,Pe),Pe.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:Pe.detectedPlanes});let et=null;for(const ne of A)Pe.detectedPlanes.has(ne)||(et===null&&(et=[]),et.push(ne));if(et!==null)for(const ne of et)A.delete(ne),D.delete(ne),r.dispatchEvent({type:"planeremoved",data:ne});for(const ne of Pe.detectedPlanes)if(!A.has(ne))A.add(ne),D.set(ne,Pe.lastChangedTime),r.dispatchEvent({type:"planeadded",data:ne});else{const qe=D.get(ne);ne.lastChangedTime>qe&&(D.set(ne,ne.lastChangedTime),r.dispatchEvent({type:"planechanged",data:ne}))}}x=null}const ve=new Y8;ve.setAnimationLoop(Oe),this.setAnimationLoop=function(ie){de=ie},this.dispose=function(){}}}function cF(t,e){function n(_,b){b.color.getRGB(_.fogColor.value,j8(t)),b.isFog?(_.fogNear.value=b.near,_.fogFar.value=b.far):b.isFogExp2&&(_.fogDensity.value=b.density)}function r(_,b,S,E,C){b.isMeshBasicMaterial||b.isMeshLambertMaterial?i(_,b):b.isMeshToonMaterial?(i(_,b),c(_,b)):b.isMeshPhongMaterial?(i(_,b),u(_,b)):b.isMeshStandardMaterial?(i(_,b),d(_,b),b.isMeshPhysicalMaterial&&h(_,b,C)):b.isMeshMatcapMaterial?(i(_,b),v(_,b)):b.isMeshDepthMaterial?i(_,b):b.isMeshDistanceMaterial?(i(_,b),x(_,b)):b.isMeshNormalMaterial?i(_,b):b.isLineBasicMaterial?(a(_,b),b.isLineDashedMaterial&&s(_,b)):b.isPointsMaterial?o(_,b,S,E):b.isSpriteMaterial?l(_,b):b.isShadowMaterial?(_.color.value.copy(b.color),_.opacity.value=b.opacity):b.isShaderMaterial&&(b.uniformsNeedUpdate=!1)}function i(_,b){_.opacity.value=b.opacity,b.color&&_.diffuse.value.copy(b.color),b.emissive&&_.emissive.value.copy(b.emissive).multiplyScalar(b.emissiveIntensity),b.map&&(_.map.value=b.map),b.alphaMap&&(_.alphaMap.value=b.alphaMap),b.bumpMap&&(_.bumpMap.value=b.bumpMap,_.bumpScale.value=b.bumpScale,b.side===ia&&(_.bumpScale.value*=-1)),b.displacementMap&&(_.displacementMap.value=b.displacementMap,_.displacementScale.value=b.displacementScale,_.displacementBias.value=b.displacementBias),b.emissiveMap&&(_.emissiveMap.value=b.emissiveMap),b.normalMap&&(_.normalMap.value=b.normalMap,_.normalScale.value.copy(b.normalScale),b.side===ia&&_.normalScale.value.negate()),b.specularMap&&(_.specularMap.value=b.specularMap),b.alphaTest>0&&(_.alphaTest.value=b.alphaTest);const S=e.get(b).envMap;if(S&&(_.envMap.value=S,_.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=b.reflectivity,_.ior.value=b.ior,_.refractionRatio.value=b.refractionRatio),b.lightMap){_.lightMap.value=b.lightMap;const A=t.useLegacyLights===!0?Math.PI:1;_.lightMapIntensity.value=b.lightMapIntensity*A}b.aoMap&&(_.aoMap.value=b.aoMap,_.aoMapIntensity.value=b.aoMapIntensity);let E;b.map?E=b.map:b.specularMap?E=b.specularMap:b.displacementMap?E=b.displacementMap:b.normalMap?E=b.normalMap:b.bumpMap?E=b.bumpMap:b.roughnessMap?E=b.roughnessMap:b.metalnessMap?E=b.metalnessMap:b.alphaMap?E=b.alphaMap:b.emissiveMap?E=b.emissiveMap:b.clearcoatMap?E=b.clearcoatMap:b.clearcoatNormalMap?E=b.clearcoatNormalMap:b.clearcoatRoughnessMap?E=b.clearcoatRoughnessMap:b.iridescenceMap?E=b.iridescenceMap:b.iridescenceThicknessMap?E=b.iridescenceThicknessMap:b.specularIntensityMap?E=b.specularIntensityMap:b.specularColorMap?E=b.specularColorMap:b.transmissionMap?E=b.transmissionMap:b.thicknessMap?E=b.thicknessMap:b.sheenColorMap?E=b.sheenColorMap:b.sheenRoughnessMap&&(E=b.sheenRoughnessMap),E!==void 0&&(E.isWebGLRenderTarget&&(E=E.texture),E.matrixAutoUpdate===!0&&E.updateMatrix(),_.uvTransform.value.copy(E.matrix));let C;b.aoMap?C=b.aoMap:b.lightMap&&(C=b.lightMap),C!==void 0&&(C.isWebGLRenderTarget&&(C=C.texture),C.matrixAutoUpdate===!0&&C.updateMatrix(),_.uv2Transform.value.copy(C.matrix))}function a(_,b){_.diffuse.value.copy(b.color),_.opacity.value=b.opacity}function s(_,b){_.dashSize.value=b.dashSize,_.totalSize.value=b.dashSize+b.gapSize,_.scale.value=b.scale}function o(_,b,S,E){_.diffuse.value.copy(b.color),_.opacity.value=b.opacity,_.size.value=b.size*S,_.scale.value=E*.5,b.map&&(_.map.value=b.map),b.alphaMap&&(_.alphaMap.value=b.alphaMap),b.alphaTest>0&&(_.alphaTest.value=b.alphaTest);let C;b.map?C=b.map:b.alphaMap&&(C=b.alphaMap),C!==void 0&&(C.matrixAutoUpdate===!0&&C.updateMatrix(),_.uvTransform.value.copy(C.matrix))}function l(_,b){_.diffuse.value.copy(b.color),_.opacity.value=b.opacity,_.rotation.value=b.rotation,b.map&&(_.map.value=b.map),b.alphaMap&&(_.alphaMap.value=b.alphaMap),b.alphaTest>0&&(_.alphaTest.value=b.alphaTest);let S;b.map?S=b.map:b.alphaMap&&(S=b.alphaMap),S!==void 0&&(S.matrixAutoUpdate===!0&&S.updateMatrix(),_.uvTransform.value.copy(S.matrix))}function u(_,b){_.specular.value.copy(b.specular),_.shininess.value=Math.max(b.shininess,1e-4)}function c(_,b){b.gradientMap&&(_.gradientMap.value=b.gradientMap)}function d(_,b){_.roughness.value=b.roughness,_.metalness.value=b.metalness,b.roughnessMap&&(_.roughnessMap.value=b.roughnessMap),b.metalnessMap&&(_.metalnessMap.value=b.metalnessMap),e.get(b).envMap&&(_.envMapIntensity.value=b.envMapIntensity)}function h(_,b,S){_.ior.value=b.ior,b.sheen>0&&(_.sheenColor.value.copy(b.sheenColor).multiplyScalar(b.sheen),_.sheenRoughness.value=b.sheenRoughness,b.sheenColorMap&&(_.sheenColorMap.value=b.sheenColorMap),b.sheenRoughnessMap&&(_.sheenRoughnessMap.value=b.sheenRoughnessMap)),b.clearcoat>0&&(_.clearcoat.value=b.clearcoat,_.clearcoatRoughness.value=b.clearcoatRoughness,b.clearcoatMap&&(_.clearcoatMap.value=b.clearcoatMap),b.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=b.clearcoatRoughnessMap),b.clearcoatNormalMap&&(_.clearcoatNormalScale.value.copy(b.clearcoatNormalScale),_.clearcoatNormalMap.value=b.clearcoatNormalMap,b.side===ia&&_.clearcoatNormalScale.value.negate())),b.iridescence>0&&(_.iridescence.value=b.iridescence,_.iridescenceIOR.value=b.iridescenceIOR,_.iridescenceThicknessMinimum.value=b.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=b.iridescenceThicknessRange[1],b.iridescenceMap&&(_.iridescenceMap.value=b.iridescenceMap),b.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=b.iridescenceThicknessMap)),b.transmission>0&&(_.transmission.value=b.transmission,_.transmissionSamplerMap.value=S.texture,_.transmissionSamplerSize.value.set(S.width,S.height),b.transmissionMap&&(_.transmissionMap.value=b.transmissionMap),_.thickness.value=b.thickness,b.thicknessMap&&(_.thicknessMap.value=b.thicknessMap),_.attenuationDistance.value=b.attenuationDistance,_.attenuationColor.value.copy(b.attenuationColor)),_.specularIntensity.value=b.specularIntensity,_.specularColor.value.copy(b.specularColor),b.specularIntensityMap&&(_.specularIntensityMap.value=b.specularIntensityMap),b.specularColorMap&&(_.specularColorMap.value=b.specularColorMap)}function v(_,b){b.matcap&&(_.matcap.value=b.matcap)}function x(_,b){_.referencePosition.value.copy(b.referencePosition),_.nearDistance.value=b.nearDistance,_.farDistance.value=b.farDistance}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function dF(t,e,n,r){let i={},a={},s=[];const o=n.isWebGL2?t.getParameter(35375):0;function l(E,C){const A=C.program;r.uniformBlockBinding(E,A)}function u(E,C){let A=i[E.id];A===void 0&&(x(E),A=c(E),i[E.id]=A,E.addEventListener("dispose",b));const D=C.program;r.updateUBOMapping(E,D);const O=e.render.frame;a[E.id]!==O&&(h(E),a[E.id]=O)}function c(E){const C=d();E.__bindingPointIndex=C;const A=t.createBuffer(),D=E.__size,O=E.usage;return t.bindBuffer(35345,A),t.bufferData(35345,D,O),t.bindBuffer(35345,null),t.bindBufferBase(35345,C,A),A}function d(){for(let E=0;E<o;E++)if(s.indexOf(E)===-1)return s.push(E),E;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(E){const C=i[E.id],A=E.uniforms,D=E.__cache;t.bindBuffer(35345,C);for(let O=0,V=A.length;O<V;O++){const P=A[O];if(v(P,O,D)===!0){const U=P.__offset,Y=Array.isArray(P.value)?P.value:[P.value];let fe=0;for(let Q=0;Q<Y.length;Q++){const G=Y[Q],re=_(G);typeof G=="number"?(P.__data[0]=G,t.bufferSubData(35345,U+fe,P.__data)):G.isMatrix3?(P.__data[0]=G.elements[0],P.__data[1]=G.elements[1],P.__data[2]=G.elements[2],P.__data[3]=G.elements[0],P.__data[4]=G.elements[3],P.__data[5]=G.elements[4],P.__data[6]=G.elements[5],P.__data[7]=G.elements[0],P.__data[8]=G.elements[6],P.__data[9]=G.elements[7],P.__data[10]=G.elements[8],P.__data[11]=G.elements[0]):(G.toArray(P.__data,fe),fe+=re.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(35345,U,P.__data)}}t.bindBuffer(35345,null)}function v(E,C,A){const D=E.value;if(A[C]===void 0){if(typeof D=="number")A[C]=D;else{const O=Array.isArray(D)?D:[D],V=[];for(let P=0;P<O.length;P++)V.push(O[P].clone());A[C]=V}return!0}else if(typeof D=="number"){if(A[C]!==D)return A[C]=D,!0}else{const O=Array.isArray(A[C])?A[C]:[A[C]],V=Array.isArray(D)?D:[D];for(let P=0;P<O.length;P++){const U=O[P];if(U.equals(V[P])===!1)return U.copy(V[P]),!0}}return!1}function x(E){const C=E.uniforms;let A=0;const D=16;let O=0;for(let V=0,P=C.length;V<P;V++){const U=C[V],Y={boundary:0,storage:0},fe=Array.isArray(U.value)?U.value:[U.value];for(let Q=0,G=fe.length;Q<G;Q++){const re=fe[Q],he=_(re);Y.boundary+=he.boundary,Y.storage+=he.storage}if(U.__data=new Float32Array(Y.storage/Float32Array.BYTES_PER_ELEMENT),U.__offset=A,V>0){O=A%D;const Q=D-O;O!==0&&Q-Y.boundary<0&&(A+=D-O,U.__offset=A)}A+=Y.storage}return O=A%D,O>0&&(A+=D-O),E.__size=A,E.__cache={},this}function _(E){const C={boundary:0,storage:0};return typeof E=="number"?(C.boundary=4,C.storage=4):E.isVector2?(C.boundary=8,C.storage=8):E.isVector3||E.isColor?(C.boundary=16,C.storage=12):E.isVector4?(C.boundary=16,C.storage=16):E.isMatrix3?(C.boundary=48,C.storage=48):E.isMatrix4?(C.boundary=64,C.storage=64):E.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",E),C}function b(E){const C=E.target;C.removeEventListener("dispose",b);const A=s.indexOf(C.__bindingPointIndex);s.splice(A,1),t.deleteBuffer(i[C.id]),delete i[C.id],delete a[C.id]}function S(){for(const E in i)t.deleteBuffer(i[E]);s=[],i={},a={}}return{bind:l,update:u,dispose:S}}function fF(){const t=Y0("canvas");return t.style.display="block",t}function ay(t={}){this.isWebGLRenderer=!0;const e=t.canvas!==void 0?t.canvas:fF(),n=t.context!==void 0?t.context:null,r=t.depth!==void 0?t.depth:!0,i=t.stencil!==void 0?t.stencil:!0,a=t.antialias!==void 0?t.antialias:!1,s=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,o=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,l=t.powerPreference!==void 0?t.powerPreference:"default",u=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1;let c;n!==null?c=n.getContextAttributes().alpha:c=t.alpha!==void 0?t.alpha:!1;let d=null,h=null;const v=[],x=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=il,this.useLegacyLights=!0,this.toneMapping=Ss,this.toneMappingExposure=1;const _=this;let b=!1,S=0,E=0,C=null,A=-1,D=null;const O=new Cr,V=new Cr;let P=null,U=e.width,Y=e.height,fe=1,Q=null,G=null;const re=new Cr(0,0,U,Y),he=new Cr(0,0,U,Y);let ye=!1;const $e=new ry;let _e=!1,de=!1,Oe=null;const ve=new tr,ie=new Ee,Pe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function et(){return C===null?fe:1}let ne=n;function qe(I,X){for(let Ve=0;Ve<I.length;Ve++){const we=I[Ve],je=e.getContext(we,X);if(je!==null)return je}return null}try{const I={alpha:!0,depth:r,stencil:i,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:o,powerPreference:l,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Z1}`),e.addEventListener("webglcontextlost",kt,!1),e.addEventListener("webglcontextrestored",Dt,!1),e.addEventListener("webglcontextcreationerror",At,!1),ne===null){const X=["webgl2","webgl","experimental-webgl"];if(_.isWebGL1Renderer===!0&&X.shift(),ne=qe(X,I),ne===null)throw qe(X)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ne.getShaderPrecisionFormat===void 0&&(ne.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(I){throw console.error("THREE.WebGLRenderer: "+I.message),I}let ge,xe,ze,Ge,ut,ce,me,ke,Xe,Ze,We,gt,ht,vt,ct,se,K,De,Je,tt,nt,xt,be,Ie;function at(){ge=new SN(ne),xe=new vN(ne,ge,t),ge.init(xe),xt=new aF(ne,ge,xe),ze=new rF(ne,ge,xe),Ge=new TN,ut=new HB,ce=new iF(ne,ge,ze,ut,xe,xt,Ge),me=new _N(_),ke=new wN(_),Xe=new LL(ne,xe),be=new mN(ne,ge,Xe,xe),Ze=new MN(ne,Xe,Ge,be),We=new IN(ne,Ze,Xe,Ge),Je=new kN(ne,xe,ce),se=new yN(ut),gt=new VB(_,me,ke,ge,xe,be,se),ht=new cF(_,ut),vt=new GB,ct=new ZB(ge,xe),De=new pN(_,me,ke,ze,We,c,s),K=new nF(_,We,xe),Ie=new dF(ne,Ge,xe,ze),tt=new gN(ne,ge,Ge,xe),nt=new EN(ne,ge,Ge,xe),Ge.programs=gt.programs,_.capabilities=xe,_.extensions=ge,_.properties=ut,_.renderLists=vt,_.shadowMap=K,_.state=ze,_.info=Ge}at();const Le=new uF(_,ne);this.xr=Le,this.getContext=function(){return ne},this.getContextAttributes=function(){return ne.getContextAttributes()},this.forceContextLoss=function(){const I=ge.get("WEBGL_lose_context");I&&I.loseContext()},this.forceContextRestore=function(){const I=ge.get("WEBGL_lose_context");I&&I.restoreContext()},this.getPixelRatio=function(){return fe},this.setPixelRatio=function(I){I!==void 0&&(fe=I,this.setSize(U,Y,!1))},this.getSize=function(I){return I.set(U,Y)},this.setSize=function(I,X,Ve=!0){if(Le.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}U=I,Y=X,e.width=Math.floor(I*fe),e.height=Math.floor(X*fe),Ve===!0&&(e.style.width=I+"px",e.style.height=X+"px"),this.setViewport(0,0,I,X)},this.getDrawingBufferSize=function(I){return I.set(U*fe,Y*fe).floor()},this.setDrawingBufferSize=function(I,X,Ve){U=I,Y=X,fe=Ve,e.width=Math.floor(I*Ve),e.height=Math.floor(X*Ve),this.setViewport(0,0,I,X)},this.getCurrentViewport=function(I){return I.copy(O)},this.getViewport=function(I){return I.copy(re)},this.setViewport=function(I,X,Ve,we){I.isVector4?re.set(I.x,I.y,I.z,I.w):re.set(I,X,Ve,we),ze.viewport(O.copy(re).multiplyScalar(fe).floor())},this.getScissor=function(I){return I.copy(he)},this.setScissor=function(I,X,Ve,we){I.isVector4?he.set(I.x,I.y,I.z,I.w):he.set(I,X,Ve,we),ze.scissor(V.copy(he).multiplyScalar(fe).floor())},this.getScissorTest=function(){return ye},this.setScissorTest=function(I){ze.setScissorTest(ye=I)},this.setOpaqueSort=function(I){Q=I},this.setTransparentSort=function(I){G=I},this.getClearColor=function(I){return I.copy(De.getClearColor())},this.setClearColor=function(){De.setClearColor.apply(De,arguments)},this.getClearAlpha=function(){return De.getClearAlpha()},this.setClearAlpha=function(){De.setClearAlpha.apply(De,arguments)},this.clear=function(I=!0,X=!0,Ve=!0){let we=0;I&&(we|=16384),X&&(we|=256),Ve&&(we|=1024),ne.clear(we)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",kt,!1),e.removeEventListener("webglcontextrestored",Dt,!1),e.removeEventListener("webglcontextcreationerror",At,!1),vt.dispose(),ct.dispose(),ut.dispose(),me.dispose(),ke.dispose(),We.dispose(),be.dispose(),Ie.dispose(),gt.dispose(),Le.dispose(),Le.removeEventListener("sessionstart",pt),Le.removeEventListener("sessionend",Tt),Oe&&(Oe.dispose(),Oe=null),Rt.stop()};function kt(I){I.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function Dt(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const I=Ge.autoReset,X=K.enabled,Ve=K.autoUpdate,we=K.needsUpdate,je=K.type;at(),Ge.autoReset=I,K.enabled=X,K.autoUpdate=Ve,K.needsUpdate=we,K.type=je}function At(I){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",I.statusMessage)}function Kt(I){const X=I.target;X.removeEventListener("dispose",Kt),on(X)}function on(I){Mn(I),ut.remove(I)}function Mn(I){const X=ut.get(I).programs;X!==void 0&&(X.forEach(function(Ve){gt.releaseProgram(Ve)}),I.isShaderMaterial&&gt.releaseShaderCache(I))}this.renderBufferDirect=function(I,X,Ve,we,je,Vt){X===null&&(X=Pe);const yt=je.isMesh&&je.matrixWorld.determinant()<0,Ot=R(I,X,Ve,we,je);ze.setMaterial(we,yt);let Gt=Ve.index,_n=1;we.wireframe===!0&&(Gt=Ze.getWireframeAttribute(Ve),_n=2);const pe=Ve.drawRange,tn=Ve.attributes.position;let Se=pe.start*_n,wr=(pe.start+pe.count)*_n;Vt!==null&&(Se=Math.max(Se,Vt.start*_n),wr=Math.min(wr,(Vt.start+Vt.count)*_n)),Gt!==null?(Se=Math.max(Se,0),wr=Math.min(wr,Gt.count)):tn!=null&&(Se=Math.max(Se,0),wr=Math.min(wr,tn.count));const Fr=wr-Se;if(Fr<0||Fr===1/0)return;be.setup(je,we,Ot,Ve,Gt);let gr,Xt=tt;if(Gt!==null&&(gr=Xe.get(Gt),Xt=nt,Xt.setIndex(gr)),je.isMesh)we.wireframe===!0?(ze.setLineWidth(we.wireframeLinewidth*et()),Xt.setMode(1)):Xt.setMode(4);else if(je.isLine){let xn=we.linewidth;xn===void 0&&(xn=1),ze.setLineWidth(xn*et()),je.isLineSegments?Xt.setMode(1):je.isLineLoop?Xt.setMode(2):Xt.setMode(3)}else je.isPoints?Xt.setMode(0):je.isSprite&&Xt.setMode(4);if(je.isInstancedMesh)Xt.renderInstances(Se,Fr,je.count);else if(Ve.isInstancedBufferGeometry){const xn=Ve._maxInstanceCount!==void 0?Ve._maxInstanceCount:1/0,Ir=Math.min(Ve.instanceCount,xn);Xt.renderInstances(Se,Fr,Ir)}else Xt.render(Se,Fr)},this.compile=function(I,X){function Ve(we,je,Vt){we.transparent===!0&&we.side===Yo&&we.forceSinglePass===!1?(we.side=ia,we.needsUpdate=!0,ln(we,je,Vt),we.side=nl,we.needsUpdate=!0,ln(we,je,Vt),we.side=Yo):ln(we,je,Vt)}h=ct.get(I),h.init(),x.push(h),I.traverseVisible(function(we){we.isLight&&we.layers.test(X.layers)&&(h.pushLight(we),we.castShadow&&h.pushShadow(we))}),h.setupLights(_.useLegacyLights),I.traverse(function(we){const je=we.material;if(je)if(Array.isArray(je))for(let Vt=0;Vt<je.length;Vt++){const yt=je[Vt];Ve(yt,I,we)}else Ve(je,I,we)}),x.pop(),h=null};let Re=null;function it(I){Re&&Re(I)}function pt(){Rt.stop()}function Tt(){Rt.start()}const Rt=new Y8;Rt.setAnimationLoop(it),typeof self<"u"&&Rt.setContext(self),this.setAnimationLoop=function(I){Re=I,Le.setAnimationLoop(I),I===null?Rt.stop():Rt.start()},Le.addEventListener("sessionstart",pt),Le.addEventListener("sessionend",Tt),this.render=function(I,X){if(X!==void 0&&X.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(b===!0)return;I.matrixWorldAutoUpdate===!0&&I.updateMatrixWorld(),X.parent===null&&X.matrixWorldAutoUpdate===!0&&X.updateMatrixWorld(),Le.enabled===!0&&Le.isPresenting===!0&&(Le.cameraAutoUpdate===!0&&Le.updateCamera(X),X=Le.getCamera()),I.isScene===!0&&I.onBeforeRender(_,I,X,C),h=ct.get(I,x.length),h.init(),x.push(h),ve.multiplyMatrices(X.projectionMatrix,X.matrixWorldInverse),$e.setFromProjectionMatrix(ve),de=this.localClippingEnabled,_e=se.init(this.clippingPlanes,de),d=vt.get(I,v.length),d.init(),v.push(d),$n(I,X,0,_.sortObjects),d.finish(),_.sortObjects===!0&&d.sort(Q,G),_e===!0&&se.beginShadows();const Ve=h.state.shadowsArray;if(K.render(Ve,I,X),_e===!0&&se.endShadows(),this.info.autoReset===!0&&this.info.reset(),De.render(d,I),h.setupLights(_.useLegacyLights),X.isArrayCamera){const we=X.cameras;for(let je=0,Vt=we.length;je<Vt;je++){const yt=we[je];nr(d,I,yt,yt.viewport)}}else nr(d,I,X);C!==null&&(ce.updateMultisampleRenderTarget(C),ce.updateRenderTargetMipmap(C)),I.isScene===!0&&I.onAfterRender(_,I,X),be.resetDefaultState(),A=-1,D=null,x.pop(),x.length>0?h=x[x.length-1]:h=null,v.pop(),v.length>0?d=v[v.length-1]:d=null};function $n(I,X,Ve,we){if(I.visible===!1)return;if(I.layers.test(X.layers)){if(I.isGroup)Ve=I.renderOrder;else if(I.isLOD)I.autoUpdate===!0&&I.update(X);else if(I.isLight)h.pushLight(I),I.castShadow&&h.pushShadow(I);else if(I.isSprite){if(!I.frustumCulled||$e.intersectsSprite(I)){we&&ie.setFromMatrixPosition(I.matrixWorld).applyMatrix4(ve);const yt=We.update(I),Ot=I.material;Ot.visible&&d.push(I,yt,Ot,Ve,ie.z,null)}}else if((I.isMesh||I.isLine||I.isPoints)&&(I.isSkinnedMesh&&I.skeleton.frame!==Ge.render.frame&&(I.skeleton.update(),I.skeleton.frame=Ge.render.frame),!I.frustumCulled||$e.intersectsObject(I))){we&&ie.setFromMatrixPosition(I.matrixWorld).applyMatrix4(ve);const yt=We.update(I),Ot=I.material;if(Array.isArray(Ot)){const Gt=yt.groups;for(let _n=0,pe=Gt.length;_n<pe;_n++){const tn=Gt[_n],Se=Ot[tn.materialIndex];Se&&Se.visible&&d.push(I,yt,Se,Ve,ie.z,tn)}}else Ot.visible&&d.push(I,yt,Ot,Ve,ie.z,null)}}const Vt=I.children;for(let yt=0,Ot=Vt.length;yt<Ot;yt++)$n(Vt[yt],X,Ve,we)}function nr(I,X,Ve,we){const je=I.opaque,Vt=I.transmissive,yt=I.transparent;h.setupLightsView(Ve),_e===!0&&se.setGlobalState(_.clippingPlanes,Ve),Vt.length>0&&mr(je,X,Ve),we&&ze.viewport(O.copy(we)),je.length>0&&bn(je,X,Ve),Vt.length>0&&bn(Vt,X,Ve),yt.length>0&&bn(yt,X,Ve),ze.buffers.depth.setTest(!0),ze.buffers.depth.setMask(!0),ze.buffers.color.setMask(!0),ze.setPolygonOffset(!1)}function mr(I,X,Ve){const we=xe.isWebGL2;Oe===null&&(Oe=new al(1024,1024,{generateMipmaps:!0,type:ge.has("EXT_color_buffer_half_float")?Nc:rl,minFilter:If,samples:we&&a===!0?4:0}));const je=_.getRenderTarget();_.setRenderTarget(Oe),_.clear();const Vt=_.toneMapping;_.toneMapping=Ss,bn(I,X,Ve),_.toneMapping=Vt,ce.updateMultisampleRenderTarget(Oe),ce.updateRenderTargetMipmap(Oe),_.setRenderTarget(je)}function bn(I,X,Ve){const we=X.isScene===!0?X.overrideMaterial:null;for(let je=0,Vt=I.length;je<Vt;je++){const yt=I[je],Ot=yt.object,Gt=yt.geometry,_n=we===null?yt.material:we,pe=yt.group;Ot.layers.test(Ve.layers)&&Yt(Ot,X,Ve,Gt,_n,pe)}}function Yt(I,X,Ve,we,je,Vt){I.onBeforeRender(_,X,Ve,we,je,Vt),I.modelViewMatrix.multiplyMatrices(Ve.matrixWorldInverse,I.matrixWorld),I.normalMatrix.getNormalMatrix(I.modelViewMatrix),je.onBeforeRender(_,X,Ve,we,I,Vt),je.transparent===!0&&je.side===Yo&&je.forceSinglePass===!1?(je.side=ia,je.needsUpdate=!0,_.renderBufferDirect(Ve,X,we,je,I,Vt),je.side=nl,je.needsUpdate=!0,_.renderBufferDirect(Ve,X,we,je,I,Vt),je.side=Yo):_.renderBufferDirect(Ve,X,we,je,I,Vt),I.onAfterRender(_,X,Ve,we,je,Vt)}function ln(I,X,Ve){X.isScene!==!0&&(X=Pe);const we=ut.get(I),je=h.state.lights,Vt=h.state.shadowsArray,yt=je.state.version,Ot=gt.getParameters(I,je.state,Vt,X,Ve),Gt=gt.getProgramCacheKey(Ot);let _n=we.programs;we.environment=I.isMeshStandardMaterial?X.environment:null,we.fog=X.fog,we.envMap=(I.isMeshStandardMaterial?ke:me).get(I.envMap||we.environment),_n===void 0&&(I.addEventListener("dispose",Kt),_n=new Map,we.programs=_n);let pe=_n.get(Gt);if(pe!==void 0){if(we.currentProgram===pe&&we.lightsStateVersion===yt)return sn(I,Ot),pe}else Ot.uniforms=gt.getUniforms(I),I.onBuild(Ve,Ot,_),I.onBeforeCompile(Ot,_),pe=gt.acquireProgram(Ot,Gt),_n.set(Gt,pe),we.uniforms=Ot.uniforms;const tn=we.uniforms;(!I.isShaderMaterial&&!I.isRawShaderMaterial||I.clipping===!0)&&(tn.clippingPlanes=se.uniform),sn(I,Ot),we.needsLights=ft(I),we.lightsStateVersion=yt,we.needsLights&&(tn.ambientLightColor.value=je.state.ambient,tn.lightProbe.value=je.state.probe,tn.directionalLights.value=je.state.directional,tn.directionalLightShadows.value=je.state.directionalShadow,tn.spotLights.value=je.state.spot,tn.spotLightShadows.value=je.state.spotShadow,tn.rectAreaLights.value=je.state.rectArea,tn.ltc_1.value=je.state.rectAreaLTC1,tn.ltc_2.value=je.state.rectAreaLTC2,tn.pointLights.value=je.state.point,tn.pointLightShadows.value=je.state.pointShadow,tn.hemisphereLights.value=je.state.hemi,tn.directionalShadowMap.value=je.state.directionalShadowMap,tn.directionalShadowMatrix.value=je.state.directionalShadowMatrix,tn.spotShadowMap.value=je.state.spotShadowMap,tn.spotLightMatrix.value=je.state.spotLightMatrix,tn.spotLightMap.value=je.state.spotLightMap,tn.pointShadowMap.value=je.state.pointShadowMap,tn.pointShadowMatrix.value=je.state.pointShadowMatrix);const Se=pe.getUniforms(),wr=E0.seqWithValue(Se.seq,tn);return we.currentProgram=pe,we.uniformsList=wr,pe}function sn(I,X){const Ve=ut.get(I);Ve.outputEncoding=X.outputEncoding,Ve.instancing=X.instancing,Ve.skinning=X.skinning,Ve.morphTargets=X.morphTargets,Ve.morphNormals=X.morphNormals,Ve.morphColors=X.morphColors,Ve.morphTargetsCount=X.morphTargetsCount,Ve.numClippingPlanes=X.numClippingPlanes,Ve.numIntersection=X.numClipIntersection,Ve.vertexAlphas=X.vertexAlphas,Ve.vertexTangents=X.vertexTangents,Ve.toneMapping=X.toneMapping}function R(I,X,Ve,we,je){X.isScene!==!0&&(X=Pe),ce.resetTextureUnits();const Vt=X.fog,yt=we.isMeshStandardMaterial?X.environment:null,Ot=C===null?_.outputEncoding:C.isXRRenderTarget===!0?C.texture.encoding:il,Gt=(we.isMeshStandardMaterial?ke:me).get(we.envMap||yt),_n=we.vertexColors===!0&&!!Ve.attributes.color&&Ve.attributes.color.itemSize===4,pe=!!we.normalMap&&!!Ve.attributes.tangent,tn=!!Ve.morphAttributes.position,Se=!!Ve.morphAttributes.normal,wr=!!Ve.morphAttributes.color,Fr=we.toneMapped?_.toneMapping:Ss,gr=Ve.morphAttributes.position||Ve.morphAttributes.normal||Ve.morphAttributes.color,Xt=gr!==void 0?gr.length:0,xn=ut.get(we),Ir=h.state.lights;if(_e===!0&&(de===!0||I!==D)){const zt=I===D&&we.id===A;se.setState(we,I,zt)}let jn=!1;we.version===xn.__version?(xn.needsLights&&xn.lightsStateVersion!==Ir.state.version||xn.outputEncoding!==Ot||je.isInstancedMesh&&xn.instancing===!1||!je.isInstancedMesh&&xn.instancing===!0||je.isSkinnedMesh&&xn.skinning===!1||!je.isSkinnedMesh&&xn.skinning===!0||xn.envMap!==Gt||we.fog===!0&&xn.fog!==Vt||xn.numClippingPlanes!==void 0&&(xn.numClippingPlanes!==se.numPlanes||xn.numIntersection!==se.numIntersection)||xn.vertexAlphas!==_n||xn.vertexTangents!==pe||xn.morphTargets!==tn||xn.morphNormals!==Se||xn.morphColors!==wr||xn.toneMapping!==Fr||xe.isWebGL2===!0&&xn.morphTargetsCount!==Xt)&&(jn=!0):(jn=!0,xn.__version=we.version);let Er=xn.currentProgram;jn===!0&&(Er=ln(we,X,je));let ur=!1,Ur=!1,Nt=!1;const hn=Er.getUniforms(),wn=xn.uniforms;if(ze.useProgram(Er.program)&&(ur=!0,Ur=!0,Nt=!0),we.id!==A&&(A=we.id,Ur=!0),ur||D!==I){if(hn.setValue(ne,"projectionMatrix",I.projectionMatrix),xe.logarithmicDepthBuffer&&hn.setValue(ne,"logDepthBufFC",2/(Math.log(I.far+1)/Math.LN2)),D!==I&&(D=I,Ur=!0,Nt=!0),we.isShaderMaterial||we.isMeshPhongMaterial||we.isMeshToonMaterial||we.isMeshStandardMaterial||we.envMap){const zt=hn.map.cameraPosition;zt!==void 0&&zt.setValue(ne,ie.setFromMatrixPosition(I.matrixWorld))}(we.isMeshPhongMaterial||we.isMeshToonMaterial||we.isMeshLambertMaterial||we.isMeshBasicMaterial||we.isMeshStandardMaterial||we.isShaderMaterial)&&hn.setValue(ne,"isOrthographic",I.isOrthographicCamera===!0),(we.isMeshPhongMaterial||we.isMeshToonMaterial||we.isMeshLambertMaterial||we.isMeshBasicMaterial||we.isMeshStandardMaterial||we.isShaderMaterial||we.isShadowMaterial||je.isSkinnedMesh)&&hn.setValue(ne,"viewMatrix",I.matrixWorldInverse)}if(je.isSkinnedMesh){hn.setOptional(ne,je,"bindMatrix"),hn.setOptional(ne,je,"bindMatrixInverse");const zt=je.skeleton;zt&&(xe.floatVertexTextures?(zt.boneTexture===null&&zt.computeBoneTexture(),hn.setValue(ne,"boneTexture",zt.boneTexture,ce),hn.setValue(ne,"boneTextureSize",zt.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const ii=Ve.morphAttributes;if((ii.position!==void 0||ii.normal!==void 0||ii.color!==void 0&&xe.isWebGL2===!0)&&Je.update(je,Ve,Er),(Ur||xn.receiveShadow!==je.receiveShadow)&&(xn.receiveShadow=je.receiveShadow,hn.setValue(ne,"receiveShadow",je.receiveShadow)),we.isMeshGouraudMaterial&&we.envMap!==null&&(wn.envMap.value=Gt,wn.flipEnvMap.value=Gt.isCubeTexture&&Gt.isRenderTargetTexture===!1?-1:1),Ur&&(hn.setValue(ne,"toneMappingExposure",_.toneMappingExposure),xn.needsLights&&B(wn,Nt),Vt&&we.fog===!0&&ht.refreshFogUniforms(wn,Vt),ht.refreshMaterialUniforms(wn,we,fe,Y,Oe),E0.upload(ne,xn.uniformsList,wn,ce)),we.isShaderMaterial&&we.uniformsNeedUpdate===!0&&(E0.upload(ne,xn.uniformsList,wn,ce),we.uniformsNeedUpdate=!1),we.isSpriteMaterial&&hn.setValue(ne,"center",je.center),hn.setValue(ne,"modelViewMatrix",je.modelViewMatrix),hn.setValue(ne,"normalMatrix",je.normalMatrix),hn.setValue(ne,"modelMatrix",je.matrixWorld),we.isShaderMaterial||we.isRawShaderMaterial){const zt=we.uniformsGroups;for(let Ma=0,Ya=zt.length;Ma<Ya;Ma++)if(xe.isWebGL2){const ua=zt[Ma];Ie.update(ua,Er),Ie.bind(ua,Er)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Er}function B(I,X){I.ambientLightColor.needsUpdate=X,I.lightProbe.needsUpdate=X,I.directionalLights.needsUpdate=X,I.directionalLightShadows.needsUpdate=X,I.pointLights.needsUpdate=X,I.pointLightShadows.needsUpdate=X,I.spotLights.needsUpdate=X,I.spotLightShadows.needsUpdate=X,I.rectAreaLights.needsUpdate=X,I.hemisphereLights.needsUpdate=X}function ft(I){return I.isMeshLambertMaterial||I.isMeshToonMaterial||I.isMeshPhongMaterial||I.isMeshStandardMaterial||I.isShadowMaterial||I.isShaderMaterial&&I.lights===!0}this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return C},this.setRenderTargetTextures=function(I,X,Ve){ut.get(I.texture).__webglTexture=X,ut.get(I.depthTexture).__webglTexture=Ve;const we=ut.get(I);we.__hasExternalTextures=!0,we.__hasExternalTextures&&(we.__autoAllocateDepthBuffer=Ve===void 0,we.__autoAllocateDepthBuffer||ge.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),we.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(I,X){const Ve=ut.get(I);Ve.__webglFramebuffer=X,Ve.__useDefaultFramebuffer=X===void 0},this.setRenderTarget=function(I,X=0,Ve=0){C=I,S=X,E=Ve;let we=!0,je=null,Vt=!1,yt=!1;if(I){const Gt=ut.get(I);Gt.__useDefaultFramebuffer!==void 0?(ze.bindFramebuffer(36160,null),we=!1):Gt.__webglFramebuffer===void 0?ce.setupRenderTarget(I):Gt.__hasExternalTextures&&ce.rebindTextures(I,ut.get(I.texture).__webglTexture,ut.get(I.depthTexture).__webglTexture);const _n=I.texture;(_n.isData3DTexture||_n.isDataArrayTexture||_n.isCompressedArrayTexture)&&(yt=!0);const pe=ut.get(I).__webglFramebuffer;I.isWebGLCubeRenderTarget?(je=pe[X],Vt=!0):xe.isWebGL2&&I.samples>0&&ce.useMultisampledRTT(I)===!1?je=ut.get(I).__webglMultisampledFramebuffer:je=pe,O.copy(I.viewport),V.copy(I.scissor),P=I.scissorTest}else O.copy(re).multiplyScalar(fe).floor(),V.copy(he).multiplyScalar(fe).floor(),P=ye;if(ze.bindFramebuffer(36160,je)&&xe.drawBuffers&&we&&ze.drawBuffers(I,je),ze.viewport(O),ze.scissor(V),ze.setScissorTest(P),Vt){const Gt=ut.get(I.texture);ne.framebufferTexture2D(36160,36064,34069+X,Gt.__webglTexture,Ve)}else if(yt){const Gt=ut.get(I.texture),_n=X||0;ne.framebufferTextureLayer(36160,36064,Gt.__webglTexture,Ve||0,_n)}A=-1},this.readRenderTargetPixels=function(I,X,Ve,we,je,Vt,yt){if(!(I&&I.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ot=ut.get(I).__webglFramebuffer;if(I.isWebGLCubeRenderTarget&&yt!==void 0&&(Ot=Ot[yt]),Ot){ze.bindFramebuffer(36160,Ot);try{const Gt=I.texture,_n=Gt.format,pe=Gt.type;if(_n!==xa&&xt.convert(_n)!==ne.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const tn=pe===Nc&&(ge.has("EXT_color_buffer_half_float")||xe.isWebGL2&&ge.has("EXT_color_buffer_float"));if(pe!==rl&&xt.convert(pe)!==ne.getParameter(35738)&&!(pe===eu&&(xe.isWebGL2||ge.has("OES_texture_float")||ge.has("WEBGL_color_buffer_float")))&&!tn){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}X>=0&&X<=I.width-we&&Ve>=0&&Ve<=I.height-je&&ne.readPixels(X,Ve,we,je,xt.convert(_n),xt.convert(pe),Vt)}finally{const Gt=C!==null?ut.get(C).__webglFramebuffer:null;ze.bindFramebuffer(36160,Gt)}}},this.copyFramebufferToTexture=function(I,X,Ve=0){const we=Math.pow(2,-Ve),je=Math.floor(X.image.width*we),Vt=Math.floor(X.image.height*we);ce.setTexture2D(X,0),ne.copyTexSubImage2D(3553,Ve,0,0,I.x,I.y,je,Vt),ze.unbindTexture()},this.copyTextureToTexture=function(I,X,Ve,we=0){const je=X.image.width,Vt=X.image.height,yt=xt.convert(Ve.format),Ot=xt.convert(Ve.type);ce.setTexture2D(Ve,0),ne.pixelStorei(37440,Ve.flipY),ne.pixelStorei(37441,Ve.premultiplyAlpha),ne.pixelStorei(3317,Ve.unpackAlignment),X.isDataTexture?ne.texSubImage2D(3553,we,I.x,I.y,je,Vt,yt,Ot,X.image.data):X.isCompressedTexture?ne.compressedTexSubImage2D(3553,we,I.x,I.y,X.mipmaps[0].width,X.mipmaps[0].height,yt,X.mipmaps[0].data):ne.texSubImage2D(3553,we,I.x,I.y,yt,Ot,X.image),we===0&&Ve.generateMipmaps&&ne.generateMipmap(3553),ze.unbindTexture()},this.copyTextureToTexture3D=function(I,X,Ve,we,je=0){if(_.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Vt=I.max.x-I.min.x+1,yt=I.max.y-I.min.y+1,Ot=I.max.z-I.min.z+1,Gt=xt.convert(we.format),_n=xt.convert(we.type);let pe;if(we.isData3DTexture)ce.setTexture3D(we,0),pe=32879;else if(we.isDataArrayTexture)ce.setTexture2DArray(we,0),pe=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ne.pixelStorei(37440,we.flipY),ne.pixelStorei(37441,we.premultiplyAlpha),ne.pixelStorei(3317,we.unpackAlignment);const tn=ne.getParameter(3314),Se=ne.getParameter(32878),wr=ne.getParameter(3316),Fr=ne.getParameter(3315),gr=ne.getParameter(32877),Xt=Ve.isCompressedTexture?Ve.mipmaps[0]:Ve.image;ne.pixelStorei(3314,Xt.width),ne.pixelStorei(32878,Xt.height),ne.pixelStorei(3316,I.min.x),ne.pixelStorei(3315,I.min.y),ne.pixelStorei(32877,I.min.z),Ve.isDataTexture||Ve.isData3DTexture?ne.texSubImage3D(pe,je,X.x,X.y,X.z,Vt,yt,Ot,Gt,_n,Xt.data):Ve.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ne.compressedTexSubImage3D(pe,je,X.x,X.y,X.z,Vt,yt,Ot,Gt,Xt.data)):ne.texSubImage3D(pe,je,X.x,X.y,X.z,Vt,yt,Ot,Gt,_n,Xt),ne.pixelStorei(3314,tn),ne.pixelStorei(32878,Se),ne.pixelStorei(3316,wr),ne.pixelStorei(3315,Fr),ne.pixelStorei(32877,gr),je===0&&we.generateMipmaps&&ne.generateMipmap(pe),ze.unbindTexture()},this.initTexture=function(I){I.isCubeTexture?ce.setTextureCube(I,0):I.isData3DTexture?ce.setTexture3D(I,0):I.isDataArrayTexture||I.isCompressedArrayTexture?ce.setTexture2DArray(I,0):ce.setTexture2D(I,0),ze.unbindTexture()},this.resetState=function(){S=0,E=0,C=null,ze.reset(),be.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(ay.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(t){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!t}}});class hF extends ay{}hF.prototype.isWebGL1Renderer=!0;class sy{constructor(e,n=1,r=1e3){this.isFog=!0,this.name="",this.color=new Sn(e),this.near=n,this.far=r}clone(){return new sy(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class pF extends Ar{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class mF extends Fi{constructor(e=null,n=1,r=1,i,a,s,o,l,u=ti,c=ti,d,h){super(null,s,o,l,u,c,i,a,d,h),this.isDataTexture=!0,this.image={data:e,width:n,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class s3 extends Ui{constructor(e,n,r,i=1){super(e,n,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const o3=new tr,l3=new tr,e0=[],gF=new tr,Rd=new $i;class u3 extends $i{constructor(e,n,r){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new s3(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1;for(let i=0;i<r;i++)this.setMatrixAt(i,gF)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}raycast(e,n){const r=this.matrixWorld,i=this.count;if(Rd.geometry=this.geometry,Rd.material=this.material,Rd.material!==void 0)for(let a=0;a<i;a++){this.getMatrixAt(a,o3),l3.multiplyMatrices(r,o3),Rd.matrixWorld=l3,Rd.raycast(e,e0);for(let s=0,o=e0.length;s<o;s++){const l=e0[s];l.instanceId=a,l.object=this,n.push(l)}e0.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new s3(new Float32Array(this.instanceMatrix.count*3),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class n7 extends bu{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Sn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const c3=new Ee,d3=new Ee,f3=new tr,eg=new ey,t0=new kp;class vF extends Ar{constructor(e=new la,n=new n7){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[0];for(let i=1,a=n.count;i<a;i++)c3.fromBufferAttribute(n,i-1),d3.fromBufferAttribute(n,i),r[i]=r[i-1],r[i]+=c3.distanceTo(d3);e.setAttribute("lineDistance",new Xr(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const r=this.geometry,i=this.matrixWorld,a=e.params.Line.threshold,s=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),t0.copy(r.boundingSphere),t0.applyMatrix4(i),t0.radius+=a,e.ray.intersectsSphere(t0)===!1)return;f3.copy(i).invert(),eg.copy(e.ray).applyMatrix4(f3);const o=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,u=new Ee,c=new Ee,d=new Ee,h=new Ee,v=this.isLineSegments?2:1,x=r.index,b=r.attributes.position;if(x!==null){const S=Math.max(0,s.start),E=Math.min(x.count,s.start+s.count);for(let C=S,A=E-1;C<A;C+=v){const D=x.getX(C),O=x.getX(C+1);if(u.fromBufferAttribute(b,D),c.fromBufferAttribute(b,O),eg.distanceSqToSegment(u,c,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const P=e.ray.origin.distanceTo(h);P<e.near||P>e.far||n.push({distance:P,point:d.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}else{const S=Math.max(0,s.start),E=Math.min(b.count,s.start+s.count);for(let C=S,A=E-1;C<A;C+=v){if(u.fromBufferAttribute(b,C),c.fromBufferAttribute(b,C+1),eg.distanceSqToSegment(u,c,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const O=e.ray.origin.distanceTo(h);O<e.near||O>e.far||n.push({distance:O,point:d.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,s=i.length;a<s;a++){const o=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}}class $s{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const r=this.getUtoTmapping(e);return this.getPoint(r,n)}getPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPoint(r/e));return n}getSpacedPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPointAt(r/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let r,i=this.getPoint(0),a=0;n.push(0);for(let s=1;s<=e;s++)r=this.getPoint(s/e),a+=r.distanceTo(i),n.push(a),i=r;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const r=this.getLengths();let i=0;const a=r.length;let s;n?s=n:s=e*r[a-1];let o=0,l=a-1,u;for(;o<=l;)if(i=Math.floor(o+(l-o)/2),u=r[i]-s,u<0)o=i+1;else if(u>0)l=i-1;else{l=i;break}if(i=l,r[i]===s)return i/(a-1);const c=r[i],h=r[i+1]-c,v=(s-c)/h;return(i+v)/(a-1)}getTangent(e,n){let i=e-1e-4,a=e+1e-4;i<0&&(i=0),a>1&&(a=1);const s=this.getPoint(i),o=this.getPoint(a),l=n||(s.isVector2?new Lt:new Ee);return l.copy(o).sub(s).normalize(),l}getTangentAt(e,n){const r=this.getUtoTmapping(e);return this.getTangent(r,n)}computeFrenetFrames(e,n){const r=new Ee,i=[],a=[],s=[],o=new Ee,l=new tr;for(let v=0;v<=e;v++){const x=v/e;i[v]=this.getTangentAt(x,new Ee)}a[0]=new Ee,s[0]=new Ee;let u=Number.MAX_VALUE;const c=Math.abs(i[0].x),d=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=u&&(u=c,r.set(1,0,0)),d<=u&&(u=d,r.set(0,1,0)),h<=u&&r.set(0,0,1),o.crossVectors(i[0],r).normalize(),a[0].crossVectors(i[0],o),s[0].crossVectors(i[0],a[0]);for(let v=1;v<=e;v++){if(a[v]=a[v-1].clone(),s[v]=s[v-1].clone(),o.crossVectors(i[v-1],i[v]),o.length()>Number.EPSILON){o.normalize();const x=Math.acos(Gr(i[v-1].dot(i[v]),-1,1));a[v].applyMatrix4(l.makeRotationAxis(o,x))}s[v].crossVectors(i[v],a[v])}if(n===!0){let v=Math.acos(Gr(a[0].dot(a[e]),-1,1));v/=e,i[0].dot(o.crossVectors(a[0],a[e]))>0&&(v=-v);for(let x=1;x<=e;x++)a[x].applyMatrix4(l.makeRotationAxis(i[x],v*x)),s[x].crossVectors(i[x],a[x])}return{tangents:i,normals:a,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class oy extends $s{constructor(e=0,n=0,r=1,i=1,a=0,s=Math.PI*2,o=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=r,this.yRadius=i,this.aStartAngle=a,this.aEndAngle=s,this.aClockwise=o,this.aRotation=l}getPoint(e,n){const r=n||new Lt,i=Math.PI*2;let a=this.aEndAngle-this.aStartAngle;const s=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=i;for(;a>i;)a-=i;a<Number.EPSILON&&(s?a=0:a=i),this.aClockwise===!0&&!s&&(a===i?a=-i:a=a-i);const o=this.aStartAngle+e*a;let l=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const c=Math.cos(this.aRotation),d=Math.sin(this.aRotation),h=l-this.aX,v=u-this.aY;l=h*c-v*d+this.aX,u=h*d+v*c+this.aY}return r.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class yF extends oy{constructor(e,n,r,i,a,s){super(e,n,r,r,i,a,s),this.isArcCurve=!0,this.type="ArcCurve"}}function ly(){let t=0,e=0,n=0,r=0;function i(a,s,o,l){t=a,e=o,n=-3*a+3*s-2*o-l,r=2*a-2*s+o+l}return{initCatmullRom:function(a,s,o,l,u){i(s,o,u*(o-a),u*(l-s))},initNonuniformCatmullRom:function(a,s,o,l,u,c,d){let h=(s-a)/u-(o-a)/(u+c)+(o-s)/c,v=(o-s)/c-(l-s)/(c+d)+(l-o)/d;h*=c,v*=c,i(s,o,h,v)},calc:function(a){const s=a*a,o=s*a;return t+e*a+n*s+r*o}}}const n0=new Ee,tg=new ly,ng=new ly,rg=new ly;class _F extends $s{constructor(e=[],n=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=r,this.tension=i}getPoint(e,n=new Ee){const r=n,i=this.points,a=i.length,s=(a-(this.closed?0:1))*e;let o=Math.floor(s),l=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/a)+1)*a:l===0&&o===a-1&&(o=a-2,l=1);let u,c;this.closed||o>0?u=i[(o-1)%a]:(n0.subVectors(i[0],i[1]).add(i[0]),u=n0);const d=i[o%a],h=i[(o+1)%a];if(this.closed||o+2<a?c=i[(o+2)%a]:(n0.subVectors(i[a-1],i[a-2]).add(i[a-1]),c=n0),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let x=Math.pow(u.distanceToSquared(d),v),_=Math.pow(d.distanceToSquared(h),v),b=Math.pow(h.distanceToSquared(c),v);_<1e-4&&(_=1),x<1e-4&&(x=_),b<1e-4&&(b=_),tg.initNonuniformCatmullRom(u.x,d.x,h.x,c.x,x,_,b),ng.initNonuniformCatmullRom(u.y,d.y,h.y,c.y,x,_,b),rg.initNonuniformCatmullRom(u.z,d.z,h.z,c.z,x,_,b)}else this.curveType==="catmullrom"&&(tg.initCatmullRom(u.x,d.x,h.x,c.x,this.tension),ng.initCatmullRom(u.y,d.y,h.y,c.y,this.tension),rg.initCatmullRom(u.z,d.z,h.z,c.z,this.tension));return r.set(tg.calc(l),ng.calc(l),rg.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){const i=this.points[n];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(new Ee().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function h3(t,e,n,r,i){const a=(r-e)*.5,s=(i-n)*.5,o=t*t,l=t*o;return(2*n-2*r+a+s)*l+(-3*n+3*r-2*a-s)*o+a*t+n}function bF(t,e){const n=1-t;return n*n*e}function xF(t,e){return 2*(1-t)*t*e}function wF(t,e){return t*t*e}function cf(t,e,n,r){return bF(t,e)+xF(t,n)+wF(t,r)}function SF(t,e){const n=1-t;return n*n*n*e}function MF(t,e){const n=1-t;return 3*n*n*t*e}function EF(t,e){return 3*(1-t)*t*t*e}function TF(t,e){return t*t*t*e}function df(t,e,n,r,i){return SF(t,e)+MF(t,n)+EF(t,r)+TF(t,i)}class r7 extends $s{constructor(e=new Lt,n=new Lt,r=new Lt,i=new Lt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=r,this.v3=i}getPoint(e,n=new Lt){const r=n,i=this.v0,a=this.v1,s=this.v2,o=this.v3;return r.set(df(e,i.x,a.x,s.x,o.x),df(e,i.y,a.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class CF extends $s{constructor(e=new Ee,n=new Ee,r=new Ee,i=new Ee){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=r,this.v3=i}getPoint(e,n=new Ee){const r=n,i=this.v0,a=this.v1,s=this.v2,o=this.v3;return r.set(df(e,i.x,a.x,s.x,o.x),df(e,i.y,a.y,s.y,o.y),df(e,i.z,a.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class uy extends $s{constructor(e=new Lt,n=new Lt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Lt){const r=n;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Lt){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class AF extends $s{constructor(e=new Ee,n=new Ee){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new Ee){const r=n;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Ee){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class i7 extends $s{constructor(e=new Lt,n=new Lt,r=new Lt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=r}getPoint(e,n=new Lt){const r=n,i=this.v0,a=this.v1,s=this.v2;return r.set(cf(e,i.x,a.x,s.x),cf(e,i.y,a.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class kF extends $s{constructor(e=new Ee,n=new Ee,r=new Ee){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=r}getPoint(e,n=new Ee){const r=n,i=this.v0,a=this.v1,s=this.v2;return r.set(cf(e,i.x,a.x,s.x),cf(e,i.y,a.y,s.y),cf(e,i.z,a.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class a7 extends $s{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Lt){const r=n,i=this.points,a=(i.length-1)*e,s=Math.floor(a),o=a-s,l=i[s===0?s:s-1],u=i[s],c=i[s>i.length-2?i.length-1:s+1],d=i[s>i.length-3?i.length-1:s+2];return r.set(h3(o,l.x,u.x,c.x,d.x),h3(o,l.y,u.y,c.y,d.y)),r}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){const i=this.points[n];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(new Lt().fromArray(i))}return this}}var IF=Object.freeze({__proto__:null,ArcCurve:yF,CatmullRomCurve3:_F,CubicBezierCurve:r7,CubicBezierCurve3:CF,EllipseCurve:oy,LineCurve:uy,LineCurve3:AF,QuadraticBezierCurve:i7,QuadraticBezierCurve3:kF,SplineCurve:a7});class $F extends $s{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);e.equals(n)||this.curves.push(new uy(n,e))}getPoint(e,n){const r=e*this.getLength(),i=this.getCurveLengths();let a=0;for(;a<i.length;){if(i[a]>=r){const s=i[a]-r,o=this.curves[a],l=o.getLength(),u=l===0?0:1-s/l;return o.getPointAt(u,n)}a++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let r=0,i=this.curves.length;r<i;r++)n+=this.curves[r].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let r=0;r<=e;r++)n.push(this.getPoint(r/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let r;for(let i=0,a=this.curves;i<a.length;i++){const s=a[i],o=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,l=s.getPoints(o);for(let u=0;u<l.length;u++){const c=l[u];r&&r.equals(c)||(n.push(c),r=c)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,r=e.curves.length;n<r;n++){const i=e.curves[n];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,r=this.curves.length;n<r;n++){const i=this.curves[n];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,r=e.curves.length;n<r;n++){const i=e.curves[n];this.curves.push(new IF[i.type]().fromJSON(i))}return this}}class PF extends $F{constructor(e){super(),this.type="Path",this.currentPoint=new Lt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,r=e.length;n<r;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const r=new uy(this.currentPoint.clone(),new Lt(e,n));return this.curves.push(r),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,r,i){const a=new i7(this.currentPoint.clone(),new Lt(e,n),new Lt(r,i));return this.curves.push(a),this.currentPoint.set(r,i),this}bezierCurveTo(e,n,r,i,a,s){const o=new r7(this.currentPoint.clone(),new Lt(e,n),new Lt(r,i),new Lt(a,s));return this.curves.push(o),this.currentPoint.set(a,s),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),r=new a7(n);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,r,i,a,s){const o=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+o,n+l,r,i,a,s),this}absarc(e,n,r,i,a,s){return this.absellipse(e,n,r,r,i,a,s),this}ellipse(e,n,r,i,a,s,o,l){const u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,n+c,r,i,a,s,o,l),this}absellipse(e,n,r,i,a,s,o,l){const u=new oy(e,n,r,i,a,s,o,l);if(this.curves.length>0){const d=u.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(u);const c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class cy extends la{constructor(e=[new Lt(0,-.5),new Lt(.5,0),new Lt(0,.5)],n=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:r,phiLength:i},n=Math.floor(n),i=Gr(i,0,Math.PI*2);const a=[],s=[],o=[],l=[],u=[],c=1/n,d=new Ee,h=new Lt,v=new Ee,x=new Ee,_=new Ee;let b=0,S=0;for(let E=0;E<=e.length-1;E++)switch(E){case 0:b=e[E+1].x-e[E].x,S=e[E+1].y-e[E].y,v.x=S*1,v.y=-b,v.z=S*0,_.copy(v),v.normalize(),l.push(v.x,v.y,v.z);break;case e.length-1:l.push(_.x,_.y,_.z);break;default:b=e[E+1].x-e[E].x,S=e[E+1].y-e[E].y,v.x=S*1,v.y=-b,v.z=S*0,x.copy(v),v.x+=_.x,v.y+=_.y,v.z+=_.z,v.normalize(),l.push(v.x,v.y,v.z),_.copy(x)}for(let E=0;E<=n;E++){const C=r+E*c*i,A=Math.sin(C),D=Math.cos(C);for(let O=0;O<=e.length-1;O++){d.x=e[O].x*A,d.y=e[O].y,d.z=e[O].x*D,s.push(d.x,d.y,d.z),h.x=E/n,h.y=O/(e.length-1),o.push(h.x,h.y);const V=l[3*O+0]*A,P=l[3*O+1],U=l[3*O+0]*D;u.push(V,P,U)}}for(let E=0;E<n;E++)for(let C=0;C<e.length-1;C++){const A=C+E*e.length,D=A,O=A+e.length,V=A+e.length+1,P=A+1;a.push(D,O,P),a.push(V,P,O)}this.setIndex(a),this.setAttribute("position",new Xr(s,3)),this.setAttribute("uv",new Xr(o,2)),this.setAttribute("normal",new Xr(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cy(e.points,e.segments,e.phiStart,e.phiLength)}}class dy extends cy{constructor(e=1,n=1,r=4,i=8){const a=new PF;a.absarc(0,-n/2,e,Math.PI*1.5,0),a.absarc(0,n/2,e,0,Math.PI*.5),super(a.getPoints(r),i),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:r,radialSegments:i}}static fromJSON(e){return new dy(e.radius,e.length,e.capSegments,e.radialSegments)}}class Pf extends la{constructor(e=1,n=1,r=1,i=32,a=1,s=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:r,radialSegments:i,heightSegments:a,openEnded:s,thetaStart:o,thetaLength:l};const u=this;i=Math.floor(i),a=Math.floor(a);const c=[],d=[],h=[],v=[];let x=0;const _=[],b=r/2;let S=0;E(),s===!1&&(e>0&&C(!0),n>0&&C(!1)),this.setIndex(c),this.setAttribute("position",new Xr(d,3)),this.setAttribute("normal",new Xr(h,3)),this.setAttribute("uv",new Xr(v,2));function E(){const A=new Ee,D=new Ee;let O=0;const V=(n-e)/r;for(let P=0;P<=a;P++){const U=[],Y=P/a,fe=Y*(n-e)+e;for(let Q=0;Q<=i;Q++){const G=Q/i,re=G*l+o,he=Math.sin(re),ye=Math.cos(re);D.x=fe*he,D.y=-Y*r+b,D.z=fe*ye,d.push(D.x,D.y,D.z),A.set(he,V,ye).normalize(),h.push(A.x,A.y,A.z),v.push(G,1-Y),U.push(x++)}_.push(U)}for(let P=0;P<i;P++)for(let U=0;U<a;U++){const Y=_[U][P],fe=_[U+1][P],Q=_[U+1][P+1],G=_[U][P+1];c.push(Y,fe,G),c.push(fe,Q,G),O+=6}u.addGroup(S,O,0),S+=O}function C(A){const D=x,O=new Lt,V=new Ee;let P=0;const U=A===!0?e:n,Y=A===!0?1:-1;for(let Q=1;Q<=i;Q++)d.push(0,b*Y,0),h.push(0,Y,0),v.push(.5,.5),x++;const fe=x;for(let Q=0;Q<=i;Q++){const re=Q/i*l+o,he=Math.cos(re),ye=Math.sin(re);V.x=U*ye,V.y=b*Y,V.z=U*he,d.push(V.x,V.y,V.z),h.push(0,Y,0),O.x=he*.5+.5,O.y=ye*.5*Y+.5,v.push(O.x,O.y),x++}for(let Q=0;Q<i;Q++){const G=D+Q,re=fe+Q;A===!0?c.push(re,re+1,G):c.push(re+1,re,G),P+=3}u.addGroup(S,P,A===!0?1:2),S+=P}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Pf(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class nu extends la{constructor(e=1,n=32,r=16,i=0,a=Math.PI*2,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:r,phiStart:i,phiLength:a,thetaStart:s,thetaLength:o},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));const l=Math.min(s+o,Math.PI);let u=0;const c=[],d=new Ee,h=new Ee,v=[],x=[],_=[],b=[];for(let S=0;S<=r;S++){const E=[],C=S/r;let A=0;S==0&&s==0?A=.5/n:S==r&&l==Math.PI&&(A=-.5/n);for(let D=0;D<=n;D++){const O=D/n;d.x=-e*Math.cos(i+O*a)*Math.sin(s+C*o),d.y=e*Math.cos(s+C*o),d.z=e*Math.sin(i+O*a)*Math.sin(s+C*o),x.push(d.x,d.y,d.z),h.copy(d).normalize(),_.push(h.x,h.y,h.z),b.push(O+A,1-C),E.push(u++)}c.push(E)}for(let S=0;S<r;S++)for(let E=0;E<n;E++){const C=c[S][E+1],A=c[S][E],D=c[S+1][E],O=c[S+1][E+1];(S!==0||s>0)&&v.push(C,A,O),(S!==r-1||l<Math.PI)&&v.push(A,D,O)}this.setIndex(v),this.setAttribute("position",new Xr(x,3)),this.setAttribute("normal",new Xr(_,3)),this.setAttribute("uv",new Xr(b,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nu(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class s7 extends bu{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Sn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Sn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Q1,this.normalScale=new Lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Uv extends s7{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Lt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Gr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Sn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Sn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Sn(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class RF extends bu{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Sn(16777215),this.specular=new Sn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Sn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Q1,this.normalScale=new Lt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class fy extends Ar{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new Sn(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}const ig=new tr,p3=new Ee,m3=new Ee;class o7{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Lt(512,512),this.map=null,this.mapPass=null,this.matrix=new tr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ry,this._frameExtents=new Lt(1,1),this._viewportCount=1,this._viewports=[new Cr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,r=this.matrix;p3.setFromMatrixPosition(e.matrixWorld),n.position.copy(p3),m3.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(m3),n.updateMatrixWorld(),ig.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ig),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(ig)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class DF extends o7{constructor(){super(new Ni(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,r=Bv*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||n.far;(r!==n.fov||i!==n.aspect||a!==n.far)&&(n.fov=r,n.aspect=i,n.far=a,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class g3 extends fy{constructor(e,n,r=0,i=Math.PI/3,a=0,s=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ar.DEFAULT_UP),this.updateMatrix(),this.target=new Ar,this.distance=r,this.angle=i,this.penumbra=a,this.decay=s,this.map=null,this.shadow=new DF}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class LF extends o7{constructor(){super(new Z8(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class v3 extends fy{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ar.DEFAULT_UP),this.updateMatrix(),this.target=new Ar,this.shadow=new LF}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class zF extends fy{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class OF{constructor(e,n,r=0,i=1/0){this.ray=new ey(e,n),this.near=r,this.far=i,this.camera=null,this.layers=new ty,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}intersectObject(e,n=!0,r=[]){return Vv(e,this,r,n),r.sort(y3),r}intersectObjects(e,n=!0,r=[]){for(let i=0,a=e.length;i<a;i++)Vv(e[i],this,r,n);return r.sort(y3),r}}function y3(t,e){return t.distance-e.distance}function Vv(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),r===!0){const i=t.children;for(let a=0,s=i.length;a<s;a++)Vv(i[a],e,n,!0)}}class _3{constructor(e=1,n=0,r=0){return this.radius=e,this.phi=n,this.theta=r,this}set(e,n,r){return this.radius=e,this.phi=n,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,r){return this.radius=Math.sqrt(e*e+n*n+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Gr(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const b3=new Ee;let r0,ag;class NF extends Ar{constructor(e=new Ee(0,0,1),n=new Ee(0,0,0),r=1,i=16776960,a=r*.2,s=a*.2){super(),this.type="ArrowHelper",r0===void 0&&(r0=new la,r0.setAttribute("position",new Xr([0,0,0,0,1,0],3)),ag=new Pf(0,.5,1,5,1),ag.translate(0,-.5,0)),this.position.copy(n),this.line=new vF(r0,new n7({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new $i(ag,new ny({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,a,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{b3.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(b3,n)}}setLength(e,n=e*.2,r=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(r,n,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Z1}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Z1);/*!
 * ONNX Runtime Web v1.21.1
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */var hy=Object.defineProperty,BF=Object.getOwnPropertyDescriptor,FF=Object.getOwnPropertyNames,UF=Object.prototype.hasOwnProperty,VF=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')}),bt=(t,e)=>()=>(t&&(e=t(t=0)),e),Wf=(t,e)=>{for(var n in e)hy(t,n,{get:e[n],enumerable:!0})},HF=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of FF(e))!UF.call(t,i)&&i!==n&&hy(t,i,{get:()=>e[i],enumerable:!(r=BF(e,i))||r.enumerable});return t},Z0=t=>HF(hy({},"__esModule",{value:!0}),t),Dd,Bo,xc,x3,l7,u7=bt(()=>{Dd=new Map,Bo=[],xc=(t,e,n)=>{if(e&&typeof e.init=="function"&&typeof e.createInferenceSessionHandler=="function"){let r=Dd.get(t);if(r===void 0)Dd.set(t,{backend:e,priority:n});else{if(r.priority>n)return;if(r.priority===n&&r.backend!==e)throw new Error(`cannot register backend "${t}" using priority ${n}`)}if(n>=0){let i=Bo.indexOf(t);i!==-1&&Bo.splice(i,1);for(let a=0;a<Bo.length;a++)if(Dd.get(Bo[a]).priority<=n){Bo.splice(a,0,t);return}Bo.push(t)}return}throw new TypeError("not a valid backend")},x3=async t=>{let e=Dd.get(t);if(!e)return"backend not found.";if(e.initialized)return e.backend;if(e.aborted)return e.error;{let n=!!e.initPromise;try{return n||(e.initPromise=e.backend.init(t)),await e.initPromise,e.initialized=!0,e.backend}catch(r){return n||(e.error=`${r}`,e.aborted=!0),e.error}finally{delete e.initPromise}}},l7=async t=>{let e=t.executionProviders||[],n=e.map(l=>typeof l=="string"?l:l.name),r=n.length===0?Bo:n,i,a=[],s=new Set;for(let l of r){let u=await x3(l);typeof u=="string"?a.push({name:l,err:u}):(i||(i=u),i===u&&s.add(l))}if(!i)throw new Error(`no available backend found. ERR: ${a.map(l=>`[${l.name}] ${l.err}`).join(", ")}`);for(let{name:l,err:u}of a)n.includes(l)&&console.warn(`removing requested execution provider "${l}" from session options because it is not available: ${u}`);let o=e.filter(l=>s.has(typeof l=="string"?l:l.name));return[i,new Proxy(t,{get:(l,u)=>u==="executionProviders"?o:Reflect.get(l,u)})]}}),WF=bt(()=>{u7()}),c7,GF=bt(()=>{c7="1.21.1"}),sg,_a,d7=bt(()=>{GF(),sg="warning",_a={wasm:{},webgl:{},webgpu:{},versions:{common:c7},set logLevel(t){if(t!==void 0){if(typeof t!="string"||["verbose","info","warning","error","fatal"].indexOf(t)===-1)throw new Error(`Unsupported logging level: ${t}`);sg=t}},get logLevel(){return sg}},Object.defineProperty(_a,"logLevel",{enumerable:!0})}),or,qF=bt(()=>{d7(),or=_a}),f7,h7,jF=bt(()=>{f7=(t,e)=>{let n=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=t.dims[3],n.height=t.dims[2];let r=n.getContext("2d");if(r!=null){let i,a;(e==null?void 0:e.tensorLayout)!==void 0&&e.tensorLayout==="NHWC"?(i=t.dims[2],a=t.dims[3]):(i=t.dims[3],a=t.dims[2]);let s=(e==null?void 0:e.format)!==void 0?e.format:"RGB",o=e==null?void 0:e.norm,l,u;o===void 0||o.mean===void 0?l=[255,255,255,255]:typeof o.mean=="number"?l=[o.mean,o.mean,o.mean,o.mean]:(l=[o.mean[0],o.mean[1],o.mean[2],0],o.mean[3]!==void 0&&(l[3]=o.mean[3])),o===void 0||o.bias===void 0?u=[0,0,0,0]:typeof o.bias=="number"?u=[o.bias,o.bias,o.bias,o.bias]:(u=[o.bias[0],o.bias[1],o.bias[2],0],o.bias[3]!==void 0&&(u[3]=o.bias[3]));let c=a*i,d=0,h=c,v=c*2,x=-1;s==="RGBA"?(d=0,h=c,v=c*2,x=c*3):s==="RGB"?(d=0,h=c,v=c*2):s==="RBG"&&(d=0,v=c,h=c*2);for(let _=0;_<a;_++)for(let b=0;b<i;b++){let S=(t.data[d++]-u[0])*l[0],E=(t.data[h++]-u[1])*l[1],C=(t.data[v++]-u[2])*l[2],A=x===-1?255:(t.data[x++]-u[3])*l[3];r.fillStyle="rgba("+S+","+E+","+C+","+A+")",r.fillRect(b,_,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},h7=(t,e)=>{let n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),r;if(n!=null){let i,a,s;(e==null?void 0:e.tensorLayout)!==void 0&&e.tensorLayout==="NHWC"?(i=t.dims[2],a=t.dims[1],s=t.dims[3]):(i=t.dims[3],a=t.dims[2],s=t.dims[1]);let o=e!==void 0&&e.format!==void 0?e.format:"RGB",l=e==null?void 0:e.norm,u,c;l===void 0||l.mean===void 0?u=[255,255,255,255]:typeof l.mean=="number"?u=[l.mean,l.mean,l.mean,l.mean]:(u=[l.mean[0],l.mean[1],l.mean[2],255],l.mean[3]!==void 0&&(u[3]=l.mean[3])),l===void 0||l.bias===void 0?c=[0,0,0,0]:typeof l.bias=="number"?c=[l.bias,l.bias,l.bias,l.bias]:(c=[l.bias[0],l.bias[1],l.bias[2],0],l.bias[3]!==void 0&&(c[3]=l.bias[3]));let d=a*i;if(e!==void 0&&(e.format!==void 0&&s===4&&e.format!=="RGBA"||s===3&&e.format!=="RGB"&&e.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let h=4,v=0,x=1,_=2,b=3,S=0,E=d,C=d*2,A=-1;o==="RGBA"?(S=0,E=d,C=d*2,A=d*3):o==="RGB"?(S=0,E=d,C=d*2):o==="RBG"&&(S=0,C=d,E=d*2),r=n.createImageData(i,a);for(let D=0;D<a*i;v+=h,x+=h,_+=h,b+=h,D++)r.data[v]=(t.data[S++]-c[0])*u[0],r.data[x]=(t.data[E++]-c[1])*u[1],r.data[_]=(t.data[C++]-c[2])*u[2],r.data[b]=A===-1?255:(t.data[A++]-c[3])*u[3]}else throw new Error("Can not access image data");return r}}),i0,p7,m7,g7,v7,y7,XF=bt(()=>{py(),i0=(t,e)=>{if(t===void 0)throw new Error("Image buffer must be defined");if(e.height===void 0||e.width===void 0)throw new Error("Image height and width must be defined");if(e.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:n,width:r}=e,i=e.norm??{mean:255,bias:0},a,s;typeof i.mean=="number"?a=[i.mean,i.mean,i.mean,i.mean]:a=[i.mean[0],i.mean[1],i.mean[2],i.mean[3]??255],typeof i.bias=="number"?s=[i.bias,i.bias,i.bias,i.bias]:s=[i.bias[0],i.bias[1],i.bias[2],i.bias[3]??0];let o=e.format!==void 0?e.format:"RGBA",l=e.tensorFormat!==void 0&&e.tensorFormat!==void 0?e.tensorFormat:"RGB",u=n*r,c=l==="RGBA"?new Float32Array(u*4):new Float32Array(u*3),d=4,h=0,v=1,x=2,_=3,b=0,S=u,E=u*2,C=-1;o==="RGB"&&(d=3,h=0,v=1,x=2,_=-1),l==="RGBA"?C=u*3:l==="RBG"?(b=0,E=u,S=u*2):l==="BGR"&&(E=0,S=u,b=u*2);for(let A=0;A<u;A++,h+=d,x+=d,v+=d,_+=d)c[b++]=(t[h]+s[0])/a[0],c[S++]=(t[v]+s[1])/a[1],c[E++]=(t[x]+s[2])/a[2],C!==-1&&_!==-1&&(c[C++]=(t[_]+s[3])/a[3]);return l==="RGBA"?new ea("float32",c,[1,4,n,r]):new ea("float32",c,[1,3,n,r])},p7=async(t,e)=>{let n=typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement,r=typeof ImageData<"u"&&t instanceof ImageData,i=typeof ImageBitmap<"u"&&t instanceof ImageBitmap,a=typeof t=="string",s,o=e??{},l=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},u=c=>typeof HTMLCanvasElement<"u"&&c instanceof HTMLCanvasElement||c instanceof OffscreenCanvas?c.getContext("2d"):null;if(n){let c=l();c.width=t.width,c.height=t.height;let d=u(c);if(d!=null){let h=t.height,v=t.width;if(e!==void 0&&e.resizedHeight!==void 0&&e.resizedWidth!==void 0&&(h=e.resizedHeight,v=e.resizedWidth),e!==void 0){if(o=e,e.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");o.tensorFormat="RGBA",o.height=h,o.width=v}else o.tensorFormat="RGBA",o.height=h,o.width=v;d.drawImage(t,0,0),s=d.getImageData(0,0,v,h).data}else throw new Error("Can not access image data")}else if(r){let c,d;if(e!==void 0&&e.resizedWidth!==void 0&&e.resizedHeight!==void 0?(c=e.resizedHeight,d=e.resizedWidth):(c=t.height,d=t.width),e!==void 0&&(o=e),o.format="RGBA",o.height=c,o.width=d,e!==void 0){let h=l();h.width=d,h.height=c;let v=u(h);if(v!=null)v.putImageData(t,0,0),s=v.getImageData(0,0,d,c).data;else throw new Error("Can not access image data")}else s=t.data}else if(i){if(e===void 0)throw new Error("Please provide image config with format for Imagebitmap");let c=l();c.width=t.width,c.height=t.height;let d=u(c);if(d!=null){let h=t.height,v=t.width;return d.drawImage(t,0,0,v,h),s=d.getImageData(0,0,v,h).data,o.height=h,o.width=v,i0(s,o)}else throw new Error("Can not access image data")}else{if(a)return new Promise((c,d)=>{let h=l(),v=u(h);if(!t||!v)return d();let x=new Image;x.crossOrigin="Anonymous",x.src=t,x.onload=()=>{h.width=x.width,h.height=x.height,v.drawImage(x,0,0,h.width,h.height);let _=v.getImageData(0,0,h.width,h.height);o.height=h.height,o.width=h.width,c(i0(_.data,o))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(s!==void 0)return i0(s,o);throw new Error("Input data provided is not supported - aborted tensor creation")},m7=(t,e)=>{let{width:n,height:r,download:i,dispose:a}=e,s=[1,r,n,4];return new ea({location:"texture",type:"float32",texture:t,dims:s,download:i,dispose:a})},g7=(t,e)=>{let{dataType:n,dims:r,download:i,dispose:a}=e;return new ea({location:"gpu-buffer",type:n??"float32",gpuBuffer:t,dims:r,download:i,dispose:a})},v7=(t,e)=>{let{dataType:n,dims:r,download:i,dispose:a}=e;return new ea({location:"ml-tensor",type:n??"float32",mlTensor:t,dims:r,download:i,dispose:a})},y7=(t,e,n)=>new ea({location:"cpu-pinned",type:t,data:e,dims:n??[e.length]})}),Kl,Xd,og,_7,KF=bt(()=>{Kl=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),Xd=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),og=!1,_7=()=>{if(!og){og=!0;let t=typeof BigInt64Array<"u"&&BigInt64Array.from,e=typeof BigUint64Array<"u"&&BigUint64Array.from,n=globalThis.Float16Array,r=typeof n<"u"&&n.from;t&&(Kl.set("int64",BigInt64Array),Xd.set(BigInt64Array,"int64")),e&&(Kl.set("uint64",BigUint64Array),Xd.set(BigUint64Array,"uint64")),r?(Kl.set("float16",n),Xd.set(n,"float16")):Kl.set("float16",Uint16Array)}}}),b7,x7,YF=bt(()=>{py(),b7=t=>{let e=1;for(let n=0;n<t.length;n++){let r=t[n];if(typeof r!="number"||!Number.isSafeInteger(r))throw new TypeError(`dims[${n}] must be an integer, got: ${r}`);if(r<0)throw new RangeError(`dims[${n}] must be a non-negative integer, got: ${r}`);e*=r}return e},x7=(t,e)=>{switch(t.location){case"cpu":return new ea(t.type,t.data,e);case"cpu-pinned":return new ea({location:"cpu-pinned",data:t.data,type:t.type,dims:e});case"texture":return new ea({location:"texture",texture:t.texture,type:t.type,dims:e});case"gpu-buffer":return new ea({location:"gpu-buffer",gpuBuffer:t.gpuBuffer,type:t.type,dims:e});case"ml-tensor":return new ea({location:"ml-tensor",mlTensor:t.mlTensor,type:t.type,dims:e});default:throw new Error(`tensorReshape: tensor location ${t.location} is not supported`)}}}),ea,py=bt(()=>{jF(),XF(),KF(),YF(),ea=class{constructor(t,e,n){_7();let r,i;if(typeof t=="object"&&"location"in t)switch(this.dataLocation=t.location,r=t.type,i=t.dims,t.location){case"cpu-pinned":{let s=Kl.get(r);if(!s)throw new TypeError(`unsupported type "${r}" to create tensor from pinned buffer`);if(!(t.data instanceof s))throw new TypeError(`buffer should be of type ${s.name}`);this.cpuData=t.data;break}case"texture":{if(r!=="float32")throw new TypeError(`unsupported type "${r}" to create tensor from texture`);this.gpuTextureData=t.texture,this.downloader=t.download,this.disposer=t.dispose;break}case"gpu-buffer":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint8"&&r!=="bool"&&r!=="uint4"&&r!=="int4")throw new TypeError(`unsupported type "${r}" to create tensor from gpu buffer`);this.gpuBufferData=t.gpuBuffer,this.downloader=t.download,this.disposer=t.dispose;break}case"ml-tensor":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint64"&&r!=="int8"&&r!=="uint8"&&r!=="bool"&&r!=="uint4"&&r!=="int4")throw new TypeError(`unsupported type "${r}" to create tensor from MLTensor`);this.mlTensorData=t.mlTensor,this.downloader=t.download,this.disposer=t.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let s,o;if(typeof t=="string")if(r=t,o=n,t==="string"){if(!Array.isArray(e))throw new TypeError("A string tensor's data must be a string array.");s=e}else{let l=Kl.get(t);if(l===void 0)throw new TypeError(`Unsupported tensor type: ${t}.`);if(Array.isArray(e)){if(t==="float16"&&l===Uint16Array||t==="uint4"||t==="int4")throw new TypeError(`Creating a ${t} tensor from number array is not supported. Please use ${l.name} as data.`);t==="uint64"||t==="int64"?s=l.from(e,BigInt):s=l.from(e)}else if(e instanceof l)s=e;else if(e instanceof Uint8ClampedArray)if(t==="uint8")s=Uint8Array.from(e);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(t==="float16"&&e instanceof Uint16Array&&l!==Uint16Array)s=new globalThis.Float16Array(e.buffer,e.byteOffset,e.length);else throw new TypeError(`A ${r} tensor's data must be type of ${l}`)}else if(o=e,Array.isArray(t)){if(t.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let l=typeof t[0];if(l==="string")r="string",s=t;else if(l==="boolean")r="bool",s=Uint8Array.from(t);else throw new TypeError(`Invalid element type of data array: ${l}.`)}else if(t instanceof Uint8ClampedArray)r="uint8",s=Uint8Array.from(t);else{let l=Xd.get(t.constructor);if(l===void 0)throw new TypeError(`Unsupported type for tensor data: ${t.constructor}.`);r=l,s=t}if(o===void 0)o=[s.length];else if(!Array.isArray(o))throw new TypeError("A tensor's dims must be a number array");i=o,this.cpuData=s,this.dataLocation="cpu"}let a=b7(i);if(this.cpuData&&a!==this.cpuData.length&&!((r==="uint4"||r==="int4")&&Math.ceil(a/2)===this.cpuData.length))throw new Error(`Tensor's size(${a}) does not match data length(${this.cpuData.length}).`);this.type=r,this.dims=i,this.size=a}static async fromImage(t,e){return p7(t,e)}static fromTexture(t,e){return m7(t,e)}static fromGpuBuffer(t,e){return g7(t,e)}static fromMLTensor(t,e){return v7(t,e)}static fromPinnedBuffer(t,e,n){return y7(t,e,n)}toDataURL(t){return f7(this,t)}toImageData(t){return h7(this,t)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(t){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let e=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=e,t&&this.disposer&&(this.disposer(),this.disposer=void 0),e}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(t){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return x7(this,t)}}}),Bi,w7=bt(()=>{py(),Bi=ea}),J0,lg,Ts,Va,S7=bt(()=>{d7(),J0=(t,e)=>{(typeof _a.trace>"u"?!_a.wasm.trace:!_a.trace)||console.timeStamp(`${t}::ORT::${e}`)},lg=(t,e)=>{var i;let n=((i=new Error().stack)==null?void 0:i.split(/\r\n|\r|\n/g))||[],r=!1;for(let a=0;a<n.length;a++){if(r&&!n[a].includes("TRACE_FUNC")){let s=`FUNC_${t}::${n[a].trim().split(" ")[1]}`;e&&(s+=`::${e}`),J0("CPU",s);return}n[a].includes("TRACE_FUNC")&&(r=!0)}},Ts=t=>{(typeof _a.trace>"u"?!_a.wasm.trace:!_a.trace)||lg("BEGIN",t)},Va=t=>{(typeof _a.trace>"u"?!_a.wasm.trace:!_a.trace)||lg("END",t)}}),M7,ZF=bt(()=>{u7(),w7(),S7(),M7=class E7{constructor(e){this.handler=e}async run(e,n,r){Ts();let i={},a={};if(typeof e!="object"||e===null||e instanceof Bi||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let s=!0;if(typeof n=="object"){if(n===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof Bi)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(n.length===0)throw new TypeError("'fetches' cannot be an empty array.");s=!1;for(let u of n){if(typeof u!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(u)===-1)throw new RangeError(`'fetches' contains invalid output name: ${u}.`);i[u]=null}if(typeof r=="object"&&r!==null)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let u=!1,c=Object.getOwnPropertyNames(n);for(let d of this.outputNames)if(c.indexOf(d)!==-1){let h=n[d];(h===null||h instanceof Bi)&&(u=!0,s=!1,i[d]=h)}if(u){if(typeof r=="object"&&r!==null)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else a=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let u of this.inputNames)if(typeof e[u]>"u")throw new Error(`input '${u}' is missing in 'feeds'.`);if(s)for(let u of this.outputNames)i[u]=null;let o=await this.handler.run(e,i,a),l={};for(let u in o)if(Object.hasOwnProperty.call(o,u)){let c=o[u];c instanceof Bi?l[u]=c:l[u]=new Bi(c.type,c.data,c.dims)}return Va(),l}async release(){return this.handler.dispose()}static async create(e,n,r,i){Ts();let a,s={};if(typeof e=="string"){if(a=e,typeof n=="object"&&n!==null)s=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(a=e,typeof n=="object"&&n!==null)s=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer){let c=e,d=0,h=e.byteLength;if(typeof n=="object"&&n!==null)s=n;else if(typeof n=="number"){if(d=n,!Number.isSafeInteger(d))throw new RangeError("'byteOffset' must be an integer.");if(d<0||d>=c.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${c.byteLength}).`);if(h=e.byteLength-d,typeof r=="number"){if(h=r,!Number.isSafeInteger(h))throw new RangeError("'byteLength' must be an integer.");if(h<=0||d+h>c.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${c.byteLength-d}].`);if(typeof i=="object"&&i!==null)s=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof r<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof n<"u")throw new TypeError("'options' must be an object.");a=new Uint8Array(c,d,h)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[o,l]=await l7(s),u=await o.createInferenceSessionHandler(a,l);return Va(),new E7(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}}),my,JF=bt(()=>{ZF(),my=M7}),QF=bt(()=>{}),eU=bt(()=>{}),tU=bt(()=>{}),nU=bt(()=>{}),rU={};Wf(rU,{InferenceSession:()=>my,TRACE:()=>J0,TRACE_FUNC_BEGIN:()=>Ts,TRACE_FUNC_END:()=>Va,Tensor:()=>Bi,env:()=>or,registerBackend:()=>xc});var Ka=bt(()=>{WF(),qF(),JF(),w7(),QF(),eU(),S7(),tU(),nU()}),gy=bt(()=>{}),T7={};Wf(T7,{default:()=>C7});var ug,cg,C7,iU=bt(()=>{var t;IT(),xu(),vy(),ug="ort-wasm-proxy-worker",cg=((t=globalThis.self)==null?void 0:t.name)===ug,cg&&(self.onmessage=e=>{let{type:n,in:r}=e.data;try{switch(n){case"init-wasm":yy(r.wasm).then(()=>{zy(r).then(()=>{postMessage({type:n})},i=>{postMessage({type:n,err:i})})},i=>{postMessage({type:n,err:i})});break;case"init-ep":{let{epName:i,env:a}=r;Oy(a,i).then(()=>{postMessage({type:n})},s=>{postMessage({type:n,err:s})});break}case"copy-from":{let{buffer:i}=r,a=ip(i);postMessage({type:n,out:a});break}case"create":{let{model:i,options:a}=r;Ny(i,a).then(s=>{postMessage({type:n,out:s})},s=>{postMessage({type:n,err:s})});break}case"release":By(r),postMessage({type:n});break;case"run":{let{sessionId:i,inputIndices:a,inputs:s,outputIndices:o,options:l}=r;Fy(i,a,s,o,new Array(o.length).fill(null),l).then(u=>{u.some(c=>c[3]!=="cpu")?postMessage({type:n,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:n,out:u},Vy([...s,...u]))},u=>{postMessage({type:n,err:u})});break}case"end-profiling":Uy(r),postMessage({type:n});break;default:}}catch(i){postMessage({type:n,err:i})}}),C7=cg?null:e=>new Worker(e??Ji,{type:"module",name:ug})}),A7={};Wf(A7,{default:()=>k7});var dg,fg,k7,w3,aU=bt(()=>{var t,e;fg=(dg=import.meta.url,async function(n={}){var Il;var r,i,a=n,s=new Promise((M,L)=>{r=M,i=L}),o=typeof window=="object",l=typeof WorkerGlobalScope<"u",u=l&&((Il=self.name)==null?void 0:Il.startsWith("em-pthread"));a.mountExternalData=(M,L)=>{M.startsWith("./")&&(M=M.substring(2)),(a.Fb||(a.Fb=new Map)).set(M,L)},a.unmountExternalData=()=>{delete a.Fb};var c=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,shared:!0}).buffer.constructor;let d=()=>{let M=(H,Z,ae)=>(...Ae)=>{let Qe=Wn,mt=Z==null?void 0:Z();Ae=H(...Ae);let St=Z==null?void 0:Z();return mt!==St&&(H=St,ae(mt),Z=ae=null),Wn!=Qe?new Promise((It,Zt)=>{Ct={resolve:It,reject:Zt}}):Ae},L=H=>async(...Z)=>{var ae;try{if(a.Gb)throw Error("Session already started");let Ae=a.Gb={fc:Z[0],errors:[]},Qe=await H(...Z);if(a.Gb!==Ae)throw Error("Session mismatch");(ae=a.Hb)==null||ae.flush();let mt=Ae.errors;if(0<mt.length){let St=await Promise.all(mt);if(St=St.filter(It=>It),0<St.length)throw Error(St.join(`
`))}return Qe}finally{a.Gb=null}};a._OrtCreateSession=M(a._OrtCreateSession,()=>a._OrtCreateSession,H=>a._OrtCreateSession=H),a._OrtRun=L(M(a._OrtRun,()=>a._OrtRun,H=>a._OrtRun=H)),a._OrtRunWithBinding=L(M(a._OrtRunWithBinding,()=>a._OrtRunWithBinding,H=>a._OrtRunWithBinding=H)),a._OrtBindInput=M(a._OrtBindInput,()=>a._OrtBindInput,H=>a._OrtBindInput=H),d=void 0};a.jsepInit=(M,L)=>{if(d==null||d(),M==="webgpu"){[a.Hb,a.Vb,a.Zb,a.Lb,a.Yb,a.kb,a.$b,a.cc,a.Wb,a.Xb,a.ac]=L;let H=a.Hb;a.jsepRegisterBuffer=(Z,ae,Ae,Qe)=>H.registerBuffer(Z,ae,Ae,Qe),a.jsepGetBuffer=Z=>H.getBuffer(Z),a.jsepCreateDownloader=(Z,ae,Ae)=>H.createDownloader(Z,ae,Ae),a.jsepOnCreateSession=Z=>{H.onCreateSession(Z)},a.jsepOnReleaseSession=Z=>{H.onReleaseSession(Z)},a.jsepOnRunStart=Z=>H.onRunStart(Z),a.dc=(Z,ae)=>{H.upload(Z,ae)}}else if(M==="webnn"){[a.Hb,a.bc,a.Mb,a.jsepEnsureTensor,a.Nb,a.jsepDownloadTensor]=L,a.jsepReleaseTensorId=a.Mb,a.jsepUploadTensor=a.Nb;let H=a.Hb;a.jsepOnRunStart=Z=>H.onRunStart(Z),a.jsepOnRunEnd=H.onRunEnd.bind(H),a.jsepRegisterMLContext=(Z,ae)=>{H.registerMLContext(Z,ae)},a.jsepOnReleaseSession=Z=>{H.onReleaseSession(Z)},a.jsepCreateMLTensorDownloader=(Z,ae)=>H.createMLTensorDownloader(Z,ae),a.jsepRegisterMLTensor=(Z,ae,Ae,Qe)=>H.registerMLTensor(Z,ae,Ae,Qe),a.jsepCreateMLContext=Z=>H.createMLContext(Z),a.jsepRegisterMLConstant=(Z,ae,Ae,Qe,mt)=>H.registerMLConstant(Z,ae,Ae,Qe,mt,a.Fb),a.jsepRegisterGraphInput=H.registerGraphInput.bind(H),a.jsepIsGraphInput=H.isGraphInput.bind(H),a.jsepCreateTemporaryTensor=H.createTemporaryTensor.bind(H)}};var h,v,x=Object.assign({},a),_=(M,L)=>{throw L},b="";(o||l)&&(l?b=self.location.href:typeof document<"u"&&document.currentScript&&(b=document.currentScript.src),dg&&(b=dg),b=b.startsWith("blob:")?"":b.slice(0,b.replace(/[?#].*/,"").lastIndexOf("/")+1),l&&(v=M=>{var L=new XMLHttpRequest;return L.open("GET",M,!1),L.responseType="arraybuffer",L.send(null),new Uint8Array(L.response)}),h=async M=>{if(Oe(M))return new Promise((H,Z)=>{var ae=new XMLHttpRequest;ae.open("GET",M,!0),ae.responseType="arraybuffer",ae.onload=()=>{ae.status==200||ae.status==0&&ae.response?H(ae.response):Z(ae.status)},ae.onerror=Z,ae.send(null)});var L=await fetch(M,{credentials:"same-origin"});if(L.ok)return L.arrayBuffer();throw Error(L.status+" : "+L.url)});var S=console.log.bind(console),E=console.error.bind(console),C=S,A=E;Object.assign(a,x),x=null;var D,O,V,P,U,Y,fe,Q,G,re,he,ye,$e,_e=a.wasmBinary,de=!1,Oe=M=>M.startsWith("file://");function ve(){return D.buffer!=P.buffer&&ut(),P}function ie(){return D.buffer!=P.buffer&&ut(),U}function Pe(){return D.buffer!=P.buffer&&ut(),Y}function et(){return D.buffer!=P.buffer&&ut(),fe}function ne(){return D.buffer!=P.buffer&&ut(),Q}function qe(){return D.buffer!=P.buffer&&ut(),G}function ge(){return D.buffer!=P.buffer&&ut(),re}function xe(){return D.buffer!=P.buffer&&ut(),$e}if(u){let M=function(L){try{var H=L.data,Z=H.Cb;if(Z==="load"){let ae=[];self.onmessage=Ae=>ae.push(Ae),self.startWorker=()=>{postMessage({Cb:"loaded"});for(let Ae of ae)M(Ae);self.onmessage=M};for(let Ae of H.Sb)a[Ae]&&!a[Ae].proxy||(a[Ae]=(...Qe)=>{postMessage({Cb:"callHandler",Rb:Ae,args:Qe})},Ae=="print"&&(C=a[Ae]),Ae=="printErr"&&(A=a[Ae]));D=H.mc,ut(),ze(H.nc)}else if(Z==="run"){Re(H.Bb),Us(H.Bb,0,0,1,0,0),Kt(),pl(H.Bb),Ge||(Ou(),Ge=!0);try{it(H.ic,H.Jb)}catch(ae){if(ae!="unwind")throw ae}}else H.target!=="setimmediate"&&(Z==="checkMailbox"?Ge&&mo():Z&&(A(`worker: received unknown command ${Z}`),A(H)))}catch(ae){throw To(),ae}};var ze,Ge=!1;A=function(...L){L=L.join(" "),console.error(L)},self.alert=function(...L){postMessage({Cb:"alert",text:L.join(" "),kc:Eo()})},self.onunhandledrejection=L=>{throw L.reason||L},self.onmessage=M}function ut(){var M=D.buffer;a.HEAP8=P=new Int8Array(M),a.HEAP16=Y=new Int16Array(M),a.HEAPU8=U=new Uint8Array(M),a.HEAPU16=fe=new Uint16Array(M),a.HEAP32=Q=new Int32Array(M),a.HEAPU32=G=new Uint32Array(M),a.HEAPF32=re=new Float32Array(M),a.HEAPF64=$e=new Float64Array(M),a.HEAP64=he=new BigInt64Array(M),a.HEAPU64=ye=new BigUint64Array(M)}function ce(){u?startWorker(a):Ft.Ca()}u||(D=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),ut());var me,ke=0,Xe=null;function Ze(){if(--ke==0&&Xe){var M=Xe;Xe=null,M()}}function We(M){throw A(M="Aborted("+M+")"),de=!0,M=new WebAssembly.RuntimeError(M+". Build with -sASSERTIONS for more info."),i(M),M}function gt(){return{a:{L:ct,Aa:vt,b:Tt,$:$n,A:Yt,pa:ln,X:B,Z:ft,qa:I,na:X,ga:Ve,ma:we,J:je,Y:Vt,V:yt,oa:Ot,W:Gt,va:tn,E:xn,Q:jn,O:zt,D:Ya,u:ua,r:fo,P:hl,z:ho,R:ca,ja:Vr,T:Eu,aa:Yc,M:Zc,F:go,ia:pl,sa:Ea,t:Ta,Ba:Fe,w:zn,n:Jc,m:Qc,c:Ur,o:yo,k:Qa,v:kn,p:_o,f:yl,s:Cu,l:$r,e:es,j:Ds,i:_t,g:Pr,d:Ls,da:zs,ea:Au,fa:ku,ba:ts,ca:Iu,N:$u,xa:bo,ua:Pu,h:qt,C:_l,G:Ns,ta:nd,x:fa,ra:Ru,U:Du,q:td,y:xo,K:rd,S:Lu,za:id,ya:zu,ka:So,la:Zr,_:Ie,B:ha,I:Mo,ha:wl,H:Sl,a:D,wa:xt}}}var ht={819692:(M,L,H,Z,ae)=>{if(a===void 0||!a.Fb)return 1;if((M=bn(Number(M>>>0))).startsWith("./")&&(M=M.substring(2)),!(M=a.Fb.get(M)))return 2;if(L=Number(L>>>0),H=Number(H>>>0),Z=Number(Z>>>0),L+H>M.byteLength)return 3;try{let Ae=M.subarray(L,L+H);switch(ae){case 0:ie().set(Ae,Z>>>0);break;case 1:a.dc(Z,Ae);break;default:return 4}return 0}catch{return 4}},820407:(M,L,H)=>{a.Nb(M,ie().subarray(L>>>0,L+H>>>0))},820470:()=>a.bc(),820511:M=>{a.Mb(M)},820547:()=>{a.Wb()},820578:()=>{a.Xb()},820607:()=>{a.ac()},820632:M=>a.Vb(M),820665:M=>a.Zb(M),820697:(M,L,H)=>{a.Lb(Number(M),Number(L),Number(H),!0)},820760:(M,L,H)=>{a.Lb(Number(M),Number(L),Number(H))},820817:()=>typeof wasmOffsetConverter<"u",820874:M=>{a.kb("Abs",M,void 0)},820925:M=>{a.kb("Neg",M,void 0)},820976:M=>{a.kb("Floor",M,void 0)},821029:M=>{a.kb("Ceil",M,void 0)},821081:M=>{a.kb("Reciprocal",M,void 0)},821139:M=>{a.kb("Sqrt",M,void 0)},821191:M=>{a.kb("Exp",M,void 0)},821242:M=>{a.kb("Erf",M,void 0)},821293:M=>{a.kb("Sigmoid",M,void 0)},821348:(M,L,H)=>{a.kb("HardSigmoid",M,{alpha:L,beta:H})},821427:M=>{a.kb("Log",M,void 0)},821478:M=>{a.kb("Sin",M,void 0)},821529:M=>{a.kb("Cos",M,void 0)},821580:M=>{a.kb("Tan",M,void 0)},821631:M=>{a.kb("Asin",M,void 0)},821683:M=>{a.kb("Acos",M,void 0)},821735:M=>{a.kb("Atan",M,void 0)},821787:M=>{a.kb("Sinh",M,void 0)},821839:M=>{a.kb("Cosh",M,void 0)},821891:M=>{a.kb("Asinh",M,void 0)},821944:M=>{a.kb("Acosh",M,void 0)},821997:M=>{a.kb("Atanh",M,void 0)},822050:M=>{a.kb("Tanh",M,void 0)},822102:M=>{a.kb("Not",M,void 0)},822153:(M,L,H)=>{a.kb("Clip",M,{min:L,max:H})},822222:M=>{a.kb("Clip",M,void 0)},822274:(M,L)=>{a.kb("Elu",M,{alpha:L})},822332:M=>{a.kb("Gelu",M,void 0)},822384:M=>{a.kb("Relu",M,void 0)},822436:(M,L)=>{a.kb("LeakyRelu",M,{alpha:L})},822500:(M,L)=>{a.kb("ThresholdedRelu",M,{alpha:L})},822570:(M,L)=>{a.kb("Cast",M,{to:L})},822628:M=>{a.kb("Add",M,void 0)},822679:M=>{a.kb("Sub",M,void 0)},822730:M=>{a.kb("Mul",M,void 0)},822781:M=>{a.kb("Div",M,void 0)},822832:M=>{a.kb("Pow",M,void 0)},822883:M=>{a.kb("Equal",M,void 0)},822936:M=>{a.kb("Greater",M,void 0)},822991:M=>{a.kb("GreaterOrEqual",M,void 0)},823053:M=>{a.kb("Less",M,void 0)},823105:M=>{a.kb("LessOrEqual",M,void 0)},823164:(M,L,H,Z,ae)=>{a.kb("ReduceMean",M,{keepDims:!!L,noopWithEmptyAxes:!!H,axes:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},823339:(M,L,H,Z,ae)=>{a.kb("ReduceMax",M,{keepDims:!!L,noopWithEmptyAxes:!!H,axes:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},823513:(M,L,H,Z,ae)=>{a.kb("ReduceMin",M,{keepDims:!!L,noopWithEmptyAxes:!!H,axes:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},823687:(M,L,H,Z,ae)=>{a.kb("ReduceProd",M,{keepDims:!!L,noopWithEmptyAxes:!!H,axes:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},823862:(M,L,H,Z,ae)=>{a.kb("ReduceSum",M,{keepDims:!!L,noopWithEmptyAxes:!!H,axes:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},824036:(M,L,H,Z,ae)=>{a.kb("ReduceL1",M,{keepDims:!!L,noopWithEmptyAxes:!!H,axes:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},824209:(M,L,H,Z,ae)=>{a.kb("ReduceL2",M,{keepDims:!!L,noopWithEmptyAxes:!!H,axes:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},824382:(M,L,H,Z,ae)=>{a.kb("ReduceLogSum",M,{keepDims:!!L,noopWithEmptyAxes:!!H,axes:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},824559:(M,L,H,Z,ae)=>{a.kb("ReduceSumSquare",M,{keepDims:!!L,noopWithEmptyAxes:!!H,axes:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},824739:(M,L,H,Z,ae)=>{a.kb("ReduceLogSumExp",M,{keepDims:!!L,noopWithEmptyAxes:!!H,axes:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},824919:M=>{a.kb("Where",M,void 0)},824972:(M,L,H)=>{a.kb("Transpose",M,{perm:L?Array.from(ne().subarray(Number(L)>>>0,Number(H)>>>0)):[]})},825096:(M,L,H,Z)=>{a.kb("DepthToSpace",M,{blocksize:L,mode:bn(H),format:Z?"NHWC":"NCHW"})},825229:(M,L,H,Z)=>{a.kb("DepthToSpace",M,{blocksize:L,mode:bn(H),format:Z?"NHWC":"NCHW"})},825362:(M,L,H,Z,ae,Ae,Qe,mt,St,It,Zt,un,Un,Gn,ka)=>{a.kb("ConvTranspose",M,{format:St?"NHWC":"NCHW",autoPad:L,dilations:[H],group:Z,kernelShape:[ae],pads:[Ae,Qe],strides:[mt],wIsConst:()=>!!ve()[It>>>0],outputPadding:Zt?Array.from(ne().subarray(Number(Zt)>>>0,Number(un)>>>0)):[],outputShape:Un?Array.from(ne().subarray(Number(Un)>>>0,Number(Gn)>>>0)):[],activation:bn(ka)})},825795:(M,L,H,Z,ae,Ae,Qe,mt,St,It,Zt,un,Un,Gn)=>{a.kb("ConvTranspose",M,{format:mt?"NHWC":"NCHW",autoPad:L,dilations:Array.from(ne().subarray(Number(H)>>>0,2+(Number(H)>>>0)>>>0)),group:Z,kernelShape:Array.from(ne().subarray(Number(ae)>>>0,2+(Number(ae)>>>0)>>>0)),pads:Array.from(ne().subarray(Number(Ae)>>>0,4+(Number(Ae)>>>0)>>>0)),strides:Array.from(ne().subarray(Number(Qe)>>>0,2+(Number(Qe)>>>0)>>>0)),wIsConst:()=>!!ve()[St>>>0],outputPadding:It?Array.from(ne().subarray(Number(It)>>>0,Number(Zt)>>>0)):[],outputShape:un?Array.from(ne().subarray(Number(un)>>>0,Number(Un)>>>0)):[],activation:bn(Gn)})},826456:(M,L,H,Z,ae,Ae,Qe,mt,St,It,Zt,un,Un,Gn,ka)=>{a.kb("ConvTranspose",M,{format:St?"NHWC":"NCHW",autoPad:L,dilations:[H],group:Z,kernelShape:[ae],pads:[Ae,Qe],strides:[mt],wIsConst:()=>!!ve()[It>>>0],outputPadding:Zt?Array.from(ne().subarray(Number(Zt)>>>0,Number(un)>>>0)):[],outputShape:Un?Array.from(ne().subarray(Number(Un)>>>0,Number(Gn)>>>0)):[],activation:bn(ka)})},826889:(M,L,H,Z,ae,Ae,Qe,mt,St,It,Zt,un,Un,Gn)=>{a.kb("ConvTranspose",M,{format:mt?"NHWC":"NCHW",autoPad:L,dilations:Array.from(ne().subarray(Number(H)>>>0,2+(Number(H)>>>0)>>>0)),group:Z,kernelShape:Array.from(ne().subarray(Number(ae)>>>0,2+(Number(ae)>>>0)>>>0)),pads:Array.from(ne().subarray(Number(Ae)>>>0,4+(Number(Ae)>>>0)>>>0)),strides:Array.from(ne().subarray(Number(Qe)>>>0,2+(Number(Qe)>>>0)>>>0)),wIsConst:()=>!!ve()[St>>>0],outputPadding:It?Array.from(ne().subarray(Number(It)>>>0,Number(Zt)>>>0)):[],outputShape:un?Array.from(ne().subarray(Number(un)>>>0,Number(Un)>>>0)):[],activation:bn(Gn)})},827550:(M,L)=>{a.kb("GlobalAveragePool",M,{format:L?"NHWC":"NCHW"})},827641:(M,L,H,Z,ae,Ae,Qe,mt,St,It,Zt,un,Un,Gn)=>{a.kb("AveragePool",M,{format:Gn?"NHWC":"NCHW",auto_pad:L,ceil_mode:H,count_include_pad:Z,storage_order:ae,dilations:Ae?Array.from(ne().subarray(Number(Ae)>>>0,Number(Qe)>>>0)):[],kernel_shape:mt?Array.from(ne().subarray(Number(mt)>>>0,Number(St)>>>0)):[],pads:It?Array.from(ne().subarray(Number(It)>>>0,Number(Zt)>>>0)):[],strides:un?Array.from(ne().subarray(Number(un)>>>0,Number(Un)>>>0)):[]})},828120:(M,L)=>{a.kb("GlobalAveragePool",M,{format:L?"NHWC":"NCHW"})},828211:(M,L,H,Z,ae,Ae,Qe,mt,St,It,Zt,un,Un,Gn)=>{a.kb("AveragePool",M,{format:Gn?"NHWC":"NCHW",auto_pad:L,ceil_mode:H,count_include_pad:Z,storage_order:ae,dilations:Ae?Array.from(ne().subarray(Number(Ae)>>>0,Number(Qe)>>>0)):[],kernel_shape:mt?Array.from(ne().subarray(Number(mt)>>>0,Number(St)>>>0)):[],pads:It?Array.from(ne().subarray(Number(It)>>>0,Number(Zt)>>>0)):[],strides:un?Array.from(ne().subarray(Number(un)>>>0,Number(Un)>>>0)):[]})},828690:(M,L)=>{a.kb("GlobalMaxPool",M,{format:L?"NHWC":"NCHW"})},828777:(M,L,H,Z,ae,Ae,Qe,mt,St,It,Zt,un,Un,Gn)=>{a.kb("MaxPool",M,{format:Gn?"NHWC":"NCHW",auto_pad:L,ceil_mode:H,count_include_pad:Z,storage_order:ae,dilations:Ae?Array.from(ne().subarray(Number(Ae)>>>0,Number(Qe)>>>0)):[],kernel_shape:mt?Array.from(ne().subarray(Number(mt)>>>0,Number(St)>>>0)):[],pads:It?Array.from(ne().subarray(Number(It)>>>0,Number(Zt)>>>0)):[],strides:un?Array.from(ne().subarray(Number(un)>>>0,Number(Un)>>>0)):[]})},829252:(M,L)=>{a.kb("GlobalMaxPool",M,{format:L?"NHWC":"NCHW"})},829339:(M,L,H,Z,ae,Ae,Qe,mt,St,It,Zt,un,Un,Gn)=>{a.kb("MaxPool",M,{format:Gn?"NHWC":"NCHW",auto_pad:L,ceil_mode:H,count_include_pad:Z,storage_order:ae,dilations:Ae?Array.from(ne().subarray(Number(Ae)>>>0,Number(Qe)>>>0)):[],kernel_shape:mt?Array.from(ne().subarray(Number(mt)>>>0,Number(St)>>>0)):[],pads:It?Array.from(ne().subarray(Number(It)>>>0,Number(Zt)>>>0)):[],strides:un?Array.from(ne().subarray(Number(un)>>>0,Number(Un)>>>0)):[]})},829814:(M,L,H,Z,ae)=>{a.kb("Gemm",M,{alpha:L,beta:H,transA:Z,transB:ae})},829918:M=>{a.kb("MatMul",M,void 0)},829972:(M,L,H,Z)=>{a.kb("ArgMax",M,{keepDims:!!L,selectLastIndex:!!H,axis:Z})},830080:(M,L,H,Z)=>{a.kb("ArgMin",M,{keepDims:!!L,selectLastIndex:!!H,axis:Z})},830188:(M,L)=>{a.kb("Softmax",M,{axis:L})},830251:(M,L)=>{a.kb("Concat",M,{axis:L})},830311:(M,L,H,Z,ae)=>{a.kb("Split",M,{axis:L,numOutputs:H,splitSizes:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},830467:M=>{a.kb("Expand",M,void 0)},830521:(M,L)=>{a.kb("Gather",M,{axis:Number(L)})},830592:(M,L)=>{a.kb("GatherElements",M,{axis:Number(L)})},830671:(M,L)=>{a.kb("GatherND",M,{batch_dims:Number(L)})},830750:(M,L,H,Z,ae,Ae,Qe,mt,St,It,Zt)=>{a.kb("Resize",M,{antialias:L,axes:H?Array.from(ne().subarray(Number(H)>>>0,Number(Z)>>>0)):[],coordinateTransformMode:bn(ae),cubicCoeffA:Ae,excludeOutside:Qe,extrapolationValue:mt,keepAspectRatioPolicy:bn(St),mode:bn(It),nearestMode:bn(Zt)})},831112:(M,L,H,Z,ae,Ae,Qe)=>{a.kb("Slice",M,{starts:L?Array.from(ne().subarray(Number(L)>>>0,Number(H)>>>0)):[],ends:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[],axes:Ae?Array.from(ne().subarray(Number(Ae)>>>0,Number(Qe)>>>0)):[]})},831376:M=>{a.kb("Tile",M,void 0)},831428:(M,L,H)=>{a.kb("InstanceNormalization",M,{epsilon:L,format:H?"NHWC":"NCHW"})},831542:(M,L,H)=>{a.kb("InstanceNormalization",M,{epsilon:L,format:H?"NHWC":"NCHW"})},831656:M=>{a.kb("Range",M,void 0)},831709:(M,L)=>{a.kb("Einsum",M,{equation:bn(L)})},831790:(M,L,H,Z,ae)=>{a.kb("Pad",M,{mode:L,value:H,pads:Z?Array.from(ne().subarray(Number(Z)>>>0,Number(ae)>>>0)):[]})},831933:(M,L,H,Z,ae,Ae)=>{a.kb("BatchNormalization",M,{epsilon:L,momentum:H,spatial:!!ae,trainingMode:!!Z,format:Ae?"NHWC":"NCHW"})},832102:(M,L,H,Z,ae,Ae)=>{a.kb("BatchNormalization",M,{epsilon:L,momentum:H,spatial:!!ae,trainingMode:!!Z,format:Ae?"NHWC":"NCHW"})},832271:(M,L,H)=>{a.kb("CumSum",M,{exclusive:Number(L),reverse:Number(H)})},832368:(M,L,H)=>{a.kb("DequantizeLinear",M,{axis:L,blockSize:H})},832458:(M,L,H,Z,ae)=>{a.kb("GridSample",M,{align_corners:L,mode:bn(H),padding_mode:bn(Z),format:ae?"NHWC":"NCHW"})},832628:(M,L,H,Z,ae)=>{a.kb("GridSample",M,{align_corners:L,mode:bn(H),padding_mode:bn(Z),format:ae?"NHWC":"NCHW"})},832798:(M,L)=>{a.kb("ScatterND",M,{reduction:bn(L)})},832883:(M,L,H,Z,ae,Ae,Qe,mt,St)=>{a.kb("Attention",M,{numHeads:L,isUnidirectional:H,maskFilterValue:Z,scale:ae,doRotary:Ae,qkvHiddenSizes:Qe?Array.from(ne().subarray(Number(mt)>>>0,Number(mt)+Qe>>>0)):[],pastPresentShareBuffer:!!St})},833155:M=>{a.kb("BiasAdd",M,void 0)},833210:M=>{a.kb("BiasSplitGelu",M,void 0)},833271:M=>{a.kb("FastGelu",M,void 0)},833327:(M,L,H,Z,ae,Ae,Qe,mt,St,It,Zt,un,Un,Gn,ka,ad)=>{a.kb("Conv",M,{format:un?"NHWC":"NCHW",auto_pad:L,dilations:H?Array.from(ne().subarray(Number(H)>>>0,Number(Z)>>>0)):[],group:ae,kernel_shape:Ae?Array.from(ne().subarray(Number(Ae)>>>0,Number(Qe)>>>0)):[],pads:mt?Array.from(ne().subarray(Number(mt)>>>0,Number(St)>>>0)):[],strides:It?Array.from(ne().subarray(Number(It)>>>0,Number(Zt)>>>0)):[],w_is_const:()=>!!ve()[Number(Un)>>>0],activation:bn(Gn),activation_params:ka?Array.from(ge().subarray(Number(ka)>>>0,Number(ad)>>>0)):[]})},833911:M=>{a.kb("Gelu",M,void 0)},833963:(M,L,H,Z,ae,Ae,Qe,mt,St)=>{a.kb("GroupQueryAttention",M,{numHeads:L,kvNumHeads:H,scale:Z,softcap:ae,doRotary:Ae,rotaryInterleaved:Qe,smoothSoftmax:mt,localWindowSize:St})},834180:(M,L,H,Z)=>{a.kb("LayerNormalization",M,{axis:L,epsilon:H,simplified:!!Z})},834291:(M,L,H,Z)=>{a.kb("LayerNormalization",M,{axis:L,epsilon:H,simplified:!!Z})},834402:(M,L,H,Z,ae,Ae)=>{a.kb("MatMulNBits",M,{k:L,n:H,accuracyLevel:Z,bits:ae,blockSize:Ae})},834529:(M,L,H,Z,ae,Ae)=>{a.kb("MultiHeadAttention",M,{numHeads:L,isUnidirectional:H,maskFilterValue:Z,scale:ae,doRotary:Ae})},834688:(M,L)=>{a.kb("QuickGelu",M,{alpha:L})},834752:(M,L,H,Z,ae)=>{a.kb("RotaryEmbedding",M,{interleaved:!!L,numHeads:H,rotaryEmbeddingDim:Z,scale:ae})},834891:(M,L,H)=>{a.kb("SkipLayerNormalization",M,{epsilon:L,simplified:!!H})},834993:(M,L,H)=>{a.kb("SkipLayerNormalization",M,{epsilon:L,simplified:!!H})},835095:(M,L,H,Z)=>{a.kb("GatherBlockQuantized",M,{gatherAxis:L,quantizeAxis:H,blockSize:Z})},835216:M=>{a.$b(M)},835250:(M,L)=>a.cc(Number(M),Number(L),a.Gb.fc,a.Gb.errors)};function vt(M,L,H){return Ps(async()=>{await a.Yb(Number(M),Number(L),Number(H))})}function ct(){return typeof wasmOffsetConverter<"u"}class se{constructor(L){ma(this,"name","ExitStatus");this.message=`Program terminated with exit(${L})`,this.status=L}}var K=M=>{M.terminate(),M.onmessage=()=>{}},De=[],Je=M=>{at.length==0&&(Mn(),on(at[0]));var L=at.pop();if(!L)return 6;Le.push(L),Dt[M.Bb]=L,L.Bb=M.Bb;var H={Cb:"run",ic:M.hc,Jb:M.Jb,Bb:M.Bb};return L.postMessage(H,M.Pb),0},tt=0,nt=(M,L,...H)=>{for(var Z=2*H.length,ae=ko(),Ae=Cl(8*Z),Qe=Ae>>>3,mt=0;mt<H.length;mt++){var St=H[mt];typeof St=="bigint"?(he[Qe+2*mt]=1n,he[Qe+2*mt+1]=St):(he[Qe+2*mt]=0n,xe()[Qe+2*mt+1>>>0]=St)}return M=pa(M,0,Z,Ae,L),Ao(ae),M};function xt(M){if(u)return nt(0,1,M);if(V=M,!(0<tt)){for(var L of Le)K(L);for(L of at)K(L);at=[],Le=[],Dt={},de=!0}_(0,new se(M))}function be(M){if(u)return nt(1,0,M);Ie(M)}var Ie=M=>{if(V=M,u)throw be(M),"unwind";xt(M)},at=[],Le=[],kt=[],Dt={},At=M=>{var L=M.Bb;delete Dt[L],at.push(M),Le.splice(Le.indexOf(M),1),M.Bb=0,El(L)};function Kt(){kt.forEach(M=>M())}var on=M=>new Promise(L=>{M.onmessage=ae=>{var Ae=(ae=ae.data).Cb;if(ae.Ib&&ae.Ib!=Eo()){var Qe=Dt[ae.Ib];Qe?Qe.postMessage(ae,ae.Pb):A(`Internal error! Worker sent a message "${Ae}" to target pthread ${ae.Ib}, but that thread no longer exists!`)}else Ae==="checkMailbox"?mo():Ae==="spawnThread"?Je(ae):Ae==="cleanupThread"?At(Dt[ae.jc]):Ae==="loaded"?(M.loaded=!0,L(M)):Ae==="alert"?alert(`Thread ${ae.kc}: ${ae.text}`):ae.target==="setimmediate"?M.postMessage(ae):Ae==="callHandler"?a[ae.Rb](...ae.args):Ae&&A(`worker sent an unknown command ${Ae}`)},M.onerror=ae=>{throw A(`worker sent an error! ${ae.filename}:${ae.lineno}: ${ae.message}`),ae};var H,Z=[];for(H of[])a.propertyIsEnumerable(H)&&Z.push(H);M.postMessage({Cb:"load",Sb:Z,mc:D,nc:O})});function Mn(){var M=new Worker(import.meta.url.startsWith("file:")?new URL("/facet/assets/ort.bundle.min-DVT1aZ7z.mjs",import.meta.url):new URL(import.meta.url),{type:"module",workerData:"em-pthread",name:"em-pthread"});at.push(M)}var Re=M=>{ut();var L=qe()[M+52>>>2>>>0];M=qe()[M+56>>>2>>>0],Nu(L,L-M),Ao(L)},it=(M,L)=>{tt=0,M=Bu(M,L),0<tt?V=M:Co(M)};class pt{constructor(L){this.Kb=L-24}}function Tt(M,L,H){var Z=new pt(M>>>=0);throw L>>>=0,H>>>=0,qe()[Z.Kb+16>>>2>>>0]=0,qe()[Z.Kb+4>>>2>>>0]=L,qe()[Z.Kb+8>>>2>>>0]=H,M}function Rt(M,L,H,Z){return u?nt(2,1,M,L,H,Z):$n(M,L,H,Z)}function $n(M,L,H,Z){if(M>>>=0,H>>>=0,Z>>>=0,c===void 0)return 6;var ae=[];return u&&ae.length===0?Rt(M,L>>>=0,H,Z):(M={hc:H,Bb:M,Jb:Z,Pb:ae},u?(M.Cb="spawnThread",postMessage(M,ae),0):Je(M))}var nr=typeof TextDecoder<"u"?new TextDecoder:void 0,mr=(M,L=0,H=NaN)=>{var Z=(L>>>=0)+H;for(H=L;M[H]&&!(H>=Z);)++H;if(16<H-L&&M.buffer&&nr)return nr.decode(M.buffer instanceof ArrayBuffer?M.subarray(L,H):M.slice(L,H));for(Z="";L<H;){var ae=M[L++];if(128&ae){var Ae=63&M[L++];if((224&ae)==192)Z+=String.fromCharCode((31&ae)<<6|Ae);else{var Qe=63&M[L++];65536>(ae=(240&ae)==224?(15&ae)<<12|Ae<<6|Qe:(7&ae)<<18|Ae<<12|Qe<<6|63&M[L++])?Z+=String.fromCharCode(ae):(ae-=65536,Z+=String.fromCharCode(55296|ae>>10,56320|1023&ae))}}else Z+=String.fromCharCode(ae)}return Z},bn=(M,L)=>(M>>>=0)?mr(ie(),M,L):"";function Yt(M,L,H){return u?nt(3,1,M,L,H):0}function ln(M,L){if(u)return nt(4,1,M,L)}var sn=M=>{for(var L=0,H=0;H<M.length;++H){var Z=M.charCodeAt(H);127>=Z?L++:2047>=Z?L+=2:55296<=Z&&57343>=Z?(L+=4,++H):L+=3}return L},R=(M,L,H)=>{var Z=ie();if(L>>>=0,0<H){var ae=L;H=L+H-1;for(var Ae=0;Ae<M.length;++Ae){var Qe=M.charCodeAt(Ae);if(55296<=Qe&&57343>=Qe&&(Qe=65536+((1023&Qe)<<10)|1023&M.charCodeAt(++Ae)),127>=Qe){if(L>=H)break;Z[L++>>>0]=Qe}else{if(2047>=Qe){if(L+1>=H)break;Z[L++>>>0]=192|Qe>>6}else{if(65535>=Qe){if(L+2>=H)break;Z[L++>>>0]=224|Qe>>12}else{if(L+3>=H)break;Z[L++>>>0]=240|Qe>>18,Z[L++>>>0]=128|Qe>>12&63}Z[L++>>>0]=128|Qe>>6&63}Z[L++>>>0]=128|63&Qe}}Z[L>>>0]=0,M=L-ae}else M=0;return M};function B(M,L){if(u)return nt(5,1,M,L)}function ft(M,L,H){if(u)return nt(6,1,M,L,H)}function I(M,L,H){return u?nt(7,1,M,L,H):0}function X(M,L){if(u)return nt(8,1,M,L)}function Ve(M,L,H){if(u)return nt(9,1,M,L,H)}function we(M,L,H,Z){if(u)return nt(10,1,M,L,H,Z)}function je(M,L,H,Z){if(u)return nt(11,1,M,L,H,Z)}function Vt(M,L,H,Z){if(u)return nt(12,1,M,L,H,Z)}function yt(M){if(u)return nt(13,1,M)}function Ot(M,L){if(u)return nt(14,1,M,L)}function Gt(M,L,H){if(u)return nt(15,1,M,L,H)}var _n,pe,tn=()=>We(""),Se=M=>{for(var L="";ie()[M>>>0];)L+=_n[ie()[M++>>>0]];return L},wr={},Fr={};function gr(M,L,H={}){return function(Z,ae,Ae={}){var Qe=ae.name;if(!Z)throw new pe(`type "${Qe}" must have a positive integer typeid pointer`);if(Fr.hasOwnProperty(Z)){if(Ae.Tb)return;throw new pe(`Cannot register type '${Qe}' twice`)}Fr[Z]=ae,wr.hasOwnProperty(Z)&&(ae=wr[Z],delete wr[Z],ae.forEach(mt=>mt()))}(M,L,H)}var Xt=(M,L,H)=>{switch(L){case 1:return H?Z=>ve()[Z>>>0]:Z=>ie()[Z>>>0];case 2:return H?Z=>Pe()[Z>>>1>>>0]:Z=>et()[Z>>>1>>>0];case 4:return H?Z=>ne()[Z>>>2>>>0]:Z=>qe()[Z>>>2>>>0];case 8:return H?Z=>he[Z>>>3]:Z=>ye[Z>>>3];default:throw new TypeError(`invalid integer width (${L}): ${M}`)}};function xn(M,L,H){H>>>=0,gr(M>>>=0,{name:L=Se(L>>>0),fromWireType:Z=>Z,toWireType:function(Z,ae){if(typeof ae!="bigint"&&typeof ae!="number")throw ae=ae===null?"null":(Z=typeof ae)=="object"||Z==="array"||Z==="function"?ae.toString():""+ae,new TypeError(`Cannot convert "${ae}" to ${this.name}`);return typeof ae=="number"&&(ae=BigInt(ae)),ae},Db:Ir,readValueFromPointer:Xt(L,H,L.indexOf("u")==-1),Eb:null})}var Ir=8;function jn(M,L,H,Z){gr(M>>>=0,{name:L=Se(L>>>0),fromWireType:function(ae){return!!ae},toWireType:function(ae,Ae){return Ae?H:Z},Db:Ir,readValueFromPointer:function(ae){return this.fromWireType(ie()[ae>>>0])},Eb:null})}var Er=[],ur=[];function Ur(M){9<(M>>>=0)&&--ur[M+1]==0&&(ur[M]=void 0,Er.push(M))}var Nt=M=>{if(!M)throw new pe("Cannot use deleted val. handle = "+M);return ur[M]},hn=M=>{switch(M){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let L=Er.pop()||ur.length;return ur[L]=M,ur[L+1]=1,L}};function wn(M){return this.fromWireType(qe()[M>>>2>>>0])}var ii={name:"emscripten::val",fromWireType:M=>{var L=Nt(M);return Ur(M),L},toWireType:(M,L)=>hn(L),Db:Ir,readValueFromPointer:wn,Eb:null};function zt(M){return gr(M>>>0,ii)}var Ma=(M,L)=>{switch(L){case 4:return function(H){return this.fromWireType(ge()[H>>>2>>>0])};case 8:return function(H){return this.fromWireType(xe()[H>>>3>>>0])};default:throw new TypeError(`invalid float width (${L}): ${M}`)}};function Ya(M,L,H){H>>>=0,gr(M>>>=0,{name:L=Se(L>>>0),fromWireType:Z=>Z,toWireType:(Z,ae)=>ae,Db:Ir,readValueFromPointer:Ma(L,H),Eb:null})}function ua(M,L,H,Z,ae){if(M>>>=0,H>>>=0,L=Se(L>>>0),ae===-1&&(ae=4294967295),ae=mt=>mt,Z===0){var Ae=32-8*H;ae=mt=>mt<<Ae>>>Ae}var Qe=L.includes("unsigned")?function(mt,St){return St>>>0}:function(mt,St){return St};gr(M,{name:L,fromWireType:ae,toWireType:Qe,Db:Ir,readValueFromPointer:Xt(L,H,Z!==0),Eb:null})}function fo(M,L,H){function Z(Ae){var Qe=qe()[Ae>>>2>>>0];return Ae=qe()[Ae+4>>>2>>>0],new ae(ve().buffer,Ae,Qe)}var ae=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][L];gr(M>>>=0,{name:H=Se(H>>>0),fromWireType:Z,Db:Ir,readValueFromPointer:Z},{Tb:!0})}function hl(M,L){gr(M>>>=0,{name:L=Se(L>>>0),fromWireType:function(H){for(var Z,ae=qe()[H>>>2>>>0],Ae=H+4,Qe=Ae,mt=0;mt<=ae;++mt){var St=Ae+mt;mt!=ae&&ie()[St>>>0]!=0||(Qe=bn(Qe,St-Qe),Z===void 0?Z=Qe:(Z+="\0",Z+=Qe),Qe=St+1)}return _i(H),Z},toWireType:function(H,Z){Z instanceof ArrayBuffer&&(Z=new Uint8Array(Z));var ae=typeof Z=="string";if(!(ae||Z instanceof Uint8Array||Z instanceof Uint8ClampedArray||Z instanceof Int8Array))throw new pe("Cannot pass non-string to std::string");var Ae=ae?sn(Z):Z.length,Qe=as(4+Ae+1),mt=Qe+4;if(qe()[Qe>>>2>>>0]=Ae,ae)R(Z,mt,Ae+1);else if(ae)for(ae=0;ae<Ae;++ae){var St=Z.charCodeAt(ae);if(255<St)throw _i(Qe),new pe("String has UTF-16 code units that do not fit in 8 bits");ie()[mt+ae>>>0]=St}else for(ae=0;ae<Ae;++ae)ie()[mt+ae>>>0]=Z[ae];return H!==null&&H.push(_i,Qe),Qe},Db:Ir,readValueFromPointer:wn,Eb(H){_i(H)}})}var Su=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Za=(M,L)=>{for(var H=M>>1,Z=H+L/2;!(H>=Z)&&et()[H>>>0];)++H;if(32<(H<<=1)-M&&Su)return Su.decode(ie().slice(M,H));for(H="",Z=0;!(Z>=L/2);++Z){var ae=Pe()[M+2*Z>>>1>>>0];if(ae==0)break;H+=String.fromCharCode(ae)}return H},mi=(M,L,H)=>{if(H??(H=2147483647),2>H)return 0;var Z=L;H=(H-=2)<2*M.length?H/2:M.length;for(var ae=0;ae<H;++ae){var Ae=M.charCodeAt(ae);Pe()[L>>>1>>>0]=Ae,L+=2}return Pe()[L>>>1>>>0]=0,L-Z},Mu=M=>2*M.length,j=(M,L)=>{for(var H=0,Z="";!(H>=L/4);){var ae=ne()[M+4*H>>>2>>>0];if(ae==0)break;++H,65536<=ae?(ae-=65536,Z+=String.fromCharCode(55296|ae>>10,56320|1023&ae)):Z+=String.fromCharCode(ae)}return Z},Zn=(M,L,H)=>{if(L>>>=0,H??(H=2147483647),4>H)return 0;var Z=L;H=Z+H-4;for(var ae=0;ae<M.length;++ae){var Ae=M.charCodeAt(ae);if(55296<=Ae&&57343>=Ae&&(Ae=65536+((1023&Ae)<<10)|1023&M.charCodeAt(++ae)),ne()[L>>>2>>>0]=Ae,(L+=4)+4>H)break}return ne()[L>>>2>>>0]=0,L-Z},Kc=M=>{for(var L=0,H=0;H<M.length;++H){var Z=M.charCodeAt(H);55296<=Z&&57343>=Z&&++H,L+=4}return L};function ho(M,L,H){if(M>>>=0,L>>>=0,H=Se(H>>>=0),L===2)var Z=Za,ae=mi,Ae=Mu,Qe=mt=>et()[mt>>>1>>>0];else L===4&&(Z=j,ae=Zn,Ae=Kc,Qe=mt=>qe()[mt>>>2>>>0]);gr(M,{name:H,fromWireType:mt=>{for(var St,It=qe()[mt>>>2>>>0],Zt=mt+4,un=0;un<=It;++un){var Un=mt+4+un*L;un!=It&&Qe(Un)!=0||(Zt=Z(Zt,Un-Zt),St===void 0?St=Zt:(St+="\0",St+=Zt),Zt=Un+L)}return _i(mt),St},toWireType:(mt,St)=>{if(typeof St!="string")throw new pe(`Cannot pass non-string to C++ string type ${H}`);var It=Ae(St),Zt=as(4+It+L);return qe()[Zt>>>2>>>0]=It/L,ae(St,Zt+4,It+L),mt!==null&&mt.push(_i,Zt),Zt},Db:Ir,readValueFromPointer:wn,Eb(mt){_i(mt)}})}function ca(M,L){gr(M>>>=0,{Ub:!0,name:L=Se(L>>>0),Db:0,fromWireType:()=>{},toWireType:()=>{}})}function Vr(M){Us(M>>>0,!l,1,!o,131072,!1),Kt()}var po=M=>{if(!de)try{if(M(),!(0<tt))try{u?Co(V):Ie(V)}catch(L){L instanceof se||L=="unwind"||_(0,L)}}catch(L){L instanceof se||L=="unwind"||_(0,L)}};function pl(M){M>>>=0,typeof Atomics.lc=="function"&&(Atomics.lc(ne(),M>>>2,M).value.then(mo),M+=128,Atomics.store(ne(),M>>>2,1))}var mo=()=>{var M=Eo();M&&(pl(M),po(ss))};function Eu(M,L){(M>>>=0)==L>>>0?setTimeout(mo):u?postMessage({Ib:M,Cb:"checkMailbox"}):(M=Dt[M])&&M.postMessage({Cb:"checkMailbox"})}var ml=[];function Yc(M,L,H,Z,ae){for(L>>>=0,Z/=2,ml.length=Z,H=ae>>>0>>>3,ae=0;ae<Z;ae++)ml[ae]=he[H+2*ae]?he[H+2*ae+1]:xe()[H+2*ae+1>>>0];return(L?ht[L]:Bs[M])(...ml)}var Zc=()=>{tt=0};function go(M){M>>>=0,u?postMessage({Cb:"cleanupThread",jc:M}):At(Dt[M])}function Ea(M){}var Gi=(M,L)=>{var H=Fr[M];if(H===void 0)throw M=Fs(M),H=Se(M),_i(M),new pe(`${L} has unknown type ${H}`);return H},da=(M,L,H)=>{var Z=[];return M=M.toWireType(Z,H),Z.length&&(qe()[L>>>2>>>0]=hn(Z)),M};function Ta(M,L,H){return L>>>=0,H>>>=0,M=Nt(M>>>0),L=Gi(L,"emval::as"),da(L,H,M)}function Fe(M,L){return L>>>=0,M=Nt(M>>>0),(L=Gi(L,"emval::as")).toWireType(null,M)}var Xn=M=>{try{M()}catch(L){We(L)}},Sr=0,Wn=null,Tu=0,gi=[],gl={},Ja={},rr=0,Ct=null,pn=[];function Ps(M){return function(L){if(!de){if(Sr===0){var H=!1,Z=!1;L((ae=0)=>{if(!de&&(Tu=ae,H=!0,Z)){Sr=2,Xn(()=>Fu(Wn)),typeof MainLoop<"u"&&MainLoop.Qb&&MainLoop.resume(),ae=!1;try{var Ae=function(){var St=ne()[Wn+8>>>2>>>0];return St=Ft[Ja[St]],--tt,St()}()}catch(St){Ae=St,ae=!0}var Qe=!1;if(!Wn){var mt=Ct;mt&&(Ct=null,(ae?mt.reject:mt.resolve)(Ae),Qe=!0)}if(ae&&!Qe)throw Ae}}),Z=!0,H||(Sr=1,Wn=function(){var ae=as(65548),Ae=ae+12;qe()[ae>>>2>>>0]=Ae,qe()[ae+4>>>2>>>0]=Ae+65536,Ae=gi[0];var Qe=gl[Ae];return Qe===void 0&&(Qe=rr++,gl[Ae]=Qe,Ja[Qe]=Ae),Ae=Qe,ne()[ae+8>>>2>>>0]=Ae,ae}(),typeof MainLoop<"u"&&MainLoop.Qb&&MainLoop.pause(),Xn(()=>Al(Wn)))}else Sr===2?(Sr=0,Xn(Di),_i(Wn),Wn=null,pn.forEach(po)):We(`invalid state: ${Sr}`);return Tu}}(L=>{M().then(L)})}function zn(M){return M>>>=0,Ps(async()=>{var L=await Nt(M);return hn(L)})}var Yr=[];function Jc(M,L,H,Z){return H>>>=0,Z>>>=0,(M=Yr[M>>>0])(null,L=Nt(L>>>0),H,Z)}var vi={},vo=M=>{var L=vi[M];return L===void 0?Se(M):L};function Qc(M,L,H,Z,ae){return H>>>=0,Z>>>=0,ae>>>=0,(M=Yr[M>>>0])(L=Nt(L>>>0),L[H=vo(H)],Z,ae)}var cr=()=>typeof globalThis=="object"?globalThis:Function("return this")();function yo(M){return(M>>>=0)==0?hn(cr()):(M=vo(M),hn(cr()[M]))}var vl=M=>{var L=Yr.length;return Yr.push(M),L},ed=(M,L)=>{for(var H=Array(M),Z=0;Z<M;++Z)H[Z]=Gi(qe()[L+4*Z>>>2>>>0],"parameter "+Z);return H},Rs=(M,L)=>Object.defineProperty(L,"name",{value:M});function Qa(M,L,H){var Z=(L=ed(M,L>>>0)).shift();M--;var ae=`return function (obj, func, destructorsRef, args) {
`,Ae=0,Qe=[];H===0&&Qe.push("obj");for(var mt=["retType"],St=[Z],It=0;It<M;++It)Qe.push("arg"+It),mt.push("argType"+It),St.push(L[It]),ae+=`  var arg${It} = argType${It}.readValueFromPointer(args${Ae?"+"+Ae:""});
`,Ae+=L[It].Db;return ae+=`  var rv = ${H===1?"new func":"func.call"}(${Qe.join(", ")});
`,Z.Ub||(mt.push("emval_returnValue"),St.push(da),ae+=`  return emval_returnValue(retType, destructorsRef, rv);
`),mt.push(ae+`};
`),M=function(Zt){var un=Function;if(!(un instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof un} which is not a function`);var Un=Rs(un.name||"unknownFunctionName",function(){});return Un.prototype=un.prototype,Un=new Un,(Zt=un.apply(Un,Zt))instanceof Object?Zt:Un}(mt)(...St),H=`methodCaller<(${L.map(Zt=>Zt.name).join(", ")}) => ${Z.name}>`,vl(Rs(H,M))}function kn(M){return M=vo(M>>>0),hn(a[M])}function _o(M,L){return L>>>=0,M=Nt(M>>>0),L=Nt(L),hn(M[L])}function yl(M){9<(M>>>=0)&&(ur[M+1]+=1)}function Cu(){return hn([])}function $r(M){M=Nt(M>>>0);for(var L=Array(M.length),H=0;H<M.length;H++)L[H]=M[H];return hn(L)}function es(M){return hn(vo(M>>>0))}function Ds(){return hn({})}function _t(M){for(var L=Nt(M>>>=0);L.length;){var H=L.pop();L.pop()(H)}Ur(M)}function Pr(M,L,H){L>>>=0,H>>>=0,M=Nt(M>>>0),L=Nt(L),H=Nt(H),M[L]=H}function Ls(M,L){return L>>>=0,M=(M=Gi(M>>>0,"_emval_take_value")).readValueFromPointer(L),hn(M)}function zs(M,L){M=-9007199254740992>M||9007199254740992<M?NaN:Number(M),L>>>=0,M=new Date(1e3*M),ne()[L>>>2>>>0]=M.getUTCSeconds(),ne()[L+4>>>2>>>0]=M.getUTCMinutes(),ne()[L+8>>>2>>>0]=M.getUTCHours(),ne()[L+12>>>2>>>0]=M.getUTCDate(),ne()[L+16>>>2>>>0]=M.getUTCMonth(),ne()[L+20>>>2>>>0]=M.getUTCFullYear()-1900,ne()[L+24>>>2>>>0]=M.getUTCDay(),M=(M.getTime()-Date.UTC(M.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,ne()[L+28>>>2>>>0]=M}var Rr=M=>M%4==0&&(M%100!=0||M%400==0),qi=[0,31,60,91,121,152,182,213,244,274,305,335],Hn=[0,31,59,90,120,151,181,212,243,273,304,334];function Au(M,L){M=-9007199254740992>M||9007199254740992<M?NaN:Number(M),L>>>=0,M=new Date(1e3*M),ne()[L>>>2>>>0]=M.getSeconds(),ne()[L+4>>>2>>>0]=M.getMinutes(),ne()[L+8>>>2>>>0]=M.getHours(),ne()[L+12>>>2>>>0]=M.getDate(),ne()[L+16>>>2>>>0]=M.getMonth(),ne()[L+20>>>2>>>0]=M.getFullYear()-1900,ne()[L+24>>>2>>>0]=M.getDay();var H=(Rr(M.getFullYear())?qi:Hn)[M.getMonth()]+M.getDate()-1|0;ne()[L+28>>>2>>>0]=H,ne()[L+36>>>2>>>0]=-60*M.getTimezoneOffset(),H=new Date(M.getFullYear(),6,1).getTimezoneOffset();var Z=new Date(M.getFullYear(),0,1).getTimezoneOffset();M=0|(H!=Z&&M.getTimezoneOffset()==Math.min(Z,H)),ne()[L+32>>>2>>>0]=M}function ku(M){M>>>=0;var L=new Date(ne()[M+20>>>2>>>0]+1900,ne()[M+16>>>2>>>0],ne()[M+12>>>2>>>0],ne()[M+8>>>2>>>0],ne()[M+4>>>2>>>0],ne()[M>>>2>>>0],0),H=ne()[M+32>>>2>>>0],Z=L.getTimezoneOffset(),ae=new Date(L.getFullYear(),6,1).getTimezoneOffset(),Ae=new Date(L.getFullYear(),0,1).getTimezoneOffset(),Qe=Math.min(Ae,ae);return 0>H?ne()[M+32>>>2>>>0]=+(ae!=Ae&&Qe==Z):0<H!=(Qe==Z)&&(ae=Math.max(Ae,ae),L.setTime(L.getTime()+6e4*((0<H?Qe:ae)-Z))),ne()[M+24>>>2>>>0]=L.getDay(),H=(Rr(L.getFullYear())?qi:Hn)[L.getMonth()]+L.getDate()-1|0,ne()[M+28>>>2>>>0]=H,ne()[M>>>2>>>0]=L.getSeconds(),ne()[M+4>>>2>>>0]=L.getMinutes(),ne()[M+8>>>2>>>0]=L.getHours(),ne()[M+12>>>2>>>0]=L.getDate(),ne()[M+16>>>2>>>0]=L.getMonth(),ne()[M+20>>>2>>>0]=L.getYear(),M=L.getTime(),BigInt(isNaN(M)?-1:M/1e3)}function ts(M,L,H,Z,ae,Ae,Qe){return u?nt(16,1,M,L,H,Z,ae,Ae,Qe):-52}function Iu(M,L,H,Z,ae,Ae){if(u)return nt(17,1,M,L,H,Z,ae,Ae)}var Os={},td=()=>performance.timeOrigin+performance.now();function $u(M,L){if(u)return nt(18,1,M,L);if(Os[M]&&(clearTimeout(Os[M].id),delete Os[M]),!L)return 0;var H=setTimeout(()=>{delete Os[M],po(()=>Tl(M,performance.timeOrigin+performance.now()))},L);return Os[M]={id:H,pc:L},0}function bo(M,L,H,Z){M>>>=0,L>>>=0,H>>>=0,Z>>>=0;var ae=new Date().getFullYear(),Ae=new Date(ae,0,1).getTimezoneOffset();ae=new Date(ae,6,1).getTimezoneOffset();var Qe=Math.max(Ae,ae);qe()[M>>>2>>>0]=60*Qe,ne()[L>>>2>>>0]=+(Ae!=ae),M=(L=mt=>{var St=Math.abs(mt);return`UTC${0<=mt?"-":"+"}${String(Math.floor(St/60)).padStart(2,"0")}${String(St%60).padStart(2,"0")}`})(Ae),L=L(ae),ae<Ae?(R(M,H,17),R(L,Z,17)):(R(M,Z,17),R(L,H,17))}var nd=()=>Date.now();function Pu(M,L,H){return 0<=M&&3>=M?(M===0?M=Date.now():M=performance.timeOrigin+performance.now(),he[H>>>0>>>3]=BigInt(Math.round(1e6*M)),0):28}var ns=[],Tn=(M,L)=>{ns.length=0;for(var H;H=ie()[M++>>>0];){var Z=H!=105;L+=(Z&=H!=112)&&L%8?4:0,ns.push(H==112?qe()[L>>>2>>>0]:H==106?he[L>>>3]:H==105?ne()[L>>>2>>>0]:xe()[L>>>3>>>0]),L+=Z?8:4}return ns};function qt(M,L,H){return M>>>=0,L=Tn(L>>>0,H>>>0),ht[M](...L)}function _l(M,L,H){return M>>>=0,L=Tn(L>>>0,H>>>0),ht[M](...L)}var Ns=()=>{};function fa(M,L){return A(bn(M>>>0,L>>>0))}var Ru=()=>{throw tt+=1,"unwind"};function Du(){return 4294901760}var xo=()=>navigator.hardwareConcurrency;function rd(){return We("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function Lu(M){M>>>=0;var L=ie().length;if(M<=L||4294901760<M)return!1;for(var H=1;4>=H;H*=2){var Z=L*(1+.2/H);Z=Math.min(Z,M+100663296);e:{Z=(Math.min(4294901760,65536*Math.ceil(Math.max(M,Z)/65536))-D.buffer.byteLength+65535)/65536|0;try{D.grow(Z),ut();var ae=1;break e}catch{}ae=void 0}if(ae)return!0}return!1}var Ca=()=>(We("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),Aa={},bl=M=>{M.forEach(L=>{Ca()})};function id(){var M=Error().stack.toString().split(`
`);return M[0]=="Error"&&M.shift(),bl(M),Aa.Ob=Ca(),Aa.ec=M,Aa.Ob}function zu(M,L,H){if(M>>>=0,L>>>=0,Aa.Ob==M)var Z=Aa.ec;else(Z=Error().stack.toString().split(`
`))[0]=="Error"&&Z.shift(),bl(Z);for(var ae=3;Z[ae]&&Ca()!=M;)++ae;for(M=0;M<H&&Z[M+ae];++M)ne()[L+4*M>>>2>>>0]=Ca();return M}var wo,rs={},xl=()=>{if(!wo){var M,L={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(M in rs)rs[M]===void 0?delete L[M]:L[M]=rs[M];var H=[];for(M in L)H.push(`${M}=${L[M]}`);wo=H}return wo};function So(M,L){if(u)return nt(19,1,M,L);M>>>=0,L>>>=0;var H=0;return xl().forEach((Z,ae)=>{var Ae=L+H;for(ae=qe()[M+4*ae>>>2>>>0]=Ae,Ae=0;Ae<Z.length;++Ae)ve()[ae++>>>0]=Z.charCodeAt(Ae);ve()[ae>>>0]=0,H+=Z.length+1}),0}function Zr(M,L){if(u)return nt(20,1,M,L);M>>>=0,L>>>=0;var H=xl();qe()[M>>>2>>>0]=H.length;var Z=0;return H.forEach(ae=>Z+=ae.length+1),qe()[L>>>2>>>0]=Z,0}function ha(M){return u?nt(21,1,M):52}function Mo(M,L,H,Z){return u?nt(22,1,M,L,H,Z):52}function wl(M,L,H,Z){return u?nt(23,1,M,L,H,Z):70}var yi=[null,[],[]];function Sl(M,L,H,Z){if(u)return nt(24,1,M,L,H,Z);L>>>=0,H>>>=0,Z>>>=0;for(var ae=0,Ae=0;Ae<H;Ae++){var Qe=qe()[L>>>2>>>0],mt=qe()[L+4>>>2>>>0];L+=8;for(var St=0;St<mt;St++){var It=ie()[Qe+St>>>0],Zt=yi[M];It===0||It===10?((M===1?C:A)(mr(Zt)),Zt.length=0):Zt.push(It)}ae+=mt}return qe()[Z>>>2>>>0]=ae,0}u||function(){for(var M=a.numThreads-1;M--;)Mn();De.unshift(()=>{ke++,function(L){u?L():Promise.all(at.map(on)).then(L)}(()=>Ze())})}();for(var Ml=Array(256),is=0;256>is;++is)Ml[is]=String.fromCharCode(is);_n=Ml,pe=a.BindingError=class extends Error{constructor(M){super(M),this.name="BindingError"}},a.InternalError=class extends Error{constructor(M){super(M),this.name="InternalError"}},ur.push(0,1,void 0,1,null,1,!0,1,!1,1),a.count_emval_handles=()=>ur.length/2-5-Er.length;var Ft,Bs=[xt,be,Rt,Yt,ln,B,ft,I,X,Ve,we,je,Vt,yt,Ot,Gt,ts,Iu,$u,So,Zr,ha,Mo,wl,Sl];(async function(){function M(Z,ae){return Ft=Z.exports,Ft=function(){var Ae=Ft,Qe={};for(let[mt,St]of Object.entries(Ae))Qe[mt]=typeof St=="function"?(...It)=>{gi.push(mt);try{return St(...It)}finally{de||(gi.pop(),Wn&&Sr===1&&gi.length===0&&(Sr=0,tt+=1,Xn(kl),typeof Fibers<"u"&&Fibers.qc()))}}:St;return Qe}(),Ft=function(){var Ae=Ft,Qe=St=>It=>St(It)>>>0,mt=St=>()=>St()>>>0;return(Ae=Object.assign({},Ae)).Da=Qe(Ae.Da),Ae.gb=mt(Ae.gb),Ae.ib=Qe(Ae.ib),Ae.ub=Qe(Ae.ub),Ae.vb=mt(Ae.vb),Ae.__cxa_get_exception_ptr=Qe(Ae.__cxa_get_exception_ptr),Ae}(),kt.push(Ft.jb),O=ae,Ze(),Ft}ke++;var L=gt();if(a.instantiateWasm)return new Promise(Z=>{a.instantiateWasm(L,(ae,Ae)=>{M(ae,Ae),Z(ae.exports)})});if(u)return new Promise(Z=>{ze=ae=>{var Ae=new WebAssembly.Instance(ae,gt());Z(M(Ae,ae))}});me??(me=a.locateFile?a.locateFile?a.locateFile("ort-wasm-simd-threaded.jsep.wasm",b):b+"ort-wasm-simd-threaded.jsep.wasm":new URL("/facet/assets/ort-wasm-simd-threaded.jsep-B5gdmGHs.wasm",import.meta.url).href);try{var H=await async function(Z){var ae=me;if(!_e&&typeof WebAssembly.instantiateStreaming=="function"&&!Oe(ae))try{var Ae=fetch(ae,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(Ae,Z)}catch(Qe){A(`wasm streaming compile failed: ${Qe}`),A("falling back to ArrayBuffer instantiation")}return async function(Qe,mt){try{var St=await async function(It){if(!_e)try{var Zt=await h(It);return new Uint8Array(Zt)}catch{}if(It==me&&_e)It=new Uint8Array(_e);else{if(!v)throw"both async and sync fetching of the wasm failed";It=v(It)}return It}(Qe);return await WebAssembly.instantiate(St,mt)}catch(It){A(`failed to asynchronously prepare wasm: ${It}`),We(It)}}(ae,Z)}(L);return M(H.instance,H.module)}catch(Z){return i(Z),Promise.reject(Z)}})();var Fs=M=>(Fs=Ft.Da)(M),Ou=()=>(Ou=Ft.Ea)();a._OrtInit=(M,L)=>(a._OrtInit=Ft.Fa)(M,L),a._OrtGetLastError=(M,L)=>(a._OrtGetLastError=Ft.Ga)(M,L),a._OrtCreateSessionOptions=(M,L,H,Z,ae,Ae,Qe,mt,St,It)=>(a._OrtCreateSessionOptions=Ft.Ha)(M,L,H,Z,ae,Ae,Qe,mt,St,It),a._OrtAppendExecutionProvider=(M,L)=>(a._OrtAppendExecutionProvider=Ft.Ia)(M,L),a._OrtAddFreeDimensionOverride=(M,L,H)=>(a._OrtAddFreeDimensionOverride=Ft.Ja)(M,L,H),a._OrtAddSessionConfigEntry=(M,L,H)=>(a._OrtAddSessionConfigEntry=Ft.Ka)(M,L,H),a._OrtReleaseSessionOptions=M=>(a._OrtReleaseSessionOptions=Ft.La)(M),a._OrtCreateSession=(M,L,H)=>(a._OrtCreateSession=Ft.Ma)(M,L,H),a._OrtReleaseSession=M=>(a._OrtReleaseSession=Ft.Na)(M),a._OrtGetInputOutputCount=(M,L,H)=>(a._OrtGetInputOutputCount=Ft.Oa)(M,L,H),a._OrtGetInputName=(M,L)=>(a._OrtGetInputName=Ft.Pa)(M,L),a._OrtGetOutputName=(M,L)=>(a._OrtGetOutputName=Ft.Qa)(M,L),a._OrtFree=M=>(a._OrtFree=Ft.Ra)(M),a._OrtCreateTensor=(M,L,H,Z,ae,Ae)=>(a._OrtCreateTensor=Ft.Sa)(M,L,H,Z,ae,Ae),a._OrtGetTensorData=(M,L,H,Z,ae)=>(a._OrtGetTensorData=Ft.Ta)(M,L,H,Z,ae),a._OrtReleaseTensor=M=>(a._OrtReleaseTensor=Ft.Ua)(M),a._OrtCreateRunOptions=(M,L,H,Z)=>(a._OrtCreateRunOptions=Ft.Va)(M,L,H,Z),a._OrtAddRunConfigEntry=(M,L,H)=>(a._OrtAddRunConfigEntry=Ft.Wa)(M,L,H),a._OrtReleaseRunOptions=M=>(a._OrtReleaseRunOptions=Ft.Xa)(M),a._OrtCreateBinding=M=>(a._OrtCreateBinding=Ft.Ya)(M),a._OrtBindInput=(M,L,H)=>(a._OrtBindInput=Ft.Za)(M,L,H),a._OrtBindOutput=(M,L,H,Z)=>(a._OrtBindOutput=Ft._a)(M,L,H,Z),a._OrtClearBoundOutputs=M=>(a._OrtClearBoundOutputs=Ft.$a)(M),a._OrtReleaseBinding=M=>(a._OrtReleaseBinding=Ft.ab)(M),a._OrtRunWithBinding=(M,L,H,Z,ae)=>(a._OrtRunWithBinding=Ft.bb)(M,L,H,Z,ae),a._OrtRun=(M,L,H,Z,ae,Ae,Qe,mt)=>(a._OrtRun=Ft.cb)(M,L,H,Z,ae,Ae,Qe,mt),a._OrtEndProfiling=M=>(a._OrtEndProfiling=Ft.db)(M),a._JsepOutput=(M,L,H)=>(a._JsepOutput=Ft.eb)(M,L,H),a._JsepGetNodeName=M=>(a._JsepGetNodeName=Ft.fb)(M);var Eo=()=>(Eo=Ft.gb)(),_i=a._free=M=>(_i=a._free=Ft.hb)(M),as=a._malloc=M=>(as=a._malloc=Ft.ib)(M),Us=(M,L,H,Z,ae,Ae)=>(Us=Ft.lb)(M,L,H,Z,ae,Ae),To=()=>(To=Ft.mb)(),pa=(M,L,H,Z,ae)=>(pa=Ft.nb)(M,L,H,Z,ae),El=M=>(El=Ft.ob)(M),Co=M=>(Co=Ft.pb)(M),Tl=(M,L)=>(Tl=Ft.qb)(M,L),ss=()=>(ss=Ft.rb)(),Nu=(M,L)=>(Nu=Ft.sb)(M,L),Ao=M=>(Ao=Ft.tb)(M),Cl=M=>(Cl=Ft.ub)(M),ko=()=>(ko=Ft.vb)(),Bu=a.dynCall_ii=(M,L)=>(Bu=a.dynCall_ii=Ft.wb)(M,L),Al=M=>(Al=Ft.xb)(M),kl=()=>(kl=Ft.yb)(),Fu=M=>(Fu=Ft.zb)(M),Di=()=>(Di=Ft.Ab)();return a.stackSave=()=>ko(),a.stackRestore=M=>Ao(M),a.stackAlloc=M=>Cl(M),a.setValue=function(M,L,H="i8"){switch(H.endsWith("*")&&(H="*"),H){case"i1":case"i8":ve()[M>>>0]=L;break;case"i16":Pe()[M>>>1>>>0]=L;break;case"i32":ne()[M>>>2>>>0]=L;break;case"i64":he[M>>>3]=BigInt(L);break;case"float":ge()[M>>>2>>>0]=L;break;case"double":xe()[M>>>3>>>0]=L;break;case"*":qe()[M>>>2>>>0]=L;break;default:We(`invalid type for setValue: ${H}`)}},a.getValue=function(M,L="i8"){switch(L.endsWith("*")&&(L="*"),L){case"i1":case"i8":return ve()[M>>>0];case"i16":return Pe()[M>>>1>>>0];case"i32":return ne()[M>>>2>>>0];case"i64":return he[M>>>3];case"float":return ge()[M>>>2>>>0];case"double":return xe()[M>>>3>>>0];case"*":return qe()[M>>>2>>>0];default:We(`invalid type for getValue: ${L}`)}},a.UTF8ToString=bn,a.stringToUTF8=R,a.lengthBytesUTF8=sn,function M(){if(0<ke)Xe=M;else if(u)r(a),ce();else{for(;0<De.length;)De.shift()(a);0<ke?Xe=M:(a.calledRun=!0,de||(ce(),r(a)))}}(),a.PTR_SIZE=4,s}),k7=fg,w3=(e=(t=globalThis.self)==null?void 0:t.name)==null?void 0:e.startsWith("em-pthread"),w3&&fg()}),hg,S3,Ji,I7,a0,M3,E3,pg,T3,mg,$7,gg,P7,vy=bt(()=>{gy(),hg=typeof location>"u"?void 0:location.origin,S3=()=>{var t;return(t=import.meta.url)!=null&&t.startsWith("file:")?new URL(new URL("/facet/assets/ort.bundle.min-DVT1aZ7z.mjs",import.meta.url).href,hg).href:import.meta.url},Ji=S3(),I7=()=>{if(Ji&&!Ji.startsWith("blob:"))return Ji.substring(0,Ji.lastIndexOf("/")+1)},a0=(t,e)=>{try{let n=e??Ji;return(n?new URL(t,n):new URL(t)).origin===hg}catch{return!1}},M3=(t,e)=>{let n=e??Ji;try{return(n?new URL(t,n):new URL(t)).href}catch{return}},E3=(t,e)=>`${e??"./"}${t}`,pg=async t=>{let e=await(await fetch(t,{credentials:"same-origin"})).blob();return URL.createObjectURL(e)},T3=async t=>(await import(t)).default,mg=(iU(),Z0(T7)).default,$7=async()=>{if(!Ji)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(a0(Ji))return[void 0,mg()];let t=await pg(Ji);return[t,mg(t)]},gg=(aU(),Z0(A7)).default,P7=async(t,e,n)=>{if(!t&&!e&&gg&&Ji&&a0(Ji))return[void 0,gg];{let r="ort-wasm-simd-threaded.jsep.mjs",i=t??M3(r,e),a=n&&i&&!a0(i,e),s=a?await pg(i):i??E3(r,e);return[a?s:void 0,await T3(s)]}}}),vg,s0,Ld,yg,C3,A3,yy,Dr,xu=bt(()=>{vy(),s0=!1,Ld=!1,yg=!1,C3=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},A3=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},yy=async t=>{if(s0)return Promise.resolve();if(Ld)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(yg)throw new Error("previous call to 'initializeWebAssembly()' failed.");Ld=!0;let e=t.initTimeout,n=t.numThreads;if(!A3())throw new Error("WebAssembly SIMD is not supported in the current environment.");let r=C3();n>1&&!r&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+n+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),t.numThreads=n=1);let i=t.wasmPaths,a=typeof i=="string"?i:void 0,s=i==null?void 0:i.mjs,o=(s==null?void 0:s.href)??s,l=i==null?void 0:i.wasm,u=(l==null?void 0:l.href)??l,c=t.wasmBinary,[d,h]=await P7(o,a,n>1),v=!1,x=[];if(e>0&&x.push(new Promise(_=>{setTimeout(()=>{v=!0,_()},e)})),x.push(new Promise((_,b)=>{let S={numThreads:n};if(c)S.wasmBinary=c;else if(u||a)S.locateFile=E=>u??a+E;else if(o&&o.indexOf("blob:")!==0)S.locateFile=E=>new URL(E,o).href;else if(d){let E=I7();E&&(S.locateFile=C=>E+C)}h(S).then(E=>{Ld=!1,s0=!0,vg=E,_(),d&&URL.revokeObjectURL(d)},E=>{Ld=!1,yg=!0,b(E)})})),await Promise.race(x),v)throw new Error(`WebAssembly backend initializing failed due to timeout: ${e}ms`)},Dr=()=>{if(s0&&vg)return vg;throw new Error("WebAssembly is not initialized yet.")}}),ei,Q0,Vn,_y=bt(()=>{xu(),ei=(t,e)=>{let n=Dr(),r=n.lengthBytesUTF8(t)+1,i=n._malloc(r);return n.stringToUTF8(t,i,r),e.push(i),i},Q0=(t,e,n,r)=>{if(typeof t=="object"&&t!==null){if(n.has(t))throw new Error("Circular reference in options");n.add(t)}Object.entries(t).forEach(([i,a])=>{let s=e?e+i:i;if(typeof a=="object")Q0(a,s+".",n,r);else if(typeof a=="string"||typeof a=="number")r(s,a.toString());else if(typeof a=="boolean")r(s,a?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof a}`)})},Vn=t=>{let e=Dr(),n=e.stackSave();try{let r=e.PTR_SIZE,i=e.stackAlloc(2*r);e._OrtGetLastError(i,i+r);let a=Number(e.getValue(i,r===4?"i32":"i64")),s=e.getValue(i+r,"*"),o=s?e.UTF8ToString(s):"";throw new Error(`${t} ERROR_CODE: ${a}, ERROR_MESSAGE: ${o}`)}finally{e.stackRestore(n)}}}),R7,sU=bt(()=>{xu(),_y(),R7=t=>{let e=Dr(),n=0,r=[],i=t||{};try{if((t==null?void 0:t.logSeverityLevel)===void 0)i.logSeverityLevel=2;else if(typeof t.logSeverityLevel!="number"||!Number.isInteger(t.logSeverityLevel)||t.logSeverityLevel<0||t.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${t.logSeverityLevel}`);if((t==null?void 0:t.logVerbosityLevel)===void 0)i.logVerbosityLevel=0;else if(typeof t.logVerbosityLevel!="number"||!Number.isInteger(t.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${t.logVerbosityLevel}`);(t==null?void 0:t.terminate)===void 0&&(i.terminate=!1);let a=0;return(t==null?void 0:t.tag)!==void 0&&(a=ei(t.tag,r)),n=e._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,a),n===0&&Vn("Can't create run options."),(t==null?void 0:t.extra)!==void 0&&Q0(t.extra,"",new WeakSet,(s,o)=>{let l=ei(s,r),u=ei(o,r);e._OrtAddRunConfigEntry(n,l,u)!==0&&Vn(`Can't set a run config entry: ${s} - ${o}.`)}),[n,r]}catch(a){throw n!==0&&e._OrtReleaseRunOptions(n),r.forEach(s=>e._free(s)),a}}}),k3,I3,$3,P3,D7,oU=bt(()=>{xu(),_y(),k3=t=>{switch(t){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${t}`)}},I3=t=>{switch(t){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${t}`)}},$3=t=>{t.extra||(t.extra={}),t.extra.session||(t.extra.session={});let e=t.extra.session;e.use_ort_model_bytes_directly||(e.use_ort_model_bytes_directly="1"),t.executionProviders&&t.executionProviders.some(n=>(typeof n=="string"?n:n.name)==="webgpu")&&(t.enableMemPattern=!1)},P3=(t,e,n)=>{for(let r of e){let i=typeof r=="string"?r:r.name;switch(i){case"webnn":if(i="WEBNN",typeof r!="string"){let s=r==null?void 0:r.deviceType;if(s){let o=ei("deviceType",n),l=ei(s,n);Dr()._OrtAddSessionConfigEntry(t,o,l)!==0&&Vn(`Can't set a session config entry: 'deviceType' - ${s}.`)}}break;case"webgpu":if(i="JS",typeof r!="string"){let s=r;if(s!=null&&s.preferredLayout){if(s.preferredLayout!=="NCHW"&&s.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${s.preferredLayout}`);let o=ei("preferredLayout",n),l=ei(s.preferredLayout,n);Dr()._OrtAddSessionConfigEntry(t,o,l)!==0&&Vn(`Can't set a session config entry: 'preferredLayout' - ${s.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${i}`)}let a=ei(i,n);Dr()._OrtAppendExecutionProvider(t,a)!==0&&Vn(`Can't append execution provider: ${i}.`)}},D7=t=>{let e=Dr(),n=0,r=[],i=t||{};$3(i);try{let a=k3(i.graphOptimizationLevel??"all"),s=I3(i.executionMode??"sequential"),o=typeof i.logId=="string"?ei(i.logId,r):0,l=i.logSeverityLevel??2;if(!Number.isInteger(l)||l<0||l>4)throw new Error(`log serverity level is not valid: ${l}`);let u=i.logVerbosityLevel??0;if(!Number.isInteger(u)||u<0||u>4)throw new Error(`log verbosity level is not valid: ${u}`);let c=typeof i.optimizedModelFilePath=="string"?ei(i.optimizedModelFilePath,r):0;if(n=e._OrtCreateSessionOptions(a,!!i.enableCpuMemArena,!!i.enableMemPattern,s,!!i.enableProfiling,0,o,l,u,c),n===0&&Vn("Can't create session options."),i.executionProviders&&P3(n,i.executionProviders,r),i.enableGraphCapture!==void 0){if(typeof i.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${i.enableGraphCapture}`);let d=ei("enableGraphCapture",r),h=ei(i.enableGraphCapture.toString(),r);e._OrtAddSessionConfigEntry(n,d,h)!==0&&Vn(`Can't set a session config entry: 'enableGraphCapture' - ${i.enableGraphCapture}.`)}if(i.freeDimensionOverrides)for(let[d,h]of Object.entries(i.freeDimensionOverrides)){if(typeof d!="string")throw new Error(`free dimension override name must be a string: ${d}`);if(typeof h!="number"||!Number.isInteger(h)||h<0)throw new Error(`free dimension override value must be a non-negative integer: ${h}`);let v=ei(d,r);e._OrtAddFreeDimensionOverride(n,v,h)!==0&&Vn(`Can't set a free dimension override: ${d} - ${h}.`)}return i.extra!==void 0&&Q0(i.extra,"",new WeakSet,(d,h)=>{let v=ei(d,r),x=ei(h,r);e._OrtAddSessionConfigEntry(n,v,x)!==0&&Vn(`Can't set a session config entry: ${d} - ${h}.`)}),[n,r]}catch(a){throw n!==0&&e._OrtReleaseSessionOptions(n)!==0&&Vn("Can't release session options."),r.forEach(s=>e._free(s)),a}}}),vc,Yl,Zl,by,ep,xy,wy,Hv,Qt=bt(()=>{vc=t=>{switch(t){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${t}`)}},Yl=t=>{switch(t){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${t}`)}},Zl=(t,e)=>{let n=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][t],r=typeof e=="number"?e:e.reduce((i,a)=>i*a,1);return n>0?Math.ceil(r*n):void 0},by=t=>{switch(t){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${t}`)}},ep=t=>{switch(t){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${t}`)}},xy=t=>t==="float32"||t==="float16"||t==="int32"||t==="int64"||t==="uint32"||t==="uint8"||t==="bool"||t==="uint4"||t==="int4",wy=t=>t==="float32"||t==="float16"||t==="int32"||t==="int64"||t==="uint32"||t==="uint64"||t==="int8"||t==="uint8"||t==="bool"||t==="uint4"||t==="int4",Hv=t=>{switch(t){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${t}`)}}}),Sy,L7=bt(()=>{gy(),Sy=async t=>{if(typeof t=="string"){let e=await fetch(t);if(!e.ok)throw new Error(`failed to load external data file: ${t}`);let n=e.headers.get("Content-Length"),r=n?parseInt(n,10):0;if(r<1073741824)return new Uint8Array(await e.arrayBuffer());{if(!e.body)throw new Error(`failed to load external data file: ${t}, no response body.`);let i=e.body.getReader(),a;try{a=new ArrayBuffer(r)}catch(o){if(o instanceof RangeError){let l=Math.ceil(r/65536);a=new WebAssembly.Memory({initial:l,maximum:l}).buffer}else throw o}let s=0;for(;;){let{done:o,value:l}=await i.read();if(o)break;let u=l.byteLength;new Uint8Array(a,s,u).set(l),s+=u}return new Uint8Array(a,0,r)}}else return t instanceof Blob?new Uint8Array(await t.arrayBuffer()):t instanceof Uint8Array?t:new Uint8Array(t)}}),R3,D3,L3,z3,My,O3,Ln,co=bt(()=>{Qt(),R3=["V","I","W","E","F"],D3=(t,e)=>{console.log(`[${R3[t]},${new Date().toISOString()}]${e}`)},My=(t,e)=>{L3=t,z3=e},O3=(t,e)=>{let n=ep(t),r=ep(L3);n>=r&&D3(n,typeof e=="function"?e():e)},Ln=(...t)=>{z3&&O3(...t)}}),Ey,z7=bt(()=>{Qt(),Ey=(t,e)=>new(by(e))(t)}),Ty=bt(()=>{}),_g,o0,l0,N3,B3,bg,Wv,F3,O7,lU=bt(()=>{co(),Ty(),_g=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),o0=[],l0=t=>Math.ceil(Number(t)/16)*16,N3=t=>{for(let e=0;e<o0.length;e++){let n=o0[e];if(t<=n)return n}return Math.ceil(t/16)*16},B3=1,bg=()=>B3++,Wv=async(t,e,n,r)=>{let i=l0(n),a=t.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let s=t.getCommandEncoder();t.endComputePass(),s.copyBufferToBuffer(e,0,a,0,i),t.flush(),await a.mapAsync(GPUMapMode.READ);let o=a.getMappedRange();if(r){let l=r();return l.set(new Uint8Array(o,0,n)),l}else return new Uint8Array(o.slice(0,n))}finally{a.destroy()}},F3=class{constructor(t){this.backend=t,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[e]of _g)o0.push(e),this.freeBuffers.set(e,[]),this.freeUniformBuffers.set(e,[]);this.sessionCount=0}upload(t,e){let n=e.buffer,r=e.byteOffset,i=e.byteLength,a=l0(i),s=this.storageCache.get(t);if(!s)throw new Error("gpu data for uploading does not exist");if(Number(s.originalSize)!==i)throw new Error(`inconsistent data size. gpu data size=${s.originalSize}, data size=${i}`);let o=this.backend.device.createBuffer({mappedAtCreation:!0,size:a,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),l=o.getMappedRange();new Uint8Array(l).set(new Uint8Array(n,r,i)),o.unmap();let u=this.backend.device.createCommandEncoder();u.copyBufferToBuffer(o,0,s.gpuData.buffer,0,a),this.backend.device.queue.submit([u.finish()]),o.destroy(),Ln("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${t})`)}memcpy(t,e){let n=this.storageCache.get(t);if(!n)throw new Error("source gpu data for memcpy does not exist");let r=this.storageCache.get(e);if(!r)throw new Error("destination gpu data for memcpy does not exist");if(n.originalSize!==r.originalSize)throw new Error("inconsistent source and destination gpu data size");let i=l0(n.originalSize),a=this.backend.getCommandEncoder();this.backend.endComputePass(),a.copyBufferToBuffer(n.gpuData.buffer,0,r.gpuData.buffer,0,i)}registerExternalBuffer(t,e,n){let r;if(n){if(r=n[0],t===n[1])return Ln("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${e}) => id=${r}, buffer is the same, skip.`),r;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else r=bg();return this.storageCache.set(r,{gpuData:{id:r,type:0,buffer:t},originalSize:e}),Ln("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${e}) => id=${r}, registered.`),r}unregisterExternalBuffer(t){t!==void 0&&(this.storageCache.delete(t),Ln("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${t}`))}create(t,e=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let n=N3(t),r,i=(e&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,a=(e&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(i||a){let o=(i?this.freeBuffers:this.freeUniformBuffers).get(n);o?o.length>0?r=o.pop():r=this.backend.device.createBuffer({size:n,usage:e}):r=this.backend.device.createBuffer({size:n,usage:e})}else r=this.backend.device.createBuffer({size:n,usage:e});let s={id:bg(),type:0,buffer:r};return this.storageCache.set(s.id,{gpuData:s,originalSize:Number(t)}),Ln("verbose",()=>`[WebGPU] GpuDataManager.create(size=${t}) => id=${s.id}`),s}get(t){var e;return(e=this.storageCache.get(t))==null?void 0:e.gpuData}release(t){let e=typeof t=="bigint"?Number(t):t,n=this.storageCache.get(e);if(!n){if(this.storageCache.size===0)return 0;throw new Error("releasing data does not exist")}return Ln("verbose",()=>`[WebGPU] GpuDataManager.release(id=${e}), gpuDataId=${n.gpuData.id}`),this.storageCache.delete(e),this.buffersPending.push(n.gpuData.buffer),n.originalSize}async download(t,e){let n=this.storageCache.get(Number(t));if(!n)throw new Error("data does not exist");await Wv(this.backend,n.gpuData.buffer,n.originalSize,e)}refreshPendingBuffers(){if(this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let t of this.buffersPending){let e=_g.get(t.size);if((t.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let n=this.freeBuffers.get(t.size)||[];e===void 0||n.length>=e?t.destroy():n.push(t)}else if((t.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let n=this.freeUniformBuffers.get(t.size)||[];e===void 0||n.length>=e?t.destroy():n.push(t)}else t.destroy()}this.buffersPending=[]}else{let t=this.capturedPendingBuffers.get(this.backend.currentSessionId);t||(t=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,t));for(let e of this.buffersPending)t.push(e);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(t=>{t.forEach(e=>{e.destroy()})}),this.freeUniformBuffers.forEach(t=>{t.forEach(e=>{e.destroy()})}),this.storageCache.forEach(t=>{t.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(t=>{t.forEach(e=>{e.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(t){let e=this.capturedPendingBuffers.get(t);e&&(e.forEach(n=>{n.destroy()}),this.capturedPendingBuffers.delete(t)),this.sessionCount-=1,this.sessionCount===0&&(Ln("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(n=>{n.gpuData.buffer.destroy()}),this.storageCache=new Map)}},O7=(...t)=>new F3(...t)}),U3,qn,xr=bt(()=>{U3=class{constructor(t){Object.assign(this,t)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(t=>`${this[t]}`).join(";")),this.key}},qn=t=>new U3(t)}),V3,Uc,Ye,tp,N7,B7,F7,dn=bt(()=>{V3=class{static calcMatMulShape(t,e){return t[1]!==e[0]?void 0:[t[0],e[1]]}},Uc=class{static calcShape(t,e,n=!1){let r=t.length,i=e.length;if(r===0)return e;if(i===0)return t;let a=Math.max(t.length,e.length),s=new Array(a);if(n){if(r<2||i<2)return;let o=V3.calcMatMulShape([t[r-2],t[r-1]],[e[i-2],e[i-1]]);if(o===void 0)return;[s[a-2],s[a-1]]=o}for(let o=n?3:1;o<=a;o++){let l=r-o<0?1:t[r-o],u=i-o<0?1:e[i-o];if(l!==u&&l>1&&u>1)return;let c=Math.max(l,u);if(l&&u)s[a-o]=Math.max(l,u);else{if(c>1)return;s[a-o]=0}}return s}static isValidBroadcast(t,e){let n=t.length,r=e.length;if(n>r)return!1;for(let i=1;i<=n;i++)if(t[n-i]!==1&&t[n-i]!==e[r-i])return!1;return!0}},Ye=class T0{static size(e){return T0.getSizeFromDimensionRange(e,0,e.length)}static convertShape(e,n=4){let r=e.length;if(r===0)return[];let i=new Array(r),a=r-1;for(;a>=0;){if(e[a]%n===0){i[a]=e[a]/n;break}if(n%e[a]!==0)throw new Error("cannot convert shape");i[a]=1,n/=e[a],a--}for(a--;a>=0;a--)i[a]=e[a];return i}static sizeFromDimension(e,n){if(n<0||n>e.length)throw new Error(`invalid dimension of ${n} for sizeFromDimension as Tensor has ${e.length} dimensions.`);return T0.getSizeFromDimensionRange(e,n,e.length)}static sizeToDimension(e,n){if(n<0||n>e.length)throw new Error(`invalid dimension of ${n} for sizeToDimension as Tensor has ${e.length} dimensions.`);return T0.getSizeFromDimensionRange(e,0,n)}static getSizeFromDimensionRange(e,n,r){let i=1;for(let a=n;a<r;a++){if(e[a]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");i*=Number(e[a])}return i}static computeStrides(e){let n=e.length;if(n===0)return[];if(n===1)return[1];let r=new Array(n);r[n-1]=1,r[n-2]=e[n-1];for(let i=n-3;i>=0;--i)r[i]=r[i+1]*e[i+1];return r}static normalizeAxis(e,n){if(e<-n&&e>=n)throw new Error("unsupported axis for this operation.");return e<0?e+n:e}static normalizeAxes(e,n){return e.map(r=>this.normalizeAxis(r,n??e.length))}static sortBasedOnPerm(e,n){return n?n.map(r=>e[r]):e.slice().reverse()}static padShape(e,n){let r=e.length;return e.map((i,a)=>i+n[a]+n[a+r])}static areEqual(e,n){return e.length!==n.length?!1:e.every((r,i)=>r===n[i])}},tp=class Kd{static adjustPoolAttributes(e,n,r,i,a,s){if(!e&&r.length!==n.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let o=0;o<n.length-2;o++)o>=r.length?r.push(n[o+2]):r[o]=n[o+2];for(let o=0;o<r.length;o++)if(o<i.length){if(i[o]<0)throw new Error("strides should be greater than or equal to 1")}else i.push(1);for(let o=0;o<r.length;o++)if(o<a.length){if(a[o]<0)throw new Error("dilations should be greater than or equal to 1")}else a.push(1);for(let o=0;o<r.length*2;o++)if(o<s.length){if(s[o]<0)throw new Error("pad should be greater than or equal to 1")}else s.push(0);for(let o=0;o<r.length;o++){if(r[o]<=0)throw new Error("kernel shapes need to be greater than 0");if(s[o]>=r[o]||s[o+r.length]>=r[o])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(e,n,r,i,a,s,o){if(o){if(a.length!==2*(e.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(n.length!==e.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==e.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let l=0;l<e.length-2;l++)Kd.adjustPadAndReturnShape(e[l+(s?1:2)],n[l],r[l],i[l],a,l,l+e.length-2,o)}}static computePoolOutputShape(e,n,r,i,a,s,o){if(n.length<=0)throw new Error("input shape must be of size greater than 0");let l=[n[0],n[1]];return Kd.computeShapeHelper(e,n,l,r,i,a,s,o),l}static computeConvOutputShape(e,n,r,i,a,s,o){if(e.length<=0||n.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let l=[e[0],n[0]];return Kd.computeShapeHelper(!1,e,l,r,i,a,s,o),l}static computeShapeHelper(e,n,r,i,a,s,o,l){if(e)for(let u=0;u<n.length-2;u++)r.push(1);else for(let u=0;u<n.length-2;u++)r.push(Kd.adjustPadAndReturnShape(n[u+2],i[u],a[u],s[u],o,u,u+n.length-2,l))}static adjustPadAndReturnShape(e,n,r,i,a,s,o,l){let u=r*(i-1)+1;if(l&&l!=="NOTSET")switch(l){case"VALID":return a[s]=0,a[o]=0,Math.floor((e-u)/n+1);case"SAME_LOWER":case"SAME_UPPER":if(r!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let c=((e+n-1)/n-1)*n+i-e;return a[s]=Math.floor(l==="SAME_LOWER"?(c+1)/2:c/2),a[o]=c-a[s],Math.floor((e+c-i)/n+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((e+a[s]+a[o]-u)/n+1)}},N7=class{static getShapeOfGemmResult(t,e,n,r,i){if(t.length!==2||n.length!==2)throw new Error("shape need to be of size 2");let a,s,o;e?(a=t[1],s=t[0]):(a=t[0],s=t[1]);let l=-1;if(r?(o=n[0],l=1):(o=n[1],l=0),n[l]!==s)throw new Error("dimension mismatch");if(a<=0||o<=0||s<=0)throw new Error("invalid shape specified");if(i&&!Uc.isValidBroadcast(i,[a,o]))throw new Error("gemm: invalid bias shape for broadcast");return[a,o,s]}},B7=-34028234663852886e22,F7=34028234663852886e22}),Vc,u0,zr,ci,Ht,hr,Gv,wc,sl,Ut,zd,rt,Bt,U7,Cy,H3,V7,gn=bt(()=>{Qt(),dn(),Vc=64,u0=(t,e)=>{if(e===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(t)){case 10:return e>1?`vec${e}<f16>`:"f16";case 1:return e>1?`vec${e}<f32>`:"f32";case 6:return e>1?`vec${e}<i32>`:"i32";case 12:return e>1?`vec${e}<u32>`:"u32";case 7:if(e>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(e>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(e!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error(`Unknown data type: ${t}`)}},zr=(t,e=1)=>{let n=u0(t,e);return typeof n=="string"?n:n[0]},ci=(t,e=1)=>{let n=u0(t,e);return typeof n=="string"?n:n[1]},Ht=(...t)=>{let e=[];return t.forEach(n=>{n.length!==0&&e.push({type:12,data:n},{type:12,data:Ye.computeStrides(n)})}),e},hr=t=>t%4===0?4:t%2===0?2:1,Gv=(t="f32",e,n="0")=>!e||e===1?`${t}(${n})`:`vec${e}<${t}>(${n})`,wc=(t,e,n)=>t==="f32"?n:e===1?`f32(${n})`:`vec${e}<f32>(${n})`,sl=(t,e)=>e===4?`(${t}.x + ${t}.y + ${t}.z + ${t}.w)`:e===2?`(${t}.x + ${t}.y)`:e===3?`(${t}.x + ${t}.y + ${t}.z)`:t,Ut=(t,e,n,r)=>t.startsWith("uniforms.")&&n>4?typeof e=="string"?r==="f16"?`${t}[(${e}) / 8][(${e}) % 8 / 4][(${e}) % 8 % 4]`:`${t}[(${e}) / 4][(${e}) % 4]`:r==="f16"?`${t}[${Math.floor(e/8)}][${Math.floor(e%8/4)}][${e%8%4}]`:`${t}[${Math.floor(e/4)}][${e%4}]`:n>1?`${t}[${e}]`:t,zd=(t,e,n,r,i)=>{let a=typeof n=="number",s=a?n:n.length,o=[...new Array(s).keys()],l=s<2?"u32":s<=4?`vec${s}<u32>`:`array<u32, ${s}>`,u=u0(e,i),c=typeof u=="string"?u:u[1],d=typeof u=="string"?u:u[0],h={indices:l,value:c,storage:d,tensor:e},v=ve=>typeof ve=="string"?ve:`${ve}u`,x={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},_=a?"uniforms.":"",b=`${_}${t}_shape`,S=`${_}${t}_strides`,E="";for(let ve=0;ve<s-1;ve++)E+=`
    let dim${ve} = current / ${Ut(S,ve,s)};
    let rest${ve} = current % ${Ut(S,ve,s)};
    indices[${ve}] = dim${ve};
    current = rest${ve};
    `;E+=`indices[${s-1}] = current;`;let C=s<2?"":`
  fn o2i_${t}(offset: u32) -> ${h.indices} {
    var indices: ${h.indices};
    var current = offset;
    ${E}
    return indices;
  }`,A=ve=>(x.offsetToIndices=!0,s<2?ve:`o2i_${t}(${ve})`),D=[];if(s>=2)for(let ve=s-1;ve>=0;ve--)D.push(`${Ut(S,ve,s)} * (indices[${ve}])`);let O=s<2?"":`
  fn i2o_${t}(indices: ${h.indices}) -> u32 {
    return ${D.join("+")};
  }`,V=ve=>(x.indicesToOffset=!0,s<2?ve:`i2o_${t}(${ve})`),P=(...ve)=>s===0?"0u":`${h.indices}(${ve.map(v).join(",")})`,U=(ve,ie)=>s<2?`${ve}`:`${Ut(ve,ie,s)}`,Y=(ve,ie,Pe)=>s<2?`${ve}=${Pe};`:`${Ut(ve,ie,s)}=${Pe};`,fe={},Q=(ve,ie)=>{x.broadcastedIndicesToOffset=!0;let Pe=`${ie.name}broadcastedIndicesTo${t}Offset`;if(Pe in fe)return`${Pe}(${ve})`;let et=[];for(let ne=s-1;ne>=0;ne--){let qe=ie.indicesGet("outputIndices",ne+ie.rank-s);et.push(`${U(S,ne)} * (${qe} % ${U(b,ne)})`)}return fe[Pe]=`fn ${Pe}(outputIndices: ${ie.type.indices}) -> u32 {
             return ${et.length>0?et.join("+"):"0u"};
           }`,`${Pe}(${ve})`},G=(ve,ie)=>(()=>{if(h.storage===h.value)return`${t}[${ve}]=${ie};`;if(h.storage==="vec2<u32>"&&h.value==="i32")return`${t}[${ve}]=vec2<u32>(u32(${ie}), select(0u, 0xFFFFFFFFu, ${ie} < 0));`;if(h.storage==="vec2<u32>"&&h.value==="u32")return`${t}[${ve}]=vec2<u32>(u32(${ie}), 0u);`;if(h.storage==="u32"&&h.value==="vec4<bool>")return`${t}[${ve}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${ie}));`;throw new Error(`not supported combination of storage type ${h.storage} and value type ${h.value} yet`)})(),re=ve=>(()=>{if(h.storage===h.value)return`${t}[${ve}]`;if(h.storage==="vec2<u32>"&&h.value==="i32")return`i32(${t}[${ve}].x)`;if(h.storage==="vec2<u32>"&&h.value==="u32")return`u32(${t}[${ve}].x)`;if(h.storage==="u32"&&h.value==="vec4<bool>")return`vec4<bool>(bool(${t}[${ve}] & 0xFFu), bool(${t}[${ve}] & 0xFF00u), bool(${t}[${ve}] & 0xFF0000u), bool(${t}[${ve}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${h.storage} and value type ${h.value} yet`)})(),he=s<2?"":`
  fn get_${t}ByIndices(indices: ${h.indices}) -> ${c} {
    return ${re(`i2o_${t}(indices)`)};
  }`,ye=s<2?"":(()=>{let ve=o.map(Pe=>`d${Pe}: u32`).join(", "),ie=o.map(Pe=>`d${Pe}`).join(", ");return`
  fn get_${t}(${ve}) -> ${c} {
    return get_${t}ByIndices(${P(ie)});
  }`})(),$e=(...ve)=>{if(ve.length!==s)throw new Error(`indices length must be ${s}`);let ie=ve.map(v).join(",");return s===0?re("0u"):s===1?re(ie[0]):(x.get=!0,x.getByIndices=!0,x.indicesToOffset=!0,`get_${t}(${ie})`)},_e=ve=>s<2?re(ve):(x.getByIndices=!0,x.indicesToOffset=!0,`get_${t}ByIndices(${ve})`),de=s<2?"":`
  fn set_${t}ByIndices(indices: ${h.indices}, value: ${c}) {
    ${G(`i2o_${t}(indices)`,"value")}
  }`,Oe=s<2?"":(()=>{let ve=o.map(Pe=>`d${Pe}: u32`).join(", "),ie=o.map(Pe=>`d${Pe}`).join(", ");return`
  fn set_${t}(${ve}, value: ${c}) {
    set_${t}ByIndices(${P(ie)}, value);
  }`})();return{impl:()=>{let ve=[],ie=!1;return x.offsetToIndices&&(ve.push(C),ie=!0),x.indicesToOffset&&(ve.push(O),ie=!0),x.broadcastedIndicesToOffset&&(Object.values(fe).forEach(Pe=>ve.push(Pe)),ie=!0),x.set&&(ve.push(Oe),ie=!0),x.setByIndices&&(ve.push(de),ie=!0),x.get&&(ve.push(ye),ie=!0),x.getByIndices&&(ve.push(he),ie=!0),!a&&ie&&ve.unshift(`const ${b} = ${h.indices}(${n.join(",")});`,`const ${S} = ${h.indices}(${Ye.computeStrides(n).join(",")});`),ve.join(`
`)},type:h,offsetToIndices:A,indicesToOffset:V,broadcastedIndicesToOffset:Q,indices:P,indicesGet:U,indicesSet:Y,set:(...ve)=>{if(ve.length!==s+1)throw new Error(`indices length must be ${s}`);let ie=ve[s];if(typeof ie!="string")throw new Error("value must be string");let Pe=ve.slice(0,s).map(v).join(",");return s===0?G("0u",ie):s===1?G(Pe[0],ie):(x.set=!0,x.setByIndices=!0,x.indicesToOffset=!0,`set_${t}(${Pe}, ${ie})`)},setByOffset:G,setByIndices:(ve,ie)=>s<2?G(ve,ie):(x.setByIndices=!0,x.indicesToOffset=!0,`set_${t}ByIndices(${ve}, ${ie});`),get:$e,getByOffset:re,getByIndices:_e,usage:r,name:t,strides:S,shape:b,rank:s}},rt=(t,e,n,r=1)=>zd(t,e,n,"input",r),Bt=(t,e,n,r=1)=>zd(t,e,n,"output",r),U7=(t,e,n)=>zd(t,e,n,"atomicOutput",1),Cy=(t,e,n,r=1)=>zd(t,e,n,"internal",r),H3=class{constructor(t,e){this.normalizedDispatchGroup=t,this.limits=e,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(t){return`if (global_idx >= ${typeof t=="number"?`${t}u`:t}) { return; }`}mainStart(t=Vc){let e=typeof t=="number"?t:t[0],n=typeof t=="number"?1:t[1],r=typeof t=="number"?1:t[2];if(e>this.limits.maxComputeWorkgroupSizeX||n>this.limits.maxComputeWorkgroupSizeY||r>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${e}, ${n}, ${r}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(e*n*r>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${e}, ${n}, ${r}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let i=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,a=i?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,s=i?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${e*n*r}u + local_idx;`;return`@compute @workgroup_size(${e}, ${n}, ${r})
  fn main(${a}) {
    ${s}
  `}appendVariableUniforms(t){t.rank!==0&&(t.shape.startsWith("uniforms.")&&this.uniforms.push({name:t.shape.replace("uniforms.",""),type:"u32",length:t.rank}),t.strides.startsWith("uniforms.")&&this.uniforms.push({name:t.strides.replace("uniforms.",""),type:"u32",length:t.rank}))}declareVariable(t,e){if(t.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(t),this.appendVariableUniforms(t);let n=t.usage==="input"?"read":"read_write",r=t.usage==="atomicOutput"?"atomic<i32>":t.type.storage;return`@group(0) @binding(${e}) var<storage, ${n}> ${t.name}: array<${r}>;`}declareVariables(...t){return t.map(e=>this.declareVariable(e,this.variableIndex++)).join(`
`)}registerInternalVariable(t){if(t.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(t),this.appendVariableUniforms(t)}registerInternalVariables(...t){return t.forEach(e=>this.registerInternalVariable(e)),this}registerUniform(t,e,n=1){return this.uniforms.push({name:t,type:e,length:n}),this}registerUniforms(t){return this.uniforms=this.uniforms.concat(t),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let t=[];for(let{name:e,type:n,length:r}of this.uniforms)if(r&&r>4)n==="f16"?t.push(`@align(16) ${e}:array<mat2x4<${n}>, ${Math.ceil(r/8)}>`):t.push(`${e}:array<vec4<${n}>, ${Math.ceil(r/4)}>`);else{let i=r==null||r===1?n:`vec${r}<${n}>`;t.push(`${e}:${i}`)}return`
      struct Uniforms { ${t.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(t=>t.impl()).join(`
`)+this.internalVariables.map(t=>t.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let t=e=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(e)];return this.uniforms.map(e=>[t(e.type),e.length??1])}},V7=(t,e)=>new H3(t,e)}),W3,xg,G3,q3,j3,X3,aa,H7,W7,fl=bt(()=>{Qt(),dn(),xr(),gn(),W3=(t,e)=>{if(!t||t.length!==1)throw new Error("Transpose requires 1 input.");if(e.length!==0&&e.length!==t[0].dims.length)throw new Error(`perm size ${e.length} does not match input rank ${t[0].dims.length}`)},xg=(t,e)=>e.length!==0?e:[...new Array(t).keys()].reverse(),G3=(t,e)=>Ye.sortBasedOnPerm(t,xg(t.length,e)),q3=(t,e,n,r)=>{let i=`fn perm(i: ${r.type.indices}) -> ${n.type.indices} {
    var a: ${n.type.indices};`;for(let a=0;a<e;++a)i+=`a[${t[a]}]=i[${a}];`;return i+="return a;}"},j3=(t,e)=>{let n=[],r=[];for(let i=0;i<t.length;++i)t[i]!==1&&n.push(t[i]),t[e[i]]!==1&&r.push(e[i]);return{newShape:n,newPerm:r}},X3=(t,e)=>{let n=0;for(let r=0;r<t.length;++r)if(e[t[r]]!==1){if(t[r]<n)return!1;n=t[r]}return!0},aa=(t,e)=>{let n=t.dataType,r=t.dims.length,i=xg(r,e),a=G3(t.dims,i),s=t.dims,o=a,l=r<2||X3(i,t.dims),u;if(l)return u=x=>{let _=rt("input",n,s,4),b=Bt("output",n,o,4);return`
  ${x.registerUniform("output_size","u32").declareVariables(_,b)}
  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let x=Ye.size(a);return{outputs:[{dims:a,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(x/64/4)},programUniforms:[{type:12,data:Math.ceil(x/4)}]}},getShaderSource:u};let{newShape:c,newPerm:d}=j3(t.dims,i),h=Ye.areEqual(d,[2,3,1]),v=Ye.areEqual(d,[3,1,2]);if(c.length===2||h||v){s=h?[c[0],c[1]*c[2]]:v?[c[0]*c[1],c[2]]:c,o=[s[1],s[0]];let x=16;return u=_=>{let b=rt("a",n,s.length),S=Bt("output",n,o.length);return`
  ${_.registerUniform("output_size","u32").declareVariables(b,S)}
  var<workgroup> tile : array<array<${S.type.value}, ${x+1}>, ${x}>;
  ${_.mainStart([x,x,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${x} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${x}u + local_id.x;
    let input_row = workgroup_id_x * ${x}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${b.getByIndices(`${b.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${x}u + local_id.x;
    let output_row = workgroup_id_y * ${x}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${S.setByIndices(`${S.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let _=Ye.size(a);return{outputs:[{dims:a,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(o[1]/x),y:Math.ceil(o[0]/x)},programUniforms:[{type:12,data:_},...Ht(s,o)]}},getShaderSource:u}}return u=x=>{let _=rt("a",n,s.length),b=Bt("output",n,o.length);return`
  ${x.registerUniform("output_size","u32").declareVariables(_,b)}

  ${q3(i,r,_,b)}

  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${b.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${b.setByOffset("global_idx",_.getByIndices("aIndices"))}
  }`},{name:"Transpose",shaderCache:{hint:`${e}`,inputDependencies:["rank"]},getRunData:()=>{let x=Ye.size(a);return{outputs:[{dims:a,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(x/64)},programUniforms:[{type:12,data:x},...Ht(s,o)]}},getShaderSource:u}},H7=(t,e)=>{W3(t.inputs,e.perm),t.compute(aa(t.inputs[0],e.perm))},W7=t=>qn({perm:t.perm})}),K3,Y3,Z3,J3,Q3,ex,tx,nx,rx,ix,Da,G7,q7,j7,X7,K7,Y7,Z7,J7,Q7,eM,uU=bt(()=>{Qt(),dn(),gn(),Ay(),fl(),K3={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},Y3={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},Z3={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},J3={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Q3=(t,e)=>{let n=[];for(let r=e-t;r<e;++r)n.push(r);return n},ex=(t,e)=>{let n=[],r=t.length;for(let a=0;a<r;a++)e.indexOf(a)===-1&&n.push(t[a]);let i=e.map(a=>t[a]);return[n,i]},tx=(t,e)=>{let n=t.length+e.length,r=[],i=0;for(let a=0;a<n;a++)e.indexOf(a)===-1?r.push(t[i++]):r.push(1);return r},nx=(t,e)=>{for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0},rx=(t,e)=>{let n=[];if(!nx(t,e)){for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);t.forEach(r=>n.push(r))}return n},ix=(t,e,n,r,i,a,s)=>{let o=n[0].dims,l=Ye.size(a),u=Ye.size(s),c=rt("_A",n[0].dataType,o),d=Bt("output",i,a),h=64;l===1&&(h=256);let v=`
          var<workgroup> aBestValues : array<f32, ${h}>;
       `,x=_=>`
        ${_.registerUniform("reduceSize","u32").declareVariables(c,d)}
        ${v}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${_.mainStart(h)}

          let outputIndex = global_idx / ${h};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${Z3[r]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${h}) {
           let candidate = f32(${c.getByOffset("offset + k")});
           bestValue = ${K3[r]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${h}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${Y3[r]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${d.setByOffset("outputIndex",`${r==="mean"?`${d.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${d.type.storage}(${J3[r]})`}`)};
         }
        }`;return{name:t,shaderCache:{hint:`${e};${h}`,inputDependencies:["type"]},getShaderSource:x,getRunData:()=>({outputs:[{dims:a,dataType:i}],dispatchGroup:{x:l},programUniforms:[{type:12,data:u}]})}},Da=(t,e,n,r)=>{let i=t.inputs.length===1?n:qv(t.inputs,n),a=i.axes;a.length===0&&!i.noopWithEmptyAxes&&(a=t.inputs[0].dims.map((v,x)=>x));let s=Ye.normalizeAxes(a,t.inputs[0].dims.length),o=s,l=t.inputs[0],u=rx(o,t.inputs[0].dims.length);u.length>0&&(l=t.compute(aa(t.inputs[0],u),{inputs:[0],outputs:[-1]})[0],o=Q3(o.length,l.dims.length));let[c,d]=ex(l.dims,o),h=c;i.keepDims&&(h=tx(c,s)),t.compute(ix(e,i.cacheKey,[l],r,t.inputs[0].dataType,h,d),{inputs:[l]})},G7=(t,e)=>{Da(t,"ReduceMeanShared",e,"mean")},q7=(t,e)=>{Da(t,"ReduceL1Shared",e,"l1")},j7=(t,e)=>{Da(t,"ReduceL2Shared",e,"l2")},X7=(t,e)=>{Da(t,"ReduceLogSumExpShared",e,"logSumExp")},K7=(t,e)=>{Da(t,"ReduceMaxShared",e,"max")},Y7=(t,e)=>{Da(t,"ReduceMinShared",e,"min")},Z7=(t,e)=>{Da(t,"ReduceProdShared",e,"prod")},J7=(t,e)=>{Da(t,"ReduceSumShared",e,"sum")},Q7=(t,e)=>{Da(t,"ReduceSumSquareShared",e,"sumSquare")},eM=(t,e)=>{Da(t,"ReduceLogSumShared",e,"logSum")}}),La,ax,np,qv,za,sx,ox,lx,ux,cx,dx,fx,hx,px,mx,Oa,tM,nM,rM,iM,aM,sM,oM,lM,uM,cM,Ay=bt(()=>{Qt(),dn(),xr(),gn(),uU(),La=t=>{if(!t||t.length===0||t.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(t.length===2&&t[1].dims.length!==1)throw new Error("Invalid axes input dims.")},ax=t=>["","",`var value = ${t.getByIndices("input_indices")};`,""],np=(t,e,n,r,i,a,s=!1,o=!1)=>{let l=[],u=n[0].dims,c=u.length,d=Ye.normalizeAxes(i,c),h=!o&&d.length===0;u.forEach((_,b)=>{h||d.indexOf(b)>=0?s&&l.push(1):l.push(_)});let v=l.length,x=Ye.size(l);return{name:t,shaderCache:e,getShaderSource:_=>{let b=[],S=rt("_A",n[0].dataType,c),E=Bt("output",a,v),C=r(S,E,d),A=C[2];for(let D=0,O=0;D<c;D++)h||d.indexOf(D)>=0?(s&&O++,A=`for(var j${D}: u32 = 0; j${D} < ${u[D]}; j${D}++) {
                  ${C[2].includes("last_index")?`let last_index = j${D};`:""}
                  ${S.indicesSet("input_indices",D,`j${D}`)}
                  ${A}
                }`):(b.push(`${S.indicesSet("input_indices",D,E.indicesGet("output_indices",O))};`),O++);return`

        ${_.registerUniform("output_size","u32").declareVariables(S,E)}

        ${_.mainStart()}
          ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${S.type.indices};
          let output_indices = ${E.offsetToIndices("global_idx")};

          ${b.join(`
`)}
          ${C[0]}       // init ops for reduce max/min
          ${C[1]}
          ${A}
          ${C[3]}
          ${C.length===4?E.setByOffset("global_idx","value"):C.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:l,dataType:a}],dispatchGroup:{x:Math.ceil(x/64)},programUniforms:[{type:12,data:x},...Ht(u,l)]})}},qv=(t,e)=>{let n=[];return t[1].dims[0]>0&&t[1].getBigInt64Array().forEach(r=>n.push(Number(r))),qn({axes:n,keepDims:e.keepDims,noopWithEmptyAxes:e.noopWithEmptyAxes})},za=(t,e,n,r)=>{let i=t.inputs,a=i.length===1?n:qv(i,n);t.compute(np(e,{hint:a.cacheKey,inputDependencies:["rank"]},[i[0]],a.noopWithEmptyAxes&&a.axes.length===0?ax:r,a.axes,i[0].dataType,a.keepDims,a.noopWithEmptyAxes),{inputs:[0]})},sx=(t,e)=>{La(t.inputs),za(t,"ReduceLogSum",e,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += ${n.getByIndices("input_indices")};`,"value = log(value);"])},ox=(t,e)=>{La(t.inputs),za(t,"ReduceL1",e,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += abs(${n.getByIndices("input_indices")});`,""])},lx=(t,e)=>{La(t.inputs),za(t,"ReduceL2",e,(n,r)=>[`var t = ${r.type.value}(0); var value = ${r.type.value}(0);`,"",`t = ${n.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},ux=(t,e)=>{La(t.inputs),za(t,"ReduceLogSumExp",e,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += exp(${n.getByIndices("input_indices")});`,"value = log(value);"])},cx=(t,e)=>{La(t.inputs),za(t,"ReduceMax",e,(n,r,i)=>{let a=[];for(let s=0;s<n.rank;s++)(i.indexOf(s)>=0||i.length===0)&&a.push(n.indicesSet("input_indices",s,0));return[`${a.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};`,`value = max(value, ${n.getByIndices("input_indices")});`,""]})},dx=(t,e)=>{La(t.inputs),za(t,"ReduceMean",e,(n,r,i)=>{let a=1;for(let s=0;s<n.rank;s++)(i.indexOf(s)>=0||i.length===0)&&(a*=t.inputs[0].dims[s]);return["var sum = f32(0);","",`sum += f32(${n.getByIndices("input_indices")});`,`let value = ${r.type.value}(sum / ${a});`]})},fx=(t,e)=>{La(t.inputs),za(t,"ReduceMin",e,(n,r,i)=>{let a=[];for(let s=0;s<n.rank;s++)(i.indexOf(s)>=0||i.length===0)&&a.push(`input_indices[${s}] = 0;`);return[`${a.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};`,`value = min(value, ${n.getByIndices("input_indices")});`,""]})},hx=(t,e)=>{La(t.inputs),za(t,"ReduceProd",e,(n,r)=>[`var value = ${r.type.storage}(1);`,"",`value *= ${n.getByIndices("input_indices")};`,""])},px=(t,e)=>{La(t.inputs),za(t,"ReduceSum",e,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += ${n.getByIndices("input_indices")};`,""])},mx=(t,e)=>{La(t.inputs),za(t,"ReduceSumSquare",e,(n,r)=>[`var t = ${r.type.value}(0); var value = ${r.type.value}(0);`,"",`t = ${n.getByIndices("input_indices")}; value += t * t;`,""])},Oa=(t,e,n)=>{if(e.length===0)return n;let r=1,i=1;for(let a=0;a<e.length;a++)e.indexOf(a)===-1?r*=t[a]:i*=t[a];return i<32&&r>1024},tM=(t,e)=>{Oa(t.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?dx(t,e):G7(t,e)},nM=(t,e)=>{Oa(t.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?ox(t,e):q7(t,e)},rM=(t,e)=>{Oa(t.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?lx(t,e):j7(t,e)},iM=(t,e)=>{Oa(t.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?ux(t,e):X7(t,e)},aM=(t,e)=>{Oa(t.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?cx(t,e):K7(t,e)},sM=(t,e)=>{Oa(t.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?fx(t,e):Y7(t,e)},oM=(t,e)=>{Oa(t.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?hx(t,e):Z7(t,e)},lM=(t,e)=>{Oa(t.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?px(t,e):J7(t,e)},uM=(t,e)=>{Oa(t.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?mx(t,e):Q7(t,e)},cM=(t,e)=>{Oa(t.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?sx(t,e):eM(t,e)}}),wg,dM,fM,jv,cU=bt(()=>{Qt(),xr(),Ay(),wg=t=>{if(!t||t.length===0||t.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(t[0].dataType!==1)throw new Error("Invalid input type.")},dM=(t,e)=>{wg(t.inputs);let n=(r,i,a)=>{let s=[];for(let o=0;o<r.rank;o++)(a.indexOf(o)>=0||a.length===0)&&s.push(`input_indices[${o}] = 0;`);return[`${s.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${r.getByIndices("input_indices")} ${e.selectLastIndex>0?"<=":"<"} value) {
         value = ${r.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",i.setByOffset("global_idx","best_index")]};t.compute(np("ArgMin",{hint:e.cacheKey,inputDependencies:["rank"]},[t.inputs[0]],n,[e.axis],7,e.keepDims),{inputs:[0]})},fM=(t,e)=>{wg(t.inputs);let n=(r,i,a)=>{let s=[];for(let o=0;o<r.rank;o++)(a.indexOf(o)>=0||a.length===0)&&s.push(`input_indices[${o}] = 0;`);return[`${s.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${r.getByIndices("input_indices")} ${e.selectLastIndex>0?">=":">"} value) {
         value = ${r.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",i.setByOffset("global_idx","best_index")]};t.compute(np("argMax",{hint:e.cacheKey,inputDependencies:["rank"]},[t.inputs[0]],n,[e.axis],7,e.keepDims),{inputs:[0]})},jv=t=>qn(t)}),gx,c0,vx,yx,_x,Rf,bx,hM,ky=bt(()=>{Qt(),dn(),Ty(),gn(),gx=(t,e)=>{let n=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5];if(s&&o)throw new Error("Attention cannot have both past and attention_bias");if(n.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let l=n.dims[0],u=n.dims[1],c=n.dims[2];if(i.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(r.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(r.dims[0]!==c)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(i.dims[0]!==r.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let d=i.dims[0]/3,h=d,v=h;if(e.qkvHiddenSizes.length>0){if(e.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let C of e.qkvHiddenSizes)if(C%e.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");d=e.qkvHiddenSizes[0],h=e.qkvHiddenSizes[1],v=e.qkvHiddenSizes[2]}let x=u;if(d!==h)throw new Error("qkv_hidden_sizes first element should be same as the second");if(i.dims[0]!==d+h+v)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let _=0;if(s){if(h!==v)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(s.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(s.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(s.dims[1]!==l)throw new Error('Input "past" second dimension must be batch_size');if(s.dims[2]!==e.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(s.dims[4]!==h/e.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');e.pastPresentShareBuffer||(_=s.dims[3])}let b=x+_,S=-1,E=0;if(a)throw new Error("Mask not supported");if(s)throw new Error("past is not supported");if(o){if(o.dims.length!==4)throw new Error('Input "attention_bias" must have 4 dimensions');if(o.dims[0]!==l||o.dims[1]!==e.numHeads||o.dims[2]!==u||o.dims[3]!==b)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:l,sequenceLength:u,pastSequenceLength:_,kvSequenceLength:x,totalSequenceLength:b,maxSequenceLength:S,inputHiddenSize:c,hiddenSize:d,vHiddenSize:v,headSize:Math.floor(d/e.numHeads),vHeadSize:Math.floor(v/e.numHeads),numHeads:e.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:e.maskFilterValue,maskType:E,scale:e.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},c0=(t,e,n)=>e&&t?`
      let total_sequence_length_input = u32(${e.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${t==null?void 0:t.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${n?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,vx=(t,e,n,r,i,a,s,o)=>{let l=hr(s?1:a),u=64,c=a/l;c<u&&(u=32);let d=Math.ceil(a/l/u),h=[{type:12,data:e},{type:12,data:n},{type:12,data:r},{type:12,data:i},{type:12,data:c},{type:12,data:d}],v=zr(t.dataType,l),x=ci(1,l),_=["type"];s&&_.push("type"),o&&_.push("type");let b=S=>{let E=Bt("x",t.dataType,t.dims,l),C=[E],A=s?rt("seq_lens",s.dataType,s.dims):void 0;A&&C.push(A);let D=o?rt("total_sequence_length_input",o.dataType,o.dims):void 0;D&&C.push(D);let O=ci(t.dataType),V=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${u}>;
  var<workgroup> thread_sum: array<f32, ${u}>;
  ${S.registerUniforms(V).declareVariables(...C)}
  ${S.mainStart([u,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${c0(A,D,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${u}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${s?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${x}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${x}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(l){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${l}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${u}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${x}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${x}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(l){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${l}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${u}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${E.type.value}(${O}(1.0) / ${O}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${x}(x[offset + i]);
        x[offset + i] = ${E.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${s?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${E.type.value}(${O}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${u};${v};${l}`,inputDependencies:_},getShaderSource:b,getRunData:()=>({outputs:[],dispatchGroup:{x:Math.ceil(a/u),y:i,z:e*n},programUniforms:h})}},yx=(t,e,n,r,i,a,s,o,l)=>{let u=s+a.kvSequenceLength,c=[a.batchSize,a.numHeads,a.sequenceLength,u],d=t>1&&r,h=a.kvNumHeads?a.kvNumHeads:a.numHeads,v=d?[a.batchSize,h,u,a.headSize]:void 0,x=a.nReps?a.nReps:1,_=a.scale===0?1/Math.sqrt(a.headSize):a.scale,b=hr(a.headSize),S=a.headSize/b,E=12,C={x:Math.ceil(u/E),y:Math.ceil(a.sequenceLength/E),z:a.batchSize*a.numHeads},A=[{type:12,data:a.sequenceLength},{type:12,data:S},{type:12,data:u},{type:12,data:a.numHeads},{type:12,data:a.headSize},{type:1,data:_},{type:12,data:s},{type:12,data:a.kvSequenceLength},{type:12,data:x}],D=d&&r&&Ye.size(r.dims)>0,O=["type","type"];D&&O.push("type"),i&&O.push("type"),o&&O.push("type"),l&&O.push("type");let V=[{dims:c,dataType:e.dataType,gpuDataType:0}];d&&V.push({dims:v,dataType:e.dataType,gpuDataType:0});let P=U=>{let Y=rt("q",e.dataType,e.dims,b),fe=rt("key",n.dataType,n.dims,b),Q=[Y,fe];if(D){let de=rt("past_key",r.dataType,r.dims,b);Q.push(de)}i&&Q.push(rt("attention_bias",i.dataType,i.dims));let G=o?rt("seq_lens",o.dataType,o.dims):void 0;G&&Q.push(G);let re=l?rt("total_sequence_length_input",l.dataType,l.dims):void 0;re&&Q.push(re);let he=Bt("output",e.dataType,c),ye=[he];d&&ye.push(Bt("present_key",e.dataType,v,b));let $e=ci(1,b),_e=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${E}u;

  var<workgroup> tileQ: array<${Y.type.storage}, ${E*E}>;
  var<workgroup> tileK: array<${Y.type.storage}, ${E*E}>;
  ${U.registerUniforms(_e).declareVariables(...Q,...ye)}
  ${U.mainStart([E,E,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${x===1?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${x===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${c0(G,re,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${D&&d?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${d?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${$e}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${D&&d?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${d?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${$e}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(b){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${b}`)}})()};
        output[outputIdx] = ${he.type.value} (sum * uniforms.alpha) + ${i?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${b};${i!==void 0};${r!==void 0};${t}`,inputDependencies:O},getRunData:()=>({outputs:V,dispatchGroup:C,programUniforms:A}),getShaderSource:P}},_x=(t,e,n,r,i,a,s=void 0,o=void 0)=>{let l=a+i.kvSequenceLength,u=i.nReps?i.nReps:1,c=i.vHiddenSize*u,d=t>1&&r,h=i.kvNumHeads?i.kvNumHeads:i.numHeads,v=d?[i.batchSize,h,l,i.headSize]:void 0,x=[i.batchSize,i.sequenceLength,c],_=12,b={x:Math.ceil(i.vHeadSize/_),y:Math.ceil(i.sequenceLength/_),z:i.batchSize*i.numHeads},S=[{type:12,data:i.sequenceLength},{type:12,data:l},{type:12,data:i.vHeadSize},{type:12,data:i.numHeads},{type:12,data:i.headSize},{type:12,data:c},{type:12,data:a},{type:12,data:i.kvSequenceLength},{type:12,data:u}],E=d&&r&&Ye.size(r.dims)>0,C=["type","type"];E&&C.push("type"),s&&C.push("type"),o&&C.push("type");let A=[{dims:x,dataType:e.dataType,gpuDataType:0}];d&&A.push({dims:v,dataType:e.dataType,gpuDataType:0});let D=O=>{let V=rt("probs",e.dataType,e.dims),P=rt("v",n.dataType,n.dims),U=[V,P];E&&U.push(rt("past_value",r.dataType,r.dims));let Y=s?rt("seq_lens",s.dataType,s.dims):void 0;s&&U.push(Y);let fe=o?rt("total_sequence_length_input",o.dataType,o.dims):void 0;o&&U.push(fe);let Q=[Bt("output",e.dataType,x)];d&&Q.push(Bt("present_value",e.dataType,v));let G=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${_}u;
  var<workgroup> tileQ: array<${V.type.value}, ${_*_}>;
  var<workgroup> tileV: array<${V.type.value}, ${_*_}>;
  ${O.registerUniforms(G).declareVariables(...U,...Q)}
  ${O.mainStart([_,_,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${u===1?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${u===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${c0(Y,fe,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${E&&d?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${d?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${V.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${E&&d?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${d?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${r!==void 0};${t}`,inputDependencies:C},getRunData:()=>({outputs:A,dispatchGroup:b,programUniforms:S}),getShaderSource:D}},Rf=(t,e,n,r,i,a,s,o,l,u,c=void 0,d=void 0)=>{let h=Math.min(t.outputCount,1+(s?1:0)+(o?1:0)),v=h>1?u.pastSequenceLength:0,x=v+u.kvSequenceLength,_=l&&Ye.size(l.dims)>0?l:void 0,b=[e,n];h>1&&s&&Ye.size(s.dims)>0&&b.push(s),_&&b.push(_),c&&b.push(c),d&&b.push(d);let S=t.compute(yx(h,e,n,s,_,u,v,c,d),{inputs:b,outputs:h>1?[-1,1]:[-1]})[0];t.compute(vx(S,u.batchSize,u.numHeads,v,u.sequenceLength,x,c,d),{inputs:c&&d?[S,c,d]:[S],outputs:[]});let E=[S,r];h>1&&o&&Ye.size(o.dims)>0&&E.push(o),c&&E.push(c),d&&E.push(d),t.compute(_x(h,S,r,o,u,v,c,d),{inputs:E,outputs:h>1?[0,2]:[0]})},bx=(t,e)=>{let n=[e.batchSize,e.numHeads,e.sequenceLength,e.headSize],r=e.sequenceLength,i=e.inputHiddenSize,a=e.headSize,s=12,o={x:Math.ceil(e.headSize/s),y:Math.ceil(e.sequenceLength/s),z:e.batchSize*e.numHeads},l=[t.inputs[0],t.inputs[1],t.inputs[2]],u=[{type:12,data:r},{type:12,data:i},{type:12,data:a},{type:12,data:e.numHeads},{type:12,data:e.headSize},{type:12,data:e.hiddenSize},{type:12,data:e.hiddenSize+e.hiddenSize+e.vHiddenSize}],c=d=>{let h=Bt("output_q",l[0].dataType,n),v=Bt("output_k",l[0].dataType,n),x=Bt("output_v",l[0].dataType,n),_=rt("input",l[0].dataType,l[0].dims),b=rt("weight",l[1].dataType,l[1].dims),S=rt("bias",l[2].dataType,l[2].dims),E=_.type.storage,C=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${s}u;
  var<workgroup> tileInput: array<${E}, ${s*s}>;
  var<workgroup> tileWeightQ: array<${E}, ${s*s}>;
  var<workgroup> tileWeightK: array<${E}, ${s*s}>;
  var<workgroup> tileWeightV: array<${E}, ${s*s}>;
  ${d.registerUniforms(C).declareVariables(_,b,S,h,v,x)}
  ${d.mainStart([s,s,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${E}(0);
    var valueK = ${E}(0);
    var valueV = ${E}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return t.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:n,dataType:t.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:t.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:t.inputs[0].dataType,gpuDataType:0}],dispatchGroup:o,programUniforms:u}),getShaderSource:c},{inputs:l,outputs:[-1,-1,-1]})},hM=(t,e)=>{let n=gx(t.inputs,e),[r,i,a]=bx(t,n);return Rf(t,r,i,a,t.inputs[4],void 0,void 0,void 0,t.inputs[5],n)}}),xx,wx,Sx,pM,dU=bt(()=>{Ka(),Qt(),dn(),xr(),gn(),xx=(t,e)=>{if(!t||t.length!==5)throw new Error("BatchNormalization requires 5 inputs");let n=(r,i,a)=>{let s=i.length;if(s!==r.length)throw new Error(`${a}: num dimensions != ${s}`);i.forEach((o,l)=>{if(o!==r[l])throw new Error(`${a}: dim[${l}] do not match`)})};if(t[0].dims.length>1){let r=e.format==="NHWC"?e.spatial?t[0].dims.slice(-1):t[0].dims.slice(-1).concat(t[0].dims.slice(1,t[0].dims.length-1)):t[0].dims.slice(1,e.spatial?2:void 0);n(t[1].dims,r,"Invalid input scale"),n(t[2].dims,r,"Invalid input B"),n(t[3].dims,r,"Invalid input mean"),n(t[4].dims,r,"Invalid input var")}else n(t[1].dims,[1],"Invalid input scale"),n(t[2].dims,[1],"Invalid input B"),n(t[3].dims,[1],"Invalid input mean"),n(t[4].dims,[1],"Invalid input var")},wx=(t,e)=>{let{epsilon:n,spatial:r,format:i}=e,a=t[0].dims,s=r?hr(a[a.length-1]):1,o=i==="NHWC"&&a.length>1?s:1,l=Ye.size(a)/s,u=r,c=u?a.length:a,d=rt("x",t[0].dataType,t[0].dims,s),h=rt("scale",t[1].dataType,t[1].dims,o),v=rt("bias",t[2].dataType,t[2].dims,o),x=rt("inputMean",t[3].dataType,t[3].dims,o),_=rt("inputVar",t[4].dataType,t[4].dims,o),b=Bt("y",t[0].dataType,c,s),S=()=>{let C="";if(r)C=`let cOffset = ${a.length===1?"0u":i==="NHWC"?`outputIndices[${a.length-1}] / ${s}`:"outputIndices[1]"};`;else if(i==="NCHW")C=`
            ${b.indicesSet("outputIndices","0","0")}
            let cOffset = ${b.indicesToOffset("outputIndices")};`;else{C=`var cIndices = ${h.type.indices}(0);
                       cIndices[0] = outputIndices[${a.length-1}];`;for(let A=1;A<h.rank;A++)C+=`cIndices[${A}] = outputIndices[${A}];`;C+=`let cOffset = ${h.indicesToOffset("cIndices")};`}return C},E=C=>`
  const epsilon = ${n};
  ${C.registerUniform("outputSize","u32").declareVariables(d,h,v,x,_,b)}
  ${C.mainStart()}
  ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${b.offsetToIndices(`global_idx * ${s}`)};
    ${S()}
    let scale = ${h.getByOffset("cOffset")};
    let bias = ${v.getByOffset("cOffset")};
    let inputMean = ${x.getByOffset("cOffset")};
    let inputVar = ${_.getByOffset("cOffset")};
    let x = ${d.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${b.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${e.epsilon}_${e.format}_${r}_${s}`,inputDependencies:u?["rank","type","type","type","type"]:void 0},getShaderSource:E,getRunData:()=>({outputs:[{dims:t[0].dims,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:u?[{type:12,data:l},...Ht(a)]:[{type:12,data:l}]})}},Sx=t=>qn(t),pM=(t,e)=>{let{inputs:n,outputCount:r}=t,i=Sx({...e,outputCount:r});if(or.webgpu.validateInputContent&&xx(n,i),e.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");t.compute(wx(n,i))}}),Mx,Ex,mM,fU=bt(()=>{dn(),gn(),Mx=t=>{if(t[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(t[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(t[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(t[0].dims[2]!==t[1].dims[0])throw new Error("last dimension of input and bias are not the same")},Ex=t=>{let e=t[0].dims,n=t[0].dims[2],r=Ye.size(e)/4,i=t[0].dataType,a=rt("input",i,e,4),s=rt("bias",i,[n],4),o=rt("residual",i,e,4),l=Bt("output",i,e,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:e,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(r/64)}}),getShaderSource:u=>`
  const channels = ${n}u / 4;
  ${u.declareVariables(a,s,o,l)}

  ${u.mainStart()}
    ${u.guardAgainstOutOfBoundsWorkgroupSizes(r)}
    let value = ${a.getByOffset("global_idx")}
      + ${s.getByOffset("global_idx % channels")} + ${o.getByOffset("global_idx")};
    ${l.setByOffset("global_idx","value")}
  }`}},mM=t=>{Mx(t.inputs),t.compute(Ex(t.inputs))}}),Tx,Bn,gM,vM,yM,_M,bM,xM,wM,SM,MM,Cx,EM,TM,CM,AM,Yd,kM,C0,IM,$M,PM,RM,DM,LM,zM,OM,NM,BM,FM,UM,VM,HM,WM,GM,Sg,qM,Xv,Kv,jM,XM,KM,Ax,kx,YM,Iy=bt(()=>{Qt(),dn(),xr(),gn(),Tx=(t,e,n,r,i,a,s)=>{let o=Math.ceil(e/4),l="";typeof i=="string"?l=`${i}(a)`:l=i("a");let u=rt("inputData",n,[o],4),c=Bt("outputData",r,[o],4),d=[{name:"vec_size",type:"u32"}];return s&&d.push(...s),`
      ${t.registerUniforms(d).declareVariables(u,c)}

  ${a??""}

  ${t.mainStart()}
    ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${u.getByOffset("global_idx")};
    ${c.setByOffset("global_idx",l)}
  }`},Bn=(t,e,n,r,i,a=t.dataType,s,o)=>{let l=[{type:12,data:Math.ceil(Ye.size(t.dims)/4)}];return s&&l.push(...s),{name:e,shaderCache:{hint:i,inputDependencies:["type"]},getShaderSource:u=>Tx(u,Ye.size(t.dims),t.dataType,a,n,r,o),getRunData:u=>({outputs:[{dims:t.dims,dataType:a}],dispatchGroup:{x:Math.ceil(Ye.size(u[0].dims)/64/4)},programUniforms:l})}},gM=t=>{t.compute(Bn(t.inputs[0],"Abs","abs"))},vM=t=>{t.compute(Bn(t.inputs[0],"Acos","acos"))},yM=t=>{t.compute(Bn(t.inputs[0],"Acosh","acosh"))},_M=t=>{t.compute(Bn(t.inputs[0],"Asin","asin"))},bM=t=>{t.compute(Bn(t.inputs[0],"Asinh","asinh"))},xM=t=>{t.compute(Bn(t.inputs[0],"Atan","atan"))},wM=t=>{t.compute(Bn(t.inputs[0],"Atanh","atanh"))},SM=t=>qn(t),MM=(t,e)=>{let n;switch(e.to){case 10:n="vec4<f16>";break;case 1:n="vec4<f32>";break;case 12:n="vec4<u32>";break;case 6:n="vec4<i32>";break;case 9:n="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${e.to}`)}t.compute(Bn(t.inputs[0],"Cast",n,void 0,e.cacheKey,e.to))},Cx=t=>{let e,n,r=t.length>=2&&t[1].data!==0,i=t.length>=3&&t[2].data!==0;switch(t[0].dataType){case 1:e=r?t[1].getFloat32Array()[0]:-34028234663852886e22,n=i?t[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:e=r?t[1].getUint16Array()[0]:64511,n=i?t[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return qn({min:e,max:n})},EM=(t,e)=>{let n=e||Cx(t.inputs),r=ci(t.inputs[0].dataType);t.compute(Bn(t.inputs[0],"Clip",i=>`clamp(${i}, vec4<${r}>(uniforms.min), vec4<${r}>(uniforms.max))`,void 0,n.cacheKey,void 0,[{type:t.inputs[0].dataType,data:n.min},{type:t.inputs[0].dataType,data:n.max}],[{name:"min",type:r},{name:"max",type:r}]),{inputs:[0]})},TM=t=>{t.compute(Bn(t.inputs[0],"Ceil","ceil"))},CM=t=>{t.compute(Bn(t.inputs[0],"Cos","cos"))},AM=t=>{t.compute(Bn(t.inputs[0],"Cosh","cosh"))},Yd=t=>qn(t),kM=(t,e)=>{let n=ci(t.inputs[0].dataType);t.compute(Bn(t.inputs[0],"Elu",r=>`elu_vf32(${r})`,`
  const elu_alpha_ = ${n}(${e.alpha});

  fn elu_f32(a: ${n}) -> ${n} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${n}>) -> vec4<${n}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,e.cacheKey))},C0=(t="f32")=>`
const r0: ${t} = 0.3275911;
const r1: ${t} = 0.254829592;
const r2: ${t} = -0.284496736;
const r3: ${t} = 1.421413741;
const r4: ${t} = -1.453152027;
const r5: ${t} = 1.061405429;

fn erf_vf32(v: vec4<${t}>) -> vec4<${t}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,IM=t=>{let e=ci(t.inputs[0].dataType);t.compute(Bn(t.inputs[0],"Erf",n=>`erf_vf32(${n})`,C0(e)))},$M=t=>{t.compute(Bn(t.inputs[0],"Exp","exp"))},PM=t=>{t.compute(Bn(t.inputs[0],"Floor","floor"))},RM=t=>{let e=ci(t.inputs[0].dataType);t.compute(Bn(t.inputs[0],"Gelu",n=>`0.5 * ${n} * (1.0 + erf_vf32(${n} * 0.7071067811865475))`,C0(e)))},DM=(t,e)=>{let n=ci(t.inputs[0].dataType);t.compute(Bn(t.inputs[0],"LeakyRelu",r=>`select(leaky_relu_alpha_ * ${r}, ${r}, ${r} >= vec4<${n}>(0.0))`,`const leaky_relu_alpha_ = ${n}(${e.alpha});`,e.cacheKey))},LM=t=>{t.compute(Bn(t.inputs[0],"Not",e=>`!${e}`))},zM=t=>{t.compute(Bn(t.inputs[0],"Neg",e=>`-${e}`))},OM=t=>{t.compute(Bn(t.inputs[0],"Reciprocal",e=>`1.0/${e}`))},NM=t=>{let e=ci(t.inputs[0].dataType);t.compute(Bn(t.inputs[0],"Relu",n=>`select(vec4<${e}>(0.0), ${n}, ${n} > vec4<${e}>(0.0))`))},BM=t=>{t.compute(Bn(t.inputs[0],"Sigmoid",e=>`(1.0 / (1.0 + exp(-${e})))`))},FM=t=>qn(t),UM=(t,e)=>{let n=ci(t.inputs[0].dataType);t.compute(Bn(t.inputs[0],"HardSigmoid",r=>`max(vec4<${n}>(0.0), min(vec4<${n}>(1.0), ${e.alpha} * ${r} + vec4<${n}>(${e.beta})))`,void 0,e.cacheKey))},VM=t=>{t.compute(Bn(t.inputs[0],"Sin","sin"))},HM=t=>{t.compute(Bn(t.inputs[0],"Sinh","sinh"))},WM=t=>{t.compute(Bn(t.inputs[0],"Sqrt","sqrt"))},GM=t=>{t.compute(Bn(t.inputs[0],"Tan","tan"))},Sg=t=>`sign(${t}) * (1 - exp(-2 * abs(${t}))) / (1 + exp(-2 * abs(${t})))`,qM=t=>{t.compute(Bn(t.inputs[0],"Tanh",Sg))},Xv=(t="f32")=>`
const fast_gelu_a: ${t} = 0.5;
const fast_gelu_b: ${t} = 0.7978845608028654;
const fast_gelu_c: ${t} = 0.035677408136300125;

fn tanh_v(v: vec4<${t}>) -> vec4<${t}> {
  return ${Sg("v")};
}
`,Kv=t=>`(fast_gelu_a + fast_gelu_a * tanh_v(${t} * (fast_gelu_c * ${t} * ${t} + fast_gelu_b))) * ${t}`,jM=t=>{let e=ci(t.inputs[0].dataType);t.compute(Bn(t.inputs[0],"FastGelu",Kv,Xv(e),void 0,t.inputs[0].dataType))},XM=(t,e)=>{let n=ci(t.inputs[0].dataType);return t.compute(Bn(t.inputs[0],"ThresholdedRelu",r=>`select(vec4<${n}>(0.0), ${r}, ${r} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${n}>(${e.alpha});`,e.cacheKey)),0},KM=t=>{t.compute(Bn(t.inputs[0],"Log","log"))},Ax=(t,e)=>`
const alpha = vec4<${t}>(${e});
const one = ${t}(1.0);
const zero = ${t}(0.0);

fn quick_gelu_impl(x: vec4<${t}>) -> vec4<${t}> {
  let v = x *alpha;
  var x1 : vec4<${t}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,kx=t=>`quick_gelu_impl(${t})`,YM=(t,e)=>{let n=ci(t.inputs[0].dataType);t.compute(Bn(t.inputs[0],"QuickGelu",kx,Ax(n,e.alpha),e.cacheKey,t.inputs[0].dataType))}}),Ix,$x,ZM,hU=bt(()=>{dn(),gn(),Iy(),Ix=t=>{if(t[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(t[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(t[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(t[0].dims[2]!==t[1].dims[0])throw new Error("last dimension of input and bias are not the same")},$x=t=>{let e=t[0].dims.slice();e[2]=e[2]/2;let n=rt("input",t[0].dataType,t[0].dims,4),r=rt("bias",t[0].dataType,[t[0].dims[2]],4),i=Bt("output",t[0].dataType,e,4),a=Ye.size(e)/4,s=zr(t[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:e,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)}}),getShaderSource:o=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${t[0].dims[2]/4/2}u;

  ${o.declareVariables(n,r,i)}

  ${C0(s)}

  ${o.mainStart()}
    ${o.guardAgainstOutOfBoundsWorkgroupSizes(a)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${i.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},ZM=t=>{Ix(t.inputs),t.compute($x(t.inputs))}}),Px,Rx,Na,JM,QM,eE,tE,nE,rE,iE,aE,sE,oE,pU=bt(()=>{Qt(),dn(),gn(),Px=(t,e,n,r,i,a,s,o,l,u,c,d)=>{let h,v;typeof o=="string"?h=v=(E,C)=>`${o}((${E}),(${C}))`:typeof o=="function"?h=v=o:(h=o.scalar,v=o.vector);let x=Bt("outputData",c,r.length,4),_=rt("aData",l,e.length,4),b=rt("bData",u,n.length,4),S;if(i)if(a){let E=Ye.size(e)===1,C=Ye.size(n)===1,A=e.length>0&&e[e.length-1]%4===0,D=n.length>0&&n[n.length-1]%4===0;E||C?S=x.setByOffset("global_idx",v(E?`${_.type.value}(${_.getByOffset("0")}.x)`:_.getByOffset("global_idx"),C?`${b.type.value}(${b.getByOffset("0")}.x)`:b.getByOffset("global_idx"))):S=`
            let outputIndices = ${x.offsetToIndices("global_idx * 4u")};
            let offsetA = ${_.broadcastedIndicesToOffset("outputIndices",x)};
            let offsetB = ${b.broadcastedIndicesToOffset("outputIndices",x)};
            ${x.setByOffset("global_idx",v(s||A?_.getByOffset("offsetA / 4u"):`${_.type.value}(${_.getByOffset("offsetA / 4u")}[offsetA % 4u])`,s||D?b.getByOffset("offsetB / 4u"):`${b.type.value}(${b.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else S=x.setByOffset("global_idx",v(_.getByOffset("global_idx"),b.getByOffset("global_idx")));else{if(!a)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let E=(C,A,D="")=>{let O=`aData[indexA${A}][componentA${A}]`,V=`bData[indexB${A}][componentB${A}]`;return`
            let outputIndices${A} = ${x.offsetToIndices(`global_idx * 4u + ${A}u`)};
            let offsetA${A} = ${_.broadcastedIndicesToOffset(`outputIndices${A}`,x)};
            let offsetB${A} = ${b.broadcastedIndicesToOffset(`outputIndices${A}`,x)};
            let indexA${A} = offsetA${A} / 4u;
            let indexB${A} = offsetB${A} / 4u;
            let componentA${A} = offsetA${A} % 4u;
            let componentB${A} = offsetB${A} % 4u;
            ${C}[${A}] = ${D}(${h(O,V)});
          `};c===9?S=`
            var data = vec4<u32>(0);
            ${E("data",0,"u32")}
            ${E("data",1,"u32")}
            ${E("data",2,"u32")}
            ${E("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:S=`
            ${E("outputData[global_idx]",0)}
            ${E("outputData[global_idx]",1)}
            ${E("outputData[global_idx]",2)}
            ${E("outputData[global_idx]",3)}
          `}return`
        ${t.registerUniform("vec_size","u32").declareVariables(_,b,x)}

        ${d??""}

        ${t.mainStart()}
        ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${S}
      }`},Rx=(t,e,n,r,i,a,s=n.dataType)=>{let o=n.dims.map(_=>Number(_)??1),l=r.dims.map(_=>Number(_)??1),u=!Ye.areEqual(o,l),c=o,d=Ye.size(o),h=!1,v=!1,x=[u];if(u){let _=Uc.calcShape(o,l,!1);if(!_)throw new Error("Can't perform binary op on the given tensors");c=_.slice(),d=Ye.size(c);let b=Ye.size(o)===1,S=Ye.size(l)===1,E=o.length>0&&o[o.length-1]%4===0,C=l.length>0&&l[l.length-1]%4===0;x.push(b),x.push(S),x.push(E),x.push(C);let A=1;for(let D=1;D<c.length;D++){let O=o[o.length-D],V=l[l.length-D];if(O===V)A*=O;else break}A%4===0?(v=!0,h=!0):(b||S||E||C)&&(h=!0)}else h=!0;return x.push(h),{name:t,shaderCache:{hint:e+x.map(_=>_.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:_=>Px(_,o,l,c,h,u,v,i,n.dataType,r.dataType,s,a),getRunData:()=>({outputs:[{dims:c,dataType:s}],dispatchGroup:{x:Math.ceil(d/64/4)},programUniforms:[{type:12,data:Math.ceil(Ye.size(c)/4)},...Ht(o,l,c)]})}},Na=(t,e,n,r,i,a)=>{t.compute(Rx(e,i??"",t.inputs[0],t.inputs[1],n,r,a))},JM=t=>{Na(t,"Add",(e,n)=>`${e}+${n}`)},QM=t=>{Na(t,"Div",(e,n)=>`${e}/${n}`)},eE=t=>{Na(t,"Equal",{scalar:(e,n)=>`u32(${e}==${n})`,vector:(e,n)=>`vec4<u32>(${e}==${n})`},void 0,void 0,9)},tE=t=>{Na(t,"Mul",(e,n)=>`${e}*${n}`)},nE=t=>{let e=rt("input",t.inputs[0].dataType,t.inputs[0].dims).type.value;Na(t,"Pow",{scalar:(n,r)=>`pow_custom(${n},${r})`,vector:(n,r)=>`pow_vector_custom(${n},${r})`},`
    fn pow_custom(a : ${e}, b : ${e}) -> ${e} {
      if (b == ${e}(0.0)) {
        return ${e}(1.0);
      } else if (a < ${e}(0.0) && f32(b) != floor(f32(b))) {
        return ${e}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${e}(1.0), round(f32(abs(b) % ${e}(2.0))) != 1.0) * ${e}(${e==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${e}>, b : vec4<${e}>) -> vec4<${e}> {
      // TODO: implement vectorized pow
      return vec4<${e}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},rE=t=>{Na(t,"Sub",(e,n)=>`${e}-${n}`)},iE=t=>{Na(t,"Greater",{scalar:(e,n)=>`u32(${e}>${n})`,vector:(e,n)=>`vec4<u32>(${e}>${n})`},void 0,void 0,9)},aE=t=>{Na(t,"Less",{scalar:(e,n)=>`u32(${e}<${n})`,vector:(e,n)=>`vec4<u32>(${e}<${n})`},void 0,void 0,9)},sE=t=>{Na(t,"GreaterOrEqual",{scalar:(e,n)=>`u32(${e}>=${n})`,vector:(e,n)=>`vec4<u32>(${e}>=${n})`},void 0,void 0,9)},oE=t=>{Na(t,"LessOrEqual",{scalar:(e,n)=>`u32(${e}<=${n})`,vector:(e,n)=>`vec4<u32>(${e}<=${n})`},void 0,void 0,9)}}),Dx,Lx,zx,Ox,lE,uE,mU=bt(()=>{Qt(),dn(),xr(),gn(),Dx=(t,e)=>{if(!t||t.length<1)throw new Error("too few inputs");let n=0,r=t[n],i=r.dataType,a=r.dims.length;t.forEach((s,o)=>{if(o!==n){if(s.dataType!==i)throw new Error("input tensors should be one type");if(s.dims.length!==a)throw new Error("input tensors should have the same shape");s.dims.forEach((l,u)=>{if(u!==e&&l!==r.dims[u])throw new Error("non concat dimensions must match")})}})},Lx=(t,e)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${t}u>(${e});
    for (var i: u32 = 0u; i < ${t}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${t}u;
  }`,zx=(t,e)=>{let n=t.length,r=[];for(let i=0;i<n;++i){let a=e.setByOffset("global_idx",t[i].getByIndices("indices"));n===1?r.push(a):i===0?r.push(`if (inputIndex == ${i}u) { ${a} }`):i===n-1?r.push(`else { ${a} }`):r.push(`else if (inputIndex == ${i}) { ${a} }`)}return r.join(`
`)},Ox=(t,e,n,r)=>{let i=Ye.size(n),a=new Array(t.length),s=new Array(t.length),o=0,l=[],u=[],c=[{type:12,data:i}];for(let _=0;_<t.length;++_)o+=t[_].dims[e],a[_]=o,u.push(t[_].dims.length),s[_]=rt(`input${_}`,r,u[_]),l.push("rank"),c.push({type:12,data:a[_]});for(let _=0;_<t.length;++_)c.push(...Ht(t[_].dims));c.push(...Ht(n));let d=Bt("output",r,n.length),h=d.indicesGet("indices",e),v=Array.from(Array(a.length).keys()).map(_=>`uniforms.sizeInConcatAxis${_}`).join(","),x=_=>`

  ${(()=>{_.registerUniform("outputSize","u32");for(let b=0;b<t.length;b++)_.registerUniform(`sizeInConcatAxis${b}`,"u32");return _.declareVariables(...s,d)})()}

  ${Lx(a.length,v)}

  ${_.mainStart()}
    ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${d.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${h});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${a.length}u>(${v});
      ${h} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${zx(s,d)}
  }`;return{name:"Concat",shaderCache:{hint:`${e}`,inputDependencies:l},getRunData:()=>({outputs:[{dims:n,dataType:r}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:c}),getShaderSource:x}},lE=(t,e)=>{let n=t.inputs,r=n[0].dims,i=Ye.normalizeAxis(e.axis,r.length);Dx(n,i);let a=r.slice();a[i]=n.reduce((o,l)=>o+(l.dims.length>i?l.dims[i]:0),0);let s=n.filter(o=>Ye.size(o.dims)>0);t.compute(Ox(s,i,a,n[0].dataType),{inputs:s})},uE=t=>qn({axis:t.axis})}),hu,pu,mu,$y,wu=bt(()=>{Qt(),dn(),hu=(t,e,n="f32")=>{switch(t.activation){case"Relu":return`value = max(value, ${e}(0.0));`;case"Sigmoid":return`value = (${e}(1.0) / (${e}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${e}(${n}(uniforms.clip_min)), ${e}(${n}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${e}(0.0), min(${e}(1.0), ${n}(uniforms.alpha) * value + ${n}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${n}(uniforms.alpha) * value, value, value >= ${e}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw new Error(`Unsupported activation ${t.activation}`)}},pu=(t,e)=>{t.activation==="Clip"?e.push({type:1,data:t.clipMax},{type:1,data:t.clipMin}):t.activation==="HardSigmoid"?e.push({type:1,data:t.alpha},{type:1,data:t.beta}):t.activation==="LeakyRelu"&&e.push({type:1,data:t.alpha})},mu=(t,e)=>{t.activation==="Clip"?e.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):t.activation==="HardSigmoid"?e.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):t.activation==="LeakyRelu"&&e.push({name:"alpha",type:"f32"})},$y=t=>{let e=(t==null?void 0:t.activation)||"";if(e==="HardSigmoid"){let[n,r]=(t==null?void 0:t.activation_params)||[.2,.5];return{activation:e,alpha:n,beta:r}}else if(e==="Clip"){let[n,r]=(t==null?void 0:t.activation_params)||[B7,F7];return{activation:e,clipMax:r,clipMin:n}}else if(e==="LeakyRelu"){let[n]=(t==null?void 0:t.activation_params)||[.01];return{activation:e,alpha:n}}return{activation:e}}}),Wr,cE,Py=bt(()=>{Wr=(t,e)=>{switch(t){case 1:return e;case 2:return`vec2<${e}>`;case 3:return`vec3<${e}>`;case 4:return`vec4<${e}>`;default:throw new Error(`${t}-component is not supported.`)}},cE=t=>`
      ${t?"value = value + getBiasByOutputCoords(coords);":""}
      `}),dE,gU=bt(()=>{dE=t=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${t}.x), i32(${t}.y), i32(${t}.z), 1));
}
`}),ff,Ry,Dy=bt(()=>{Qt(),dn(),gn(),wu(),ff=(t,e,n,r,i)=>{let a=r-n;return`
      ${Array.from({length:n}).map((s,o)=>`
      if (${Ut(e.shape,o,e.rank)} != 1) {
        ${e.indicesSet(t,o,Ut(i,o+a,r))}
      } else {
        ${e.indicesSet(t,o,0)}
      }`).join("")}
`},Ry=(t,e,n,r,i=!1,a)=>{let s=t[0].dims,o=t[1].dims,l=s[s.length-2],u=o[o.length-1],c=s[s.length-1],d=hr(u),h=hr(c),v=hr(l),x=Ye.size(n)/d/v,_=t.length>2,b=r?r.slice(0,-2):n.slice(0,-2),S=[Ye.size(b),l,u],E=[{type:12,data:x},{type:12,data:l},{type:12,data:u},{type:12,data:c}];pu(e,E),E.push(...Ht(b,s,o)),_&&E.push(...Ht(t[2].dims)),E.push(...Ht(S));let C=A=>{let D=Cy("batch_dims",t[0].dataType,b.length),O=rt("a",t[0].dataType,s.length,h),V=rt("b",t[1].dataType,o.length,d),P=Bt("output",t[0].dataType,S.length,d),U=zr(P.type.tensor),Y=hu(e,P.type.value,U),fe=[O,V],Q="";if(_){let he=i?d:1;fe.push(rt("bias",t[2].dataType,t[2].dims.length,he)),Q=`${i?`value += bias[col / ${he}];`:`value += ${P.type.value}(bias[row + i]);`}`}let G=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];mu(e,G);let re=()=>{let he=`var a_data: ${O.type.value};`;for(let ye=0;ye<h;ye++)he+=`
              let b_data${ye} = b[(b_offset + (k + ${ye}) * uniforms.N + col) / ${d}];`;for(let ye=0;ye<v;ye++){he+=`a_data = a[(a_offset + (row + ${ye}) * uniforms.K + k) / ${h}];`;for(let $e=0;$e<h;$e++)he+=`
            values[${ye}] = fma(${V.type.value}(a_data${h===1?"":`[${$e}]`}), b_data${$e}, values[${ye}]);
`}return he};return`
  ${A.registerUniforms(G).registerInternalVariables(D).declareVariables(...fe,P)}
  ${A.mainStart()}
    ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${d})) * ${d};
    var index1 = global_idx / (uniforms.N / ${d});
    let stride1 = uniforms.M / ${v};
    let row = (index1 % stride1) * ${v};
    let batch = index1 / stride1;

    ${n.length===2?"":`let batch_indices = ${D.offsetToIndices("batch")};`}

    var a_indices: ${O.type.indices};
    ${ff("a_indices",O,O.rank-2,D.rank,"batch_indices")}
    ${O.indicesSet("a_indices",O.rank-2,0)}
    ${O.indicesSet("a_indices",O.rank-1,0)}
    let a_offset = ${O.indicesToOffset("a_indices")};

    var b_indices: ${V.type.indices};
    ${ff("b_indices",V,V.rank-2,D.rank,"batch_indices")}
    ${V.indicesSet("b_indices",V.rank-2,0)}
    ${V.indicesSet("b_indices",V.rank-1,0)}
    let b_offset = ${V.indicesToOffset("b_indices")};
    var values: array<${P.type.value}, ${v}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${h}) {
      ${re()}
    }
    for (var i = 0u; i < ${v}u; i++) {
      var value = values[i];
      ${Q}
      ${Y}
      let cur_indices = ${P.type.indices}(batch, row + i, col);
      let offset = ${P.indicesToOffset("cur_indices")};
      ${P.setByOffset(`offset / ${d}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${e.activation};${d};${h};${v};${i}`,inputDependencies:_?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:a?a(n):n,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(x/64)},programUniforms:E}),getShaderSource:C}}}),Nx,Bx,Yv,Mg,Fx,Zv,Ux,rp,Ly=bt(()=>{Qt(),dn(),gn(),wu(),Dy(),Py(),Nx=(t,e)=>t?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${e?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${e?", batchIndices":""});
        `,Bx=(t,e)=>t?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${e===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${e===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${e===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,Yv=(t,e,n="f32",r,i=!1,a=32,s=!1,o=32)=>{let l=e[1]*t[1],u=e[0]*t[0],c=i?l:a,d=i?a:l,h=c/e[0],v=a/e[1];if(!((i&&h===4&&t[1]===4||!i&&(h===3||h===4))&&c%e[0]===0&&a%e[1]===0&&t[0]===4))throw new Error(`If transposeA ${i} is true, innerElementSize ${h} and workPerThread[1] ${t[1]} must be 4.
      Otherwise, innerElementSize ${h} must be 3 or 4.
  tileAWidth ${c} must be divisible by workgroupSize[0]${e[0]}. tileInner ${a} must be divisible by workgroupSize[1] ${e[1]}. colPerThread ${t[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${h}<${n}>, ${c/h}>, ${d}>;
var<workgroup> mm_Bsub: array<array<vec4<${n}>, ${u/t[0]}>, ${a}>;

const rowPerThread = ${t[1]};
const colPerThread = ${t[0]};
const innerElementSize = ${h};
const tileInner = ${a};

@compute @workgroup_size(${e[0]}, ${e[1]}, ${e[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${s?"0":"i32(globalId.z)"};
  ${r?`let batchIndices = ${r.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${l};

  let num_tiles = ${s?`${Math.ceil(o/a)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${s?`i32(globalId.z) * ${o}`:"0"};

  var acc: array<vec4<${n}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${v};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${Nx(i,r)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${r?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${h===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${Bx(i,h)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},Mg=(t,e)=>t?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${e?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${e?", batchIndices":""});
            `,Fx=t=>t?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",Zv=(t,e,n="f32",r,i=!1,a=32,s=!1,o=32,l=!1)=>{let u=t[1]*e[1],c=t[0]*e[0],d=i?u:a,h=i?a:u;if(!(h%e[1]===0&&d%e[0]===0&&a%e[1]===0))throw new Error(`tileAHight ${h} must be divisible by workgroupSize[1]${e[1]}, tileAWidth ${d} must be divisible by workgroupSize[0]${e[0]}, tileInner ${a} must be divisible by workgroupSize[1]${e[1]}`);let v=h/e[1],x=d/e[0],_=a/e[1],b=l?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${u};
    let globalColStart = i32(workgroupId.x) * ${c};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${h}; inputRow = inputRow + ${e[1]}) {
        for (var inputCol = localCol; inputCol < ${d}; inputCol = inputCol + ${e[0]}) {
          ${Mg(i,r)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${a}; inputRow = inputRow + ${e[1]}) {
            for (var inputCol = localCol; inputCol < ${c}; inputCol = inputCol + ${e[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${r?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${n}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${e[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${i?`mm_Asub[k][localRow + innerRow * ${e[1]}];`:`mm_Asub[localRow + innerRow * ${e[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${e[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${e[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${u};

let tileRowA = i32(localId.y) * ${v};
let tileColA = i32(localId.x) * ${x};
let tileRowB = i32(localId.y) * ${_};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${x}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${Mg(i,r)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${_}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${r?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${n}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${Fx(i)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${n}, ${d}>, ${h}>;
  var<workgroup> mm_Bsub : array<array<${n}, ${c}>, ${a}>;
  const rowPerThread = ${t[1]};
  const colPerThread = ${t[0]};
  const tileInner = ${a};

@compute @workgroup_size(${e[0]}, ${e[1]}, ${e[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${s?"0":"i32(globalId.z)"};
    ${r?`let batchIndices = ${r.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${s?`${Math.ceil(o/a)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${s?`i32(globalId.z) * ${o}`:"0"};

    var acc : array<array<${n}, colPerThread>, rowPerThread>;
    ${b}
  }
`},Ux=(t,e,n,r,i=!1)=>{let[a,s,o,l]=r,u=zr(r[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${a.type.indices}) -> ${Wr(t,u)} {
      var value = ${Wr(t,u)}(0.0);
      let col = colIn * ${t};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${s.type.indices};
        ${ff("aIndices",s,s.rank-2,a.rank,"batchIndices")}
        ${s.indicesSet("aIndices",s.rank-2,"u32(row)")}
        ${s.indicesSet("aIndices",s.rank-1,"u32(colIn)")}
        value = ${s.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${a.type.indices}) -> ${Wr(t,u)} {
      var value = ${Wr(t,u)}(0.0);
      let col = colIn * ${t};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${o.type.indices};
        ${ff("bIndices",o,o.rank-2,a.rank,"batchIndices")}
        ${o.indicesSet("bIndices",o.rank-2,"u32(row)")}
        ${o.indicesSet("bIndices",o.rank-1,"u32(colIn)")}
        value = ${o.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${Wr(t,u)}) {
      let col = colIn * ${t};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${e?`value = value + ${i?"bias[colIn]":`${Wr(t,u)}(bias[row])`};`:""}
        ${n}
        ${l.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},rp=(t,e,n,r,i=!1,a)=>{let s=t[0].dims,o=t[1].dims,l=s.slice(0,-2),u=o.slice(0,-2),c=r?r.slice(0,-2):n.slice(0,-2),d=Ye.size(c),h=s[s.length-2],v=s[s.length-1],x=o[o.length-1],_=v%4===0&&x%4===0,b=h<=8?[4,1,1]:[4,4,1],S=[8,8,1],E=[Math.ceil(x/S[0]/b[0]),Math.ceil(h/S[1]/b[1]),Math.ceil(d/S[2]/b[2])],C=_?4:1,A=[...l,h,v/C],D=A.length,O=[...u,v,x/C],V=O.length,P=[d,h,x/C],U=[{type:6,data:h},{type:6,data:x},{type:6,data:v}];pu(e,U),U.push(...Ht(c,A,O));let Y=["rank","rank"],fe=t.length>2;fe&&(U.push(...Ht(t[2].dims)),Y.push("rank")),U.push(...Ht(P));let Q=G=>{let re=c.length,he=Cy("batchDims",t[0].dataType,re,1),ye=zr(t[0].dataType),$e=rt("a",t[0].dataType,D,C),_e=rt("b",t[1].dataType,V,C),de=Bt("result",t[0].dataType,P.length,C),Oe=[$e,_e];if(fe){let ne=i?C:1;Oe.push(rt("bias",t[2].dataType,t[2].dims.length,ne))}let ve=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];mu(e,ve);let ie=zr(de.type.tensor),Pe=hu(e,de.type.value,ie),et=Ux(C,fe,Pe,[he,$e,_e,de],i);return`
  ${G.registerUniforms(ve).registerInternalVariables(he).declareVariables(...Oe,de)}
  ${et}
  ${_?Yv(b,S,ye,he):Zv(b,S,ye,he)}
                   `};return{name:"MatMul",shaderCache:{hint:`${b};${e.activation};${_};${i}`,inputDependencies:Y},getRunData:()=>({outputs:[{dims:a?a(n):n,dataType:t[0].dataType}],dispatchGroup:{x:E[0],y:E[1],z:E[2]},programUniforms:U}),getShaderSource:Q}}}),Vx,fE,vU=bt(()=>{Qt(),co(),gn(),wu(),Py(),gU(),Ly(),Vx=(t,e,n,r,i=!1,a,s=4,o=4,l=4,u="f32")=>{let c=U=>{switch(U){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${u}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${U} is not supported.`)}},d=U=>{switch(U){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${U} is not supported.`)}},h=t?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,v=t?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,x=t?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",_=t?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",b=t?"row":"col",S=t?"col":"row",E=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${t?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${b} / outWidth;
    let outCol = ${b} % outWidth;

    let WRow = ${S} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${S} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${S} % inChannels;
    var resData = ${Wr(s,u)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${x} && xCol >= 0 && xCol < ${_}) {
      ${h}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${c(s)}
    }
    return resData;`,C=t?e&&r?`
    let col = colIn * ${s};
    ${E}`:`
    let col = colIn * ${s};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${E}
    }
    return ${Wr(s,u)}(0.0);`:r&&n?`
    let col = colIn * ${s};
    ${E}`:`
    let col = colIn * ${s};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${E}
    }
    return ${Wr(s,u)}(0.0);`,A=t?r&&n?d(o):`
    let col = colIn * ${o};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${d(o)}
    }
    return ${Wr(o,u)}(0.0);`:`
    let col = colIn * ${o};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${d(o)}
    }
    return ${Wr(o,u)}(0.0);`,D=Wr(l,u),O=Wr(t?s:o,u),V=Wr(t?o:s,u),P=hu(a,D,u);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${O} {
      ${t?C:A}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${V} {
      ${t?A:C}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${D}) {
      let col = colIn * ${l};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${t?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${v}
      ${cE(i)}
      ${P}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},fE=(t,e,n,r,i,a,s,o,l)=>{let u=e.format==="NHWC",c=u?t[0].dims[3]:t[0].dims[1],d=n[0],h=u?n[2]:n[3],v=u?n[1]:n[2],x=u?n[3]:n[1],_=u&&(c%4===0||c%3===0)&&x%4===0,b=u?x:h*v,S=u?h*v:x,E=[8,8,1],C=r<=8?[4,1,1]:[4,4,1],A=[Math.ceil(b/E[0]/C[0]),Math.ceil(S/E[1]/C[1]),Math.ceil(d/E[2]/C[2])];Ln("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${A}`);let D=_?u&&c%4!==0?3:4:1,O=E[1]*C[1],V=E[0]*C[0],P=Math.max(E[0]*D,E[1]),U=r%O===0,Y=i%V===0,fe=a%P===0,Q=_?[D,4,4]:[1,1,1],G=[{type:6,data:r},{type:6,data:i},{type:6,data:a},{type:6,data:[e.pads[0],e.pads[1]]},{type:6,data:e.strides},{type:6,data:e.dilations}];pu(e,G),G.push(...Ht(t[0].dims,t[1].dims));let re=["rank","rank"];s&&(G.push(...Ht(t[2].dims)),re.push("rank")),G.push(...Ht(n));let he=ye=>{let $e=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];mu(e,$e);let _e=_?4:1,de=zr(t[0].dataType),Oe=`
      fn setOutputAtIndex(flatIndex : i32, value : ${_?`vec4<${de}>`:de}) {
        result[flatIndex] = ${_?`vec4<${de}>`:de}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${_?`vec4<${de}>`:de}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${_?"/ 4":""}, value);
      }`,ve=rt("x",t[0].dataType,t[0].dims.length,D===3?1:D),ie=rt("w",t[1].dataType,t[1].dims.length,_e),Pe=[ve,ie],et=Bt("result",t[0].dataType,n.length,_e);if(s){let ne=rt("bias",t[2].dataType,t[2].dims.length,_e);Pe.push(ne),Oe+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${_?`vec4<${de}>`:de} {
          return bias[coords.${u?"w":"y"}${_?"/ 4":""}];
        }`}return`
        ${dE("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${ye.registerUniforms($e).declareVariables(...Pe,et)}
        ${Oe}
        ${Vx(u,U,Y,fe,s,e,Q[0],Q[1],Q[2],de)}
        ${_?Yv(C,E,de,void 0,!u,P):Zv(C,E,de,void 0,!u,P,!1,void 0,o)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${e.cacheKey};${D};${_};${U};${Y};${fe};${O};${V};${P}`,inputDependencies:re},getRunData:()=>({outputs:[{dims:l?l(n):n,dataType:t[0].dataType}],dispatchGroup:{x:A[0],y:A[1],z:A[2]},programUniforms:G}),getShaderSource:he}}}),Hx,Eg,Od,Wx,Tg,Gx,hE,pE,yU=bt(()=>{Qt(),co(),dn(),gn(),wu(),Py(),Hx=t=>{let e=1;for(let n=0;n<t.length;n++)e*=t[n];return e},Eg=t=>typeof t=="number"?[t,t,t]:t,Od=(t,e)=>e<=1?t:t+(t-1)*(e-1),Wx=(t,e,n,r=1)=>{let i=Od(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)},Tg=(t,e,n,r,i)=>{i==null&&(i=Wx(t,e[0],r[0]));let a=[0,0,0,n];for(let s=0;s<3;s++)t[s]+2*i>=e[s]&&(a[s]=Math.trunc((t[s]-e[s]+2*i)/r[s]+1));return a},Gx=(t,e,n,r,i,a,s,o,l,u)=>{let c,d,h,v;if(t==="VALID"&&(t=0),typeof t=="number"){c={top:t,bottom:t,left:t,right:t,front:t,back:t};let x=Tg([e,n,r,1],[o,l,u],1,[i,a,s],t);d=x[0],h=x[1],v=x[2]}else if(Array.isArray(t)){if(!t.every((_,b,S)=>_===S[0]))throw Error(`Unsupported padding parameter: ${t}`);c={top:t[0],bottom:t[1],left:t[2],right:t[3],front:t[4],back:t[5]};let x=Tg([e,n,r,1],[o,l,u],1,[i,a,s],t[0]);d=x[0],h=x[1],v=x[2]}else if(t==="SAME_UPPER"){d=Math.ceil(e/i),h=Math.ceil(n/a),v=Math.ceil(r/s);let x=(d-1)*i+o-e,_=(h-1)*a+l-n,b=(v-1)*s+u-r,S=Math.floor(x/2),E=x-S,C=Math.floor(_/2),A=_-C,D=Math.floor(b/2),O=b-D;c={top:C,bottom:A,left:D,right:O,front:S,back:E}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outDepth:d,outHeight:h,outWidth:v}},hE=(t,e,n,r,i,a=!1,s="channelsLast")=>{let o,l,u,c,d;if(s==="channelsLast")[o,l,u,c,d]=t;else if(s==="channelsFirst")[o,d,l,u,c]=t;else throw new Error(`Unknown dataFormat ${s}`);let[h,,v,x,_]=e,[b,S,E]=Eg(n),[C,A,D]=Eg(r),O=Od(v,C),V=Od(x,A),P=Od(_,D),{padInfo:U,outDepth:Y,outHeight:fe,outWidth:Q}=Gx(i,l,u,c,b,S,E,O,V,P),G=a?h*d:h,re=[0,0,0,0,0];return s==="channelsFirst"?re=[o,G,Y,fe,Q]:s==="channelsLast"&&(re=[o,Y,fe,Q,G]),{batchSize:o,dataFormat:s,inDepth:l,inHeight:u,inWidth:c,inChannels:d,outDepth:Y,outHeight:fe,outWidth:Q,outChannels:G,padInfo:U,strideDepth:b,strideHeight:S,strideWidth:E,filterDepth:v,filterHeight:x,filterWidth:_,effectiveFilterDepth:O,effectiveFilterHeight:V,effectiveFilterWidth:P,dilationDepth:C,dilationHeight:A,dilationWidth:D,inShape:t,outShape:re,filterShape:e}},pE=(t,e,n,r,i,a)=>{let s=a==="channelsLast";s?t[0].dims[3]:t[0].dims[1];let o=[64,1,1],l={x:n.map((b,S)=>S)},u=[Math.ceil(Hx(l.x.map(b=>n[b]))/o[0]),1,1];Ln("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${u}`);let c=1,d=Ye.size(n),h=[{type:12,data:d},{type:12,data:r},{type:12,data:i},{type:12,data:e.strides},{type:12,data:e.dilations}];pu(e,h),h.push(...Ht(t[0].dims,t[1].dims));let v=["rank","rank"],x=t.length===3;x&&(h.push(...Ht(t[2].dims)),v.push("rank")),h.push(...Ht(n));let _=b=>{let S=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:r.length},{name:"pads",type:"u32",length:i.length},{name:"strides",type:"u32",length:e.strides.length},{name:"dilations",type:"u32",length:e.dilations.length}];mu(e,S);let E=1,C=zr(t[0].dataType),A=rt("x",t[0].dataType,t[0].dims.length,c),D=rt("W",t[1].dataType,t[1].dims.length,E),O=[A,D],V=Bt("result",t[0].dataType,n.length,E),P="";if(x){let fe=rt("bias",t[2].dataType,t[2].dims.length,E);O.push(fe),P+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${C} {
          return bias[${s?Ut("coords",4,5):Ut("coords",1,5)}];
        }`}let U=Wr(c,C),Y=hu(e,U,C);return`
            ${P}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${A.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${D.getByIndices("aIndices")};
            }
          ${b.registerUniforms(S).declareVariables(...O,V)}
          ${b.mainStart()}
          ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${V.offsetToIndices("global_idx")};
              let batch = ${Ut("coords",0,A.rank)};
              let d2 = ${s?Ut("coords",A.rank-1,A.rank):Ut("coords",1,A.rank)};
              let xFRCCorner = vec3<u32>(${s?Ut("coords",1,A.rank):Ut("coords",2,A.rank)},
              ${s?Ut("coords",2,A.rank):Ut("coords",3,A.rank)},
              ${s?Ut("coords",3,A.rank):Ut("coords",4,A.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${s?Ut("uniforms.x_shape",1,A.rank):Ut("uniforms.x_shape",2,A.rank)};
              let xShapeZ = ${s?Ut("uniforms.x_shape",2,A.rank):Ut("uniforms.x_shape",3,A.rank)};
              let xShapeW = ${s?Ut("uniforms.x_shape",3,A.rank):Ut("uniforms.x_shape",4,A.rank)};
              let xShapeU = ${s?Ut("uniforms.x_shape",4,A.rank):Ut("uniforms.x_shape",1,A.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${s?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${s?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${s?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${s?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${x?"value = value + getBiasByOutputCoords(coords)":""};
              ${Y}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${e.cacheKey};${s};${c};${x}`,inputDependencies:v},getRunData:()=>({outputs:[{dims:n,dataType:t[0].dataType}],dispatchGroup:{x:u[0],y:u[1],z:u[2]},programUniforms:h}),getShaderSource:_}}}),mE,gE,_U=bt(()=>{Qt(),dn(),gn(),wu(),mE=(t,e,n,r)=>{let i=t.length>2,a=i?"value += b[output_channel];":"",s=t[0].dims,o=t[1].dims,l=e.format==="NHWC",u=l?n[3]:n[1],c=u/e.group,d=l&&c>=4?hr(u):1,h=Ye.size(n)/d,v=[{type:12,data:h},{type:12,data:e.dilations},{type:12,data:[e.strides[0],e.strides[1]]},{type:12,data:[e.pads[0],e.pads[1]]},{type:12,data:c}];pu(e,v),v.push(...Ht(s,[o[0],o[1],o[2],o[3]/d]));let x=i?["rank","rank","rank"]:["rank","rank"];v.push(...Ht([n[0],n[1],n[2],n[3]/d]));let _=b=>{let S=Bt("output",t[0].dataType,n.length,d),E=zr(S.type.tensor),C=hu(e,S.type.value,E),A=rt("x",t[0].dataType,s.length),D=rt("w",t[1].dataType,o.length,d),O=[A,D];i&&O.push(rt("b",t[2].dataType,t[2].dims,d));let V=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:e.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];mu(e,V);let P=l?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${A.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${D.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${A.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${D.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${b.registerUniforms(V).declareVariables(...O,S)}

  ${b.mainStart()}
    ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${S.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${l?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${l?1:2}], outputIndices[${l?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${d} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${l?2:1}];

    var value: ${S.type.value} = ${S.type.value}(0);
    ${P}
    ${a}
    ${C}
    ${S.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${e.cacheKey}_${d}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:r?r(n):n,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:v}),getShaderSource:_}},gE=(t,e,n,r)=>{let i=t.length>2,a=hr(n[3]),s=hr(n[2]),o=Ye.size(n)/a/s,l=[t[0].dims[0],t[0].dims[1],t[0].dims[2],t[0].dims[3]/a],u=[t[1].dims[0],t[1].dims[1],t[1].dims[2],t[1].dims[3]/a],c=[n[0],n[1],n[2],n[3]/a],d=[{type:12,data:o},{type:6,data:[e.strides[0],e.strides[1]]},{type:6,data:[e.pads[0],e.pads[1]]}];pu(e,d),d.push(...Ht(l,u,c));let h=(s-1)*e.strides[1]+u[1],v=x=>{let _=Bt("output",t[0].dataType,c.length,a),b=zr(_.type.tensor),S=hu(e,_.type.value,b),E=rt("x",t[0].dataType,l.length,a),C=rt("w",t[1].dataType,u.length,a),A=[E,C];i&&A.push(rt("b",t[2].dataType,t[2].dims,a));let D=i?"value += b[output_channel];":"",O=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return mu(e,O),`
  ${x.registerUniforms(O).declareVariables(...A,_)}
  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${s}u;
    let col = (index1 % width1) * ${s}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${E.type.value}, ${h}>;
    var values: array<${_.type.value}, ${s}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${u[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${h}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${E.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${E.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${u[1]}; w_width++) {
          let w_val = ${C.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${s}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${s}u; i++) {
      var value = values[i];
      ${D}
      ${S}
      ${_.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${e.cacheKey};${a};${s};${h};${u[0]};${u[1]}`,inputDependencies:i?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r?r(n):n,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:d}),getShaderSource:v}}}),qx,d0,jx,f0,Jv,Cg,Xx,Kx,Qv,bU=bt(()=>{dn(),vU(),yU(),Ly(),_U(),wu(),Dy(),fl(),qx=(t,e,n,r,i,a)=>{let s=t[0],o=t.slice(a?1:2,a?3:4),l=o.length,u=e[0],c=e.slice(2).map((h,v)=>h+(h-1)*(n[v]-1)),d=o.map((h,v)=>h+r[v]+r[v+l]).map((h,v)=>Math.floor((h-c[v]+i[v])/i[v]));return d.splice(0,0,s),d.splice(a?3:1,0,u),d},d0=[2,3,1,0],jx=(t,e)=>{if(!t||t.length!==2&&t.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(t[0].dims.length>5)throw new Error("greater than 5D is not supported");if(t[0].dims.length!==t[1].dims.length)throw new Error("filter does not have same dimension as input");let n=t[0].dims[e.format==="NHWC"?t[0].dims.length-1:1],r=t[1].dims[1]*e.group;if(n!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(t.length===3&&(t[2].dims.length!==1||t[1].dims[0]!==t[2].dims[0]))throw new Error("invalid bias");let i=t[0].dims.length-2;if(e.dilations.length!==i)throw new Error(`dilations should be ${i}D`);if(e.strides.length!==i)throw new Error(`strides should be ${i}D`);if(e.pads.length!==i*2)throw new Error(`pads should be ${i*2}D`);if(e.kernelShape.length!==0&&e.kernelShape.length!==t[1].dims.length-2)throw new Error("invalid kernel shape")},f0=(t,e)=>{let n=t.kernelShape.slice();n.length<e[1].dims.length-2&&n.push(...Array(e[1].dims.length-2-n.length).fill(0));for(let a=2;a<e[1].dims.length;++a)n[a-2]===0&&(n[a-2]=e[1].dims[a]);let r=t.pads.slice();tp.adjustPadsBasedOnAutoPad(e[0].dims,t.strides,t.dilations,n,r,t.format==="NHWC",t.autoPad);let i=Object.assign({},t);return Object.assign(i,{kernelShape:n,pads:r}),i},Jv=t=>{let e=$y(t),n=t.format,r=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][t.auto_pad],i=t.dilations,a=t.group,s=t.kernel_shape,o=t.pads,l=t.strides,u=t.w_is_const();return{autoPad:r,format:n,dilations:i,group:a,kernelShape:s,pads:o,strides:l,wIsConst:u,...e,cacheKey:`${t.format};${e.activation};`}},Cg=(t,e,n,r)=>{let i=n.format==="NHWC",a=qx(e[0].dims,e[1].dims,n.dilations,n.pads,n.strides,i);if(n.group!==1){let O=[e[0]];if(i){let V=t.kernelCustomData.wT??t.compute(aa(e[1],d0),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!t.kernelCustomData.wT&&(t.kernelCustomData.wT=V),O.push(V)}else O.push(e[1]);e.length===3&&O.push(e[2]),!t.adapterInfo.isArchitecture("ampere")&&i&&e[1].dims[0]===n.group&&e[1].dims[1]===1&&n.dilations[0]===1&&n.dilations[1]===1?t.compute(gE(O,n,a,r),{inputs:O}):t.compute(mE(O,n,a,r),{inputs:O});return}let s=e.length===3,o=e[0].dims[i?1:2],l=e[0].dims[i?2:3],u=e[0].dims[i?3:1],c=e[1].dims[2],d=e[1].dims[3],h=a[i?1:2],v=a[i?2:3],x=a[i?3:1],_=i&&c===o&&d===l&&n.pads[0]===0&&n.pads[1]===0;if(_||c===1&&d===1&&n.dilations[0]===1&&n.dilations[1]===1&&n.strides[0]===1&&n.strides[1]===1&&n.pads[0]===0&&n.pads[1]===0){let O=a[0],V,P,U,Y=[];if(i){let G=t.kernelCustomData.wT??t.compute(aa(e[1],d0),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];if(n.wIsConst&&!t.kernelCustomData.wT&&(t.kernelCustomData.wT=G),_){let re=o*l*u;V=e[0].reshape([1,O,re]),P=G.reshape([1,re,x]),U=[1,O,x]}else V=e[0].reshape([O,o*l,u]),P=G.reshape([1,u,x]),U=[O,h*v,x];Y.push(V),Y.push(P)}else V=e[0].reshape([O,u,o*l]),P=e[1].reshape([1,x,u]),U=[O,x,h*v],Y.push(P),Y.push(V);s&&Y.push(e[2]);let fe=U[2],Q=Y[0].dims[Y[0].dims.length-1];fe<8&&Q<8?t.compute(Ry(Y,n,a,U,i,r),{inputs:Y}):t.compute(rp(Y,n,a,U,i,r),{inputs:Y});return}let b=!0,S=t.kernelCustomData.wT??t.compute(aa(e[1],d0),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!t.kernelCustomData.wT&&(t.kernelCustomData.wT=S);let E=[e[0],S];s&&E.push(e[2]);let C=i?h*v:x,A=i?x:h*v,D=c*d*u;t.compute(fE(E,n,a,C,A,D,s,b,r),{inputs:E})},Xx=(t,e)=>{let n=e.format==="NHWC",r=[t.inputs[0].reshape(n?[t.inputs[0].dims[0],1,t.inputs[0].dims[1],t.inputs[0].dims[2]]:[t.inputs[0].dims[0],t.inputs[0].dims[1],1,t.inputs[0].dims[2]]),t.inputs[1].reshape([t.inputs[1].dims[0],t.inputs[1].dims[1],1,t.inputs[1].dims[2]])];t.inputs.length===3&&r.push(t.inputs[2]);let i=[0,e.pads[0],0,e.pads[1]],a=[1].concat(e.strides),s=[1].concat(e.dilations),o=[1].concat(e.kernelShape),l=f0({...e,pads:i,strides:a,dilations:s,kernelShape:o},r);Cg(t,r,l,u=>n?[u[0],u[2],u[3]]:[u[0],u[1],u[3]])},Kx=(t,e,n)=>{let r=n.format==="NHWC"?"channelsLast":"channelsFirst",i=f0(n,e),a=n.autoPad==="NOTSET"?n.pads:n.autoPad,s=hE(e[0].dims,e[1].dims,n.strides,n.dilations,a,!1,r);t.compute(pE(e,i,s.outShape,[s.filterDepth,s.filterHeight,s.filterWidth],[s.padInfo.front,s.padInfo.top,s.padInfo.left],r))},Qv=(t,e)=>{if(jx(t.inputs,e),t.inputs[0].dims.length===3)Xx(t,e);else if(t.inputs[0].dims.length===5)Kx(t,t.inputs,e);else{let n=f0(e,t.inputs);Cg(t,t.inputs,n)}}}),vE,xU=bt(()=>{Qt(),co(),dn(),gn(),vE=(t,e,n)=>{let r=t.length>2,i=e.outputShape,a=e.format==="NHWC",s=e.group,o=t[1].dims,l=o[2]/s,u=o[3],c=a?hr(l):1,d=a?hr(u):1,h=a?u===1?c:d:1,v=Ye.size(i)/d,x=[Math.ceil(v/64),1,1];Ln("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${x}`);let _=["rank","rank"],b=[e.strides[0],e.strides[1]],S=[e.kernelShape[a?1:2],e.kernelShape[a?2:3]],E=[e.dilations[0],e.dilations[1]],C=[S[0]+(e.dilations[0]<=1?0:(e.kernelShape[a?1:2]-1)*(e.dilations[0]-1)),S[1]+(e.dilations[1]<=1?0:(e.kernelShape[a?2:3]-1)*(e.dilations[1]-1))],A=[C[0]-1-Math.floor((e.pads[0]+e.pads[2])/2),C[1]-1-Math.floor((e.pads[1]+e.pads[3])/2)],D=[{type:12,data:v},{type:12,data:b},{type:12,data:S},{type:12,data:E},{type:12,data:C},{type:6,data:A},{type:12,data:l},{type:12,data:u},...Ht(t[0].dims,t[1].dims)];r&&(D.push(...Ht(t[2].dims)),_.push("rank")),D.push(...Ht(i));let O=V=>{let P=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:b.length},{name:"filter_dims",type:"u32",length:S.length},{name:"dilations",type:"u32",length:S.length},{name:"effective_filter_dims",type:"u32",length:C.length},{name:"pads",type:"i32",length:A.length},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],U=zr(t[0].dataType),Y=a?1:2,fe=a?2:3,Q=a?3:1,G=rt("W",t[1].dataType,t[1].dims.length,h),re=rt("Dy",t[0].dataType,t[0].dims.length,c),he=[re,G];r&&he.push(rt("bias",t[2].dataType,[i[Q]].length,d));let ye=Bt("result",t[0].dataType,i.length,d),$e=()=>{let de="";if(c===1)de+=`
        let w_offset = ${G.indicesToOffset(`${G.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
        let wValue = ${G.getByOffset(`w_offset / ${h}`)};
        dotProd = dotProd + xValue * wValue;`;else if(u===1)de+=`
          let wValue = ${G.getByOffset(`${G.indicesToOffset(`${G.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)} / ${h}`)};
          dotProd = dotProd + dot(xValue, wValue);`;else for(let Oe=0;Oe<c;Oe++)de+=`
            let wValue${Oe} = ${G.getByOffset(`${G.indicesToOffset(`${G.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${Oe}, wOutChannel)`)} / ${h}`)};
            dotProd = dotProd + xValue[${Oe}] * wValue${Oe};`;return de},_e=`
            let outputIndices = ${ye.offsetToIndices(`global_idx * ${d}`)};
            let batch = ${ye.indicesGet("outputIndices",0)};
            let d1 = ${ye.indicesGet("outputIndices",Q)};
            let r = ${ye.indicesGet("outputIndices",Y)};
            let c = ${ye.indicesGet("outputIndices",fe)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${ye.type.value}(0.0);
            var wR: u32 = 0;
            if (uniforms.dilations.x == 1) {
              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0
              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);
            }
            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${U}(dyRCorner) + ${U}(wR)) / ${U}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${U}(uniforms.Dy_shape[${Y}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              let idyR: u32 = u32(dyR);
              var wC: u32 = 0;
              if (uniforms.dilations.y == 1) {
                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0
                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);
              }

              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${U}(dyCCorner) + ${U}(wC)) / ${U}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${U}(uniforms.Dy_shape[${fe}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group; d2 = d2 + ${c}) {
                  let xValue = ${a?re.getByOffset(`${re.indicesToOffset(`${re.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${c}`):re.get("batch","inputChannel","idyR","idyC")};
                  ${$e()}
                  inputChannel = inputChannel + ${c};
                }
                wC = wC + uniforms.strides.y - 1;
              }
              wR = wR + uniforms.strides[0] - 1;
            }
            let value = dotProd${r?` + bias[d1 / ${d}]`:""};
            ${ye.setByOffset("global_idx","value")};
          `;return`
    ${V.registerUniforms(P).declareVariables(...he,ye)}
      ${V.mainStart()}
      ${V.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${_e}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${e.cacheKey};${c}${h}${d}${u===1}`,inputDependencies:_},getRunData:()=>({dispatchGroup:{x:x[0],y:x[1],z:x[2]},outputs:[{dims:n?n(i):i,dataType:t[0].dataType}],programUniforms:D}),getShaderSource:O}}}),Yx,Zx,Jx,Ag,yE,Qx,kg,ew,_E,wU=bt(()=>{xU(),wu(),fl(),Yx=(t,e,n,r,i,a)=>(t-1)*e+n+(r-1)*i+1-a,Zx=(t,e,n,r,i)=>{let a=Math.floor(t/2);e==="SAME_UPPER"?(n[r]=a,n[i]=t-a):e==="SAME_LOWER"&&(n[r]=t-a,n[i]=a)},Jx=(t,e,n,r,i,a,s,o,l,u)=>{let c=t.length-2,d=u.length===0;l.length<c&&l.push(...Array(c-l.length).fill(0));let h=t[0],v=e[o?3:1]*i;for(let x=0,_=t.length-c-(o?1:0);x<c;++x,++_){let b=t[_],S=d?b*s[x]:u[x],E=Yx(b,s[x],a[x],e[_],n[x],S);Zx(E,r,a,x,x+c),d&&u.push(s[x]*(b-1)+l[x]+(e[_]-1)*n[x]+1-a[x]-a[x+c])}u.splice(0,0,h),u.splice(o?3:1,0,v)},Ag=(t,e)=>{let n=t.kernelShape.slice();if(t.kernelShape.length===0||t.kernelShape.reduce((d,h)=>d*h,1)===0){n.length=0;for(let d=2;d<e[1].dims.length;++d)n.push(e[1].dims[d])}let r=t.format==="NHWC";n.splice(0,0,e[1].dims[0]),n.splice(r?3:1,0,e[1].dims[1]);let i=t.pads.slice(),a=t.outputShape.slice(),s=t.outputPadding.slice(),o=e[0].dims,l=t.dilations.slice();if(l.reduce((d,h)=>d+h,0)===0){let d=e[0].dims.length-2;l=new Array(d).fill(1)}let u=t.strides.slice();if(u.reduce((d,h)=>d+h,0)===0){let d=e[0].dims.length-2;u=new Array(d).fill(1)}Jx(o,n,l,t.autoPad,t.group,i,u,r,s,a);let c=Object.assign({},t);return Object.assign(c,{kernelShape:n,pads:i,outputPadding:s,outputShape:a,dilations:l,strides:u}),c},yE=t=>{let e=$y(t),n=t.format,r=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof t.autoPad>"u"?0:t.autoPad],i=t.dilations,a=t.group,s=t.kernelShape,o=t.pads,l=t.strides,u=t.wIsConst(),c=t.outputPadding,d=t.outputShape;return{autoPad:r,format:n,dilations:i,group:a,kernelShape:s,outputPadding:c,outputShape:d,pads:o,strides:l,wIsConst:u,...e,cacheKey:`${t.format};${e.activation};`}},Qx=(t,e)=>{if(!t||t.length!==2&&t.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(t[0].dims.length!==4&&t[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(t[0].dims.length!==t[1].dims.length)throw new Error("filter does not have same dimension as input");let n=t[0].dims[e.format==="NHWC"?t[0].dims.length-1:1],r=t[1].dims[0];if(n!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let i=t[1].dims[1]*e.group;if(t.length===3&&(t[2].dims.length!==1||t[2].dims[0]!==i))throw new Error("invalid bias");let a=t[0].dims.length-2;if(e.dilations.reduce((s,o)=>s+o,0)>0&&e.dilations.length!==a)throw new Error(`dilations should be ${a}D`);if(e.strides.reduce((s,o)=>s+o,0)>0&&e.strides.length!==a)throw new Error(`strides should be ${a}D`);if(e.pads.reduce((s,o)=>s+o,0)>0&&e.pads.length!==a*2)throw new Error(`pads should be ${a*2}D`);if(e.outputPadding.length!==a&&e.outputPadding.length!==0)throw new Error(`output_padding should be ${a}D`);if(e.kernelShape.reduce((s,o)=>s+o,0)>0&&e.kernelShape.length!==0&&e.kernelShape.length!==t[1].dims.length-2)throw new Error("invalid kernel shape");if(e.outputShape.length!==0&&e.outputShape.length!==t[0].dims.length-2)throw new Error("invalid output shape")},kg=(t,e,n,r)=>{let i=t.kernelCustomData.wT??t.compute(aa(e[1],[2,3,0,1]),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!t.kernelCustomData.wT&&(t.kernelCustomData.wT=i);let a=[e[0],i];e.length===3&&a.push(e[2]),t.compute(vE(a,n,r),{inputs:a})},ew=(t,e)=>{let n=e.format==="NHWC",r=[t.inputs[0].reshape(n?[t.inputs[0].dims[0],1,t.inputs[0].dims[1],t.inputs[0].dims[2]]:[t.inputs[0].dims[0],t.inputs[0].dims[1],1,t.inputs[0].dims[2]]),t.inputs[1].reshape([t.inputs[1].dims[0],t.inputs[1].dims[1],1,t.inputs[1].dims[2]])];t.inputs.length===3&&r.push(t.inputs[2]);let i=e.kernelShape;(i.length===0||i[0]===0)&&(i=[t.inputs[1].dims[2]]);let a=e.dilations;(a.length===0||a[0]===0)&&(a=[1]);let s=e.strides;(s.length===0||s[0]===0)&&(s=[1]);let o=e.pads;o.length===0&&(o=[0,0]),o=[0,o[0],0,o[1]],s=[1].concat(s),a=[1].concat(a),i=[1].concat(i);let l=e.outputPadding;l=[0].concat(l);let u=Ag({...e,pads:o,strides:s,dilations:a,kernelShape:i,outputPadding:l},r);kg(t,r,u,c=>n?[c[0],c[2],c[3]]:[c[0],c[1],c[3]])},_E=(t,e)=>{if(Qx(t.inputs,e),t.inputs[0].dims.length===3)ew(t,e);else{let n=Ag(e,t.inputs);kg(t,t.inputs,n)}}}),tw,bE,xE,SU=bt(()=>{Qt(),dn(),xr(),gn(),tw=(t,e,n,r)=>{let i=Ye.size(e),a=e.length,s=rt("input",t,a),o=Bt("output",t,a),l=n.dataType===6?n.getInt32Array()[0]:Number(n.getBigInt64Array()[0]),u=Ye.normalizeAxis(l,a),c=d=>{let h=` i32(${s.indicesGet("inputIndices","uniforms.axis")}) `,v=Ut("uniforms.input_shape","uniforms.axis",a),x=r.reverse?h+(r.exclusive?" + 1":""):"0",_=r.reverse?v:h+(r.exclusive?"":" + 1");return`
                ${d.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(s,o)}
                ${d.mainStart()}
                  ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${o.offsetToIndices("global_idx")};
                  var sum = ${o.type.value}(0);
                  let first : i32 = ${x};
                  let last : i32 = ${_};
                  for (var i : i32 = first; i < last; i++) {
                    ${s.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${s.getByIndices("inputIndices")};
                  }
                  ${o.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:r.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:e,dataType:t}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},{type:12,data:u},...Ht(e,e)]}),getShaderSource:c}},bE=(t,e)=>{let n=t.inputs[0].dims,r=t.inputs[0].dataType,i=t.inputs[1];t.compute(tw(r,n,i,e),{inputs:[0]})},xE=t=>{let e=t.exclusive===1,n=t.reverse===1;return qn({exclusive:e,reverse:n})}}),nw,rw,iw,wE,SE,MU=bt(()=>{Qt(),dn(),xr(),gn(),nw=t=>{if(!t||t.length!==1)throw new Error("DepthToSpace requires 1 input.");if(t[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},rw=(t,e,n,r)=>{let i=[];i.push(`fn perm(i: ${r.type.indices}) -> ${n.type.indices} {
    var a: ${n.type.indices};`);for(let a=0;a<e;++a)i.push(n.indicesSet("a",t[a],`i[${a}]`));return i.push("return a;}"),i.join(`
`)},iw=(t,e)=>{let n,r,i,a,s,o,l=e.format==="NHWC",u=e.blocksize,c=e.mode==="DCR";l?([n,r,i,a]=t.dims,s=c?[n,r,i,u,u,a/u**2]:[n,r,i,a/u**2,u,u],o=c?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([n,r,i,a]=[t.dims[0],t.dims[2],t.dims[3],t.dims[1]],s=c?[n,u,u,a/u**2,r,i]:[n,a/u**2,u,u,r,i],o=c?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let d=t.reshape(s),h=d.dims.length,v=t.dataType,x=rt("a",v,h),_=Bt("output",v,h),b=S=>`
  ${S.registerUniform("output_size","u32").declareVariables(x,_)}

  ${rw(o,h,x,_)}

  ${S.mainStart()}
    ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${_.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${_.setByOffset("global_idx",x.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${t.dims};${e.blocksize};${e.mode}`,inputDependencies:["rank"]},getRunData:S=>{let E=l?[n,r*u,i*u,a/u**2]:[n,a/u**2,r*u,i*u],C=Ye.size(E),A=d.dims,D=Ye.sortBasedOnPerm(A,o);return{outputs:[{dims:E,dataType:S[0].dataType}],dispatchGroup:{x:Math.ceil(C/64)},programUniforms:[{type:12,data:C},...Ht(A,D)]}},getShaderSource:b}},wE=(t,e)=>{nw(t.inputs),t.compute(iw(t.inputs[0],e))},SE=t=>qn({blocksize:t.blocksize,mode:t.mode,format:t.format})}),h0,Nd,Ig,aw,sw,ow,lw,$g,uw,ME,EE,EU=bt(()=>{Qt(),dn(),xr(),gn(),h0="[a-zA-Z]|\\.\\.\\.",Nd="("+h0+")+",Ig="^"+Nd+"$",aw="("+Nd+",)*"+Nd,sw="^"+aw+"$",ow=class{constructor(t=-1){this.symbolToIndices=new Map,this.inputIndex=t}addSymbol(t,e){let n=this.symbolToIndices.get(t);n===void 0?n=[e]:n.push(e),this.symbolToIndices.set(t,n)}},lw=class{constructor(t,e){var i;this.equation=e,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[n,r]=e.includes("->")?e.split("->",2):[e,""];if(!n.match(RegExp(sw)))throw new Error("Invalid LHS term");if(n.split(",").forEach((a,s)=>{let o=t[s].dims.slice();if(!a.match(RegExp(Ig)))throw new Error("Invalid LHS term");let l=this.processTerm(a,!0,o,s);this.lhs.push(l)}),r==="")r+=[...this.symbolToInfo.entries()].filter(([a,s])=>s.count===1||a==="...").map(([a])=>a).join("");else if(!r.match(RegExp(Nd)))throw new Error("Invalid RHS");(i=r.match(RegExp(h0,"g")))==null||i.forEach(a=>{if(a==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let s=this.symbolToInfo.get(a);if(s===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(s.dimValue)}}),this.rhs=this.processTerm(r,!1,this.outputDims)}addSymbol(t,e,n){let r=this.symbolToInfo.get(t);if(r!==void 0){if(r.dimValue!==e&&r.count!==1)throw new Error("Dimension mismatch");r.count++,r.inputIndices.push(n)}else r={count:1,dimValue:e,inputIndices:[n]};this.symbolToInfo.set(t,r)}processTerm(t,e,n,r=-1){let i=n.length,a=!1,s=[],o=0;if(!t.match(RegExp(Ig))&&!e&&t!=="")throw new Error("Invalid LHS term");let l=t.match(RegExp(h0,"g")),u=new ow(r);return l==null||l.forEach((c,d)=>{if(c==="..."){if(a)throw new Error("Only one ellipsis is allowed per input term");a=!0;let h=i-l.length+1;if(h<0)throw new Error("Ellipsis out of bounds");if(s=n.slice(o,o+h),this.hasEllipsis){if(this.ellipsisDims.length!==s.length||this.ellipsisDims.toString()!==s.toString())throw new Error("Ellipsis dimensions mismatch")}else if(e)this.hasEllipsis=!0,this.ellipsisDims=s;else throw new Error("Ellipsis must be specified in the LHS");for(let v=0;v<s.length;v++){let x=String.fromCharCode(48+v);u.addSymbol(x,d+v),this.addSymbol(x,n[o++],r)}}else u.addSymbol(c,d+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(c,n[o++],r)}),u}},$g=t=>t+"_max",uw=(t,e,n,r)=>{let i=t.map(u=>u.length).map((u,c)=>rt(`input${c}`,e,u)),a=Ye.size(r),s=Bt("output",e,r.length),o=[...n.symbolToInfo.keys()].filter(u=>!n.rhs.symbolToIndices.has(u)),l=u=>{let c=[],d="var prod = 1.0;",h="var sum = 0.0;",v="sum += prod;",x=[],_=[],b=[],S=[],E=n.symbolToInfo.size===n.rhs.symbolToIndices.size;n.symbolToInfo.forEach((A,D)=>{var O;if(n.rhs.symbolToIndices.has(D)){let V=(O=n.rhs.symbolToIndices.get(D))==null?void 0:O[0];V!==void 0&&n.lhs.forEach((P,U)=>{if(A.inputIndices.includes(U)){let Y=P.symbolToIndices.get(D);if(Y===void 0)throw new Error("Invalid symbol error");Y.forEach(fe=>{c.push(`${i[U].indicesSet(`input${U}Indices`,fe,s.indicesGet("outputIndices",V))}`)})}})}else n.lhs.forEach((V,P)=>{if(A.inputIndices.includes(P)){let U=V.symbolToIndices.get(D);if(U===void 0)throw new Error("Invalid symbol error");U.forEach(Y=>{x.push(`${i[P].indicesSet(`input${P}Indices`,Y,`${D}`)}`)}),S.push(`prod *= ${i[P].getByIndices(`input${P}Indices`)};`)}}),_.push(`for(var ${D}: u32 = 0; ${D} < uniforms.${$g(D)}; ${D}++) {`),b.push("}")});let C=E?[...c,`let sum = ${i.map((A,D)=>A.getByIndices(`input${D}Indices`)).join(" * ")};`]:[...c,h,..._,...x,d,...S,v,...b];return`
            ${u.registerUniforms(o.map(A=>({name:`${$g(A)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...i,s)}

            ${u.mainStart()}
            ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${s.offsetToIndices("global_idx")};
            ${i.map((A,D)=>`var input${D}Indices: ${i[D].type.indices};`).join(`
`)}
            ${C.join(`
`)};
            ${s.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:n.equation,inputDependencies:t.map(()=>"rank")},getRunData:()=>{let u=o.filter(d=>n.symbolToInfo.has(d)).map(d=>{var h;return{type:12,data:((h=n.symbolToInfo.get(d))==null?void 0:h.dimValue)||0}});u.push({type:12,data:a});let c=t.map((d,h)=>[...Ht(d)]).reduce((d,h)=>d.concat(h),u);return c.push(...Ht(r)),{outputs:[{dims:r,dataType:e}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:c}},getShaderSource:l}},ME=(t,e)=>{let n=new lw(t.inputs,e.equation),r=n.outputDims,i=t.inputs.map((a,s)=>a.dims);t.compute(uw(i,t.inputs[0].dataType,n,r))},EE=t=>{let e=t.equation.replace(/\s+/g,"");return qn({equation:e})}}),cw,Pg,dw,fw,TE,TU=bt(()=>{Qt(),dn(),gn(),cw=t=>{if(!t||t.length!==2)throw new Error("Expand requires 2 input.");let e=t[0].dims,n=Array.from(t[1].getBigInt64Array(),Number),r=n.length<e.length?0:n.length-e.length,i=e.length<n.length?0:e.length-n.length;for(;r<n.length&&i<e.length;++r,++i)if(n[r]!==e[i]&&n[r]!==1&&e[i]!==1)throw new Error("Expand requires shape to be broadcastable to input")},Pg=(t,e)=>{let n=t.length-e.length,r=[];for(let i=0;i<n;++i)r.push(t[i]);for(let i=0;i<e.length;++i)r.push(e[i]===1?t[i+n]:e[i]);return r},dw=(t,e)=>t.length>e.length?Pg(t,e):Pg(e,t),fw=t=>{let e=t[0].dims,n=Array.from(t[1].getBigInt64Array(),Number),r=dw(e,n),i=t[0].dataType,a=i===9||Ye.size(e)===1,s=i===9||e.length>0&&e[e.length-1]%4===0?4:1,o=a||r.length>0&&r[r.length-1]%4===0?4:1,l=Math.ceil(Ye.size(r)/o),u=d=>{let h=rt("input",i,e.length,s),v=Bt("output",i,r.length,o),x;if(i===9){let _=(b,S,E="")=>`
          let outputIndices${S} = ${v.offsetToIndices(`outputOffset + ${S}u`)};
          let offset${S} = ${h.broadcastedIndicesToOffset(`outputIndices${S}`,v)};
          let index${S} = offset${S} / 4u;
          let component${S} = offset${S} % 4u;
          ${b}[${S}] = ${E}(${h.getByOffset(`index${S}`)}[component${S}]);
        `;x=`
        let outputOffset = global_idx * ${o};
        var data = vec4<u32>(0);
        ${_("data",0,"u32")}
        ${_("data",1,"u32")}
        ${_("data",2,"u32")}
        ${_("data",3,"u32")}
        ${v.setByOffset("global_idx","data")}
      }`}else x=`
        let outputIndices = ${v.offsetToIndices(`global_idx * ${o}`)};
        let inputOffset = ${h.broadcastedIndicesToOffset("outputIndices",v)};
        let data = ${v.type.value}(${h.getByOffset(`inputOffset / ${s}`)});
        ${v.setByOffset("global_idx","data")}
      }`;return`
    ${d.registerUniform("vec_size","u32").declareVariables(h,v)}
    ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${x}`},c=[{type:12,data:l},...Ht(e,r)];return{name:"Expand",shaderCache:{hint:`${r.length};${s}${o}`,inputDependencies:["rank"]},getShaderSource:u,getRunData:()=>({outputs:[{dims:r,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c})}},TE=t=>{cw(t.inputs),t.compute(fw(t.inputs),{inputs:[0]})}}),hw,CE,CU=bt(()=>{Qt(),dn(),gn(),Iy(),hw=t=>{let e=t[0].dataType,n=Ye.size(t[0].dims),r=Ye.size(t[1].dims),i=r%4===0,a=s=>{let o=rt("x",e,[1],4),l=rt("bias",e,[1],4),u=Bt("y",e,[1],4),c=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],d=v=>`
      let bias${v}_offset: u32 = (global_idx * 4 + ${v}) % uniforms.bias_size;
      let bias${v} = ${l.getByOffset(`bias${v}_offset / 4`)}[bias${v}_offset % 4];`,h=i?`
      let bias = ${l.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${d(0)}${d(1)}${d(2)}${d(3)}
      let bias = ${o.type.value}(bias0, bias1, bias2, bias3);`;return`${s.registerUniforms(c).declareVariables(o,l,u)}

    ${Xv(ci(e))}

    ${s.mainStart(Vc)}
      ${s.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${o.getByOffset("global_idx")};
      ${h}
      let x_in = x + bias;
      ${u.setByOffset("global_idx",Kv("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${i}`,inputDependencies:["type","type"]},getShaderSource:a,getRunData:s=>({outputs:[{dims:s[0].dims,dataType:s[0].dataType}],programUniforms:[{type:12,data:Math.ceil(n/4)},{type:12,data:r}],dispatchGroup:{x:Math.ceil(n/Vc/4)}})}},CE=t=>{t.inputs.length<2||Ye.size(t.inputs[1].dims)===0?jM(t):t.compute(hw(t.inputs))}}),pw,mw,AE,kE,AU=bt(()=>{Qt(),dn(),xr(),gn(),pw=t=>{if(!t||t.length!==2)throw new Error("Gather requires 2 inputs.")},mw=(t,e)=>{let n=t[0].dims,r=t[1].dims,i=n.length,a=Ye.normalizeAxis(e.axis,i),s=n.slice(0);s.splice(a,1,...r);let o=n[a],l=t[0].dataType===9?4:1,u=Math.ceil(Ye.size(s)/l),c=[{type:12,data:u},{type:6,data:o},{type:12,data:a},...Ht(t[0].dims,t[1].dims,s)],d=h=>{let v=rt("data",t[0].dataType,t[0].dims.length,l),x=rt("inputIndices",t[1].dataType,t[1].dims.length),_=Bt("output",t[0].dataType,s.length,l),b=E=>{let C=r.length,A=`var indicesIndices${E}  = ${x.type.indices}(0);`;for(let D=0;D<C;D++)A+=`${C>1?`indicesIndices${E}[${D}]`:`indicesIndices${E}`} = ${s.length>1?`outputIndices${E}[uniforms.axis + ${D}]`:`outputIndices${E}`};`;A+=`
          var idx${E} = ${x.getByIndices(`indicesIndices${E}`)};
          if (idx${E} < 0) {
            idx${E} = idx${E} + uniforms.axisDimLimit;
          }
          var dataIndices${E} : ${v.type.indices};
        `;for(let D=0,O=0;D<i;D++)D===a?(A+=`${i>1?`dataIndices${E}[${D}]`:`dataIndices${E}`} = u32(idx${E});`,O+=C):(A+=`${i>1?`dataIndices${E}[${D}]`:`dataIndices${E}`} = ${s.length>1?`outputIndices${E}[${O}]`:`outputIndices${E}`};`,O++);return A},S;if(t[0].dataType===9){let E=(C,A,D="")=>`
          let outputIndices${A} = ${_.offsetToIndices(`outputOffset + ${A}u`)};
          ${b(A)};
          let offset${A} = ${v.indicesToOffset(`dataIndices${A}`)};
          let index${A} = offset${A} / 4u;
          let component${A} = offset${A} % 4u;
          ${C}[${A}] = ${D}(${v.getByOffset(`index${A}`)}[component${A}]);
        `;S=`
        let outputOffset = global_idx * ${l};
        var value = vec4<u32>(0);
        ${E("value",0,"u32")}
        ${E("value",1,"u32")}
        ${E("value",2,"u32")}
        ${E("value",3,"u32")}
        ${_.setByOffset("global_idx","value")}
      `}else S=`
      let outputIndices = ${_.offsetToIndices("global_idx")};
      ${b("")};
      let value = ${v.getByIndices("dataIndices")};
      ${_.setByOffset("global_idx","value")};
      `;return`
      ${h.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(v,x,_)}
      ${h.mainStart()}
        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${S}
      }`};return{name:"Gather",shaderCache:{hint:e.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:s,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:c}),getShaderSource:d}},AE=t=>qn({axis:t.axis}),kE=(t,e)=>{let n=t.inputs;pw(n),t.compute(mw(t.inputs,e))}}),gw,IE,$E,kU=bt(()=>{Qt(),dn(),gn(),gw=(t,e,n,r,i,a,s,o,l)=>{let u=[{type:12,data:a},{type:12,data:r},{type:12,data:i},{type:12,data:n},{type:12,data:s},{type:12,data:o},{type:12,data:l}],c=[a];u.push(...Ht(e.dims,c));let d=h=>{let v=rt("indices_data",e.dataType,e.dims.length),x=Bt("input_slice_offsets_data",12,1,1),_=[v,x],b=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:i.length},{name:"sizes_from_slice_dims_data",type:"u32",length:n.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${h.registerUniforms(b).declareVariables(..._)}
  ${h.mainStart()}
    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${i.length===1?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${n.length===1?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return t.compute({name:"computeSliceOffsets",shaderCache:{hint:`${i.length}_${n.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:c,dataType:t.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:u}),getShaderSource:d},{inputs:[e],outputs:[-1]})[0]},IE=(t,e)=>{let n=t.inputs,r=n[0].dims,i=n[0].dataType,a=n[1].dims,s=a[a.length-1],o=Ye.sizeToDimension(a,a.length-1),l=Ye.sizeFromDimension(r,e.batchDims+s),u=Ye.sizeToDimension(r,e.batchDims),c=Ye.sizeFromDimension(r,e.batchDims),d=o/u,h=new Array(s),v=l;for(let A=0;A<s;++A)h[s-1-A]=v,v*=r[e.batchDims+s-1-A];let x=gw(t,n[1],h,e.batchDims,r,o,d,c,s),_=e.batchDims+s;if(_>r.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let b=a.slice(0,-1).concat(r.slice(_)),S=Ye.size(b),E=[{type:12,data:S},{type:12,data:l},...Ht(n[0].dims,x.dims,b)],C=A=>{let D=rt("data",n[0].dataType,n[0].dims.length),O=rt("slice_offsets",12,x.dims.length),V=Bt("output",n[0].dataType,b.length);return`
          ${A.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(D,O,V)}
            ${A.mainStart()}
            ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};t.compute({name:"GatherND",shaderCache:{hint:e.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:b,dataType:i}],dispatchGroup:{x:Math.ceil(S/64)},programUniforms:E}),getShaderSource:C},{inputs:[n[0],x]})},$E=t=>({batchDims:t.batch_dims,cacheKey:""})}),vw,yw,PE,RE,IU=bt(()=>{Qt(),dn(),xr(),gn(),vw=(t,e)=>{if(t.length<3||t.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let n=Ye.normalizeAxis(e.quantizeAxis,t[0].dims.length),r=e.blockSize,i=t[0],a=t[2],s=t.length===4?t[3]:void 0;if(a.dims.length!==i.dims.length||!i.dims.map((o,l)=>l===n?Math.ceil(o/r)===a.dims[l]:o===a.dims[l]).reduce((o,l)=>o&&l,!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(s){if(s.dataType!==i.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(s.dims.length!==a.dims.length||!s.dims.map((o,l)=>o===a.dims[l]).reduce((o,l)=>o&&l,!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},yw=(t,e)=>{let n=t[0].dims,r=t[1].dims,i=n.length,a=Ye.normalizeAxis(e.gatherAxis,i),s=Ye.normalizeAxis(e.quantizeAxis,i),o=n.slice(0);o.splice(a,1,...r);let l=Ye.size(o),u=t[2].dataType,c=t[0].dataType===22,d=[{type:12,data:l},{type:12,data:s},{type:12,data:a},{type:12,data:e.blockSize},...Ht(...t.map((v,x)=>v.dims),o)],h=v=>{let x=rt("data",t[0].dataType,t[0].dims.length),_=rt("inputIndices",t[1].dataType,t[1].dims.length),b=rt("scales",t[2].dataType,t[2].dims.length),S=t.length>3?rt("zeroPoint",t[3].dataType,t[3].dims.length):void 0,E=Bt("output",u,o.length),C=[x,_,b];S&&C.push(S);let A=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${v.registerUniforms(A).declareVariables(...C,E)}
        ${v.mainStart()}
        let output_indices = ${E.offsetToIndices("global_idx")};
        var indices_indices = ${_.type.indices}(0);
        ${r.length>1?`
          for (var i: u32 = 0; i < ${r.length}; i++) {
            let index = ${E.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${_.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${E.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${x.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${E.indicesGet("output_indices","i")};
          ${x.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${_.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${n[a]};
        }
        ${x.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${o.length}; i++) {
          let index = ${E.indicesGet("output_indices",`i + ${r.length} - 1`)};
          ${x.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${x.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${x.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${c?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${b.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${b.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${b.getByIndices("scale_indices")};
        ${S?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${S.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${S.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${c?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${ci(u)}(quantized_data - zero_point) * scale;
        ${E.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${e.cacheKey};${t.filter((v,x)=>x!==1).map(v=>v.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:t.length},(v,x)=>"rank")},getRunData:()=>({outputs:[{dims:o,dataType:u}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:d}),getShaderSource:h}},PE=(t,e)=>{let n=t.inputs;vw(n,e),t.compute(yw(t.inputs,e))},RE=t=>qn({blockSize:t.blockSize,gatherAxis:t.gatherAxis,quantizeAxis:t.quantizeAxis})}),_w,bw,DE,LE,$U=bt(()=>{Qt(),dn(),xr(),gn(),_w=t=>{if(!t||t.length!==2)throw new Error("GatherElements requires 2 inputs.");if(t[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(t[0].dims.length!==t[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},bw=(t,e)=>{let n=t[0].dims,r=t[0].dataType,i=n.length,a=t[1].dims,s=t[1].dataType,o=Ye.normalizeAxis(e.axis,i),l=n[o],u=a.slice(0),c=Ye.size(u),d=rt("input",r,i),h=rt("indicesInput",s,a.length),v=Bt("output",r,u.length),x=[{type:12,data:c},{type:6,data:l},{type:12,data:o}];return x.push(...Ht(n,a,u)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:u,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:x}),getShaderSource:_=>`
      ${_.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(d,h,v)}
      ${_.mainStart()}
      ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${v.offsetToIndices("global_idx")};

      var idx = ${h.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${d.type.indices}(outputIndices);
      ${d.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${d.getByIndices("inputIndices")};

      ${v.setByOffset("global_idx","value")};
  }`}},DE=t=>qn({axis:t.axis}),LE=(t,e)=>{let n=t.inputs;_w(n),t.compute(bw(t.inputs,e))}}),xw,ww,zE,OE,PU=bt(()=>{Qt(),dn(),gn(),xw=t=>{if(!t)throw new Error("Input is missing");if(t.length<2||t.length>3)throw new Error("Invaid input number.");if(t.length===3&&t[2].dims.length>2)throw new Error("Invalid input shape of C");if(t[0].dataType!==t[1].dataType||t.length===3&&t[0].dataType!==t[2].dataType)throw new Error("Input types are mismatched")},ww=(t,e)=>{let n=t[0].dims.slice(),r=t[1].dims.slice(),[i,a,s]=N7.getShapeOfGemmResult(n,e.transA,r,e.transB,t.length===3?t[2].dims:void 0),o=[i,a];if(!o)throw new Error("Can't use gemm on the given tensors");let l=16,u=Math.ceil(a/l),c=Math.ceil(i/l),d=!0,h=Ye.size(o),v=[{type:12,data:d?u:h},{type:12,data:i},{type:12,data:a},{type:12,data:s},{type:1,data:e.alpha},{type:1,data:e.beta}],x=["type","type"];t.length===3&&(v.push(...Ht(t[2].dims)),x.push("rank")),v.push(...Ht(o));let _=S=>{let E="";e.transA&&e.transB?E="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":e.transA&&!e.transB?E="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!e.transA&&e.transB?E="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!e.transA&&!e.transB&&(E="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let C=e.alpha===1?"":"value *= uniforms.alpha;",A=rt("a",t[0].dataType,t[0].dims),D=rt("b",t[1].dataType,t[1].dims),O=A.type.value,V=null,P=[A,D];t.length===3&&(V=rt("c",t[2].dataType,t[2].dims.length),P.push(V));let U=Bt("output",t[0].dataType,o.length);P.push(U);let Y=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${S.registerUniforms(Y).declareVariables(...P)}

  ${S.mainStart()}
    ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${O}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${E}
    }

    ${C}
    ${V!=null?`let cOffset = ${V.broadcastedIndicesToOffset("vec2(m, n)",U)}; value += ${O}(uniforms.beta) * ${V.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},b=S=>{let E=rt("a",t[0].dataType,t[0].dims),C=rt("b",t[1].dataType,t[1].dims),A=null,D=[E,C];t.length===3&&(A=rt("c",t[2].dataType,t[2].dims.length),D.push(A));let O=Bt("output",t[0].dataType,o.length);D.push(O);let V=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],P="",U="";e.transA&&e.transB?(U=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${E.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${C.type.value}(0);
      }
      `,P="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):e.transA&&!e.transB?(U=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${E.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${C.type.value}(0);
      }
      `,P="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!e.transA&&e.transB?(U=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${E.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${C.type.value}(0);
      }
      `,P="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!e.transA&&!e.transB&&(U=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${E.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${C.type.value}(0);
      }
      `,P="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let Y=e.alpha===1?"":"value *= uniforms.alpha;";return`
  ${S.registerUniforms(V).declareVariables(...D)}
  var<workgroup> tile_a: array<array<${E.type.storage}, ${l}>, ${l}>;
  var<workgroup> tile_b: array<array<${C.type.storage}, ${l}>, ${l}>;
  ${S.mainStart([l,l,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${l};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${l};
    let num_tiles = (uniforms.K - 1) / ${l} + 1;
    var k_start = 0u;
    var value = ${O.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${U}
      k_start = k_start + ${l};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${l}; k++) {
        ${P}
      }
      workgroupBarrier();
    }

    ${Y}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${A!=null?`let cOffset = ${A.broadcastedIndicesToOffset("vec2(m, n)",O)}; value += ${O.type.value}(uniforms.beta) * ${A.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return d?{name:"GemmShared",shaderCache:{hint:`${e.cacheKey}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:o,dataType:t[0].dataType}],dispatchGroup:{x:u*c},programUniforms:v}),getShaderSource:b}:{name:"Gemm",shaderCache:{hint:`${e.cacheKey}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:o,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:v}),getShaderSource:_}},zE=t=>{let e=t.transA,n=t.transB,r=t.alpha,i=t.beta;return{transA:e,transB:n,alpha:r,beta:i,cacheKey:`${t.transA};${t.transB};${t.alpha===1}`}},OE=(t,e)=>{xw(t.inputs),t.compute(ww(t.inputs,e))}}),ds,Ys,Ul,Vl,Sw,Mw,Ew,Tw,Cw,Aw,kw,Iw,NE,BE,RU=bt(()=>{Qt(),dn(),xr(),gn(),[ds,Ys,Ul,Vl]=[0,1,2,3],Sw=t=>{if(t[0].dims.length!==4)throw new Error("only 4-D tensor is supported.");if(t[0].dims.length!==t[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(t[0].dims.length-2!==t[1].dims[t[1].dims.length-1])throw new Error(`last dimension of grid must be equal to ${t[0].dims.length-2}`);if(t[0].dims[0]!==t[1].dims[0])throw new Error("grid batch size must match input batch size")},Mw=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,Ew=t=>`
  fn gs_bicubic_interpolate(p: mat4x4<${t}>, x: f32, y: f32) -> ${t} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${t}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,Tw=t=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${t.alignCorners===0?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,Cw=t=>`
  ${t.paddingMode==="reflection"?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,Aw=(t,e,n)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${e} {
     var pixel = ${e}(0);
     var indices = vec4<u32>(0);
     indices[${ds}] = batch;
     indices[${Ys}] = channel;`+(()=>{switch(n.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${Ul}] = u32(r);
            indices[${Vl}] = u32(c);
          }
        `;case"border":return`
          indices[${Ul}] = u32(clamp(r, 0, H - 1));
          indices[${Vl}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${Ul}] = gs_reflect(r, border[1], border[3]);
          indices[${Vl}] = gs_reflect(c, border[0], border[2]);
        `;default:throw new Error(`padding mode ${n.paddingMode} is not supported`)}})()+`
    return ${t.getByIndices("indices")};
  }
`,kw=(t,e,n)=>(()=>{switch(n.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${ds}], indices[${Ys}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${ds}], indices[${Ys}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${ds}], indices[${Ys}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${ds}], indices[${Ys}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${ds}], indices[${Ys}], border);

          let dx2 = ${e}(f32(x2) - x);
          let dx1 = ${e}(x - f32(x1));
          let dy2 = ${e}(f32(y2) - y);
          let dy1 = ${e}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${e}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${ds}], indices[${Ys}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw new Error(`mode ${n.mode} is not supported`)}})()+`${t.setByOffset("global_idx","result")}`,Iw=(t,e)=>{let n=rt("x",t[0].dataType,t[0].dims.length),r=[t[1].dims[0],t[1].dims[1],t[1].dims[2]],i=rt("grid",t[1].dataType,r.length,2),a=[t[0].dims[0],t[0].dims[1],t[1].dims[1],t[1].dims[2]];e.format==="NHWC"&&(a=[t[0].dims[0],t[1].dims[1],t[1].dims[2],t[0].dims[3]],[ds,Ys,Ul,Vl]=[0,3,1,2]);let s=Bt("output",t[0].dataType,a.length),o=n.type.value,l=Ye.size(a),u=[{type:12,data:l},...Ht(t[0].dims,r,a)],c=d=>`
  ${d.registerUniform("output_size","u32").declareVariables(n,i,s)}
  ${Mw}
  ${Ew(o)}
  ${Tw(e)}
  ${Cw(e)}
  ${Aw(n,o,e)}

  ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${Ul}]);
      let W_in = i32(uniforms.x_shape[${Vl}]);

      ${e.alignCorners===0?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${s.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${ds}], indices[${Ul}], indices[${Vl}]);
      let nxy = ${i.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${kw(s,o,e)}
  }`;return{name:"GridSample",shaderCache:{hint:`${e.cacheKey}`,inputDependencies:["type","type"]},getRunData:d=>{let h=Ye.size(a);return{outputs:[{dims:a,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:u}},getShaderSource:c}},NE=(t,e)=>{Sw(t.inputs),t.compute(Iw(t.inputs,e))},BE=t=>qn({alignCorners:t.align_corners,mode:t.mode,paddingMode:t.padding_mode,format:t.format})}),xi,$w,FE,Rg,Pw,Zd,UE,VE=bt(()=>{Qt(),dn(),xr(),Ty(),ky(),gn(),fl(),xi=(t,e)=>t.length>e&&t[e].dims.length>0?t[e]:void 0,$w=(t,e)=>{let n=t[0],r=xi(t,1),i=xi(t,2),a=xi(t,3),s=xi(t,4),o=xi(t,5),l=xi(t,6),u=xi(t,7);if(n.dims.length!==3&&n.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let c=n.dims[0],d=n.dims[1],h=n.dims.length===3?n.dims[2]:e.numHeads*n.dims[4],v=d,x=0,_=0,b=Math.floor(h/e.numHeads);if(l&&u&&Ye.size(l.dims)&&Ye.size(u.dims)){if(l.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(l.dims[0]!==c||l.dims[1]!==e.numHeads||l.dims[3]!==b)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(u.dims[0]!==c||u.dims[1]!==e.numHeads||u.dims[3]!==b)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(l.dims[2]!==u.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(u.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');x=l.dims[2],_=l.dims[2]}else if(l&&Ye.size(l.dims)||u&&Ye.size(u.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let S;if(r&&Ye.size(r.dims)>0){if(n.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(r.dims.length<3||r.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(n.dims[0]!==r.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(r.dims.length===3){if(r.dims[2]!==n.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');S=2,v=r.dims[1]}else if(r.dims.length===5){if(r.dims[2]!==e.numHeads||r.dims[3]!==2||r.dims[4]!==b)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');S=5,v=r.dims[1]}else{if(r.dims[1]!==e.numHeads||r.dims[3]!==b)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');S=0,v=r.dims[2]}}else{if(n.dims.length!==5)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(n.dims[2]!==e.numHeads||n.dims[3]!==3)throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');S=3}if(a&&Ye.size(a.dims)>0){if(a.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(r&&r.dims.length===5&&r.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let E=x+v,C=0;if(s&&Ye.size(s.dims)>0){C=8;let V=s.dims;throw V.length===1?V[0]===c?C=1:V[0]===3*c+2&&(C=3):V.length===2&&V[0]===c&&V[1]===E&&(C=5),C===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let A=!1,D=h;if(i&&Ye.size(i.dims)>0){if(i.dims.length!==3&&i.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(n.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(i.dims.length===3){if(v!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');D=i.dims[2]}else{if(v!==i.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');D=i.dims[1]*i.dims[3],A=!0}}let O=!1;if(s&&Ye.size(s.dims)>0)throw new Error("Key padding mask is not supported");if(o&&Ye.size(o.dims)>0){if(o.dims.length!==4)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(o.dims[0]!==c||o.dims[1]!==e.numHeads||o.dims[2]!==d||o.dims[3]!==E)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:c,sequenceLength:d,pastSequenceLength:x,kvSequenceLength:v,totalSequenceLength:E,maxSequenceLength:_,inputHiddenSize:0,hiddenSize:h,vHiddenSize:D,headSize:b,vHeadSize:Math.floor(D/e.numHeads),numHeads:e.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:e.maskFilterValue,maskType:C,scale:e.scale,broadcastResPosBias:O,passPastInKv:A,qkvFormat:S}},FE=t=>qn({...t}),Rg=qn({perm:[0,2,1,3]}),Pw=(t,e,n,r,i,a,s)=>{let o=[r,i,a],l=Ye.size(o),u=[{type:12,data:l},{type:12,data:s},{type:12,data:a}],c=d=>{let h=Bt("qkv_with_bias",e.dataType,o),v=rt("qkv",e.dataType,o),x=rt("bias",n.dataType,o),_=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${d.registerUniforms(_).declareVariables(v,x,h)}
  ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return t.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:o,dataType:e.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:u}),getShaderSource:c},{inputs:[e,n],outputs:[-1]})[0]},Zd=(t,e,n,r,i,a,s,o)=>{let l=a;if(s&&Ye.size(s.dims)>0){if(r===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return l=Pw(t,a,s,e,r,n*i,o),l=l.reshape([e,r,n,i]),n===1||r===1?l:t.compute(aa(l,Rg.perm),{inputs:[l],outputs:[-1]})[0]}else return a.dims.length===3&&(l=a.reshape([e,r,n,i])),n===1||r===1?l:t.compute(aa(l,Rg.perm),{inputs:[l],outputs:[-1]})[0]},UE=(t,e)=>{let n=$w(t.inputs,e),r=t.inputs[0],i=xi(t.inputs,1),a=xi(t.inputs,2),s=xi(t.inputs,3),o=xi(t.inputs,4),l=xi(t.inputs,5),u=xi(t.inputs,6),c=xi(t.inputs,7);if(r.dims.length===5)throw new Error("Packed QKV is not implemented");if((i==null?void 0:i.dims.length)===5)throw new Error("Packed KV is not implemented");let d=i&&a&&i.dims.length===4&&a.dims.length===4,h=Zd(t,n.batchSize,n.numHeads,n.sequenceLength,n.headSize,r,s,0);if(d)return Rf(t,h,i,a,o,void 0,u,c,l,n);if(!i||!a)throw new Error("key and value must be provided");let v=Zd(t,n.batchSize,n.numHeads,n.kvSequenceLength,n.headSize,i,s,n.hiddenSize),x=Zd(t,n.batchSize,n.numHeads,n.kvSequenceLength,n.vHeadSize,a,s,2*n.hiddenSize);Rf(t,h,v,x,o,void 0,u,c,l,n)}}),Rw,Dw,Lw,zw,e1,HE,WE,GE=bt(()=>{Qt(),dn(),xr(),gn(),Rw=t=>{if(!t||t.length<1)throw new Error("too few inputs")},Dw=(t,e)=>{let n=[],r=e.numOutputs;return t[1].dims[0]>0&&(t[1].getBigInt64Array().forEach(i=>n.push(Number(i))),r=n.length),qn({numOutputs:r,axis:e.axis,splitSizes:n})},Lw=t=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${t}u; i += 1u ) {
    if (index < ${Ut("uniforms.size_in_split_axis","i",t)}) {
        return i;
    }
    }
    return ${t}u;
}`,zw=t=>{let e=t.length,n=[];for(let r=0;r<e;++r){let i=t[r].setByIndices("indices","input[global_idx]");e===1?n.push(i):r===0?n.push(`if (output_number == ${r}u) { ${i} }`):r===e-1?n.push(`else { ${i} }`):n.push(`else if (output_number == ${r}) { ${i} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${t[0].type.indices}, global_idx: u32) {
        ${n.join(`
`)}
      }`},e1=(t,e)=>{let n=t[0].dims,r=Ye.size(n),i=t[0].dataType,a=Ye.normalizeAxis(e.axis,n.length),s=new Array(e.numOutputs),o=rt("input",i,n.length),l=new Array(e.numOutputs),u=[],c=[],d=0,h=[{type:12,data:r}];for(let x=0;x<e.numOutputs;x++){d+=e.splitSizes[x],l[x]=d;let _=n.slice();_[a]=e.splitSizes[x],c.push(_),s[x]=Bt(`output${x}`,i,_.length),u.push({dims:c[x],dataType:t[0].dataType})}h.push({type:12,data:l},...Ht(n,...c));let v=x=>`
  ${x.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",l.length).declareVariables(o,...s)}
  ${Lw(l.length)}
  ${zw(s)}

  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${o.offsetToIndices("global_idx")};
    var index = ${o.indicesGet("indices",a)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${Ut("uniforms.size_in_split_axis","output_number - 1u",l.length)};
      ${o.indicesSet("indices",a,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:e.cacheKey,inputDependencies:["rank"]},getShaderSource:v,getRunData:()=>({outputs:u,dispatchGroup:{x:Math.ceil(r/64)},programUniforms:h})}},HE=(t,e)=>{Rw(t.inputs);let n=t.inputs.length===1?e:Dw(t.inputs,e);t.compute(e1(t.inputs,n),{inputs:[0]})},WE=t=>{let e=t.axis,n=t.splitSizes,r=t.numOutputs<0?n.length:t.numOutputs;if(r!==n.length)throw new Error("numOutputs and splitSizes lengh must be equal");return qn({axis:e,numOutputs:r,splitSizes:n})}}),Ow,Nw,Dg,qE,DU=bt(()=>{xr(),ky(),VE(),GE(),fl(),Ow=(t,e)=>{if(e.doRotary)throw new Error("GroupQuerryAttention do_rotary attribute is not supported");if(e.doRotary&&t.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let n=t[0],r=t[1],i=t[2],a=t[3],s=t[4];if(e.localWindowSize!==-1)throw new Error("Local attention is not supported");if(e.softcap!==0)throw new Error("Softcap is not supported");if(e.rotaryInterleaved!==0)throw new Error("Rotary interleaved is not supported");if(e.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(n.dims.length!==3&&n.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let o=!1,l=n.dims[0],u=n.dims[1],c=n.dims.length===3?o?n.dims[2]/3:n.dims[2]:e.numHeads*n.dims[4],d=u,h=0,v=!r||r.dims.length===0,x=Math.floor(v?c/(e.numHeads+2*e.kvNumHeads):c/e.numHeads);v&&(c=x*e.numHeads);let _=a&&a.dims.length!==0,b=s&&s.dims.length!==0;if(_&&a.dims.length===4&&a.dims[0]===l&&a.dims[1]!==e.kvNumHeads&&a.dims[2]===e.kvNumHeads&&a.dims[3]===x)throw new Error("BSNH pastKey/pastValue is not supported");if(_&&b){if(a.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(s.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');h=a.dims[2]}else if(_||b)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let S=1;if(r&&r.dims.length>0){if(n.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(r.dims.length<3||r.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(n.dims[0]!==r.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(r.dims.length===3){if(n.dims[2]%r.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');d=r.dims[1]}else if(r.dims.length===5){if(r.dims[2]!==e.numHeads||r.dims[3]!==2||r.dims[4]!==x)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');d=r.dims[1]}else{if(r.dims[1]!==e.numHeads||r.dims[3]!==x)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');d=r.dims[2]}}else{if(n.dims.length!==3&&n.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(n.dims.length===5&&(n.dims[2]!==e.numHeads||n.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');S=3}let E=0,C=!1,A=e.kvNumHeads?x*e.kvNumHeads:c;if(i&&i.dims.length>0){if(i.dims.length!==3&&i.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(n.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(i.dims.length===3){if(d!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');A=i.dims[2]}else{if(d!==i.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');A=i.dims[1]*i.dims[3],C=!0}}let D=t.length>4?t[5]:void 0;if(D&&D.dims.length!==1&&D.dims[0]!==l)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:l,sequenceLength:u,pastSequenceLength:h,kvSequenceLength:d,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:c,vHiddenSize:A,headSize:x,vHeadSize:Math.floor(A/e.kvNumHeads),numHeads:e.numHeads,kvNumHeads:e.kvNumHeads,nReps:e.numHeads/e.kvNumHeads,pastPresentShareBuffer:!1,maskType:E,scale:e.scale,broadcastResPosBias:!1,passPastInKv:C,qkvFormat:S}},Nw=qn({perm:[0,2,1,3]}),Dg=(t,e,n)=>{let r=e,i=n.kvNumHeads;return e.dims.length===3&&n.kvSequenceLength!==0&&(r=e.reshape([n.batchSize,n.kvSequenceLength,i,n.headSize]),r=t.compute(aa(r,Nw.perm),{inputs:[r],outputs:[-1]})[0]),r},qE=(t,e)=>{var b;let n=Ow(t.inputs,e);if(t.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(((b=t.inputs[1])==null?void 0:b.dims.length)===5)throw new Error("Packed KV is not implemented");let r=t.inputs[0],i=t.inputs[1]&&t.inputs[1].dims.length>0?t.inputs[1]:void 0,a=t.inputs[2]&&t.inputs[2].dims.length>0?t.inputs[2]:void 0,s=t.inputs[3]&&t.inputs[3].dims.length!==0?t.inputs[3]:void 0,o=t.inputs[4]&&t.inputs[4].dims.length!==0?t.inputs[4]:void 0,l=t.inputs.length>4?t.inputs[5]:void 0,u=t.inputs.length>5?t.inputs[6]:void 0,c=n.kvNumHeads?n.kvNumHeads:n.numHeads,d=qn({axis:2,numOutputs:3,splitSizes:[n.numHeads*n.headSize,c*n.headSize,c*n.headSize]}),[h,v,x]=!i&&!a?t.compute(e1([r],d),{inputs:[r],outputs:[-1,-1,-1]}):[r,i,a],_=Zd(t,n.batchSize,n.numHeads,n.sequenceLength,n.headSize,h,void 0,0);Rf(t,_,Dg(t,v,n),Dg(t,x,n),void 0,void 0,s,o,void 0,n,l,u)}}),Lg,Bw,Fw,jE,LU=bt(()=>{Qt(),dn(),fl(),gn(),Lg=(t,e,n,r,i,a,s,o)=>{let l=hr(a),u=l===1?"f32":`vec${l}f`,c=l===1?"vec2f":`mat2x${l}f`,d=i*s,h=64;d===1&&(h=256);let v=[i,s,a/l],x=[i,s,2],_=["rank","type","type"],b=[];b.push(...Ht(v,x));let S=E=>{let C=rt("x",e.dataType,3,l),A=rt("scale",n.dataType,n.dims),D=rt("bias",r.dataType,r.dims),O=Bt("output",1,3,2),V=[C,A,D,O];return`
  var<workgroup> workgroup_shared : array<${c}, ${h}>;
  const workgroup_size = ${h}u;
  ${E.declareVariables(...V)}
  ${E.mainStart(h)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${u}(0);
    var squared_sum = ${u}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${u}(${C.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${c}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${sl("workgroup_shared[0][0]",l)} / f32(hight * ${l});
      let squared_sum_final = ${sl("workgroup_shared[0][1]",l)} / f32(hight * ${l});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${o}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return t.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${l};${o};${h}`,inputDependencies:_},getRunData:()=>({outputs:[{dims:x,dataType:1}],dispatchGroup:{x:d},programUniforms:b}),getShaderSource:S},{inputs:[e,n,r],outputs:[-1]})[0]},Bw=(t,e,n)=>{let r=e[0].dims,i=r,a=2,s=r[0],o=r[1],l=Ye.sizeFromDimension(r,a),u=hr(l),c=Ye.size(i)/u,d=Lg(t,e[0],e[1],e[2],s,l,o,n.epsilon),h=[s,o,l/u],v=[s,o],x=["type","none"],_=b=>{let S=rt("x",e[0].dataType,h.length,u),E=rt("scale_shift",1,v.length,2),C=Bt("output",e[0].dataType,h.length,u),A=[S,E,C];return`
  ${b.registerUniform("output_size","u32").declareVariables(...A)}
  ${b.mainStart()}
  ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${C.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${E.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${S.getByOffset("global_idx")} * ${C.type.value}(scale_shift.x) + ${C.type.value}(scale_shift.y);
      ${C.setByOffset("global_idx","value")};
  }`};t.compute({name:"InstanceNormalization",shaderCache:{hint:`${u}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:[{type:12,data:c},...Ht(h,v,h)]}),getShaderSource:_},{inputs:[e[0],d]})},Fw=(t,e,n)=>{let r=e[0].dims,i=r,a=r[0],s=r[r.length-1],o=Ye.sizeFromDimension(r,1)/s,l=hr(s),u=Ye.size(i)/l,c=[{type:12,data:o},{type:12,data:Math.floor(s/l)}],d=["type","type"],h=!1,v=[0,r.length-1];for(let S=0;S<r.length-2;S++)h=h||r[S+1]!==1,v.push(S+1);h=h&&r[r.length-1]!==1;let x=h?t.compute(aa(t.inputs[0],v),{inputs:[t.inputs[0]],outputs:[-1]})[0]:t.inputs[0].reshape(Array.from({length:r.length},(S,E)=>r[v[E]])),_=Lg(t,x,e[1],e[2],a,o,s,n.epsilon),b=S=>{let E=zr(e[0].dataType),C=l===1?"vec2f":`mat${l}x2f`,A=V=>{let P=V===0?"x":"y",U=l===1?"f32":`vec${l}f`;switch(l){case 1:return`${E}(${U}(scale.${P}))`;case 2:return`vec2<${E}>(${U}(scale[0].${P}, scale[1].${P}))`;case 4:return`vec4<${E}>(${U}(scale[0].${P}, scale[1].${P}, scale[2].${P}, scale[3].${P}))`;default:throw new Error(`Not supported compoents ${l}`)}},D=rt("input",e[0].dataType,e[0].dims,l),O=Bt("output",e[0].dataType,i,l);return`
  @group(0) @binding(0) var<storage, read> input : array<${D.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${C}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${O.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${S.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${A(0)}, ${A(1)});
  }`};t.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${l}`,inputDependencies:d},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:c}),getShaderSource:b},{inputs:[e[0],_]})},jE=(t,e)=>{e.format==="NHWC"?Fw(t,t.inputs,e):Bw(t,t.inputs,e)}}),Uw,Vw,XE,zU=bt(()=>{Qt(),dn(),gn(),Uw=t=>{if(!t||t.length<2)throw new Error("layerNorm requires at least 2 inputs.")},Vw=(t,e,n)=>{let r=e.simplified,i=t[0].dims,a=t[1],s=!r&&t[2],o=i,l=Ye.normalizeAxis(e.axis,i.length),u=Ye.sizeToDimension(i,l),c=Ye.sizeFromDimension(i,l),d=Ye.size(a.dims),h=s?Ye.size(s.dims):0;if(d!==c||s&&h!==c)throw new Error(`Size of X.shape()[axis:] == ${c}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${d} and bias size of ${h}`);let v=[];for(let D=0;D<i.length;++D)D<l?v.push(i[D]):v.push(1);let x=hr(c),_=["type","type"],b=[{type:12,data:u},{type:1,data:c},{type:12,data:Math.floor(c/x)},{type:1,data:e.epsilon}];s&&_.push("type");let S=n>1,E=n>2,C=D=>{let O=zr(t[0].dataType),V=[rt("x",t[0].dataType,t[0].dims,x),rt("scale",a.dataType,a.dims,x)];s&&V.push(rt("bias",s.dataType,s.dims,x)),V.push(Bt("output",t[0].dataType,o,x)),S&&V.push(Bt("mean_data_output",1,v)),E&&V.push(Bt("inv_std_output",1,v));let P=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${D.registerUniforms(P).declareVariables(...V)}
  ${D.mainStart()}
    ${D.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${Gv("f32",x)};
    var mean_square_vector = ${Gv("f32",x)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${wc(O,x,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${sl("mean_vector",x)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${sl("mean_square_vector",x)} / uniforms.norm_size ${r?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${wc(O,x,"x[j + offset]")};
      let f32scale = ${wc(O,x,"scale[j]")};
      output[j + offset] = ${V[0].type.value}((f32input ${r?"":"- mean"}) * inv_std_dev * f32scale
        ${s?`+ ${wc(O,x,"bias[j]")}`:""}
      );
    }

    ${S?"mean_data_output[global_idx] = mean":""};
    ${E?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},A=[{dims:o,dataType:t[0].dataType}];return S&&A.push({dims:v,dataType:1}),E&&A.push({dims:v,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${x};${n};${r}`,inputDependencies:_},getRunData:()=>({outputs:A,dispatchGroup:{x:Math.ceil(u/64)},programUniforms:b}),getShaderSource:C}},XE=(t,e)=>{Uw(t.inputs),t.compute(Vw(t.inputs,e,t.outputCount))}}),Hw,KE,OU=bt(()=>{dn(),Dy(),Ly(),Hw=t=>{if(!t||t.length!==2)throw new Error("MatMul requires 2 inputs.");if(t[0].dims[t[0].dims.length-1]!==t[1].dims[t[1].dims.length-2])throw new Error("shared dimension does not match.")},KE=t=>{Hw(t.inputs);let e=Uc.calcShape(t.inputs[0].dims,t.inputs[1].dims,!0);if(!e)throw new Error("Can't use matmul on the given tensors");let n=e[e.length-1],r=t.inputs[0].dims[t.inputs[0].dims.length-1];if(n<8&&r<8)t.compute(Ry(t.inputs,{activation:""},e));else{let i=e[e.length-2],a=Ye.size(t.inputs[0].dims.slice(0,-2)),s=Ye.size(t.inputs[1].dims.slice(0,-2));if(a!==1&&i===1&&s===1){let o=t.inputs[0].reshape([1,a,r]),l=t.inputs[1].reshape([1,r,n]),u=[1,a,n],c=[o,l];t.compute(rp(c,{activation:""},e,u),{inputs:c})}else t.compute(rp(t.inputs,{activation:""},e))}}}),Ww,Gw,qw,YE,ZE,NU=bt(()=>{Qt(),dn(),xr(),gn(),Ww=(t,e)=>{if(t.length<3||t.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let n=t[0],r=n.dims.length;if(n.dims[r-1]!==e.k)throw new Error("The last dim of input shape does not match the k value");let i=Math.floor((e.k+e.blockSize-1)/e.blockSize),a=e.blockSize/8*e.bits,s=t[1];if(!Ye.areEqual(s.dims,[e.n,i,a]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let o=t[2].dims;if(Ye.size(o)!==e.n*i)throw new Error("scales input size error.");if(t.length===4){let l=t[3].dims,u=e.bits>4?e.n*i:e.n*Math.floor((i+1)/2);if(Ye.size(l)!==u)throw new Error("zeroPoints input size error.")}},Gw=(t,e)=>{let n=t[0].dims,r=n.length,i=n[r-2],a=e.k,s=e.n,o=n.slice(0,r-2),l=Ye.size(o),u=t[1].dims[2]/4,c=t[0].dataType,d=hr(e.k),h=hr(u),v=hr(s),x=o.concat([i,s]),_=i>1&&s/v%2===0?2:1,b=Ye.size(x)/v/_,S=64,E=[],C=[l,i,a/d],A=Ye.convertShape(t[1].dims).slice();A.splice(-1,1,u/h),E.push(...Ht(C)),E.push(...Ht(A)),E.push(...Ht(t[2].dims)),t.length===4&&E.push(...Ht(Ye.convertShape(t[3].dims)));let D=[l,i,s/v];E.push(...Ht(D));let O=V=>{let P=C.length,U=rt("a",t[0].dataType,P,d),Y=rt("b",12,A.length,h),fe=rt("scales",t[2].dataType,t[2].dims.length),Q=[U,Y,fe],G=t.length===4?rt("zero_points",12,t[3].dims.length):void 0;G&&Q.push(G);let re=D.length,he=Bt("output",t[0].dataType,re,v),ye=zr(t[0].dataType),$e=(()=>{switch(d){case 1:return`array<${ye}, 8>`;case 2:return`mat4x2<${ye}>`;case 4:return`mat2x4<${ye}>`;default:throw new Error(`${d}-component is not supported.`)}})(),_e=()=>{let ve=`
          // reuse a data
            var input_offset = ${U.indicesToOffset(`${U.type.indices}(batch, row, word_offset)`)};
            var a_data: ${$e};
            for (var j: u32 = 0; j < ${8/d}; j++) {
              a_data[j] = ${U.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let ie=0;ie<v*_;ie++)ve+=`
            b_value = ${h===1?`b${ie}_data`:`b${ie}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${$e}(${Array.from({length:4},(Pe,et)=>`${ye}(b_value_lower[${et}]), ${ye}(b_value_upper[${et}])`).join(", ")});
            b_dequantized_values = ${d===1?`${$e}(${Array.from({length:8},(Pe,et)=>`(b_quantized_values[${et}] - ${G?`zero_point${ie}`:"zero_point"}) * scale${ie}`).join(", ")});`:`(b_quantized_values - ${$e}(${Array(8).fill(`${G?`zero_point${ie}`:"zero_point"}`).join(",")})) * scale${ie};`};
            workgroup_shared[local_id.x * ${_} + ${Math.floor(ie/v)}]${v>1?`[${ie%v}]`:""} += ${Array.from({length:8/d},(Pe,et)=>`${d===1?`a_data[${et}] * b_dequantized_values[${et}]`:`dot(a_data[${et}], b_dequantized_values[${et}])`}`).join(" + ")};
          `;return ve},de=()=>{let ve=`
            var col_index = col * ${v};
            ${G?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${ye}(8);`}
            `;for(let ie=0;ie<v*_;ie++)ve+=`
            let scale${ie} = ${fe.getByOffset("col_index * nBlocksPerCol + block")};
            ${G?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${G.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${ie} = ${ye}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return ve},Oe=()=>{let ve=`col_index = col * ${v};`;for(let ie=0;ie<v*_;ie++)ve+=`
            let b${ie}_data = ${Y.getByIndices(`${Y.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return ve+=`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${$e};
            var b_dequantized_values: ${$e};`,ve};return`
        var<workgroup> workgroup_shared: array<${he.type.value}, ${_*S}>;
        ${V.declareVariables(...Q,he)}
        ${V.mainStart([S,1,1])}
          let output_indices = ${he.offsetToIndices(`(global_idx / ${S}) * ${_}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${S}) {
            //process one block
            var word_offset: u32 = block * ${e.blockSize/d};
            ${de()}
            for (var word: u32 = 0; word < ${u}; word += ${h}) {
              ${Oe()}
              for (var i: u32 = 0; i < ${h}; i++) {
                ${_e()}
                word_offset += ${8/d};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${_}) {
            var output_value: ${he.type.value} = ${he.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${S}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${_};
            }
            ${he.setByIndices(`${he.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${e.blockSize};${e.bits};${d};${h};${v};${_};${S}`,inputDependencies:Array(t.length).fill("rank")},getRunData:()=>({outputs:[{dims:x,dataType:c}],dispatchGroup:{x:b},programUniforms:E}),getShaderSource:O}},qw=(t,e)=>{let n=t[0].dims,r=n.length,i=n[r-2],a=e.k,s=e.n,o=n.slice(0,r-2),l=Ye.size(o),u=t[1].dims[2]/4,c=t[0].dataType,d=hr(e.k),h=hr(u),v=o.concat([i,s]),x=128,_=s%8===0?8:s%4===0?4:1,b=x/_,S=b*h*8,E=S/d,C=S/e.blockSize,A=Ye.size(v)/_,D=[],O=[l,i,a/d],V=Ye.convertShape(t[1].dims).slice();V.splice(-1,1,u/h),D.push(...Ht(O)),D.push(...Ht(V)),D.push(...Ht(t[2].dims)),t.length===4&&D.push(...Ht(Ye.convertShape(t[3].dims)));let P=[l,i,s];D.push(...Ht(P));let U=Y=>{let fe=O.length,Q=rt("a",t[0].dataType,fe,d),G=rt("b",12,V.length,h),re=rt("scales",t[2].dataType,t[2].dims.length),he=[Q,G,re],ye=t.length===4?rt("zero_points",12,t[3].dims.length):void 0;ye&&he.push(ye);let $e=P.length,_e=Bt("output",t[0].dataType,$e),de=zr(t[0].dataType),Oe=()=>{switch(d){case 1:return`
          let a_data0 = vec4<${de}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${de}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${de}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${de}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw new Error(`${d}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${Q.type.value}, ${E}>;
        var<workgroup> inter_results: array<array<${_e.type.value}, ${b}>, ${_}>;
        ${Y.declareVariables(...he,_e)}
        ${Y.mainStart([b,_,1])}
          let output_indices = ${_e.offsetToIndices(`workgroup_index * ${_}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${C} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${E};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${E}; a_offset += ${x})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${Q.getByIndices(`${Q.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${Q.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${C} + local_id.x;
            ${ye?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${ye.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${de}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${de}(8);`}
            let scale = ${re.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${G.getByIndices(`${G.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${e.blockSize/d};
            for (var i: u32 = 0; i < ${h}; i++) {
              ${Oe()}
              let b_value = ${h===1?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${de}>(${Array.from({length:4},(ve,ie)=>`${de}(b_value_lower[${ie}]), ${de}(b_value_upper[${ie}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${de}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(ve,ie)=>`${`dot(a_data${ie}, b_dequantized_values[${ie}])`}`).join(" + ")};
              word_offset += ${8/d};
            }
            workgroupBarrier();
          }

          if (local_idx < ${_}) {
            var output_value: ${_e.type.value} = ${_e.type.value}(0);
            for (var b = 0u; b < ${b}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${_e.setByIndices(`${_e.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${e.blockSize};${d};${h};${b};${_}`,inputDependencies:Array(t.length).fill("rank")},getRunData:()=>({outputs:[{dims:v,dataType:c}],dispatchGroup:{x:A},programUniforms:D}),getShaderSource:U}},YE=(t,e)=>{Ww(t.inputs,e),e.blockSize===32&&t.adapterInfo.isVendor("intel")&&t.adapterInfo.isArchitecture("gen-12lp")?t.compute(qw(t.inputs,e)):t.compute(Gw(t.inputs,e))},ZE=t=>qn(t)}),jw,Xw,Kw,Yw,Zw,Jw,Qw,e4,JE,BU=bt(()=>{Qt(),dn(),gn(),jw=t=>{if(!t||t.length<1)throw new Error("Too few inputs");if(t[0].dataType!==1&&t[0].dataType!==10)throw new Error("Input type must be float or float16.");if(t.length>=2){let e=t[0].dims.length*2===t[1].dims[0];if(t.length===4&&(e=t[3].dims[0]*2===t[1].dims[0]),!e)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},Xw=(t,e,n)=>{let r="";for(let i=e-1;i>=0;--i)r+=`
            k = i32(${t.indicesGet("indices",i)}) - ${Ut("uniforms.pads",i,n)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${Ut("uniforms.x_shape",i,e)})) {
              break;
            }
            offset += k * i32(${Ut("uniforms.x_strides",i,e)});
        `;return`
          value = ${t.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${r}
            value = x[offset];
          }
      `},Kw=(t,e,n)=>{let r="";for(let i=e-1;i>=0;--i)r+=`
                k = i32(${t.indicesGet("indices",i)}) - ${Ut("uniforms.pads",i,n)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${Ut("uniforms.x_shape",i,e)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${Ut("uniforms.x_shape",i,e)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${Ut("uniforms.x_strides",i,e)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},Yw=(t,e,n)=>{let r="";for(let i=e-1;i>=0;--i)r+=`
                k = i32(${t.indicesGet("indices",i)}) - ${Ut("uniforms.pads",i,n)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${Ut("uniforms.x_shape",i,e)})) {
                  k = i32(${Ut("uniforms.x_shape",i,e)}) - 1;
                }
                offset += k * i32(${Ut("uniforms.x_strides",i,e)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},Zw=(t,e,n)=>{let r="";for(let i=e-1;i>=0;--i)r+=`
                k = i32(${t.indicesGet("indices",i)}) - ${Ut("uniforms.pads",i,n)};
                if (k < 0)  {
                  k += i32(${Ut("uniforms.x_shape",i,e)}]);
                }
                if (k >= i32(${Ut("uniforms.x_shape",i,e)})) {
                  k -= i32(${Ut("uniforms.x_shape",i,e)});
                }
                offset += k * i32(${Ut("uniforms.x_strides",i,e)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},Jw=(t,e,n)=>{switch(n.mode){case 0:return Xw(t,e,n.pads.length);case 1:return Kw(t,e,n.pads.length);case 2:return Yw(t,e,n.pads.length);case 3:return Zw(t,e,n.pads.length);default:throw new Error("Invalid mode")}},Qw=(t,e)=>{let n=Ye.padShape(t[0].dims.slice(),e.pads),r=t[0].dims,i=Ye.size(n),a=[{type:12,data:i},{type:6,data:e.pads}],s=t.length>=3&&t[2].data;e.mode===0&&a.push({type:s?t[2].dataType:1,data:e.value}),a.push(...Ht(t[0].dims,n));let o=["rank"],l=u=>{let c=Bt("output",t[0].dataType,n.length),d=rt("x",t[0].dataType,r.length),h=d.type.value,v=Jw(c,r.length,e),x=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:e.pads.length}];return e.mode===0&&x.push({name:"constant_value",type:s?h:"f32"}),`
            ${u.registerUniforms(x).declareVariables(d,c)}
            ${u.mainStart()}
            ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${c.offsetToIndices("global_idx")};

            var value = ${h}(0);
            ${v}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${e.mode}${s}`,inputDependencies:o},getRunData:()=>({outputs:[{dims:n,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(Ye.size(n)/64)},programUniforms:a}),getShaderSource:l}},e4=(t,e)=>{if(t.length>1){let n=t[1].getBigInt64Array(),r=t.length>=3&&t[2].data?t[2].dataType===10?t[2].getUint16Array()[0]:t[2].getFloat32Array()[0]:0,i=t[0].dims.length,a=new Int32Array(2*i).fill(0);if(t.length>=4){let o=t[3].getBigInt64Array();for(let l=0;l<o.length;l++)a[Number(o[l])]=Number(n[l]),a[Number(o[l])+i]=Number(n[l+o.length])}else n.forEach((o,l)=>a[Number(l)]=Number(o));let s=[];return a.forEach(o=>s.push(o)),{mode:e.mode,value:r,pads:s}}else return e},JE=(t,e)=>{jw(t.inputs);let n=e4(t.inputs,e);t.compute(Qw(t.inputs,n),{inputs:[0]})}}),Bd,zg,Og,Ng,Bg,t4,n4,Fg,Ug,QE,eT,Vg,tT,nT,Hg,rT,iT,aT,sT,FU=bt(()=>{Ka(),Qt(),dn(),gn(),Bd=t=>{if(or.webgpu.validateInputContent&&(!t||t.length!==1))throw new Error("Pool ops requires 1 input.")},zg=(t,e,n)=>{let r=e.format==="NHWC",i=t.dims.slice();r&&i.splice(1,0,i.pop());let a=Object.hasOwnProperty.call(e,"dilations"),s=e.kernelShape.slice(),o=e.strides.slice(),l=a?e.dilations.slice():[],u=e.pads.slice();tp.adjustPoolAttributes(n,i,s,o,l,u);let c=tp.computePoolOutputShape(n,i,o,l,s,u,e.autoPad),d=Object.assign({},e);a?Object.assign(d,{kernelShape:s,strides:o,pads:u,dilations:l,cacheKey:e.cacheKey}):Object.assign(d,{kernelShape:s,strides:o,pads:u,cacheKey:e.cacheKey});let h=c.slice();return h.push(h.splice(1,1)[0]),[d,r?h:c]},Og=(t,e)=>{let n=e.format==="NHWC",r=Ye.size(t),i=Ye.size(e.kernelShape),a=[{type:12,data:r},{type:12,data:i}],s=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(e.kernelShape.length<=2){let o=e.kernelShape[e.kernelShape.length-1],l=e.strides[e.strides.length-1],u=e.pads[e.pads.length/2-1],c=e.pads[e.pads.length-1],d=!!(u+c);a.push({type:12,data:o},{type:12,data:l},{type:12,data:u},{type:12,data:c}),s.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let h=!1;if(e.kernelShape.length===2){let v=e.kernelShape[e.kernelShape.length-2],x=e.strides[e.strides.length-2],_=e.pads[e.pads.length/2-2],b=e.pads[e.pads.length-2];h=!!(_+b),a.push({type:12,data:v},{type:12,data:x},{type:12,data:_},{type:12,data:b}),s.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[a,s,!0,d,h]}else{if(n)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let o=Ye.computeStrides(e.kernelShape);a.push({type:12,data:o},{type:12,data:e.pads},{type:12,data:e.strides}),s.push({name:"kernelStrides",type:"u32",length:o.length},{name:"pads",type:"u32",length:e.pads.length},{name:"strides",type:"u32",length:e.strides.length});let l=e.pads.reduce((u,c)=>u+c);return[a,s,!!l,!1,!1]}},Ng=(t,e,n,r,i,a,s,o,l,u,c,d)=>{let h=i.format==="NHWC",v=e.type.value,x=Bt("output",e.type.tensor,r);if(i.kernelShape.length<=2){let _="",b="",S="",E=n-(h?2:1);if(c?_=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${E}] = indices[${E}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${E}] < 0 || xIndices[${E}]
                      >= uniforms.x_shape[${E}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${e.indicesToOffset("xIndices")}];
                  ${a}
                }`:_=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${E}] = indices[${E}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${e.indicesToOffset("xIndices")}];
                  ${a}
                }`,i.kernelShape.length===2){let C=n-(h?3:2);d?b=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${C}] = indices[${C}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${C}] < 0 || xIndices[${C}] >= uniforms.x_shape[${C}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:b=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${C}] = indices[${C}] * uniforms.sh - uniforms.phStart + j;
                `,S=`
              }
            `}return`
            ${t.registerUniforms(l).declareVariables(e,x)}

            ${t.mainStart()}
              ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${x.offsetToIndices("global_idx")};
              var xIndices = ${x.offsetToIndices("global_idx")};

              var value = ${v}(${o});
              var pad = 0;
              ${b}
              ${_}
              ${S}
              ${s}

              output[global_idx] = value;
            }`}else{if(h)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let _=i.kernelShape.length,b=i.pads.length,S="";return u?S=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${e.indicesToOffset("xIndices")}];
                ${a}
              }`:S=`
              }
              let x_val = x[${e.indicesToOffset("xIndices")}];
              ${a}
            `,`
            ${t.registerUniforms(l).declareVariables(e,x)}

            ${t.mainStart()}
              ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${x.offsetToIndices("global_idx")};
              var xIndices = ${x.offsetToIndices("global_idx")};

              var offsets: array<u32, ${_}>;

              var value = ${v}(${o});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${_-1}u; j++) {
                  offsets[j] = offset / ${Ut("uniforms.kernelStrides","j",_)};
                  offset -= offsets[j] * ${Ut("uniforms.kernelStrides","j",_)};
                }
                offsets[${_-1}] = offset;

                isPad = false;
                for (var j = ${n-_}u; j < ${n}u; j++) {
                  xIndices[j] = indices[j] * ${Ut("uniforms.strides",`j - ${n-_}u`,_)}
                    + offsets[j - ${n-_}u] - ${Ut("uniforms.pads","j - 2u",b)};
                  ${S}
              }
              ${s}

              output[global_idx] = value;
            }`}},Bg=t=>`${t.format};${t.ceilMode};${t.autoPad};${t.kernelShape.length}`,t4=t=>`${Bg(t)};${t.countIncludePad}`,n4=t=>`${Bg(t)};${t.storageOrder};${t.dilations}`,Fg=t=>({format:t.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][t.auto_pad],ceilMode:t.ceil_mode,kernelShape:t.kernel_shape,strides:t.strides,pads:t.pads}),Ug=(t,e,n,r)=>{let[i,a]=zg(e,r,n),s=rt("x",e.dataType,e.dims.length),o=s.type.value,l="value += x_val;",u="";i.countIncludePad?u+=`value /= ${o}(uniforms.kernelSize);`:u+=`value /= ${o}(i32(uniforms.kernelSize) - pad);`;let[c,d,h,v,x]=Og(a,i);c.push(...Ht(e.dims,a));let _=["rank"];return{name:t,shaderCache:{hint:`${r.cacheKey};${h};${v};${x}`,inputDependencies:_},getRunData:()=>({outputs:[{dims:a,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(Ye.size(a)/64)},programUniforms:c}),getShaderSource:b=>Ng(b,s,e.dims.length,a.length,i,l,u,0,d,h,v,x)}},QE=t=>{let e=t.count_include_pad!==0,n=Fg(t);if(n.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let r={countIncludePad:e,...n,cacheKey:""};return{...r,cacheKey:t4(r)}},eT=(t,e)=>{Bd(t.inputs),t.compute(Ug("AveragePool",t.inputs[0],!1,e))},Vg={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},tT=t=>{let e=t.format;return{format:e,...Vg,cacheKey:e}},nT=(t,e)=>{Bd(t.inputs),t.compute(Ug("GlobalAveragePool",t.inputs[0],!0,e))},Hg=(t,e,n,r)=>{let[i,a]=zg(e,r,n),s=`
      value = max(x_val, value);
    `,o="",l=rt("x",e.dataType,e.dims.length),u=["rank"],[c,d,h,v,x]=Og(a,i);return c.push(...Ht(e.dims,a)),{name:t,shaderCache:{hint:`${r.cacheKey};${h};${v};${x}`,inputDependencies:u},getRunData:()=>({outputs:[{dims:a,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(Ye.size(a)/64)},programUniforms:c}),getShaderSource:_=>Ng(_,l,e.dims.length,a.length,i,s,o,e.dataType===10?-65504:-1e5,d,h,v,x)}},rT=(t,e)=>{Bd(t.inputs),t.compute(Hg("MaxPool",t.inputs[0],!1,e))},iT=t=>{let e=t.storage_order,n=t.dilations,r=Fg(t);if(e!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let i={storageOrder:e,dilations:n,...r,cacheKey:""};return{...i,cacheKey:n4(i)}},aT=t=>{let e=t.format;return{format:e,...Vg,cacheKey:e}},sT=(t,e)=>{Bd(t.inputs),t.compute(Hg("GlobalMaxPool",t.inputs[0],!0,e))}}),r4,i4,oT,lT,UU=bt(()=>{Qt(),dn(),xr(),gn(),r4=(t,e)=>{if(t.length<2||t.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(t.length===3&&t[1].dims===t[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(t.length===3&&t[0].dataType!==t[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(t[0].dataType===6&&t.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(t[1].dims.length!==0&&t[1].dims.length!==1&&t[1].dims.length!==t[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(t.length>2){if(t[0].dataType!==t[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(t[1].dims.length!==t[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!t[1].dims.map((n,r)=>n===t[2].dims[r]).reduce((n,r)=>n&&r,!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(e.blockSize>0){if(t[1].dims.length===0||t[1].dims.length===1&&t[1].dims[0]===1)throw new Error("blockSize must be set only for block quantization.");if(!t[1].dims.map((i,a)=>a===e.axis||i===t[0].dims[a]).reduce((i,a)=>i&&a,!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(t[1].dims.length!==t[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let n=t[0].dims[e.axis],r=t[1].dims[e.axis];if(e.blockSize<Math.ceil(n/r)||e.blockSize>Math.ceil(n/(r-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},i4=(t,e)=>{let n=Ye.normalizeAxis(e.axis,t[0].dims.length),r=t[0].dataType,i=r===3,a=t[0].dims,s=t[1].dataType,o=Ye.size(a),l=r===3||r===2,u=l?[Math.ceil(Ye.size(t[0].dims)/4)]:t[0].dims,c=t[1].dims,d=t.length>2?t[2]:void 0,h=d?l?[Math.ceil(Ye.size(d.dims)/4)]:d.dims:void 0,v=c.length===0||c.length===1&&c[0]===1,x=v===!1&&c.length===1,_=hr(o),b=v&&(!l||_===4),S=b?_:1,E=b&&!l?_:1,C=rt("input",l?12:r,u.length,E),A=rt("scale",s,c.length),D=d?rt("zero_point",l?12:r,h.length):void 0,O=Bt("output",s,a.length,S),V=[C,A];D&&V.push(D);let P=[u,c];d&&P.push(h);let U=[{type:12,data:o/S},{type:12,data:n},{type:12,data:e.blockSize},...Ht(...P,a)],Y=fe=>{let Q=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${fe.registerUniforms(Q).declareVariables(...V,O)}
      ${fe.mainStart()}
          ${fe.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${O.offsetToIndices("global_idx")};

          // Set input x
          ${l?`
            let input = ${C.getByOffset("global_idx / 4")};
            let x_vec = ${i?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${S===1?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${C.getByOffset("global_idx")};`};

          // Set scale input
          ${v?`let scale_value= ${A.getByOffset("0")}`:x?`
            let scale_index = ${O.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${A.getByOffset("scale_index")};`:`
            var scale_indices: ${A.type.indices} = output_indices;
            let index = ${A.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${A.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${A.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${D?v?l?`
                let zero_point_input = ${D.getByOffset("0")};
                let zero_point_vec =  ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${D.getByOffset("0")}`:x?l?`
                let zero_point_index = ${O.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${D.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${O.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${D.getByOffset("zero_point_index")};`:l?`
                let zero_point_offset = ${A.indicesToOffset("scale_indices")};
                let zero_point_input = ${D.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${D.getByIndices("scale_indices")};`:`let zero_point_value = ${l?i?"i32":"u32":C.type.value}(0);`};
      // Compute and write output
      ${O.setByOffset("global_idx",`${O.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:e.cacheKey,inputDependencies:D?["rank","rank","rank"]:["rank","rank"]},getShaderSource:Y,getRunData:()=>({outputs:[{dims:a,dataType:s}],dispatchGroup:{x:Math.ceil(o/S/64),y:1,z:1},programUniforms:U})}},oT=(t,e)=>{r4(t.inputs,e),t.compute(i4(t.inputs,e))},lT=t=>qn({axis:t.axis,blockSize:t.blockSize})}),a4,s4,uT,VU=bt(()=>{Ka(),Qt(),gn(),a4=(t,e,n)=>{let r=t===e,i=t<e&&n<0,a=t>e&&n>0;if(r||i||a)throw new Error("Range these inputs' contents are invalid.")},s4=(t,e,n,r)=>{let i=Math.abs(Math.ceil((e-t)/n)),a=[i],s=i,o=[{type:12,data:s},{type:r,data:t},{type:r,data:n},...Ht(a)],l=u=>{let c=Bt("output",r,a.length),d=c.type.value,h=[{name:"outputSize",type:"u32"},{name:"start",type:d},{name:"delta",type:d}];return`
        ${u.registerUniforms(h).declareVariables(c)}
        ${u.mainStart()}
        ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${d}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${r}`},getShaderSource:l,getRunData:()=>({outputs:[{dims:a,dataType:r}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:o})}},uT=t=>{let e=0,n=0,r=0;t.inputs[0].dataType===6?(e=t.inputs[0].getInt32Array()[0],n=t.inputs[1].getInt32Array()[0],r=t.inputs[2].getInt32Array()[0]):t.inputs[0].dataType===1&&(e=t.inputs[0].getFloat32Array()[0],n=t.inputs[1].getFloat32Array()[0],r=t.inputs[2].getFloat32Array()[0]),or.webgpu.validateInputContent&&a4(e,n,r),t.compute(s4(e,n,r,t.inputs[0].dataType),{inputs:[]})}}),o4,l4,cT,dT,HU=bt(()=>{Qt(),dn(),xr(),gn(),o4=(t,e,n,r)=>{if(t!=="none"&&r!=="i32"&&r!=="u32"&&r!=="f32")throw new Error(`Input ${r} is not supported with reduction ${t}.`);let i=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,a=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${e}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(t){case"none":return`${e}=${n};`;case"add":return r==="i32"||r==="u32"?`atomicAdd(&${e}, bitcast<${r}>(${n}));`:`
              ${i}bitcast<${r}>(oldValue) + (${n})${a}`;case"max":return r==="i32"||r==="u32"?`atomicMax(&${e}, bitcast<${r}>(${n}));`:`
                ${i}max(bitcast<f32>(oldValue), (${n}))${a}`;case"min":return r==="i32"||r==="u32"?`atomicMin(&${e}, bitcast<${r}>(${n}));`:`${i}min(bitcast<${r}>(oldValue), (${n}))${a}`;case"mul":return`${i}(bitcast<${r}>(oldValue) * (${n}))${a}`;default:throw new Error(`Reduction ${t} is not supported.`)}},l4=(t,e)=>{let n=t[0].dims,r=t[1].dims,i=n,a=1,s=Math.ceil(Ye.size(r)/a),o=r[r.length-1],l=Ye.sizeFromDimension(n,o),u=[{type:12,data:s},{type:12,data:o},{type:12,data:l},...Ht(t[1].dims,t[2].dims,i)],c=d=>{let h=rt("indices",t[1].dataType,t[1].dims.length),v=rt("updates",t[2].dataType,t[2].dims.length,a),x=e.reduction!=="none"&&e.reduction!==""?U7("output",t[0].dataType,i.length):Bt("output",t[0].dataType,i.length,a);return`
      ${d.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(h,v,x)}
      ${d.mainStart()}
        ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var hasDuplicates = false;
  if (${e.reduction==="none"}) {
    let n = ${Ye.size(r)};
    for (var i = 0; i < n; i = i + 1) {
      for (var j = i + 1; j < n; j = j + 1) {
        var index_i = i32(indices[i].x);
        var index_j = i32(indices[j].x);
        if (index_i == index_j) {
          hasDuplicates = true;
          break;
        }
      }
      if (hasDuplicates) {
        break;
      }
    }
  }

  var data_offset = 0u;
  var indices_start = uniforms.last_index_dimension * global_idx;
  if (${e.reduction==="none"} && hasDuplicates) {
    if (global_idx != 0u) {
      return;
    }
    indices_start = 0u;
  }
  let indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${t[0].dims.length===1?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[i - indices_start];
    let dim_value = uniforms.output_shape[i - indices_start + uniforms.last_index_dimension];`}
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));
  }

  for (var i = 0u; i < uniforms.num_updates_elements; i++) {
    let value = updates[uniforms.num_updates_elements * global_idx + i];
    ${o4(e.reduction,"output[data_offset + i]","value",x.type.value)}
  }

      }`};return{name:"ScatterND",shaderCache:{hint:`${e.cacheKey}_${e.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:u}),getShaderSource:c}},cT=t=>qn({reduction:t.reduction}),dT=(t,e)=>{t.compute(l4(t.inputs,e),{inputs:[t.inputs[1],t.inputs[2]],outputs:[]})}}),u4,c4,d4,Wg,f4,h4,p4,m4,g4,v4,y4,_4,Gg,b4,x4,w4,S4,M4,fT,hT,WU=bt(()=>{Qt(),dn(),xr(),gn(),u4=(t,e)=>{if(t.every(n=>n>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),t.length>0){if(e.mode==="linear"){if(!(t.length===2||t.length===3||t.length===4&&t[0]===1&&t[1]===1||t.length===4&&t[0]===1&&t[3]===1||t.length===5&&t[0]===1&&t[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(e.mode==="cubic"&&!(t.length===2||t.length===4&&t[0]===1&&t[1]===1||t.length===4&&t[0]===1&&t[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},c4=(t,e,n)=>{e.every(i=>i>=0&&i<n||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let r=new Array(n).fill(1);return e.forEach((i,a)=>r[i]=t[a]),r},d4=(t,e,n,r,i,a)=>{let[s,o,l]=n>10?[1,2,3]:[-1,t.length>1?1:-1,-1],u=t[0].dims.length;if(s>0&&t.length>s&&t[s].dims.length>0)t[s].getFloat32Array().forEach(c=>a.push(c));else if(e.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(o>0&&t.length>o&&t[o].dims.length===1&&t[o].dims[0]>0){if(t[o].getFloat32Array().forEach(c=>r.push(c)),r.length!==0&&r.length!==u&&n>=18&&r.length!==e.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");u4(r,e),e.axes.length>0&&c4(r,e.axes,u).forEach((c,d)=>r[d]=c)}if(l>0&&t.length>l&&t[l].dims.length===1&&t[l].dims[0]>0&&(t[l].getBigInt64Array().forEach(c=>i.push(Number(c))),i.length!==0&&i.length!==u&&n>=18&&i.length!==e.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(e.axes.length>0){if(r.length!==0&&r.length!==e.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(i.length!==0&&i.length!==e.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof r<"u"&&typeof i<"u"&&r.length>0&&i.length>u)throw new Error("Resize requires only of scales or sizes to be specified")},Wg=(t,e,n,r)=>`
  // The whole part and the fractional part are calculated separately due to inaccuracy of floating
  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
  // offset-by-one error later in floor().
  let big = (${t}) * (${e});
  let whole = ${r}(big / (${n}));
  let fract = ${r}(big % (${n})) / ${r}(${n});
  return whole + fract;
`,f4=(t,e)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${e} { `+(()=>{switch(t){case"asymmetric":return`
          if (xScale < 1.0 || floor(xScale) != xScale) {
            return ${e}(xResized) / ${e}(xScale);
          } else {
            ${Wg("xResized","lengthOriginal","lengthResized",e)}
          }
        `;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${e}(xResized) + 0.5) / ${e}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${e}(xResized) + 0.5) / ${e}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    ${Wg("xResized","lengthOriginal - 1","lengthResized - 1",e)}
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${e}(roiStart) * ${e}(lengthOriginal - 1) +
                        (${e}(xResized) * ${e}(roiEnd - roiStart) * ${e}(lengthOriginal - 1)) /
                        ${e}(lengthResized - 1);
                  } else {
                    return 0.5 * ${e}(roiStart + roiEnd) * ${e}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${e}xScale * ${e}(lengthResized);
                  const adjustment = ${e}(lengthResized) / outputWidth;
                  const center = ${e}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${e}(xResized) + 0.5) / ${e}(xScale)) - 0.5;`;case"half_pixel":return`return ((${e}(xResized) + 0.5) / ${e}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${t} is not supported`)}})()+"}",h4=(t,e,n)=>`fn getNearestPixelFromOriginal(xOriginal: ${n}, isDownSample: bool) -> ${n} {`+(()=>{switch(t){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(e<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${t} is not supported`)}})()+"}",p4=(t,e,n)=>{let r=new Array(n).fill(0).concat(new Array(n).fill(1)),i=t.length===0?r:t.slice();return e.length>0?(e.forEach((a,s)=>{r[a]=i[s],r[s+n]=i[e.length+s]}),r):i},m4=(t,e,n,r)=>{let i=[];if(n.length>0)if(r.length>0){if(t.forEach(a=>i.push(a)),Math.max(...r)>t.length)throw new Error("axes is out of bound");r.forEach((a,s)=>i[a]=n[s])}else n.forEach(a=>i.push(a));else{if(e.length===0)throw new Error("Resize requires either scales or sizes.");i=t.map((a,s)=>Math.round(a*e[s]))}return i},g4=(t,e,n)=>{let r=(()=>{switch(n.keepAspectRatioPolicy){case"not_larger":return n.axes.length>0?Math.min(...n.axes.map(a=>e[a]),Number.MAX_VALUE):Math.min(...e,Number.MAX_VALUE);case"not_smaller":return n.axes.length>0?Math.max(...n.axes.map(a=>e[a]),Number.MIN_VALUE):Math.max(...e,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${n.keepAspectRatioPolicy} is not supported`)}})();e.fill(1,0,e.length);let i=t.slice();return n.axes.length>0?(n.axes.forEach(a=>e[a]=r),n.axes.forEach(a=>i[a]=Math.round(t[a]*e[a]))):(e.fill(r,0,e.length),i.forEach((a,s)=>i[s]=Math.round(a*e[s]))),i},v4=(t,e,n,r,i)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> array<${t.type.value}, ${n.length}> {
      var original_indices: array<${t.type.value}, ${n.length}>;
      for (var i:u32 = 0; i < ${n.length}; i++) {
        var output_index = ${t.indicesGet("output_indices","i")};
        var scale = ${Ut("uniforms.scales","i",r)};
        var roi_low = ${Ut("uniforms.roi","i",i)};
        var roi_hi = ${Ut("uniforms.roi",`i + ${e.length}`,i)};
        if (scale == 1.0) {
          original_indices[i] = ${t.type.value}(output_index);
        } else {
          var input_shape_i = ${Ut("uniforms.input_shape","i",e.length)};
          var output_shape_i = ${Ut("uniforms.output_shape","i",n.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,y4=(t,e,n,r,i,a,s)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> ${t.type.indices} {
      var input_indices: ${t.type.indices};
      for (var i:u32 = 0; i < ${r.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${Ut("uniforms.scales","i",i)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${Ut("uniforms.roi","i",a)};
          var roi_hi = ${Ut("uniforms.roi",`i + ${n.length}`,a)};
          var input_shape_i = ${Ut("uniforms.input_shape","i",n.length)};
          var output_shape_i = ${Ut("uniforms.output_shape","i",r.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${s} || (original_idx >= 0 && original_idx < ${e.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${e.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${t.indicesSet("input_indices","i","input_index")}
      }
      return input_indices;
    }`,_4=(t,e)=>`
    fn checkInputIndices(input_indices: ${t.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${e.length}; i++) {
        var input_index = ${t.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${Ut("uniforms.input_shape","i",e.length)}) {
          return false;
        }
      }
      return true;
    }`,Gg=(t,e,n,r)=>t.rank>r?`
    ${t.indicesSet("input_indices",e,"channel")};
    ${t.indicesSet("input_indices",n,"batch")};
`:"",b4=(t,e,n,r,i)=>{let[a,s,o,l]=n.length===2?[-1,0,1,-1]:[0,2,3,1],u=t.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${u} {
      var input_indices: ${t.type.indices};
      ${t.indicesSet("input_indices",s,`max(0, min(row, ${n[s]} - 1))`)};
      ${t.indicesSet("input_indices",o,`max(0, min(col, ${n[o]} - 1))`)};
      ${Gg(t,l,a,2)}
      return ${t.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${e.type.indices}) -> ${u} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${u} = originalIndices[${s}];
      var col:${u} = originalIndices[${o}];
      ${r?`if (row < 0 || row > (${n[s]} - 1) || col < 0 || col > (${n[o]} - 1)) {
        return ${i};
      }`:""};
      row = max(0, min(row, ${n[s]} - 1));
      col = max(0, min(col, ${n[o]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${n.length>2?`u32(originalIndices[${l}])`:"0"};
      var batch: u32 =  ${n.length>2?`u32(originalIndices[${a}])`:"0"};
      var x11: ${u} = getInputValue(batch, channel, row1, col1);
      var x12: ${u} = getInputValue(batch, channel, row1, col2);
      var x21: ${u} = getInputValue(batch, channel, row2, col1);
      var x22: ${u} = getInputValue(batch, channel, row2, col2);
      var dx1: ${u} = abs(row - ${u}(row1));
      var dx2: ${u} = abs(${u}(row2) - row);
      var dy1: ${u} = abs(col - ${u}(col1));
      var dy2: ${u} = abs(${u}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},x4=(t,e,n,r,i,a,s,o,l,u)=>{let c=n.length===2,[d,h]=c?[0,1]:[2,3],v=t.type.value,x=_=>{let b=_===d?"row":"col";return`
      fn ${b}CubicInterpolation(input_indices: ${t.type.indices}, output_indices: ${e.type.indices}) -> ${v} {
        var output_index = ${e.indicesGet("output_indices",_)};
        var originalIdx: ${v} = getOriginalCoordinateFromResizedCoordinate(output_index, ${i[_]},
        ${r[_]}, ${n[_]}, ${a[_]}, ${a[_]} + ${n.length});
        var fractOriginalIdx: ${v} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${o} && (originalIdx < 0 || originalIdx > (${n[_]} - 1))) {
          return ${l};
        }
        var data: array<${v}, 4> = array<${v}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${b}: ${v} = originalIdx + ${v}(i);
          if (${b} < 0 || ${b} >= ${n[_]}) {
            ${u?`coefs[i + 1] = 0.0;
                        continue;`:o?`return ${l};`:`${b} = max(0, min(${b}, ${n[_]} - 1));`};
          }
        var input_indices_copy: ${t.type.indices} = input_indices;
          ${t.indicesSet("input_indices_copy",_,`u32(${b})`)};
          data[i + 1] = ${_===d?t.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${x(d)};
    ${x(h)};
  fn getCubicInterpolationCoefs(s: ${v}) -> array<${v}, 4> {
    var absS = abs(s);
    var coeffs: array<${v}, 4> = array<${v}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${v} = 1.0 - absS;
    var twoMinusAbsS: ${v} = 2.0 - absS;
    var onePlusAbsS: ${v} = 1.0 + absS;
    coeffs[0] = ((${s} * onePlusAbsS - 5 * ${s}) * onePlusAbsS + 8 * ${s}) * onePlusAbsS - 4 * ${s};
    coeffs[1] = ((${s} + 2) * absS - (${s} + 3)) * absS * absS + 1;
    coeffs[2] = ((${s} + 2) * oneMinusAbsS - (${s} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${s} * twoMinusAbsS - 5 * ${s}) * twoMinusAbsS + 8 * ${s}) * twoMinusAbsS - 4 * ${s};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${v}, 4>, coefs: array<${v}, 4>) -> ${v} {
    var coefsSum: ${v} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${e.type.indices}) -> ${v} {
    var input_indices: ${t.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},w4=(t,e,n,r,i)=>{let[a,s,o,l,u]=n.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],c=t.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${c} {
      var input_indices: ${t.type.indices};
      ${t.indicesSet("input_indices",s,`max(0, min(depth, ${n[s]} - 1))`)};
      ${t.indicesSet("input_indices",o,`max(0, min(height, ${n[o]} - 1))`)};
      ${t.indicesSet("input_indices",l,`max(0, min(width, ${n[l]} - 1))`)};
      ${Gg(t,u,a,3)}
      return ${t.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${e.type.indices}) -> ${c} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${c} = originalIndices[${s}];
      var height:${c} = originalIndices[${o}];
      var width:${c} = originalIndices[${l}];
      ${r?`if (depth < 0 || depth > (${n[s]} - 1) || height < 0 || height > (${n[o]} - 1) || width < 0 || (width > ${n[l]} - 1)) {
      return ${i};
        }`:""};

    depth = max(0, min(depth, ${n[s]} - 1));
      height = max(0, min(height, ${n[o]} - 1));
      width = max(0, min(width, ${n[l]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${n.length>3?`u32(originalIndices[${u}])`:"0"};
      var batch: u32 =  ${n.length>3?`u32(originalIndices[${a}])`:"0"};

      var x111: ${c} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${c} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${c} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${c} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${c} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${c} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${c} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${c} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${c} = abs(depth - ${c}(depth1));
      var dx2: ${c} = abs(${c}(depth2) - depth);
      var dy1: ${c} = abs(height - ${c}(height1));
      var dy2: ${c} = abs(${c}(height2) - height);
      var dz1: ${c} = abs(width - ${c}(width1));
      var dz2: ${c} = abs(${c}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},S4=(t,e,n,r,i,a)=>{let s=t.dims,o=p4(a,e.axes,s.length),l=m4(s,r,i,e.axes),u=r.slice();r.length===0&&(u=s.map((E,C)=>E===0?1:l[C]/E),e.keepAspectRatioPolicy!=="stretch"&&(l=g4(s,u,e)));let c=Bt("output",t.dataType,l.length),d=rt("input",t.dataType,s.length),h=Ye.size(l),v=s.length===l.length&&s.every((E,C)=>E===l[C]),x=e.coordinateTransformMode==="tf_crop_and_resize",_=e.extrapolationValue,b=d.type.value,S=E=>`
      ${v?"":`
      ${f4(e.coordinateTransformMode,b)};
      ${(()=>{switch(e.mode){case"nearest":return`
              ${_4(d,s)};
              ${h4(e.nearestMode,n,b)};
              ${y4(d,c,s,l,u.length,o.length,x)};
              `;case"linear":return`
              ${v4(c,s,l,u.length,o.length)};
              ${(()=>{if(s.length===2||s.length===4)return`${b4(d,c,s,x,_)}`;if(s.length===3||s.length===5)return`${w4(d,c,s,x,_)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(s.length===2||s.length===4)return`${x4(d,c,s,l,u,o,e.cubicCoeffA,x,e.extrapolationValue,e.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${E.registerUniform("output_size","u32").registerUniform("scales","f32",u.length).registerUniform("roi","f32",o.length).declareVariables(d,c)}
      ${E.mainStart()}
        ${E.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${v?"output[global_idx] = input[global_idx];":`
        let output_indices = ${c.offsetToIndices("global_idx")};
        var input_indices: ${d.type.indices};
        ${(()=>{switch(e.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${d.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${e.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${s.length===2||s.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${e.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${e.cacheKey}|${n}|${u.length>0?e.mode==="cubic"?u:u.length:""}|${i.length>0?i:""}|${o.length>0?o:""}|${v}|${e.mode==="nearest"?s.length:s}`,inputDependencies:["rank"]},getShaderSource:S,getRunData:()=>({outputs:[{dims:l,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:[{type:12,data:h},{type:1,data:u},{type:1,data:o},...Ht(s,l)]})}},M4=t=>{let e=t.customDataBuffer;return new Uint32Array(e,e.byteOffset,1)[0]},fT=(t,e)=>{let n=[],r=[],i=[],a=M4(t);if(e.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");d4(t.inputs,e,a,n,r,i),t.compute(S4(t.inputs[0],e,a,n,r,i),{inputs:[0]})},hT=t=>{let e=t.antialias,n=t.axes,r=t.coordinateTransformMode,i=t.cubicCoeffA,a=t.excludeOutside!==0,s=t.extrapolationValue,o=t.keepAspectRatioPolicy,l=t.mode,u=t.nearestMode===""?"simple":t.nearestMode;return qn({antialias:e,axes:n,coordinateTransformMode:r,cubicCoeffA:i,excludeOutside:a,extrapolationValue:s,keepAspectRatioPolicy:o,mode:l,nearestMode:u})}}),E4,T4,pT,GU=bt(()=>{Qt(),dn(),xr(),gn(),E4=(t,e)=>{let[n,r,i,a]=t,{numHeads:s,rotaryEmbeddingDim:o}=e;if(n.dims.length!==3&&n.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${n.dims.length}`);if(!Ye.areEqual(r.dims,[])&&!Ye.areEqual(r.dims,[1])&&r.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${r.dims.length}`);if(i.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${i.dims.length}`);if(a.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${a.dims.length}`);if(!Ye.areEqual(i.dims,a.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(o>0&&s===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let l=n.dims[0],u=n.dims[n.dims.length-2],c=i.dims[0],d=Ye.sizeFromDimension(n.dims,1)/u,h=o===0?i.dims[1]*2:d/s;if(o>h)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(r.dims.length===2){if(l!==r.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${r.dims[0]}`);if(u!==r.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${r.dims[1]}`)}if(h/2!==i.dims[1]&&o/2!==i.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${i.dims[1]}`);if(u>c)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},T4=(t,e)=>{let{interleaved:n,numHeads:r,rotaryEmbeddingDim:i,scale:a}=e,s=t[0].dims[0],o=Ye.sizeFromDimension(t[0].dims,1),l=t[0].dims[t[0].dims.length-2],u=o/l,c=t[2].dims[1],d=i===0?c*2:u/r,h=new Array(s,l,u/d,d-c),v=Ye.computeStrides(h),x=[{type:1,data:a},{type:12,data:h},{type:12,data:v},...t[0].dims.length===3?new Array({type:12,data:[o,u,d,1]}):[],...t[0].dims.length===4?new Array({type:12,data:[o,d,l*d,1]}):[],...Ht(t[0].dims,t[1].dims,t[2].dims,t[3].dims,t[0].dims)],_=b=>{let S=rt("input",t[0].dataType,t[0].dims.length),E=rt("position_ids",t[1].dataType,t[1].dims.length),C=rt("cos_cache",t[2].dataType,t[2].dims.length),A=rt("sin_cache",t[3].dataType,t[3].dims.length),D=Bt("output",t[0].dataType,t[0].dims.length);return b.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:h.length},{name:"global_strides",type:"u32",length:v.length},{name:"input_output_strides",type:"u32",length:v.length}]),`
        ${b.declareVariables(S,E,C,A,D)}

        ${b.mainStart(Vc)}
          let half_rotary_emb_dim = uniforms.${C.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${b.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${E.broadcastedIndicesToOffset("bsnh.xy",Bt("",E.type.tensor,2))};
            let position_id =
                u32(${E.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${n});
            let j = i + select(half_rotary_emb_dim, 1, ${n});
            let re = ${S.getByOffset("i")} * ${C.get("position_id","bsnh[3]")} -
                ${S.getByOffset("j")} * ${A.get("position_id","bsnh[3]")};
            ${D.setByOffset("i","re")}
            let im = ${S.getByOffset("i")} * ${A.get("position_id","bsnh[3]")} +
                ${S.getByOffset("j")} * ${C.get("position_id","bsnh[3]")};
            ${D.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${D.setByOffset("k",S.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:qn({interleaved:n}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:_,getRunData:()=>({outputs:[{dims:t[0].dims,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(Ye.size(h)/Vc)},programUniforms:x})}},pT=(t,e)=>{E4(t.inputs,e),t.compute(T4(t.inputs,e))}}),C4,A4,mT,qU=bt(()=>{Qt(),dn(),gn(),C4=t=>{if(!t||t.length<3)throw new Error("layerNorm requires at least 3 inputs.");let e=t[0],n=t[1],r=t[2];if(e.dataType!==n.dataType||e.dataType!==r.dataType)throw new Error("All inputs must have the same data type");if(e.dims.length!==3&&e.dims.length!==2)throw new Error("Input must be 2D or 3D");if(n.dims.length!==3&&n.dims.length!==2)throw new Error("Skip must be 2D or 3D");let i=e.dims[e.dims.length-1],a=e.dims[e.dims.length-2];if(n.dims[n.dims.length-1]!==i)throw new Error("Skip must have the same hidden size as input");if(n.dims[n.dims.length-2]!==a)throw new Error("Skip must have the same sequence length as input");if(r.dims.length!==1)throw new Error("Gamma must be 1D");if(r.dims[r.dims.length-1]!==i)throw new Error("Gamma must have the same hidden size as input");if(t.length>3){let s=t[3];if(s.dims.length!==1)throw new Error("Beta must be 1D");if(s.dims[s.dims.length-1]!==i)throw new Error("Beta must have the same hidden size as input")}if(t.length>4){let s=t[4];if(s.dims.length!==1)throw new Error("Bias must be 1D");if(s.dims[s.dims.length-1]!==i)throw new Error("Bias must have the same hidden size as input")}},A4=(t,e,n,r)=>{let i=e.simplified,a=t[0].dims,s=Ye.size(a),o=a,l=s,u=a.slice(-1)[0],c=r?a.slice(0,-1).concat(1):[],d=!i&&t.length>3,h=t.length>4,v=r&&n>1,x=r&&n>2,_=n>3,b=64,S=hr(u),E=[{type:12,data:l},{type:12,data:S},{type:12,data:u},{type:1,data:e.epsilon}],C=D=>{let O=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],V=[rt("x",t[0].dataType,t[0].dims,S),rt("skip",t[1].dataType,t[1].dims,S),rt("gamma",t[2].dataType,t[2].dims,S)];d&&V.push(rt("beta",t[3].dataType,t[3].dims,S)),h&&V.push(rt("bias",t[4].dataType,t[4].dims,S)),V.push(Bt("output",t[0].dataType,o,S)),v&&V.push(Bt("mean_output",1,c)),x&&V.push(Bt("inv_std_output",1,c)),_&&V.push(Bt("input_skip_bias_sum",t[0].dataType,o,S));let P=zr(t[0].dataType),U=zr(1,S);return`

      ${D.registerUniforms(O).declareVariables(...V)}
      var<workgroup> sum_shared : array<${U}, ${b}>;
      var<workgroup> sum_squared_shared : array<${U}, ${b}>;

      ${D.mainStart([b,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${b};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${b};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${b-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${h?"bias[offset1d + i]":P+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${_?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${wc(P,S,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${b};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${sl("sum",S)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${sl("square_sum",S)} / f32(uniforms.hidden_size) ${i?"":"- mean * mean"} + uniforms.epsilon);
        ${v?"mean_output[global_idx] = mean;":""}
        ${x?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${i?"":`- ${P}(mean)`}) *
            ${P}(inv_std_dev) * gamma[offset1d + i]
            ${d?"+ beta[offset1d + i]":""};
        }
      }`},A=[{dims:o,dataType:t[0].dataType}];return n>1&&A.push({dims:c,dataType:1}),n>2&&A.push({dims:c,dataType:1}),n>3&&A.push({dims:a,dataType:t[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${S};${v};${x};${_}`,inputDependencies:t.map((D,O)=>"type")},getShaderSource:C,getRunData:()=>({outputs:A,dispatchGroup:{x:Math.ceil(l/u)},programUniforms:E})}},mT=(t,e)=>{C4(t.inputs);let n=[0];t.outputCount>1&&n.push(-3),t.outputCount>2&&n.push(-3),t.outputCount>3&&n.push(3),t.compute(A4(t.inputs,e,t.outputCount,!1),{outputs:n})}}),k4,Fd,I4,qg,$4,P4,gT,vT,jU=bt(()=>{Qt(),dn(),xr(),gn(),k4=(t,e)=>{if(!t||t.length<1)throw new Error("too few inputs");if(e.axes.length!==0){if(e.axes.length!==e.starts.length||e.axes.length!==e.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(e.starts.length!==e.ends.length)throw new Error("starts and ends must have the same length");t.slice(1).forEach((n,r)=>{if(t[r+1].dataType!==6&&t[r+1].dataType!==7)throw new Error(`Input ${r} must be an array of int32 or int64`)})},Fd=(t,e)=>{let n=[];if(t.length>e)if(t[e].dataType===7)t[e].getBigInt64Array().forEach(r=>n.push(Number(r)));else if(t[e].dataType===6)t[e].getInt32Array().forEach(r=>n.push(Number(r)));else throw new Error(`Input ${e} must be an array of int32 or int64`);return n},I4=(t,e)=>{if(t.length>1){let n=Fd(t,1),r=Fd(t,2),i=Fd(t,3);return i.length===0&&(i=[...Array(t[0].dims.length).keys()]),qn({starts:n,ends:r,axes:i})}else return e},qg=(t,e,n,r,i)=>{let a=t;return t<0&&(a+=n[r[e]]),i[e]<0?Math.max(0,Math.min(a,n[r[e]]-1)):Math.max(0,Math.min(a,n[r[e]]))},$4=(t,e,n)=>`fn calculateInputIndices(output_indices: ${e.type.indices}) -> ${t.type.indices} {
          var input_indices: ${t.type.indices};
          var carry = 0u;
          for (var i = ${n.length}; i >= 0; i--) {
            let input_shape_i = ${Ut("uniforms.input_shape","i",n.length)};
            let steps_i = ${Ut("uniforms.steps","i",n.length)};
            let signs_i = ${Ut("uniforms.signs","i",n.length)};
            let starts_i = ${Ut("uniforms.starts","i",n.length)};
            var output_index = ${e.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${t.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,P4=(t,e)=>{let n=t[0].dims,r=Ye.size(n),i=e.axes.length>0?Ye.normalizeAxes(e.axes,n.length):[...Array(n.length).keys()],a=Fd(t,4);a.forEach(S=>S!==0||(()=>{throw new Error("step cannot be 0")})),a.length===0&&(a=Array(i.length).fill(1));let s=e.starts.map((S,E)=>qg(S,E,n,i,a)),o=e.ends.map((S,E)=>qg(S,E,n,i,a));if(i.length!==s.length||i.length!==o.length)throw new Error("start, ends and axes should have the same number of elements");if(i.length!==n.length)for(let S=0;S<n.length;++S)i.includes(S)||(s.splice(S,0,0),o.splice(S,0,n[S]),a.splice(S,0,1));let l=a.map(S=>Math.sign(S));a.forEach((S,E,C)=>{if(S<0){let A=(o[E]-s[E])/S,D=s[E],O=D+A*a[E];s[E]=O,o[E]=D,C[E]=-S}});let u=n.slice(0);i.forEach((S,E)=>{u[S]=Math.ceil((o[S]-s[S])/a[S])});let c={dims:u,dataType:t[0].dataType},d=Bt("output",t[0].dataType,u.length),h=rt("input",t[0].dataType,t[0].dims.length),v=Ye.size(u),x=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:s.length},{name:"signs",type:"i32",length:l.length},{name:"steps",type:"u32",length:a.length}],_=[{type:12,data:v},{type:12,data:s},{type:6,data:l},{type:12,data:a},...Ht(t[0].dims,u)],b=S=>`
      ${S.registerUniforms(x).declareVariables(h,d)}
        ${$4(h,d,n)}
        ${S.mainStart()}
          ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${d.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${d.setByOffset("global_idx",h.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${l.length}_${s.length}_${a.length}`,inputDependencies:["rank"]},getShaderSource:b,getRunData:()=>({outputs:[c],dispatchGroup:{x:Math.ceil(r/64)},programUniforms:_})}},gT=(t,e)=>{k4(t.inputs,e);let n=I4(t.inputs,e);t.compute(P4(t.inputs,n),{inputs:[0]})},vT=t=>{let e=t.starts,n=t.ends,r=t.axes;return qn({starts:e,ends:n,axes:r})}}),R4,D4,yT,_T,XU=bt(()=>{Qt(),dn(),xr(),fl(),gn(),R4=t=>{if(!t||t.length!==1)throw new Error("Softmax op requires 1 input.")},D4=(t,e)=>{let n=t.inputs[0],r=n.dims,i=Ye.size(r),a=r.length,s=Ye.normalizeAxis(e.axis,a),o=s<r.length-1,l,u=[];o?(u=Array.from({length:a},(V,P)=>P),u[s]=a-1,u[a-1]=s,l=t.compute(aa(n,u),{inputs:[n],outputs:[-1]})[0]):l=n;let c=l.dims,d=c[a-1],h=i/d,v=hr(d),x=d/v,_=64;h===1&&(_=256);let b=(V,P)=>P===4?`max(max(${V}.x, ${V}.y), max(${V}.z, ${V}.w))`:P===2?`max(${V}.x, ${V}.y)`:P===3?`max(max(${V}.x, ${V}.y), ${V}.z)`:V,S=rt("x",l.dataType,l.dims,v),E=Bt("result",l.dataType,l.dims,v),C=S.type.value,A=zr(l.dataType)==="f32"?`var threadMax = ${C}(-3.402823e+38f);`:`var threadMax = ${C}(-65504.0h);`,D=V=>`
      var<workgroup> rowMaxShared : ${C};
      var<workgroup> rowSumShared : ${C};
      var<workgroup> threadShared : array<${C}, ${_}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${C} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${C}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${V.registerUniform("packedCols","i32").declareVariables(S,E)}
      ${V.mainStart(_)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${_};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${A}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${C}(${b("threadShared[0]",v)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${C}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${C}(${sl("threadShared[0]",v)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          setValue(row, col, row_stride, value);
        }
      }`,O=t.compute({name:"Softmax",shaderCache:{hint:`${v};${_}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:c,dataType:l.dataType}],dispatchGroup:{x:h},programUniforms:[{type:6,data:x}]}),getShaderSource:D},{inputs:[l],outputs:[o?-1:0]})[0];o&&t.compute(aa(O,u),{inputs:[O]})},yT=(t,e)=>{R4(t.inputs),D4(t,e)},_T=t=>qn({axis:t.axis})}),jg,L4,z4,O4,bT,KU=bt(()=>{Qt(),dn(),gn(),jg=t=>Array.from(t.getBigInt64Array(),Number),L4=t=>{if(!t||t.length!==2)throw new Error("Tile requires 2 inputs.");if(t[0].dataType!==1&&t[0].dataType!==10&&t[0].dataType!==6&&t[0].dataType!==12)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(t[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(t[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(jg(t[1]).length!==t[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},z4=(t,e)=>{let n=[];for(let r=0;r<t.length;++r)n.push(t[r]*e[r]);return n},O4=(t,e)=>{let n=t[0].dims,r=e??jg(t[1]),i=z4(n,r),a=Ye.size(i),s=t[0].dataType,o=rt("input",s,n.length),l=Bt("output",s,i.length),u=c=>`
      const inputShape = ${o.indices(...n)};
      ${c.registerUniform("output_size","u32").declareVariables(o,l)}
      ${c.mainStart()}
      ${c.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${l.offsetToIndices("global_idx")};
      var input_indices: ${o.type.indices};
      for (var i = 0; i < ${n.length}; i++) {
        let input_dim_i = ${o.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${l.indicesGet("output_indices","i")}  % input_dim_i;

        ${o.indicesSet("input_indices","i","input_dim_value")}
      }
      ${l.setByOffset("global_idx",o.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:[{type:12,data:a},...Ht(t[0].dims,i)]}),getShaderSource:u}},bT=t=>{L4(t.inputs),t.compute(O4(t.inputs),{inputs:[0]})}}),N4,B4,xT,YU=bt(()=>{Qt(),dn(),gn(),N4=(t,e,n,r,i)=>{let a=Bt("output_data",i,n.length,4),s=rt("a_data",e[1].dataType,e[1].dims.length,4),o=rt("b_data",e[2].dataType,e[2].dims.length,4),l=rt("c_data",e[0].dataType,e[0].dims.length,4),u,c=(d,h,v)=>`select(${h}, ${d}, ${v})`;if(!r)u=a.setByOffset("global_idx",c(s.getByOffset("global_idx"),o.getByOffset("global_idx"),l.getByOffset("global_idx")));else{let d=(h,v,x="")=>{let _=`a_data[index_a${v}][component_a${v}]`,b=`b_data[index_b${v}][component_b${v}]`,S=`bool(c_data[index_c${v}] & (0xffu << (component_c${v} * 8)))`;return`
            let output_indices${v} = ${a.offsetToIndices(`global_idx * 4u + ${v}u`)};
            let offset_a${v} = ${s.broadcastedIndicesToOffset(`output_indices${v}`,a)};
            let offset_b${v} = ${o.broadcastedIndicesToOffset(`output_indices${v}`,a)};
            let offset_c${v} = ${l.broadcastedIndicesToOffset(`output_indices${v}`,a)};
            let index_a${v} = offset_a${v} / 4u;
            let index_b${v} = offset_b${v} / 4u;
            let index_c${v} = offset_c${v} / 4u;
            let component_a${v} = offset_a${v} % 4u;
            let component_b${v} = offset_b${v} % 4u;
            let component_c${v} = offset_c${v} % 4u;
            ${h}[${v}] = ${x}(${c(_,b,S)});
          `};i===9?u=`
            var data = vec4<u32>(0);
            ${d("data",0,"u32")}
            ${d("data",1,"u32")}
            ${d("data",2,"u32")}
            ${d("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:u=`
            ${d("output_data[global_idx]",0)}
            ${d("output_data[global_idx]",1)}
            ${d("output_data[global_idx]",2)}
            ${d("output_data[global_idx]",3)}
          `}return`
        ${t.registerUniform("vec_size","u32").declareVariables(l,s,o,a)}
        ${t.mainStart()}
        ${t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${u}
      }`},B4=t=>{let e=t[1].dims,n=t[2].dims,r=t[0].dims,i=t[1].dataType,a=!(Ye.areEqual(e,n)&&Ye.areEqual(n,r)),s=e,o=Ye.size(e);if(a){let u=Uc.calcShape(Uc.calcShape(e,n,!1),r,!1);if(!u)throw new Error("Can't perform where op on the given tensors");s=u,o=Ye.size(s)}let l=Math.ceil(o/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:u=>N4(u,t,s,a,i),getRunData:()=>({outputs:[{dims:s,dataType:i}],dispatchGroup:{x:Math.ceil(o/64/4)},programUniforms:[{type:12,data:l},...Ht(r,e,n,s)]})}},xT=t=>{t.compute(B4(t.inputs))}}),wT,ZU=bt(()=>{cU(),ky(),dU(),fU(),hU(),pU(),mU(),bU(),wU(),SU(),MU(),EU(),TU(),CU(),AU(),kU(),IU(),$U(),PU(),RU(),DU(),LU(),zU(),OU(),NU(),VE(),BU(),FU(),UU(),VU(),HU(),Ay(),WU(),GU(),qU(),jU(),XU(),GE(),KU(),fl(),Iy(),YU(),wT=new Map([["Abs",[gM]],["Acos",[vM]],["Acosh",[yM]],["Add",[JM]],["ArgMax",[fM,jv]],["ArgMin",[dM,jv]],["Asin",[_M]],["Asinh",[bM]],["Atan",[xM]],["Atanh",[wM]],["Attention",[hM]],["AveragePool",[eT,QE]],["BatchNormalization",[pM]],["BiasAdd",[mM]],["BiasSplitGelu",[ZM]],["Cast",[MM,SM]],["Ceil",[TM]],["Clip",[EM]],["Concat",[lE,uE]],["Conv",[Qv,Jv]],["ConvTranspose",[_E,yE]],["Cos",[CM]],["Cosh",[AM]],["CumSum",[bE,xE]],["DepthToSpace",[wE,SE]],["DequantizeLinear",[oT,lT]],["Div",[QM]],["Einsum",[ME,EE]],["Elu",[kM,Yd]],["Equal",[eE]],["Erf",[IM]],["Exp",[$M]],["Expand",[TE]],["FastGelu",[CE]],["Floor",[PM]],["FusedConv",[Qv,Jv]],["Gather",[kE,AE]],["GatherElements",[LE,DE]],["GatherBlockQuantized",[PE,RE]],["GatherND",[IE,$E]],["Gelu",[RM]],["Gemm",[OE,zE]],["GlobalAveragePool",[nT,tT]],["GlobalMaxPool",[sT,aT]],["Greater",[iE]],["GreaterOrEqual",[sE]],["GridSample",[NE,BE]],["GroupQueryAttention",[qE]],["HardSigmoid",[UM,FM]],["InstanceNormalization",[jE]],["LayerNormalization",[XE]],["LeakyRelu",[DM,Yd]],["Less",[aE]],["LessOrEqual",[oE]],["Log",[KM]],["MatMul",[KE]],["MatMulNBits",[YE,ZE]],["MaxPool",[rT,iT]],["Mul",[tE]],["MultiHeadAttention",[UE,FE]],["Neg",[zM]],["Not",[LM]],["Pad",[JE]],["Pow",[nE]],["QuickGelu",[YM,Yd]],["Range",[uT]],["Reciprocal",[OM]],["ReduceMin",[sM]],["ReduceMean",[tM]],["ReduceMax",[aM]],["ReduceSum",[lM]],["ReduceProd",[oM]],["ReduceL1",[nM]],["ReduceL2",[rM]],["ReduceLogSum",[cM]],["ReduceLogSumExp",[iM]],["ReduceSumSquare",[uM]],["Relu",[NM]],["Resize",[fT,hT]],["RotaryEmbedding",[pT]],["ScatterND",[dT,cT]],["Sigmoid",[BM]],["Sin",[VM]],["Sinh",[HM]],["Slice",[gT,vT]],["SkipLayerNormalization",[mT]],["Split",[HE,WE]],["Sqrt",[WM]],["Softmax",[yT,_T]],["Sub",[rE]],["Tan",[GM]],["Tanh",[qM]],["ThresholdedRelu",[XM,Yd]],["Tile",[bT]],["Transpose",[H7,W7]],["Where",[xT]]])}),ST,JU=bt(()=>{Ka(),co(),gn(),ST=class{constructor(t){this.backend=t,this.repo=new Map,this.attributesBound=!1}getArtifact(t){return this.repo.get(t)}setArtifact(t,e){this.repo.set(t,e)}run(t,e,n,r,i){Ts(t.programInfo.name);let a=this.backend.device,s=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let o=[];for(let u of e)o.push({binding:o.length,resource:{buffer:u.buffer}});for(let u of n)o.push({binding:o.length,resource:{buffer:u.buffer}});i&&o.push({binding:o.length,resource:i});let l=a.createBindGroup({layout:t.computePipeline.getBindGroupLayout(0),entries:o,label:t.programInfo.name});if(this.backend.sessionStatus==="capturing"){let u={kernelId:this.backend.currentKernelId,computePipeline:t.computePipeline,bindGroup:l,dispatchGroup:r};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(u)}s.setPipeline(t.computePipeline),s.setBindGroup(0,l),s.dispatchWorkgroups(...r),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Va(t.programInfo.name)}dispose(){}build(t,e){Ts(t.name);let n=this.backend.device,r=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"},{feature:"subgroups-f16",extension:"subgroups_f16"}].forEach(u=>{n.features.has(u.feature)&&r.push(`enable ${u.extension};`)});let i=V7(e,this.backend.device.limits),a=t.getShaderSource(i),s=`${r.join(`
`)}
${i.additionalImplementations}
${a}`,o=n.createShaderModule({code:s,label:t.name});Ln("verbose",()=>`[WebGPU] ${t.name} shader code: ${s}`);let l=n.createComputePipeline({compute:{module:o,entryPoint:"main"},layout:"auto",label:t.name});return Va(t.name),{programInfo:t,computePipeline:l,uniformVariablesInfo:i.variablesInfo}}normalizeDispatchGroupSize(t){let e=typeof t=="number"?t:t.x,n=typeof t=="number"?1:t.y||1,r=typeof t=="number"?1:t.z||1,i=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(e<=i&&n<=i&&r<=i)return[e,n,r];let a=e*n*r,s=Math.ceil(Math.sqrt(a));if(s>i){if(s=Math.ceil(Math.cbrt(a)),s>i)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[s,s,s]}else return[s,s,1]}}}),F4,U4,V4,H4,MT,QU=bt(()=>{Ka(),Qt(),co(),z7(),lU(),ZU(),JU(),F4=(t,e)=>{if(e.length!==t.length)throw new Error(`inputDependencies length ${e.length} is not equal to inputTensors length ${t.length}.`);let n=[];for(let r=0;r<t.length;++r){let i=t[r].dataType;switch(e[r]){case"none":{n.push("");break}case"type":{n.push(`${i}`);break}case"rank":{let a=t[r].dims.length;n.push(`${i};${a}`);break}case"dims":{let a=t[r].dims.join(",");n.push(`${i};${a}`);break}default:throw new Error(`unsupported input dependency: ${e[r]}`)}}return n.join("|")},U4=(t,e,n)=>{var i,a;let r=t.name;return(i=t.shaderCache)!=null&&i.hint&&(r+="["+t.shaderCache.hint+"]"),r+=":"+n+`:${F4(e,((a=t.shaderCache)==null?void 0:a.inputDependencies)??new Array(e.length).fill("dims"))}`,r},V4=class{constructor(t){t&&(this.architecture=t.architecture,this.vendor=t.vendor)}isArchitecture(t){return this.architecture===t}isVendor(t){return this.vendor===t}},H4=class{constructor(t){this.subgroupsSupported=t.features.has("subgroups"),this.subgroupsF16Supported=t.features.has("subgroups");let e=t.limits;!this.subgroupsSupported||!e.minSubgroupSize||!e.maxSubgroupSize?this.subgroupSizeRange=void 0:this.subgroupSizeRange=[e.minSubgroupSize,e.maxSubgroupSize]}},MT=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let t=this.kernelCustomData.get(this.currentKernelId);return t||(t={},this.kernelCustomData.set(this.currentKernelId,t)),t}async initialize(t,e){this.env=t;let n=[],r={requiredLimits:{maxComputeWorkgroupStorageSize:e.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:e.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:e.limits.maxStorageBufferBindingSize,maxBufferSize:e.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:e.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:e.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:e.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:e.limits.maxComputeWorkgroupSizeZ},requiredFeatures:n},i=a=>e.features.has(a)&&n.push(a)&&!0;i("chromium-experimental-timestamp-query-inside-passes")||i("timestamp-query"),i("shader-f16"),i("subgroups")&&i("subgroups-f16"),this.device=await e.requestDevice(r),this.deviceInfo=new H4(this.device),this.adapterInfo=new V4(e.info||await e.requestAdapterInfo()),this.gpuDataManager=O7(this),this.programManager=new ST(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,My(t.logLevel,!!t.debug),this.device.onuncapturederror=a=>{a.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${a.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:e,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let t=this.getCommandEncoder(),e={};this.queryType==="at-passes"&&(e.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=t.beginComputePass(e)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;Ts(),this.endComputePass();let t;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),t=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(t,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,t,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&t.mapAsync(GPUMapMode.READ).then(()=>{var r;let e=new BigUint64Array(t.getMappedRange()),n=this.pendingQueries.get(t);for(let i=0;i<e.length/2;i++){let a=n[i],s=a.kernelId,o=this.kernels.get(s),l=o.kernelType,u=o.kernelName,c=a.programName,d=a.inputTensorViews,h=a.outputTensorViews,v=e[i*2],x=e[i*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=v);let _=Number(v-this.queryTimeBase),b=Number(x-this.queryTimeBase);if(!Number.isSafeInteger(_)||!Number.isSafeInteger(b))throw new RangeError("incorrect timestamp range");if((r=this.env.webgpu.profiling)!=null&&r.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:d.map(S=>({dims:S.dims,dataType:Yl(S.dataType)})),outputsMetadata:h.map(S=>({dims:S.dims,dataType:Yl(S.dataType)})),kernelId:s,kernelType:l,kernelName:u,programName:c,startTime:_,endTime:b});else{let S="";d.forEach((C,A)=>{S+=`input[${A}]: [${C.dims}] | ${Yl(C.dataType)}, `});let E="";h.forEach((C,A)=>{E+=`output[${A}]: [${C.dims}] | ${Yl(C.dataType)}, `}),console.log(`[profiling] kernel "${s}|${l}|${u}|${c}" ${S}${E}execution time: ${b-_} ns`)}J0("GPU",`${c}::${v}::${x}`)}t.unmap(),this.pendingQueries.delete(t)}),Va()}run(t,e,n,r,i,a){Ts(t.name);let s=[];for(let E=0;E<e.length;++E){let C=e[E].data;if(C===0)continue;let A=this.gpuDataManager.get(C);if(!A)throw new Error(`no GPU data for input: ${C}`);s.push(A)}let{outputs:o,dispatchGroup:l,programUniforms:u}=t.getRunData(e),c=n.length===0?o.map((E,C)=>C):n;if(c.length!==o.length)throw new Error(`Output size ${c.length} must be equal to ${o.length}.`);let d=[],h=[];for(let E=0;E<o.length;++E){if(!Number.isInteger(c[E])||c[E]<-3||c[E]>=a)throw new Error(`Invalid output index: ${c[E]}`);if(c[E]===-3)continue;let C=c[E]===-1,A=c[E]===-2,D=C||A?i(o[E].dataType,o[E].dims):r(c[E],o[E].dataType,o[E].dims);if(d.push(D),D.data===0)continue;let O=this.gpuDataManager.get(D.data);if(!O)throw new Error(`no GPU data for output: ${D.data}`);if(C&&this.temporaryData.push(O),A){let V=this.kernelPersistentData.get(this.currentKernelId);V||(V=[],this.kernelPersistentData.set(this.currentKernelId,V)),V.push(O)}h.push(O)}if(s.length!==e.length||h.length!==d.length){if(h.length===0)return Va(t.name),d;throw new Error(`Program ${t.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let v;if(u){let E=0,C=[];u.forEach(V=>{let P=typeof V.data=="number"?[V.data]:V.data;if(P.length===0)return;let U=V.type===10?2:4,Y,fe;V.type===10?(fe=P.length>4?16:P.length>2?8:P.length*U,Y=P.length>4?16:U*P.length):(fe=P.length<=2?P.length*U:16,Y=16),E=Math.ceil(E/fe)*fe,C.push(E);let Q=V.type===10?8:4;E+=P.length>4?Math.ceil(P.length/Q)*Y:P.length*U});let A=16;E=Math.ceil(E/A)*A;let D=new ArrayBuffer(E);u.forEach((V,P)=>{let U=C[P],Y=typeof V.data=="number"?[V.data]:V.data;if(V.type===6)new Int32Array(D,U,Y.length).set(Y);else if(V.type===12)new Uint32Array(D,U,Y.length).set(Y);else if(V.type===10)new Uint16Array(D,U,Y.length).set(Y);else if(V.type===1)new Float32Array(D,U,Y.length).set(Y);else throw new Error(`Unsupported uniform type: ${Yl(V.type)}`)});let O=this.gpuDataManager.create(E,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(O.buffer,0,D,0,E),this.gpuDataManager.release(O.id),v={offset:0,size:E,buffer:O.buffer}}let x=this.programManager.normalizeDispatchGroupSize(l),_=x[1]===1&&x[2]===1,b=U4(t,e,_),S=this.programManager.getArtifact(b);if(S||(S=this.programManager.build(t,x),this.programManager.setArtifact(b,S),Ln("info",()=>`[artifact] key: ${b}, programName: ${t.name}`)),u&&S.uniformVariablesInfo){if(u.length!==S.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${S.uniformVariablesInfo.length}, got ${u.length} in program "${S.programInfo.name}".`);for(let E=0;E<u.length;E++){let C=u[E],A=C.type,D=typeof C.data=="number"?1:C.data.length,[O,V]=S.uniformVariablesInfo[E];if(A!==O||D!==V)throw new Error(`Uniform variable ${E} mismatch: expect type ${O} with size ${V}, got type ${A} with size ${D} in program "${S.programInfo.name}".`)}}if(Ln("info",()=>`[ProgramManager] run "${t.name}" (key=${b}) with ${x[0]}x${x[1]}x${x[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let E={kernelId:this.currentKernelId,programName:S.programInfo.name,inputTensorViews:e,outputTensorViews:d};this.pendingKernels.push(E),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(E)}return this.programManager.run(S,s,h,x,v),Va(t.name),d}upload(t,e){this.gpuDataManager.upload(t,e)}memcpy(t,e){this.gpuDataManager.memcpy(t,e)}async download(t,e){await this.gpuDataManager.download(t,e)}alloc(t){return this.gpuDataManager.create(t).id}free(t){return this.gpuDataManager.release(t)}createKernel(t,e,n,r){let i=wT.get(t);if(!i)throw new Error(`kernel not implemented: ${t}`);let a={kernelType:t,kernelName:r,kernelEntry:i[0],attributes:[i[1],n]};this.kernels.set(e,a)}releaseKernel(t){let e=this.kernelPersistentData.get(t);if(e){for(let n of e)this.gpuDataManager.release(n.id);this.kernelPersistentData.delete(t)}this.kernelCustomData.delete(t),this.kernels.delete(t)}computeKernel(t,e,n){let r=this.kernels.get(t);if(!r)throw new Error(`kernel not created: ${t}`);let i=r.kernelType,a=r.kernelName,s=r.kernelEntry,o=r.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${i}] ${a}" is not allowed to be called recursively`);this.currentKernelId=t,o[0]&&(o[1]=o[0](o[1]),o[0]=void 0),Ln("info",()=>`[WebGPU] Start to run kernel "[${i}] ${a}"...`);let l=this.env.debug;this.temporaryData=[];try{return l&&this.device.pushErrorScope("validation"),s(e,o[1]),0}catch(u){return n.push(Promise.resolve(`[WebGPU] Kernel "[${i}] ${a}" failed. ${u}`)),1}finally{l&&n.push(this.device.popErrorScope().then(u=>u?`GPU validation error for kernel "[${i}] ${a}": ${u.message}`:null));for(let u of this.temporaryData)this.gpuDataManager.release(u.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(t,e,n,r){let i=this.sessionExternalDataMapping.get(t);i||(i=new Map,this.sessionExternalDataMapping.set(t,i));let a=i.get(e),s=this.gpuDataManager.registerExternalBuffer(n,r,a);return i.set(e,[s,n]),s}unregisterBuffers(t){let e=this.sessionExternalDataMapping.get(t);e&&(e.forEach(n=>this.gpuDataManager.unregisterExternalBuffer(n[0])),this.sessionExternalDataMapping.delete(t))}getBuffer(t){let e=this.gpuDataManager.get(t);if(!e)throw new Error(`no GPU data for buffer: ${t}`);return e.buffer}createDownloader(t,e,n){return async()=>{let r=await Wv(this,t,e);return Ey(r.buffer,n)}}writeTimestamp(t){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,t)}setQueryType(){var t;this.queryType="none",(((t=this.env.webgpu.profiling)==null?void 0:t.mode)==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){Ln("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){Ln("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Ln("info","replay"),this.sessionStatus="replaying";let t=this.capturedCommandList.get(this.currentSessionId),e=this.capturedPendingKernels.get(this.currentSessionId),n=t.length;this.pendingKernels=[];for(let r=0;r<n;r++){let i=this.getComputePassEncoder(),a=t[r];this.writeTimestamp(this.pendingDispatchNumber*2),i.setPipeline(a.computePipeline),i.setBindGroup(0,a.bindGroup),i.dispatchWorkgroups(...a.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(e[r]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(t){this.unregisterBuffers(t),this.capturedCommandList.has(t)&&this.capturedCommandList.delete(t),this.capturedPendingKernels.has(t)&&this.capturedPendingKernels.delete(t),this.gpuDataManager.onReleaseSession(t)}onRunStart(t){this.currentSessionId=t,this.setQueryType()}}}),W4,Xg,G4,Kg,Yg,Zg,q4,ET,eV=bt(()=>{co(),W4=1,Xg=()=>W4++,G4=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),Kg=(t,e)=>{let n=G4.get(t);if(!n)throw new Error("Unsupported data type.");return e.length>0?Math.ceil(e.reduce((r,i)=>r*i)*n/8):0},Yg=class{constructor(t){this.sessionId=t.sessionId,this.mlContext=t.context,this.mlTensor=t.tensor,this.dataType=t.dataType,this.tensorShape=t.shape}get tensor(){return this.mlTensor}get type(){return this.dataType}get shape(){return this.tensorShape}get byteLength(){return Kg(this.dataType,this.tensorShape)}destroy(){Ln("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(t){this.mlContext.writeTensor(this.mlTensor,t)}async read(t){return t?this.mlContext.readTensor(this.mlTensor,t):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(t,e,n){return this.mlContext===t&&this.dataType===e&&this.tensorShape.length===n.length&&this.tensorShape.every((r,i)=>r===n[i])}},Zg=class{constructor(t,e){this.tensorManager=t,this.wrapper=e}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(t,e,n,r){let i=this.tensorManager.getMLContext(t);if(this.wrapper){if(this.wrapper.canReuseTensor(i,e,n))return this.wrapper.tensor;if(r){if(this.wrapper.byteLength!==Kg(e,n))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let a=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(t,e,n,a,!0,!0),r&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(t){if(this.wrapper)if(t.byteLength===this.wrapper.byteLength){this.wrapper.write(t);return}else Ln("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor();this.activeUpload?this.activeUpload.set(t):this.activeUpload=new Uint8Array(t)}async download(t){if(this.activeUpload)if(t){t instanceof ArrayBuffer?new Uint8Array(t).set(this.activeUpload):new Uint8Array(t.buffer,t.byteOffset,t.byteLength).set(this.activeUpload);return}else return this.activeUpload.buffer;if(!this.wrapper)throw new Error("Tensor has not been created.");return t?this.wrapper.read(t):this.wrapper.read()}},q4=class{constructor(t){this.backend=t,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(t){let e=this.backend.getMLContext(t);if(!e)throw new Error("MLContext not found for session.");return e}reserveTensorId(){let t=Xg();return this.tensorTrackersById.set(t,new Zg(this)),t}releaseTensorId(t){let e=this.tensorTrackersById.get(t);e&&(this.tensorTrackersById.delete(t),e.tensorWrapper&&this.releaseTensor(e.tensorWrapper))}async ensureTensor(t,e,n,r,i){Ln("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${e}, dataType: ${n}, shape: ${r}, copyOld: ${i}}`);let a=this.tensorTrackersById.get(e);if(!a)throw new Error("Tensor not found.");return a.ensureTensor(t,n,r,i)}upload(t,e){let n=this.tensorTrackersById.get(t);if(!n)throw new Error("Tensor not found.");n.upload(e)}async download(t,e){Ln("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${t}, dstBuffer: ${e==null?void 0:e.byteLength}}`);let n=this.tensorTrackersById.get(t);if(!n)throw new Error("Tensor not found.");return n.download(e)}releaseTensorsForSession(t){for(let e of this.freeTensors)e.sessionId===t&&e.destroy();this.freeTensors=this.freeTensors.filter(e=>e.sessionId!==t)}registerTensor(t,e,n,r){let i=this.getMLContext(t),a=Xg(),s=new Yg({sessionId:t,context:i,tensor:e,dataType:n,shape:r});return this.tensorTrackersById.set(a,new Zg(this,s)),this.externalTensors.add(s),a}async getCachedTensor(t,e,n,r,i,a){let s=this.getMLContext(t);for(let[l,u]of this.freeTensors.entries())if(u.canReuseTensor(s,e,n)){Ln("verbose",()=>`[WebNN] Reusing tensor {dataType: ${e}, shape: ${n}}`);let c=this.freeTensors.splice(l,1)[0];return c.sessionId=t,c}Ln("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${e}, shape: ${n}}`);let o=await s.createTensor({dataType:e,shape:n,dimensions:n,usage:r,writable:i,readable:a});return new Yg({sessionId:t,context:s,tensor:o,dataType:e,shape:n})}releaseTensor(t){this.externalTensors.has(t)&&this.externalTensors.delete(t),this.freeTensors.push(t)}},ET=(...t)=>new q4(...t)}),p0,j4,TT,tV=bt(()=>{Qt(),xu(),z7(),eV(),co(),p0=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),j4=(t,e)=>{if(t===e)return!0;if(t===void 0||e===void 0)return!1;let n=Object.keys(t).sort(),r=Object.keys(e).sort();return n.length===r.length&&n.every((i,a)=>i===r[a]&&t[i]===e[i])},TT=class{constructor(t){this.tensorManager=ET(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.temporaryGraphInputs=[],this.temporarySessionTensorIds=new Map,My(t.logLevel,!!t.debug)}get currentSessionId(){if(this.activeSessionId===void 0)throw new Error("No active session");return this.activeSessionId}onRunStart(t){Ln("verbose",()=>`[WebNN] onRunStart {sessionId: ${t}}`),this.activeSessionId=t}onRunEnd(t){Ln("verbose",()=>`[WebNN] onRunEnd {sessionId: ${t}}`);let e=this.temporarySessionTensorIds.get(t);if(e){for(let n of e)Ln("verbose",()=>`[WebNN] releasing temporary tensor {tensorId: ${n}}`),this.tensorManager.releaseTensorId(n);this.temporarySessionTensorIds.delete(t),this.activeSessionId=void 0}}async createMLContext(t){if(t instanceof GPUDevice){let n=this.mlContextCache.findIndex(r=>r.gpuDevice===t);if(n!==-1)return this.mlContextCache[n].mlContext;{let r=await navigator.ml.createContext(t);return this.mlContextCache.push({gpuDevice:t,mlContext:r}),r}}else if(t===void 0){let n=this.mlContextCache.findIndex(r=>r.options===void 0&&r.gpuDevice===void 0);if(n!==-1)return this.mlContextCache[n].mlContext;{let r=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:r}),r}}let e=this.mlContextCache.findIndex(n=>j4(n.options,t));if(e!==-1)return this.mlContextCache[e].mlContext;{let n=await navigator.ml.createContext(t);return this.mlContextCache.push({options:t,mlContext:n}),n}}registerMLContext(t,e){this.mlContextBySessionId.set(t,e);let n=this.sessionIdsByMLContext.get(e);n||(n=new Set,this.sessionIdsByMLContext.set(e,n)),n.add(t),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(t,this.temporaryGraphInputs),this.temporaryGraphInputs=[])}onReleaseSession(t){this.sessionGraphInputs.delete(t);let e=this.mlContextBySessionId.get(t);if(!e)return;this.tensorManager.releaseTensorsForSession(t),this.mlContextBySessionId.delete(t);let n=this.sessionIdsByMLContext.get(e);if(n.delete(t),n.size===0){this.sessionIdsByMLContext.delete(e);let r=this.mlContextCache.findIndex(i=>i.mlContext===e);r!==-1&&this.mlContextCache.splice(r,1)}}getMLContext(t){return this.mlContextBySessionId.get(t)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(t){Ln("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${t}}`),this.tensorManager.releaseTensorId(t)}async ensureTensor(t,e,n,r,i){let a=p0.get(n);if(!a)throw new Error(`Unsupported ONNX data type: ${n}`);return this.tensorManager.ensureTensor(t??this.currentSessionId,e,a,r,i)}async createTemporaryTensor(t,e,n){Ln("verbose",()=>`[WebNN] createTemporaryTensor {onnxDataType: ${e}, shape: ${n}}`);let r=p0.get(e);if(!r)throw new Error(`Unsupported ONNX data type: ${e}`);let i=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(t,i,r,n,!1);let a=this.temporarySessionTensorIds.get(t);return a?a.push(i):this.temporarySessionTensorIds.set(t,[i]),i}uploadTensor(t,e){if(!Dr().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");Ln("verbose",()=>`[WebNN] uploadTensor {tensorId: ${t}, data: ${e.byteLength}}`),this.tensorManager.upload(t,e)}async downloadTensor(t,e){return this.tensorManager.download(t,e)}createMLTensorDownloader(t,e){return async()=>{let n=await this.tensorManager.download(t);return Ey(n,e)}}registerMLTensor(t,e,n,r){let i=p0.get(n);if(!i)throw new Error(`Unsupported ONNX data type: ${n}`);let a=this.tensorManager.registerTensor(t,e,i,r);return Ln("verbose",()=>`[WebNN] registerMLTensor {tensor: ${e}, dataType: ${i}, dimensions: ${r}} -> {tensorId: ${a}}`),a}registerMLConstant(t,e,n,r,i,a){if(!a)throw new Error("External mounted files are not available.");let s=t;t.startsWith("./")&&(s=t.substring(2));let o=a.get(s);if(!o)throw new Error(`File with name ${s} not found in preloaded files.`);if(e+n>o.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let l=o.slice(e,e+n).buffer,u;switch(i.dataType){case"float32":u=new Float32Array(l);break;case"float16":u=new Uint16Array(l);break;case"int32":u=new Int32Array(l);break;case"uint32":u=new Uint32Array(l);break;case"int64":u=new BigInt64Array(l);break;case"uint64":u=new BigUint64Array(l);break;case"int8":u=new Int8Array(l);break;case"int4":case"uint4":case"uint8":u=new Uint8Array(l);break;default:throw new Error(`Unsupported data type: ${i.dataType} in creating WebNN Constant from external data.`)}return Ln("verbose",()=>`[WebNN] registerMLConstant {dataType: ${i.dataType}, shape: ${i.shape}}}`),r.constant(i,u)}registerGraphInput(t){this.temporaryGraphInputs.push(t)}isGraphInput(t,e){let n=this.sessionGraphInputs.get(t);return n?n.includes(e):!1}flush(){}}}),CT={};Wf(CT,{init:()=>AT});var m0,X4,AT,nV=bt(()=>{Qt(),QU(),co(),dn(),tV(),m0=class kT{constructor(e,n,r,i){this.module=e,this.dataType=n,this.data=r,this.dims=i}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let e=Ye.size(this.dims);return e===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,e)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let e=Ye.size(this.dims);return e===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,e)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let e=Ye.size(this.dims);return e===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,e)}getUint16Array(){if(this.dataType!==10&&this.dataType!==4)throw new Error("Invalid data type");let e=Ye.size(this.dims);return e===0?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,e)}reshape(e){if(Ye.size(e)!==Ye.size(this.dims))throw new Error("Invalid new shape");return new kT(this.module,this.dataType,this.data,e)}},X4=class{constructor(t,e,n){this.module=t,this.backend=e,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=e.adapterInfo,this.deviceInfo=e.deviceInfo;let r=t.PTR_SIZE,i=n/t.PTR_SIZE,a=r===4?"i32":"i64";this.opKernelContext=Number(t.getValue(r*i++,a));let s=Number(t.getValue(r*i++,a));this.outputCount=Number(t.getValue(r*i++,a)),this.customDataOffset=Number(t.getValue(r*i++,"*")),this.customDataSize=Number(t.getValue(r*i++,a));let o=[];for(let l=0;l<s;l++){let u=Number(t.getValue(r*i++,a)),c=Number(t.getValue(r*i++,"*")),d=Number(t.getValue(r*i++,a)),h=[];for(let v=0;v<d;v++)h.push(Number(t.getValue(r*i++,a)));o.push(new m0(t,u,c,h))}this.inputs=o}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(t,e){var s;let n=((s=e==null?void 0:e.inputs)==null?void 0:s.map(o=>typeof o=="number"?this.inputs[o]:o))??this.inputs,r=(e==null?void 0:e.outputs)??[],i=(o,l,u)=>new m0(this.module,l,this.output(o,u),u),a=(o,l)=>{let u=Zl(o,l);if(!u)throw new Error(`Unsupported data type: ${o}`);let c=u>0?this.backend.gpuDataManager.create(u).id:0;return new m0(this.module,o,c,l)};return this.backend.run(t,n,r,i,a,this.outputCount)}output(t,e){let n=this.module.stackSave();try{let r=this.module.PTR_SIZE,i=r===4?"i32":"i64",a=this.module.stackAlloc((1+e.length)*r);this.module.setValue(a,e.length,i);for(let s=0;s<e.length;s++)this.module.setValue(a+r*(s+1),e[s],i);return this.module._JsepOutput(this.opKernelContext,t,a)}catch(r){throw new Error(`Failed to generate kernel's output[${t}] with dims [${e}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${r}`)}finally{this.module.stackRestore(n)}}},AT=async(t,e,n,r)=>{let i=e.jsepInit;if(!i)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(t==="webgpu"){let a=new MT;await a.initialize(n,r),i("webgpu",[a,s=>a.alloc(Number(s)),s=>a.free(s),(s,o,l,u=!1)=>{if(u)Ln("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(s)}, dst=${Number(o)}, size=${Number(l)}`),a.memcpy(Number(s),Number(o));else{Ln("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(s)}, gpuDataId=${Number(o)}, size=${Number(l)}`);let c=e.HEAPU8.subarray(Number(s>>>0),Number(s>>>0)+Number(l));a.upload(Number(o),c)}},async(s,o,l)=>{Ln("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${s}, dataOffset=${o}, size=${l}`),await a.download(Number(s),()=>e.HEAPU8.subarray(Number(o)>>>0,Number(o+l)>>>0))},(s,o,l)=>a.createKernel(s,Number(o),l,e.UTF8ToString(e._JsepGetNodeName(Number(o)))),s=>a.releaseKernel(s),(s,o,l,u)=>{Ln("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${l}, kernel=${s}, contextDataOffset=${o}`);let c=new X4(e,a,Number(o));return a.computeKernel(Number(s),c,u)},()=>a.captureBegin(),()=>a.captureEnd(),()=>a.replay()])}else{let a=new TT(n);i("webnn",[a,()=>a.reserveTensorId(),s=>a.releaseTensorId(s),async(s,o,l,u,c)=>a.ensureTensor(s,o,l,u,c),(s,o)=>{a.uploadTensor(s,o)},async(s,o)=>a.downloadTensor(s,o)])}}}),K4,zy,Oy,Fo,Y4,ip,Ny,By,Jg,Fy,Uy,Vy,IT=bt(()=>{sU(),oU(),Qt(),xu(),_y(),L7(),K4=(t,e)=>{Dr()._OrtInit(t,e)!==0&&Vn("Can't initialize onnxruntime.")},zy=async t=>{K4(t.wasm.numThreads,ep(t.logLevel))},Oy=async(t,e)=>{{let n=(nV(),Z0(CT)).init;if(e==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let r=t.webgpu.adapter;if(r){if(typeof r.limits!="object"||typeof r.features!="object"||typeof r.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let i=t.webgpu.powerPreference;if(i!==void 0&&i!=="low-power"&&i!=="high-performance")throw new Error(`Invalid powerPreference setting: "${i}"`);let a=t.webgpu.forceFallbackAdapter;if(a!==void 0&&typeof a!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${a}"`);if(r=await navigator.gpu.requestAdapter({powerPreference:i,forceFallbackAdapter:a}),!r)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}await n("webgpu",Dr(),t,r)}if(e==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await n("webnn",Dr(),t)}}},Fo=new Map,Y4=t=>{let e=Dr(),n=e.stackSave();try{let r=e.PTR_SIZE,i=e.stackAlloc(2*r);e._OrtGetInputOutputCount(t,i,i+r)!==0&&Vn("Can't get session input/output count.");let a=r===4?"i32":"i64";return[Number(e.getValue(i,a)),Number(e.getValue(i+r,a))]}finally{e.stackRestore(n)}},ip=t=>{let e=Dr(),n=e._malloc(t.byteLength);if(n===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${t.byteLength}.`);return e.HEAPU8.set(t,n),[n,t.byteLength]},Ny=async(t,e)=>{var d,h,v;let n,r,i=Dr();Array.isArray(t)?[n,r]=t:t.buffer===i.HEAPU8.buffer?[n,r]=[t.byteOffset,t.byteLength]:[n,r]=ip(t);let a=0,s=0,o=0,l=[],u=[],c=[];try{if([s,l]=D7(e),(e==null?void 0:e.externalData)&&i.mountExternalData){let D=[];for(let O of e.externalData){let V=typeof O=="string"?O:O.path;D.push(Sy(typeof O=="string"?O:O.data).then(P=>{i.mountExternalData(V,P)}))}await Promise.all(D)}for(let D of(e==null?void 0:e.executionProviders)??[])if((typeof D=="string"?D:D.name)==="webnn"){if(i.shouldTransferToMLTensor=!1,typeof D!="string"){let O=D,V=O==null?void 0:O.context,P=O==null?void 0:O.gpuDevice,U=O==null?void 0:O.deviceType,Y=O==null?void 0:O.powerPreference;V?i.currentContext=V:P?i.currentContext=await i.jsepCreateMLContext(P):i.currentContext=await i.jsepCreateMLContext({deviceType:U,powerPreference:Y})}else i.currentContext=await i.jsepCreateMLContext();break}a=await i._OrtCreateSession(n,r,s),a===0&&Vn("Can't create a session."),(d=i.jsepOnCreateSession)==null||d.call(i),i.currentContext&&(i.jsepRegisterMLContext(a,i.currentContext),i.currentContext=void 0,i.shouldTransferToMLTensor=!0);let[x,_]=Y4(a),b=!!(e!=null&&e.enableGraphCapture),S=[],E=[],C=[];for(let D=0;D<x;D++){let O=i._OrtGetInputName(a,D);O===0&&Vn("Can't get an input name."),u.push(O),S.push(i.UTF8ToString(O))}for(let D=0;D<_;D++){let O=i._OrtGetOutputName(a,D);O===0&&Vn("Can't get an output name."),c.push(O);let V=i.UTF8ToString(O);E.push(V);{if(b&&(e==null?void 0:e.preferredOutputLocation)===void 0){C.push("gpu-buffer");continue}let P=typeof(e==null?void 0:e.preferredOutputLocation)=="string"?e.preferredOutputLocation:((h=e==null?void 0:e.preferredOutputLocation)==null?void 0:h[V])??"cpu";if(P!=="cpu"&&P!=="cpu-pinned"&&P!=="gpu-buffer"&&P!=="ml-tensor")throw new Error(`Not supported preferred output location: ${P}.`);if(b&&P!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${P}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);C.push(P)}}let A=null;return C.some(D=>D==="gpu-buffer"||D==="ml-tensor")&&(o=i._OrtCreateBinding(a),o===0&&Vn("Can't create IO binding."),A={handle:o,outputPreferredLocations:C,outputPreferredLocationsEncoded:C.map(D=>Hv(D))}),Fo.set(a,[a,u,c,A,b,!1]),[a,S,E]}catch(x){throw u.forEach(_=>i._OrtFree(_)),c.forEach(_=>i._OrtFree(_)),o!==0&&i._OrtReleaseBinding(o)!==0&&Vn("Can't release IO binding."),a!==0&&i._OrtReleaseSession(a)!==0&&Vn("Can't release session."),x}finally{i._free(n),s!==0&&i._OrtReleaseSessionOptions(s)!==0&&Vn("Can't release session options."),l.forEach(x=>i._free(x)),(v=i.unmountExternalData)==null||v.call(i)}},By=t=>{var l;let e=Dr(),n=Fo.get(t);if(!n)throw new Error(`cannot release session. invalid session id: ${t}`);let[r,i,a,s,o]=n;s&&(o&&e._OrtClearBoundOutputs(s.handle)!==0&&Vn("Can't clear bound outputs."),e._OrtReleaseBinding(s.handle)!==0&&Vn("Can't release IO binding.")),(l=e.jsepOnReleaseSession)==null||l.call(e,t),i.forEach(u=>e._OrtFree(u)),a.forEach(u=>e._OrtFree(u)),e._OrtReleaseSession(r)!==0&&Vn("Can't release session."),Fo.delete(t)},Jg=async(t,e,n,r,i,a=!1)=>{if(!t){e.push(0);return}let s=Dr(),o=s.PTR_SIZE,l=t[0],u=t[1],c=t[3],d=c,h,v;if(l==="string"&&(c==="gpu-buffer"||c==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(a&&c!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if(c==="gpu-buffer"){let b=t[2].gpuBuffer;v=Zl(vc(l),u);let S=s.jsepRegisterBuffer;if(!S)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');h=S(r,i,b,v)}else if(c==="ml-tensor"){let b=t[2].mlTensor;v=Zl(vc(l),u);let S=s.jsepRegisterMLTensor;if(!S)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');h=S(r,b,vc(l),u)}else{let b=t[2];if(Array.isArray(b)){v=o*b.length,h=s._malloc(v),n.push(h);for(let S=0;S<b.length;S++){if(typeof b[S]!="string")throw new TypeError(`tensor data at index ${S} is not a string`);s.setValue(h+S*o,ei(b[S],n),"*")}}else{let S=s.jsepIsGraphInput;if(l!=="string"&&S){let E=s._OrtGetInputName(r,i),C=s.UTF8ToString(E);if(S(r,C)){let A=vc(l);v=Zl(A,u),d="ml-tensor";let D=s.jsepCreateTemporaryTensor,O=s.jsepUploadTensor;if(!D||!O)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');let V=await D(r,A,u);O(V,new Uint8Array(b.buffer,b.byteOffset,b.byteLength)),h=V}else v=b.byteLength,h=s._malloc(v),n.push(h),s.HEAPU8.set(new Uint8Array(b.buffer,b.byteOffset,v),h)}else v=b.byteLength,h=s._malloc(v),n.push(h),s.HEAPU8.set(new Uint8Array(b.buffer,b.byteOffset,v),h)}}let x=s.stackSave(),_=s.stackAlloc(4*u.length);try{u.forEach((S,E)=>s.setValue(_+E*o,S,o===4?"i32":"i64"));let b=s._OrtCreateTensor(vc(l),h,v,_,u.length,Hv(d));b===0&&Vn(`Can't create tensor for input/output. session=${r}, index=${i}.`),e.push(b)}finally{s.stackRestore(x)}},Fy=async(t,e,n,r,i,a)=>{var fe,Q,G;let s=Dr(),o=s.PTR_SIZE,l=Fo.get(t);if(!l)throw new Error(`cannot run inference. invalid session id: ${t}`);let u=l[0],c=l[1],d=l[2],h=l[3],v=l[4],x=l[5],_=e.length,b=r.length,S=0,E=[],C=[],A=[],D=[],O=s.stackSave(),V=s.stackAlloc(_*o),P=s.stackAlloc(_*o),U=s.stackAlloc(b*o),Y=s.stackAlloc(b*o);try{[S,E]=R7(a);for(let ye=0;ye<_;ye++)await Jg(n[ye],C,D,t,e[ye],v);for(let ye=0;ye<b;ye++)await Jg(i[ye],A,D,t,_+r[ye],v);for(let ye=0;ye<_;ye++)s.setValue(V+ye*o,C[ye],"*"),s.setValue(P+ye*o,c[e[ye]],"*");for(let ye=0;ye<b;ye++)s.setValue(U+ye*o,A[ye],"*"),s.setValue(Y+ye*o,d[r[ye]],"*");if(h&&!x){let{handle:ye,outputPreferredLocations:$e,outputPreferredLocationsEncoded:_e}=h;if(c.length!==_)throw new Error(`input count from feeds (${_}) is expected to be always equal to model's input count (${c.length}).`);for(let de=0;de<_;de++){let Oe=e[de];await s._OrtBindInput(ye,c[Oe],C[de])!==0&&Vn(`Can't bind input[${de}] for session=${t}.`)}for(let de=0;de<b;de++){let Oe=r[de];(fe=i[de])!=null&&fe[3]?s._OrtBindOutput(ye,d[Oe],A[de],0)!==0&&Vn(`Can't bind pre-allocated output[${de}] for session=${t}.`):s._OrtBindOutput(ye,d[Oe],0,_e[Oe])!==0&&Vn(`Can't bind output[${de}] to ${$e[de]} for session=${t}.`)}Fo.set(t,[u,c,d,h,v,!0])}(Q=s.jsepOnRunStart)==null||Q.call(s,u);let re;h?re=await s._OrtRunWithBinding(u,h.handle,b,U,S):re=await s._OrtRun(u,P,V,_,Y,b,U,S),re!==0&&Vn("failed to call OrtRun().");let he=[];for(let ye=0;ye<b;ye++){let $e=Number(s.getValue(U+ye*o,"*"));if($e===A[ye]){he.push(i[ye]);continue}let _e=s.stackSave(),de=s.stackAlloc(4*o),Oe=!1,ve,ie=0;try{s._OrtGetTensorData($e,de,de+o,de+2*o,de+3*o)!==0&&Vn(`Can't access output tensor data on index ${ye}.`);let Pe=o===4?"i32":"i64",et=Number(s.getValue(de,Pe));ie=s.getValue(de+o,"*");let ne=s.getValue(de+o*2,"*"),qe=Number(s.getValue(de+o*3,Pe)),ge=[];for(let Ge=0;Ge<qe;Ge++)ge.push(Number(s.getValue(ne+Ge*o,Pe)));s._OrtFree(ne)!==0&&Vn("Can't free memory for tensor dims.");let xe=ge.reduce((Ge,ut)=>Ge*ut,1);ve=Yl(et);let ze=h==null?void 0:h.outputPreferredLocations[r[ye]];if(ve==="string"){if(ze==="gpu-buffer"||ze==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let Ge=[];for(let ut=0;ut<xe;ut++){let ce=s.getValue(ie+ut*o,"*"),me=s.getValue(ie+(ut+1)*o,"*"),ke=ut===xe-1?void 0:me-ce;Ge.push(s.UTF8ToString(ce,ke))}he.push([ve,ge,Ge,"cpu"])}else if(ze==="gpu-buffer"&&xe>0){let Ge=s.jsepGetBuffer;if(!Ge)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let ut=Ge(ie),ce=Zl(et,xe);if(ce===void 0||!xy(ve))throw new Error(`Unsupported data type: ${ve}`);Oe=!0,he.push([ve,ge,{gpuBuffer:ut,download:s.jsepCreateDownloader(ut,ce,ve),dispose:()=>{s._OrtReleaseTensor($e)!==0&&Vn("Can't release tensor.")}},"gpu-buffer"])}else if(ze==="ml-tensor"&&xe>0){let Ge=s.jsepEnsureTensor;if(!Ge)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(Zl(et,xe)===void 0||!wy(ve))throw new Error(`Unsupported data type: ${ve}`);let ut=await Ge(t,ie,et,ge,!1);Oe=!0,he.push([ve,ge,{mlTensor:ut,download:s.jsepCreateMLTensorDownloader(ie,ve),dispose:()=>{s.jsepReleaseTensorId(ie),s._OrtReleaseTensor($e)}},"ml-tensor"])}else{let Ge=by(ve),ut=new Ge(xe);new Uint8Array(ut.buffer,ut.byteOffset,ut.byteLength).set(s.HEAPU8.subarray(ie,ie+ut.byteLength)),he.push([ve,ge,ut,"cpu"])}}finally{s.stackRestore(_e),ve==="string"&&ie&&s._free(ie),Oe||s._OrtReleaseTensor($e),(G=s.jsepOnRunEnd)==null||G.call(s,u)}}return h&&!v&&(s._OrtClearBoundOutputs(h.handle)!==0&&Vn("Can't clear bound outputs."),Fo.set(t,[u,c,d,h,v,!1])),he}finally{s.stackRestore(O),C.forEach(re=>s._OrtReleaseTensor(re)),A.forEach(re=>s._OrtReleaseTensor(re)),D.forEach(re=>s._free(re)),S!==0&&s._OrtReleaseRunOptions(S),E.forEach(re=>s._free(re))}},Uy=t=>{let e=Dr(),n=Fo.get(t);if(!n)throw new Error("invalid session id");let r=n[0],i=e._OrtEndProfiling(r);i===0&&Vn("Can't get an profile file name."),e._OrtFree(i)},Vy=t=>{let e=[];for(let n of t){let r=n[2];!Array.isArray(r)&&"buffer"in r&&e.push(r.buffer)}return e}}),Uo,zi,fc,Ud,Vd,g0,Qg,v0,Hl,Wl,Z4,$T,PT,RT,DT,LT,zT,OT,NT=bt(()=>{Ka(),IT(),xu(),vy(),Uo=()=>!!or.wasm.proxy&&typeof document<"u",fc=!1,Ud=!1,Vd=!1,v0=new Map,Hl=(t,e)=>{let n=v0.get(t);n?n.push(e):v0.set(t,[e])},Wl=()=>{if(fc||!Ud||Vd||!zi)throw new Error("worker not ready")},Z4=t=>{switch(t.data.type){case"init-wasm":fc=!1,t.data.err?(Vd=!0,Qg[1](t.data.err)):(Ud=!0,Qg[0]()),g0&&(URL.revokeObjectURL(g0),g0=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let e=v0.get(t.data.type);t.data.err?e.shift()[1](t.data.err):e.shift()[0](t.data.out);break}}},$T=async()=>{if(!Ud){if(fc)throw new Error("multiple calls to 'initWasm()' detected.");if(Vd)throw new Error("previous call to 'initWasm()' failed.");if(fc=!0,Uo())return new Promise((t,e)=>{zi==null||zi.terminate(),$7().then(([n,r])=>{var i;try{zi=r,zi.onerror=s=>e(s),zi.onmessage=Z4,Qg=[t,e];let a={type:"init-wasm",in:or};!a.in.wasm.wasmPaths&&(n||(i=import.meta.url)!=null&&i.startsWith("file:"))&&(a.in.wasm.wasmPaths={wasm:new URL("/facet/assets/ort-wasm-simd-threaded.jsep-B5gdmGHs.wasm",import.meta.url).href}),zi.postMessage(a),g0=n}catch(a){e(a)}},e)});try{await yy(or.wasm),await zy(or),Ud=!0}catch(t){throw Vd=!0,t}finally{fc=!1}}},PT=async t=>{if(Uo())return Wl(),new Promise((e,n)=>{Hl("init-ep",[e,n]);let r={type:"init-ep",in:{epName:t,env:or}};zi.postMessage(r)});await Oy(or,t)},RT=async t=>Uo()?(Wl(),new Promise((e,n)=>{Hl("copy-from",[e,n]);let r={type:"copy-from",in:{buffer:t}};zi.postMessage(r,[t.buffer])})):ip(t),DT=async(t,e)=>{if(Uo()){if(e!=null&&e.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Wl(),new Promise((n,r)=>{Hl("create",[n,r]);let i={type:"create",in:{model:t,options:{...e}}},a=[];t instanceof Uint8Array&&a.push(t.buffer),zi.postMessage(i,a)})}else return Ny(t,e)},LT=async t=>{if(Uo())return Wl(),new Promise((e,n)=>{Hl("release",[e,n]);let r={type:"release",in:t};zi.postMessage(r)});By(t)},zT=async(t,e,n,r,i,a)=>{if(Uo()){if(n.some(s=>s[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(i.some(s=>s))throw new Error("pre-allocated output tensor is not supported for proxy.");return Wl(),new Promise((s,o)=>{Hl("run",[s,o]);let l=n,u={type:"run",in:{sessionId:t,inputIndices:e,inputs:l,outputIndices:r,options:a}};zi.postMessage(u,Vy(l))})}else return Fy(t,e,n,r,i,a)},OT=async t=>{if(Uo())return Wl(),new Promise((e,n)=>{Hl("end-profiling",[e,n]);let r={type:"end-profiling",in:t};zi.postMessage(r)});Uy(t)}}),ev,J4,BT,rV=bt(()=>{Ka(),NT(),Qt(),gy(),L7(),ev=(t,e)=>{switch(t.location){case"cpu":return[t.type,t.dims,t.data,"cpu"];case"gpu-buffer":return[t.type,t.dims,{gpuBuffer:t.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[t.type,t.dims,{mlTensor:t.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${t.location} for ${e()}`)}},J4=t=>{switch(t[3]){case"cpu":return new Bi(t[0],t[2],t[1]);case"gpu-buffer":{let e=t[0];if(!xy(e))throw new Error(`not supported data type: ${e} for deserializing GPU tensor`);let{gpuBuffer:n,download:r,dispose:i}=t[2];return Bi.fromGpuBuffer(n,{dataType:e,dims:t[1],download:r,dispose:i})}case"ml-tensor":{let e=t[0];if(!wy(e))throw new Error(`not supported data type: ${e} for deserializing MLTensor tensor`);let{mlTensor:n,download:r,dispose:i}=t[2];return Bi.fromMLTensor(n,{dataType:e,dims:t[1],download:r,dispose:i})}default:throw new Error(`invalid data location: ${t[3]}`)}},BT=class{async fetchModelAndCopyToWasmMemory(t){return RT(await Sy(t))}async loadModel(t,e){Ts();let n;typeof t=="string"?n=await this.fetchModelAndCopyToWasmMemory(t):n=t,[this.sessionId,this.inputNames,this.outputNames]=await DT(n,e),Va()}async dispose(){return LT(this.sessionId)}async run(t,e,n){Ts();let r=[],i=[];Object.entries(t).forEach(d=>{let h=d[0],v=d[1],x=this.inputNames.indexOf(h);if(x===-1)throw new Error(`invalid input '${h}'`);r.push(v),i.push(x)});let a=[],s=[];Object.entries(e).forEach(d=>{let h=d[0],v=d[1],x=this.outputNames.indexOf(h);if(x===-1)throw new Error(`invalid output '${h}'`);a.push(v),s.push(x)});let o=r.map((d,h)=>ev(d,()=>`input "${this.inputNames[i[h]]}"`)),l=a.map((d,h)=>d?ev(d,()=>`output "${this.outputNames[s[h]]}"`):null),u=await zT(this.sessionId,i,o,s,l,n),c={};for(let d=0;d<u.length;d++)c[this.outputNames[s[d]]]=a[d]??J4(u[d]);return Va(),c}startProfiling(){}endProfiling(){OT(this.sessionId)}}}),FT={};Wf(FT,{OnnxruntimeWebAssemblyBackend:()=>n1,initializeFlags:()=>t1,wasmBackend:()=>UT});var t1,n1,UT,iV=bt(()=>{Ka(),NT(),rV(),t1=()=>{if((typeof or.wasm.initTimeout!="number"||or.wasm.initTimeout<0)&&(or.wasm.initTimeout=0),or.wasm.simd===!1&&console.warn('Deprecated property "env.wasm.simd" is set to false. non-SIMD build is no longer provided, and this setting will be ignored.'),typeof or.wasm.proxy!="boolean"&&(or.wasm.proxy=!1),typeof or.wasm.trace!="boolean"&&(or.wasm.trace=!1),typeof or.wasm.numThreads!="number"||!Number.isInteger(or.wasm.numThreads)||or.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)or.wasm.numThreads=1;else{let t=typeof navigator>"u"?VF("node:os").cpus().length:navigator.hardwareConcurrency;or.wasm.numThreads=Math.min(4,Math.ceil((t||1)/2))}},n1=class{async init(t){t1(),await $T(),await PT(t)}async createInferenceSessionHandler(t,e){let n=new BT;return await n.loadModel(t,e),Promise.resolve(n)}},UT=new n1});Ka();Ka();Ka();var aV="1.21.1";{let t=(iV(),Z0(FT)).wasmBackend;xc("webgpu",t,5),xc("webnn",t,5),xc("cpu",t,10),xc("wasm",t,10)}Object.defineProperty(or.versions,"web",{value:aV,enumerable:!0});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q4={type:"change"},tv={type:"start"},eS={type:"end"};class sV extends _u{constructor(e,n){super(),this.object=e,this.domElement=n,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Ee,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Zu.ROTATE,MIDDLE:Zu.DOLLY,RIGHT:Zu.PAN},this.touches={ONE:Ju.ROTATE,TWO:Ju.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(be){be.addEventListener("keydown",ct),this._domElementKeyEvents=be},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",ct),this._domElementKeyEvents=null},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(Q4),r.update(),a=i.NONE},this.update=function(){const be=new Ee,Ie=new Ai().setFromUnitVectors(e.up,new Ee(0,1,0)),at=Ie.clone().invert(),Le=new Ee,kt=new Ai,Dt=2*Math.PI;return function(){const Kt=r.object.position;be.copy(Kt).sub(r.target),be.applyQuaternion(Ie),o.setFromVector3(be),r.autoRotate&&a===i.NONE&&U(V()),r.enableDamping?(o.theta+=l.theta*r.dampingFactor,o.phi+=l.phi*r.dampingFactor):(o.theta+=l.theta,o.phi+=l.phi);let on=r.minAzimuthAngle,Mn=r.maxAzimuthAngle;return isFinite(on)&&isFinite(Mn)&&(on<-Math.PI?on+=Dt:on>Math.PI&&(on-=Dt),Mn<-Math.PI?Mn+=Dt:Mn>Math.PI&&(Mn-=Dt),on<=Mn?o.theta=Math.max(on,Math.min(Mn,o.theta)):o.theta=o.theta>(on+Mn)/2?Math.max(on,o.theta):Math.min(Mn,o.theta)),o.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,o.phi)),o.makeSafe(),o.radius*=u,o.radius=Math.max(r.minDistance,Math.min(r.maxDistance,o.radius)),r.enableDamping===!0?r.target.addScaledVector(c,r.dampingFactor):r.target.add(c),be.setFromSpherical(o),be.applyQuaternion(at),Kt.copy(r.target).add(be),r.object.lookAt(r.target),r.enableDamping===!0?(l.theta*=1-r.dampingFactor,l.phi*=1-r.dampingFactor,c.multiplyScalar(1-r.dampingFactor)):(l.set(0,0,0),c.set(0,0,0)),u=1,d||Le.distanceToSquared(r.object.position)>s||8*(1-kt.dot(r.object.quaternion))>s?(r.dispatchEvent(Q4),Le.copy(r.object.position),kt.copy(r.object.quaternion),d=!1,!0):!1}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",De),r.domElement.removeEventListener("pointerdown",ke),r.domElement.removeEventListener("pointercancel",We),r.domElement.removeEventListener("wheel",vt),r.domElement.removeEventListener("pointermove",Xe),r.domElement.removeEventListener("pointerup",Ze),r._domElementKeyEvents!==null&&(r._domElementKeyEvents.removeEventListener("keydown",ct),r._domElementKeyEvents=null)};const r=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=i.NONE;const s=1e-6,o=new _3,l=new _3;let u=1;const c=new Ee;let d=!1;const h=new Lt,v=new Lt,x=new Lt,_=new Lt,b=new Lt,S=new Lt,E=new Lt,C=new Lt,A=new Lt,D=[],O={};function V(){return 2*Math.PI/60/60*r.autoRotateSpeed}function P(){return Math.pow(.95,r.zoomSpeed)}function U(be){l.theta-=be}function Y(be){l.phi-=be}const fe=function(){const be=new Ee;return function(at,Le){be.setFromMatrixColumn(Le,0),be.multiplyScalar(-at),c.add(be)}}(),Q=function(){const be=new Ee;return function(at,Le){r.screenSpacePanning===!0?be.setFromMatrixColumn(Le,1):(be.setFromMatrixColumn(Le,0),be.crossVectors(r.object.up,be)),be.multiplyScalar(at),c.add(be)}}(),G=function(){const be=new Ee;return function(at,Le){const kt=r.domElement;if(r.object.isPerspectiveCamera){const Dt=r.object.position;be.copy(Dt).sub(r.target);let At=be.length();At*=Math.tan(r.object.fov/2*Math.PI/180),fe(2*at*At/kt.clientHeight,r.object.matrix),Q(2*Le*At/kt.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(fe(at*(r.object.right-r.object.left)/r.object.zoom/kt.clientWidth,r.object.matrix),Q(Le*(r.object.top-r.object.bottom)/r.object.zoom/kt.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function re(be){r.object.isPerspectiveCamera?u/=be:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*be)),r.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function he(be){r.object.isPerspectiveCamera?u*=be:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/be)),r.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function ye(be){h.set(be.clientX,be.clientY)}function $e(be){E.set(be.clientX,be.clientY)}function _e(be){_.set(be.clientX,be.clientY)}function de(be){v.set(be.clientX,be.clientY),x.subVectors(v,h).multiplyScalar(r.rotateSpeed);const Ie=r.domElement;U(2*Math.PI*x.x/Ie.clientHeight),Y(2*Math.PI*x.y/Ie.clientHeight),h.copy(v),r.update()}function Oe(be){C.set(be.clientX,be.clientY),A.subVectors(C,E),A.y>0?re(P()):A.y<0&&he(P()),E.copy(C),r.update()}function ve(be){b.set(be.clientX,be.clientY),S.subVectors(b,_).multiplyScalar(r.panSpeed),G(S.x,S.y),_.copy(b),r.update()}function ie(be){be.deltaY<0?he(P()):be.deltaY>0&&re(P()),r.update()}function Pe(be){let Ie=!1;switch(be.code){case r.keys.UP:be.ctrlKey||be.metaKey||be.shiftKey?Y(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):G(0,r.keyPanSpeed),Ie=!0;break;case r.keys.BOTTOM:be.ctrlKey||be.metaKey||be.shiftKey?Y(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):G(0,-r.keyPanSpeed),Ie=!0;break;case r.keys.LEFT:be.ctrlKey||be.metaKey||be.shiftKey?U(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):G(r.keyPanSpeed,0),Ie=!0;break;case r.keys.RIGHT:be.ctrlKey||be.metaKey||be.shiftKey?U(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):G(-r.keyPanSpeed,0),Ie=!0;break}Ie&&(be.preventDefault(),r.update())}function et(){if(D.length===1)h.set(D[0].pageX,D[0].pageY);else{const be=.5*(D[0].pageX+D[1].pageX),Ie=.5*(D[0].pageY+D[1].pageY);h.set(be,Ie)}}function ne(){if(D.length===1)_.set(D[0].pageX,D[0].pageY);else{const be=.5*(D[0].pageX+D[1].pageX),Ie=.5*(D[0].pageY+D[1].pageY);_.set(be,Ie)}}function qe(){const be=D[0].pageX-D[1].pageX,Ie=D[0].pageY-D[1].pageY,at=Math.sqrt(be*be+Ie*Ie);E.set(0,at)}function ge(){r.enableZoom&&qe(),r.enablePan&&ne()}function xe(){r.enableZoom&&qe(),r.enableRotate&&et()}function ze(be){if(D.length==1)v.set(be.pageX,be.pageY);else{const at=xt(be),Le=.5*(be.pageX+at.x),kt=.5*(be.pageY+at.y);v.set(Le,kt)}x.subVectors(v,h).multiplyScalar(r.rotateSpeed);const Ie=r.domElement;U(2*Math.PI*x.x/Ie.clientHeight),Y(2*Math.PI*x.y/Ie.clientHeight),h.copy(v)}function Ge(be){if(D.length===1)b.set(be.pageX,be.pageY);else{const Ie=xt(be),at=.5*(be.pageX+Ie.x),Le=.5*(be.pageY+Ie.y);b.set(at,Le)}S.subVectors(b,_).multiplyScalar(r.panSpeed),G(S.x,S.y),_.copy(b)}function ut(be){const Ie=xt(be),at=be.pageX-Ie.x,Le=be.pageY-Ie.y,kt=Math.sqrt(at*at+Le*Le);C.set(0,kt),A.set(0,Math.pow(C.y/E.y,r.zoomSpeed)),re(A.y),E.copy(C)}function ce(be){r.enableZoom&&ut(be),r.enablePan&&Ge(be)}function me(be){r.enableZoom&&ut(be),r.enableRotate&&ze(be)}function ke(be){r.enabled!==!1&&(D.length===0&&(r.domElement.setPointerCapture(be.pointerId),r.domElement.addEventListener("pointermove",Xe),r.domElement.addEventListener("pointerup",Ze)),Je(be),be.pointerType==="touch"?se(be):gt(be))}function Xe(be){r.enabled!==!1&&(be.pointerType==="touch"?K(be):ht(be))}function Ze(be){tt(be),D.length===0&&(r.domElement.releasePointerCapture(be.pointerId),r.domElement.removeEventListener("pointermove",Xe),r.domElement.removeEventListener("pointerup",Ze)),r.dispatchEvent(eS),a=i.NONE}function We(be){tt(be)}function gt(be){let Ie;switch(be.button){case 0:Ie=r.mouseButtons.LEFT;break;case 1:Ie=r.mouseButtons.MIDDLE;break;case 2:Ie=r.mouseButtons.RIGHT;break;default:Ie=-1}switch(Ie){case Zu.DOLLY:if(r.enableZoom===!1)return;$e(be),a=i.DOLLY;break;case Zu.ROTATE:if(be.ctrlKey||be.metaKey||be.shiftKey){if(r.enablePan===!1)return;_e(be),a=i.PAN}else{if(r.enableRotate===!1)return;ye(be),a=i.ROTATE}break;case Zu.PAN:if(be.ctrlKey||be.metaKey||be.shiftKey){if(r.enableRotate===!1)return;ye(be),a=i.ROTATE}else{if(r.enablePan===!1)return;_e(be),a=i.PAN}break;default:a=i.NONE}a!==i.NONE&&r.dispatchEvent(tv)}function ht(be){switch(a){case i.ROTATE:if(r.enableRotate===!1)return;de(be);break;case i.DOLLY:if(r.enableZoom===!1)return;Oe(be);break;case i.PAN:if(r.enablePan===!1)return;ve(be);break}}function vt(be){r.enabled===!1||r.enableZoom===!1||a!==i.NONE||(be.preventDefault(),r.dispatchEvent(tv),ie(be),r.dispatchEvent(eS))}function ct(be){r.enabled===!1||r.enablePan===!1||Pe(be)}function se(be){switch(nt(be),D.length){case 1:switch(r.touches.ONE){case Ju.ROTATE:if(r.enableRotate===!1)return;et(),a=i.TOUCH_ROTATE;break;case Ju.PAN:if(r.enablePan===!1)return;ne(),a=i.TOUCH_PAN;break;default:a=i.NONE}break;case 2:switch(r.touches.TWO){case Ju.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;ge(),a=i.TOUCH_DOLLY_PAN;break;case Ju.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;xe(),a=i.TOUCH_DOLLY_ROTATE;break;default:a=i.NONE}break;default:a=i.NONE}a!==i.NONE&&r.dispatchEvent(tv)}function K(be){switch(nt(be),a){case i.TOUCH_ROTATE:if(r.enableRotate===!1)return;ze(be),r.update();break;case i.TOUCH_PAN:if(r.enablePan===!1)return;Ge(be),r.update();break;case i.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;ce(be),r.update();break;case i.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;me(be),r.update();break;default:a=i.NONE}}function De(be){r.enabled!==!1&&be.preventDefault()}function Je(be){D.push(be)}function tt(be){delete O[be.pointerId];for(let Ie=0;Ie<D.length;Ie++)if(D[Ie].pointerId==be.pointerId){D.splice(Ie,1);return}}function nt(be){let Ie=O[be.pointerId];Ie===void 0&&(Ie=new Lt,O[be.pointerId]=Ie),Ie.set(be.pageX,be.pageY)}function xt(be){const Ie=be.pointerId===D[0].pointerId?D[1]:D[0];return O[Ie.pointerId]}r.domElement.addEventListener("contextmenu",De),r.domElement.addEventListener("pointerdown",ke),r.domElement.addEventListener("pointercancel",We),r.domElement.addEventListener("wheel",vt,{passive:!1}),this.update()}}class oV{constructor(e,n,r,i,a){this.scene=e,this.renderer=n,this.camera=r,this.mousePos=new Lt,this.raycaster=new OF,this.raycaster.params.Line.threshold=.1,this.grabDistance=0,this.active=!1,this.physicsObject=null,this.controls=a,this.arrow=new NF(new Ee(0,1,0),new Ee(0,0,0),15,6710886),this.arrow.setLength(15,3,1),this.scene.add(this.arrow),this.arrow.line.material.transparent=!0,this.arrow.cone.material.transparent=!0,this.arrow.line.material.opacity=.5,this.arrow.cone.material.opacity=.5,this.arrow.visible=!1,this.previouslySelected=null,this.higlightColor=16711680,this.localHit=new Ee,this.worldHit=new Ee,this.currentWorld=new Ee,i.addEventListener("pointerdown",this.onPointer.bind(this),!0),document.addEventListener("pointermove",this.onPointer.bind(this),!0),document.addEventListener("pointerup",this.onPointer.bind(this),!0),document.addEventListener("pointerout",this.onPointer.bind(this),!0),i.addEventListener("dblclick",this.onPointer.bind(this),!1)}updateRaycaster(e,n){var r=this.renderer.domElement.getBoundingClientRect();this.mousePos.x=(e-r.left)/r.width*2-1,this.mousePos.y=-((n-r.top)/r.height)*2+1,this.raycaster.setFromCamera(this.mousePos,this.camera)}start(e,n){this.physicsObject=null,this.updateRaycaster(e,n);let r=this.raycaster.intersectObjects(this.scene.children);for(let i=0;i<r.length;i++){let a=r[i].object;if(a.bodyID){this.physicsObject=a,this.grabDistance=r[0].distance;let s=this.raycaster.ray.origin.clone();s.addScaledVector(this.raycaster.ray.direction,this.grabDistance),this.arrow.position.copy(s),this.active=!0,this.controls.enabled=!1,this.localHit=a.worldToLocal(s.clone()),this.worldHit.copy(s),this.currentWorld.copy(s),this.arrow.visible=!0;break}}}move(e,n){if(this.active){this.updateRaycaster(e,n);let r=this.raycaster.ray.origin.clone();r.addScaledVector(this.raycaster.ray.direction,this.grabDistance),this.currentWorld.copy(r),this.update(),this.physicsObject!=null}}update(){this.worldHit&&this.localHit&&this.currentWorld&&this.arrow&&this.physicsObject&&(this.worldHit.copy(this.localHit),this.physicsObject.localToWorld(this.worldHit),this.arrow.position.copy(this.worldHit),this.offset=this.currentWorld.clone().sub(this.worldHit),this.arrow.setDirection(this.offset.clone().normalize()),this.arrow.setLength(this.offset.clone().length()))}end(e){this.physicsObject=null,this.active=!1,this.controls.enabled=!0,this.arrow.visible=!1,this.mouseDown=!1}onPointer(e){e.type=="pointerdown"?(this.start(e.clientX,e.clientY),this.mouseDown=!0):e.type=="pointermove"&&this.mouseDown?this.active&&this.move(e.clientX,e.clientY):e.type=="pointerup"&&this.end(e),e.type=="dblclick"&&(this.start(e.clientX,e.clientY),this.doubleClick=!0,this.physicsObject?this.physicsObject==this.previouslySelected?(this.physicsObject.material.emissive.setHex(0),this.previouslySelected=null):(this.previouslySelected&&this.previouslySelected.material.emissive.setHex(0),this.physicsObject.material.emissive.setHex(this.higlightColor),this.previouslySelected=this.physicsObject):this.previouslySelected&&(this.previouslySelected.material.emissive.setHex(0),this.previouslySelected=null))}}class Hy extends $i{constructor(e,n={}){super(e),this.isReflector=!0,this.type="Reflector",this.camera=new Ni;const r=this;n.color!==void 0?new Sn(n.color):new Sn(8355711);const i=n.textureWidth||512,a=n.textureHeight||512,s=n.clipBias||0;n.shader||Hy.ReflectorShader;const o=n.multisample!==void 0?n.multisample:4,l=n.texture||void 0,u=new Xo,c=new Ee,d=new Ee,h=new Ee,v=new tr,x=new Ee(0,0,-1),_=new Cr,b=new Ee,S=new Ee,E=new Cr,C=new tr,A=this.camera,D=new al(i,a,{samples:o,type:Nc});this.material=new Uv({map:l}),this.material.uniforms={tDiffuse:{value:D.texture},textureMatrix:{value:C}},this.material.onBeforeCompile=O=>{let V=O.vertexShader.indexOf("void main() {");O.vertexShader=O.vertexShader.slice(0,V)+`
uniform mat4 textureMatrix;
varying vec4 vUv3;
`+O.vertexShader.slice(V-1,-1)+"	vUv3 = textureMatrix * vec4( position, 1.0 ); }",V=O.fragmentShader.indexOf("void main() {"),O.fragmentShader=`
uniform sampler2D tDiffuse; 
 varying vec4 vUv3;
`+O.fragmentShader.slice(0,V)+O.fragmentShader.slice(V-1,-1)+`	gl_FragColor = vec4( mix( texture2DProj( tDiffuse,  vUv3 ).rgb, gl_FragColor.rgb , 0.5), 1.0 );
				}`,O.uniforms.tDiffuse={value:D.texture},O.uniforms.textureMatrix={value:C},this.material.uniforms=O.uniforms,this.material.userData.shader=O},this.receiveShadow=!0,this.onBeforeRender=function(O,V,P){if(d.setFromMatrixPosition(r.matrixWorld),h.setFromMatrixPosition(P.matrixWorld),v.extractRotation(r.matrixWorld),c.set(0,0,1),c.applyMatrix4(v),b.subVectors(d,h),b.dot(c)>0)return;b.reflect(c).negate(),b.add(d),v.extractRotation(P.matrixWorld),x.set(0,0,-1),x.applyMatrix4(v),x.add(h),S.subVectors(d,x),S.reflect(c).negate(),S.add(d),A.position.copy(b),A.up.set(0,1,0),A.up.applyMatrix4(v),A.up.reflect(c),A.lookAt(S),A.far=P.far,A.updateMatrixWorld(),A.projectionMatrix.copy(P.projectionMatrix),C.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),C.multiply(A.projectionMatrix),C.multiply(A.matrixWorldInverse),C.multiply(r.matrixWorld),u.setFromNormalAndCoplanarPoint(c,d),u.applyMatrix4(A.matrixWorldInverse),_.set(u.normal.x,u.normal.y,u.normal.z,u.constant);const U=A.projectionMatrix;E.x=(Math.sign(_.x)+U.elements[8])/U.elements[0],E.y=(Math.sign(_.y)+U.elements[9])/U.elements[5],E.z=-1,E.w=(1+U.elements[10])/U.elements[14],_.multiplyScalar(2/_.dot(E)),U.elements[2]=_.x,U.elements[6]=_.y,U.elements[10]=_.z+1-s,U.elements[14]=_.w,r.visible=!1;const Y=O.getRenderTarget(),fe=O.xr.enabled,Q=O.shadowMap.autoUpdate,G=O.outputEncoding,re=O.toneMapping;O.xr.enabled=!1,O.shadowMap.autoUpdate=!1,O.outputEncoding=il,O.toneMapping=Ss,O.setRenderTarget(D),O.state.buffers.depth.setMask(!0),O.autoClear===!1&&O.clear(),O.render(V,A),O.xr.enabled=fe,O.shadowMap.autoUpdate=Q,O.outputEncoding=G,O.toneMapping=re,O.setRenderTarget(Y);const he=P.viewport;he!==void 0&&O.state.viewport(he),r.visible=!0},this.getRenderTarget=function(){return D},this.dispose=function(){D.dispose(),r.material.dispose()}}}function VT(t){const e=4*Math.PI,n=[e*t+Math.PI,e*t,e*t,e*t+Math.PI];return[...n.map(Math.sin),...n.map(Math.cos),e,e,e,e]}class lV{constructor(e,n,r,i={}){this.model=e,this.simulation=n,this.demo=r;const{angvel_kp:a=1}=i;this.angvel_kp=a}compute(e){const n=VT(this.demo.mujoco_time/1e3),i=new Ee(this.demo.params.command_vel_x,0,0).clone().applyQuaternion(this.demo.quat.clone().invert());return[i.x,i.y,this.angvel_kp*(0-this.demo.rpy.z),0,...n]}}class uV{constructor(e,n,r,i={}){this.model=e,this.simulation=n,this.demo=r;const{mass:a=1}=i;this.mass=a}compute(e){const n=this.demo.params.impedance_kp,r=1.8*Math.sqrt(n),i=VT(this.demo.mujoco_time/1e3),a=new Ee(...this.simulation.qpos.subarray(0,3)),o=new Ee(this.demo.params.command_vel_x,0,0).clone().multiplyScalar(r/n).add(a);this.demo.params.compliant_mode&&o.copy(a),this.demo.params.use_setpoint?(o.x=this.demo.ball.position.x,o.y=-this.demo.ball.position.z,o.z=0):this.demo.ball.position.set(o.x,.5,-o.y);let l=o.sub(a).applyQuaternion(this.demo.quat.clone().invert()),u=l.length();return l.normalize().multiplyScalar(Math.min(u,2)),[...[l.x,l.y,0-this.demo.rpy.z,n*l.x,n*l.y,r,r,r,n*(0-this.demo.rpy.z),this.mass,n*l.x/this.mass,n*l.y/this.mass,r/this.mass,r/this.mass,r/this.mass],...i]}}class cV{constructor(e,n,r,i={}){this.model=e,this.simulation=n;const{base_joint_name:a="floating_base_joint",history_steps:s=4}=i;this.steps=s,this.angvel_multistep=new Array(this.steps).fill().map(()=>new Float32Array(3));const o=r.jointNamesMJC.indexOf(a);this.joint_qvel_adr=e.jnt_dofadr[o],console.log("ang vel dof adr",this.joint_qvel_adr)}compute(e){for(let i=this.angvel_multistep.length-1;i>0;i--)this.angvel_multistep[i]=this.angvel_multistep[i-1];const n=this.simulation.qvel.subarray(this.joint_qvel_adr,this.joint_qvel_adr+3);this.angvel_multistep[0]=n;const r=new Float32Array(this.steps*3);for(let i=0;i<this.steps;i++)r.set(this.angvel_multistep[i],i*3);return r}}class dV{constructor(e,n,r,i={}){this.model=e,this.simulation=n;const{joint_name:a="floating_base_joint",history_steps:s=4,gravity:o=[0,0,-1]}=i;this.steps=s,this.gravity_multistep=new Array(this.steps).fill().map(()=>new Float32Array(3));const l=r.jointNamesMJC.indexOf(a);this.joint_qpos_adr=e.jnt_qposadr[l],this.gravity=new Ee(...o)}compute(e){const n=this.simulation.qpos.subarray(this.joint_qpos_adr+3,this.joint_qpos_adr+7),r=new Ai(n[1],n[2],n[3],n[0]).invert(),i=this.gravity.clone().applyQuaternion(r);for(let s=this.gravity_multistep.length-1;s>0;s--)this.gravity_multistep[s]=this.gravity_multistep[s-1];this.gravity_multistep[0]=new Float32Array([i.x,i.y,i.z]);const a=new Float32Array(this.steps*3);for(let s=0;s<this.steps;s++)a.set(this.gravity_multistep[s],s*3);return a}}class fV{constructor(e,n,r,i={}){this.model=e,this.simulation=n;const{joint_names:a=[],history_steps:s=4}=i;this.steps=s,this.joint_names=a,this.joint_pos_multistep=new Array(this.steps).fill().map(()=>new Float32Array(a.length)),console.log("joint_names",a),this.joint_qpos_adr=[];for(let o=0;o<a.length;o++){const l=r.jointNamesMJC.indexOf(a[o]),u=e.jnt_qposadr[l];this.joint_qpos_adr.push(u)}console.log("jposadr",this.joint_qpos_adr)}compute(e){for(let r=this.joint_pos_multistep.length-1;r>0;r--)this.joint_pos_multistep[r]=this.joint_pos_multistep[r-1];for(let r=0;r<this.joint_names.length;r++)this.joint_pos_multistep[0][r]=this.simulation.qpos[this.joint_qpos_adr[r]];const n=new Float32Array(this.steps*this.joint_names.length);for(let r=0;r<this.steps;r++)n.set(this.joint_pos_multistep[r],r*this.joint_names.length);return n}}class hV{constructor(e,n,r,i={}){this.model=e,this.simulation=n;const{joint_names:a=[],history_steps:s=4}=i;this.steps=s,this.joint_names=a,this.numJoints=a.length,this.joint_vel_multistep=new Array(this.steps).fill().map(()=>new Float32Array(this.numJoints)),this.joint_qvel_adr=[];for(let o=0;o<a.length;o++){const l=r.jointNamesMJC.indexOf(a[o]),u=e.jnt_dofadr[l];this.joint_qvel_adr.push(u)}console.log("jveladr",this.joint_qvel_adr)}compute(e){for(let r=this.joint_vel_multistep.length-1;r>0;r--)this.joint_vel_multistep[r]=this.joint_vel_multistep[r-1];for(let r=0;r<this.joint_names.length;r++)this.joint_vel_multistep[0][r]=this.simulation.qvel[this.joint_qvel_adr[r]];const n=new Float32Array(this.steps*this.numJoints);for(let r=0;r<this.steps;r++)n.set(this.joint_vel_multistep[r],r*this.numJoints);return n}}class pV{constructor(e,n,r,i={}){this.model=e,this.simulation=n;const{history_steps:a=4}=i;this.steps=a,this.numActions=r.numActions,this.actionBuffer=r.actionBuffer}compute(e){const n=new Float32Array(this.steps*this.numActions);for(let r=0;r<this.numActions;r++)for(let i=0;i<this.steps;i++)n[r*this.steps+i]=this.actionBuffer[i][r];return n}}class mV{constructor(e,n,r,i={}){this.model=e,this.simulation=n,this.demo=r,this.steps=6,this.defaultJpos=r.defaultJpos,this.commands_scale=[2,2,.25],this.ang_vel_scale=.25,this.dof_pos_scale=1,this.dof_vel_scale=.05,this.obs_buf=new Float32Array(this.steps*45);const{joint_names:a}=i;this.joint_qpos_adr=[],this.joint_qvel_adr=[];for(let s=0;s<a.length;s++){const o=r.jointNamesMJC.indexOf(a[s]),l=e.jnt_qposadr[o];this.joint_qpos_adr.push(l);const u=e.jnt_dofadr[o];this.joint_qvel_adr.push(u)}console.log("jposadr",this.joint_qpos_adr),console.log("jveladr",this.joint_qvel_adr)}compute(e){let r=[this.demo.params.command_vel_x,0,0];r=r.map((h,v)=>h*this.commands_scale[v]);const i=this.simulation.qvel.subarray(3,6).map(h=>h*this.ang_vel_scale),a=this.simulation.qpos.subarray(3,7),s=new Ai(a[1],a[2],a[3],a[0]).invert(),o=new Ee(0,0,-1).applyQuaternion(s),l=new Float32Array(12);for(let h=0;h<12;h++)l[h]=(this.simulation.qpos[this.joint_qpos_adr[h]]-this.defaultJpos[h])*this.dof_pos_scale;const u=new Float32Array(12);for(let h=0;h<12;h++)u[h]=this.simulation.qvel[this.joint_qvel_adr[h]]*this.dof_vel_scale;const c=this.demo.lastActions;let d=[...r,...i,...o,...l,...u,...c];for(let h=this.obs_buf.length-1;h>=45;h--)this.obs_buf[h]=this.obs_buf[h-45];return this.obs_buf.set(d,0),this.obs_buf}}class gV{constructor(e,n,r,i={}){this.model=e,this.simulation=n,this.demo=r,this.defaultJpos=r.defaultJpos,this.commands_scale=[2,2,.25],this.ang_vel_scale=.25,this.dof_pos_scale=1,this.dof_vel_scale=.05;const{joint_names:a}=i;this.joint_qpos_adr=[],this.joint_qvel_adr=[];for(let s=0;s<a.length;s++){const o=r.jointNamesMJC.indexOf(a[s]),l=e.jnt_qposadr[o];this.joint_qpos_adr.push(l);const u=e.jnt_dofadr[o];this.joint_qvel_adr.push(u)}console.log("jposadr",this.joint_qpos_adr),console.log("jveladr",this.joint_qvel_adr)}compute(e){let r=[this.demo.params.command_vel_x,0,0];console.log("decap commands",r),r=r.map((d,h)=>d*this.commands_scale[h]);const i=this.simulation.qpos.subarray(3,7),a=new Ai(i[1],i[2],i[3],i[0]).invert(),s=new Ee(0,0,-1).applyQuaternion(a),o=new Float32Array(12);for(let d=0;d<12;d++)o[d]=(this.simulation.qpos[this.joint_qpos_adr[d]]-this.defaultJpos[d])*this.dof_pos_scale;const l=new Float32Array(12);for(let d=0;d<12;d++)l[d]=this.simulation.qvel[this.joint_qvel_adr[d]]*this.dof_vel_scale;const u=this.demo.lastActions;return[...s,...r,...o,...l,...u]}}const vV={VelocityCommand:lV,ImpedanceCommand:uV,BaseAngVelMultistep:cV,GravityMultistep:dV,JointPosMultistep:fV,JointVelMultistep:hV,PrevActions:pV,HIMLocoObs:mV,DecapObs:gV};class yV{constructor(e){this.modelPath=e.path,this.metaData=e.meta,this.isRecurrent=e.meta.in_keys.includes("adapt_hx"),console.log("isRecurrent",this.isRecurrent)}async init(){const n=await(await fetch(this.modelPath)).arrayBuffer();this.inKeys=this.metaData.in_keys,this.outKeys=this.metaData.out_keys,this.session=await my.create(n,{executionProviders:["wasm"],graphOptimizationLevel:"all"}),console.log("ONNX model loaded successfully"),console.log("inKeys",this.inKeys),console.log("outKeys",this.outKeys),console.log("inputNames",this.session.inputNames),console.log("outputNames",this.session.outputNames)}initInput(){return this.isRecurrent?{is_init:new Bi("bool",[!0],[1]),adapt_hx:new Bi("float32",new Float32Array(128),[1,128])}:{}}async runInference(e){let n={};for(let s=0;s<this.inKeys.length;s++)n[this.session.inputNames[s]]=e[this.inKeys[s]];const r=await this.session.run(n);let i={};for(let s=0;s<this.outKeys.length;s++)i[this.outKeys[s]]=r[this.session.outputNames[s]];let a={};return this.isRecurrent&&(a.is_init=new Bi("bool",[!1],[1]),a.adapt_hx=i["next,adapt_hx"]),[i,a]}}async function _V(t,e){this.scene.remove(this.scene.getObjectByName("MuJoCo Root"));let n=this.mujoco;console.log("Loading scene:",t),[this.model,this.state,this.simulation,this.bodies,this.lights]=await xV(n,t,this);const r=new TextDecoder,i=new Uint8Array(this.model.names);this.jointNamesMJC=[];for(let o=0;o<this.model.njnt;o++){let l=this.model.name_jntadr[o],u=l;for(;u<i.length&&i[u]!==0;)u++;let c=r.decode(i.subarray(l,u));this.jointNamesMJC.push(c)}const a=await fetch(e).then(o=>o.json());this.jointNamesIsaac=a.joint_names_isaac;let s=[];for(let o=0;o<this.model.nu;o++){if(this.model.actuator_trntype[o]!==n.mjtTrn.mjTRN_JOINT.value)throw new Error("Expected actuator transmission type to be mjTRN_JOINT");s.push(this.model.actuator_trnid[2*o])}console.log("this.actuator2joint",s),this.ctrl_adr_isaac=[],this.qpos_adr_isaac=[],this.qvel_adr_isaac=[];for(const o of this.jointNamesIsaac){const l=this.jointNamesMJC.indexOf(o),u=s.findIndex(c=>c==l);this.ctrl_adr_isaac.push(u),this.qpos_adr_isaac.push(this.model.jnt_qposadr[l]),this.qvel_adr_isaac.push(this.model.jnt_dofadr[l])}console.log("this.ctrl_adr_isaac",this.ctrl_adr_isaac),console.log("this.qpos_adr_isaac",this.qpos_adr_isaac),console.log("this.qvel_adr_isaac",this.qvel_adr_isaac),this.defaultJpos=new Float32Array(a.default_joint_pos),this.numActions=this.jointNamesIsaac.length,this.actionBuffer=new Array(4).fill().map(()=>new Float32Array(this.numActions)),this.lastActions=new Float32Array(this.numActions),this.timestep=this.model.getOptions().timestep,this.decimation=Math.round(.02/this.timestep),this.mujoco_time=0,this.simStepCount=0,this.inferenceStepCount=0,console.log("timestep:",this.timestep,"decimation:",this.decimation)}async function bV(t){for(console.log("Reloading policy:",this.params.policy);this.isInferencing;)await new Promise(i=>setTimeout(i,10));const n=await(await fetch(t)).json();this.policy=new yV(n.onnx),await this.policy.init(),this.adapt_hx.fill(0),this.rpy.set(0,0,0),this.simulation.resetData(),this.simulation.forward();const r=i=>{const a=vV[i.name];if(!a)throw new Error(`Unknown observation type: ${i.name}`);const s={...i};return delete s.name,s.joint_names==="isaac"&&(s.joint_names=this.jointNamesIsaac),new a(this.model,this.simulation,this,s)};this.observations={};for(const[i,a]of Object.entries(n.obs_config))this.observations[i]=a.map(s=>r(s));this.action_scale=new Float32Array(this.numActions).fill(n.action_scale),this.jntKp=new Float32Array(this.numActions).fill(n.stiffness),this.jntKd=new Float32Array(this.numActions).fill(n.damping),this.control_type=n.control_type??"joint_position"}async function xV(t,e,n){n.simulation!=null&&(n.simulation.free(),n.model=null,n.state=null,n.simulation=null),n.model=t.Model.load_from_xml("/working/"+e),n.state=new t.State(n.model),n.simulation=new t.Simulation(n.model,n.state);let r=n.model,i=n.state,a=n.simulation,s=new TextDecoder("utf-8"),o=new Uint8Array(r.names),u=s.decode(r.names).split(s.decode(new ArrayBuffer(1))),c=new tu;c.name="MuJoCo Root",n.scene.add(c);let d={},h={},v=[],x=new Uv;x.color=new Sn(1,1,1);for(let b=0;b<r.ngeom;b++){if(!(r.geom_group[b]<3))continue;let S=r.geom_bodyid[b],E=r.geom_type[b],C=[r.geom_size[b*3+0],r.geom_size[b*3+1],r.geom_size[b*3+2]];if(!(S in d)){d[S]=new tu;let P=r.name_bodyadr[S],U=P;for(;U<o.length&&o[U]!==0;)U++;let Y=o.subarray(P,U);d[S].name=s.decode(Y),d[S].bodyID=S,d[S].name=="base"&&(n.pelvis_body_id=S),d[S].has_custom_mesh=!1}let A=new nu(C[0]*.5);if(E!=t.mjtGeom.mjGEOM_PLANE.value){if(E!=t.mjtGeom.mjGEOM_HFIELD.value){if(E==t.mjtGeom.mjGEOM_SPHERE.value)A=new nu(C[0]);else if(E==t.mjtGeom.mjGEOM_CAPSULE.value)A=new dy(C[0],C[1]*2,20,20);else if(E==t.mjtGeom.mjGEOM_ELLIPSOID.value)A=new nu(1);else if(E==t.mjtGeom.mjGEOM_CYLINDER.value)A=new Pf(C[0],C[0],C[1]*2);else if(E==t.mjtGeom.mjGEOM_BOX.value)A=new jc(C[0]*2,C[2]*2,C[1]*2);else if(E==t.mjtGeom.mjGEOM_MESH.value){let P=r.geom_dataid[b];if(P in h)A=h[P];else{A=new la;let U=r.mesh_vert.subarray(r.mesh_vertadr[P]*3,(r.mesh_vertadr[P]+r.mesh_vertnum[P])*3);for(let G=0;G<U.length;G+=3){let re=U[G+1];U[G+1]=U[G+2],U[G+2]=-re}let Y=r.mesh_normal.subarray(r.mesh_vertadr[P]*3,(r.mesh_vertadr[P]+r.mesh_vertnum[P])*3);for(let G=0;G<Y.length;G+=3){let re=Y[G+1];Y[G+1]=Y[G+2],Y[G+2]=-re}let fe=r.mesh_texcoord.subarray(r.mesh_texcoordadr[P]*2,(r.mesh_texcoordadr[P]+r.mesh_vertnum[P])*2),Q=r.mesh_face.subarray(r.mesh_faceadr[P]*3,(r.mesh_faceadr[P]+r.mesh_facenum[P])*3);A.setAttribute("position",new Ui(U,3)),A.setAttribute("normal",new Ui(Y,3)),A.setAttribute("uv",new Ui(fe,2)),A.setIndex(Array.from(Q)),h[P]=A}d[S].has_custom_mesh=!0}}}let D,O=[r.geom_rgba[b*4+0],r.geom_rgba[b*4+1],r.geom_rgba[b*4+2],r.geom_rgba[b*4+3]];if(r.geom_matid[b]!=-1){let P=r.geom_matid[b];O=[r.mat_rgba[P*4+0],r.mat_rgba[P*4+1],r.mat_rgba[P*4+2],r.mat_rgba[P*4+3]],D=void 0;let U=r.mat_texid[P];if(U!=-1){let Y=r.tex_width[U],fe=r.tex_height[U],Q=r.tex_adr[U],G=r.tex_rgb,re=new Uint8Array(Y*fe*4);for(let he=0;he<Y*fe;he++)re[he*4+0]=G[Q+(he*3+0)],re[he*4+1]=G[Q+(he*3+1)],re[he*4+2]=G[Q+(he*3+2)],re[he*4+3]=1;D=new mF(re,Y,fe,xa,rl),U==2?(D.repeat=new Lt(50,50),D.wrapS=Jl,D.wrapT=Jl):(D.repeat=new Lt(1,1),D.wrapS=Jl,D.wrapT=Jl),D.needsUpdate=!0}}(x.color.r!=O[0]||x.color.g!=O[1]||x.color.b!=O[2]||x.opacity!=O[3]||x.map!=D)&&(x=new Uv({color:new Sn(O[0],O[1],O[2]),transparent:O[3]<1,opacity:O[3],specularIntensity:r.geom_matid[b]!=-1?r.mat_specular[r.geom_matid[b]]*.5:void 0,reflectivity:r.geom_matid[b]!=-1?r.mat_reflectance[r.geom_matid[b]]:void 0,roughness:r.geom_matid[b]!=-1?1-r.mat_shininess[r.geom_matid[b]]:void 0,metalness:r.geom_matid[b]!=-1?.1:void 0,map:D}));let V=new $i;E==0?(V=new Hy(new Ip(100,100),{clipBias:.003,texture:D}),V.rotateX(-Math.PI/2)):V=new $i(A,x),V.castShadow=b!=0,V.receiveShadow=E!=7,V.bodyID=S,d[S].add(V),Ho(r.geom_pos,b,V.position),E!=0&&r1(r.geom_quat,b,V.quaternion),E==4&&V.scale.set(C[0],C[2],C[1])}let _=new RF;_.color=new Sn(.8,.3,.3),c.cylinders=new u3(new Pf(1,1,1),_,1023),c.cylinders.receiveShadow=!0,c.cylinders.castShadow=!0,c.add(c.cylinders),c.spheres=new u3(new nu(1,10,10),_,1023),c.spheres.receiveShadow=!0,c.spheres.castShadow=!0,c.add(c.spheres);for(let b=0;b<r.nlight;b++){let S=new g3;r.light_directional[b]?S=new v3:S=new g3,S.decay=r.light_attenuation[b]*100,S.penumbra=.5,S.castShadow=!0,S.shadow.mapSize.width=1024,S.shadow.mapSize.height=1024,S.shadow.camera.near=1,S.shadow.camera.far=10,d[0]?d[0].add(S):c.add(S),v.push(S)}if(r.nlight==0){let b=new v3;c.add(b)}for(let b=0;b<r.nbody;b++)b==0||!d[0]?c.add(d[b]):(d[b]||(console.log("Body without Geometry detected; adding to bodies",b,d[b]),d[b]=new tu,d[b].name=u[b+1],d[b].bodyID=b,d[b].has_custom_mesh=!1),d[0].add(d[b]));return n.mujocoRoot=c,[r,i,a,d,v]}async function wV(t){const n=await(await fetch("./examples/scenes/files.json")).json();let r=n.map(a=>fetch("./examples/scenes/"+a)),i=await Promise.all(r);for(let a=0;a<i.length;a++){let s=n[a].split("/"),o="/working/";for(let l=0;l<s.length-1;l++)o+=s[l],t.FS.analyzePath(o).exists||t.FS.mkdir(o),o+="/";n[a].endsWith(".png")||n[a].endsWith(".stl")||n[a].endsWith(".skn")?t.FS.writeFile("/working/"+n[a],new Uint8Array(await i[a].arrayBuffer())):t.FS.writeFile("/working/"+n[a],await i[a].text())}}function Ho(t,e,n,r=!0){return r?n.set(t[e*3+0],t[e*3+2],-t[e*3+1]):n.set(t[e*3+0],t[e*3+1],t[e*3+2])}function r1(t,e,n,r=!0){return r?n.set(-t[e*4+1],-t[e*4+3],t[e*4+2],-t[e*4+0]):n.set(t[e*4+0],t[e*4+1],t[e*4+2],t[e*4+3])}function tS(t){return t.set(t.x,-t.z,t.y)}class SV{constructor(e){this.mujoco=e,e.FS.mkdir("/working"),e.FS.mount(e.MEMFS,{root:"."},"/working"),this.params={paused:!0,help:!1,command_vel_x:0,impedance_kp:24,use_setpoint:!0,impulse_remain_time:0,compliant_mode:!1},this.lastActions=null,this.isInferencing=!1,this.observations={},this.bodies={},this.lights={},this.updateGUICallbacks=[],this.container=document.getElementById("mujoco-container"),this.scene=new pF,this.scene.name="scene",this.camera=new Ni(45,window.innerWidth/window.innerHeight,.001,100),this.camera.name="PerspectiveCamera",this.camera.position.set(2,1.7,1.7),this.scene.add(this.camera),this.scene.background=new Sn(.15,.25,.35),this.scene.fog=new sy(this.scene.background,15,25.5),this.ambientLight=new zF(16777215,.1),this.ambientLight.name="AmbientLight",this.scene.add(this.ambientLight);const n=new nu(.05,16,16),r=new s7({color:15680580,metalness:.2,roughness:.2});this.ball=new $i(n,r),this.ball.position.set(0,.5,0),this.ball.castShadow=!0,this.ball.bodyID="setpoint",this.scene.add(this.ball),this.renderer=new ay({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=D8,this.container.appendChild(this.renderer.domElement),this.controls=new sV(this.camera,this.renderer.domElement),this.controls.target.set(0,.7,0),this.controls.panSpeed=2,this.controls.zoomSpeed=1,this.controls.enableDamping=!0,this.controls.dampingFactor=.1,this.controls.screenSpacePanning=!0,this.controls.update(),window.addEventListener("resize",this.onWindowResize.bind(this)),this.dragStateManager=new oV(this.scene,this.renderer,this.camera,this.container.parentElement,this.controls),this.lastSimState={bodies:new Map,lights:new Map,tendons:{numWraps:0,matrix:new tr}},this.renderer.setAnimationLoop(this.render.bind(this)),this.reloadScene=_V.bind(this),this.reloadPolicy=bV.bind(this)}async init(){await wV(this.mujoco),this.adapt_hx=new Float32Array(128),this.rpy=new lu,await this.reloadScene("unitree_go2/scene.xml","./examples/checkpoints/go2/asset_meta.json"),await this.reloadPolicy("./examples/checkpoints/policy-05-03_21-31.json"),this.alive=!0}async reload(e,n){await this.reloadScene(e,n),await this.reloadScene(e,n),this.timestep=this.model.getOptions().timestep,this.decimation=Math.round(.02/this.timestep),this.mujoco_time=0,this.simStepCount=0,this.inferenceStepCount=0,console.log("timestep:",this.timestep,"decimation:",this.decimation),this.adapt_hx=new Float32Array(128),this.rpy=new lu,await this.reloadScene(e,n),this.timestep=this.model.getOptions().timestep,this.decimation=Math.round(.02/this.timestep),this.mujoco_time=0,this.simStepCount=0,this.inferenceStepCount=0,console.log("timestep:",this.timestep,"decimation:",this.decimation),this.adapt_hx=new Float32Array(128),this.rpy=new lu,await this.reloadPolicy(),this.alive=!0}async main_loop(){for(this.inputDict=this.policy.initInput();this.alive;){const e=performance.now();if(!this.params.paused&&this.model!=null&&this.state!=null&&this.simulation!=null&&this.observations!=null){performance.now();const a=this.simulation.qpos.subarray(3,7);this.quat=new Ai(a[1],a[2],a[3],a[0]),this.rpy.setFromQuaternion(this.quat),this.computeObservations(this.simulation);try{await this.runInference()}catch(s){console.error("Inference error in main loop:",s),this.alive=!1;break}performance.now();for(let s=0;s<this.decimation;s++){if(this.control_type=="joint_position")for(let l=0;l<this.numActions;l++){const u=this.qpos_adr_isaac[l],c=this.qvel_adr_isaac[l],d=this.ctrl_adr_isaac[l],h=this.action_scale[l]*this.lastActions[l]+this.defaultJpos[l],v=this.jntKp[l]*(h-this.simulation.qpos[u])+this.jntKd[l]*(0-this.simulation.qvel[c]);this.simulation.ctrl[d]=v}else if(this.control_type=="torque")for(let l=0;l<this.numActions;l++){const u=this.ctrl_adr_isaac[l],c=this.action_scale[l]*this.lastActions[l];this.simulation.ctrl[u]=c}for(let l=0;l<this.simulation.qfrc_applied.length;l++)this.simulation.qfrc_applied[l]=0;let o=this.dragStateManager.physicsObject;if(o&&o.bodyID){for(let u=0;u<this.model.nbody;u++)this.bodies[u]&&(Ho(this.simulation.xpos,u,this.bodies[u].position),r1(this.simulation.xquat,u,this.bodies[u].quaternion),this.bodies[u].updateWorldMatrix());let l=o.bodyID;if(this.dragStateManager.update(),this.dragStateManager.physicsObject)if(this.dragStateManager.physicsObject.bodyID=="setpoint")this.ball.position.x=this.dragStateManager.currentWorld.x,this.ball.position.z=this.dragStateManager.currentWorld.z;else{let u=tS(this.dragStateManager.offset.clone().multiplyScalar(25)),c=tS(this.dragStateManager.worldHit.clone());this.simulation.applyForce(u.x,u.y,u.z,0,0,0,c.x,c.y,c.z,l)}}if(this.params.impulse_remain_time>0){let l=new Ee(0,50,0),u=new Ee(0,0,0);Ho(this.simulation.xpos,this.pelvis_body_id,u,!1),this.simulation.applyForce(l.x,l.y,l.z,0,0,0,u.x,u.y,u.z,this.pelvis_body_id),this.params.impulse_remain_time-=this.timestep}this.simulation.step(),this.mujoco_time+=this.timestep*1e3,this.simStepCount+=1}performance.now();for(let s=0;s<this.model.nbody;s++)this.bodies[s]&&(this.lastSimState.bodies.has(s)||this.lastSimState.bodies.set(s,{position:new Ee,quaternion:new Ai}),Ho(this.simulation.xpos,s,this.lastSimState.bodies.get(s).position),r1(this.simulation.xquat,s,this.lastSimState.bodies.get(s).quaternion));for(let s=0;s<this.model.nlight;s++)this.lights[s]&&(this.lastSimState.lights.has(s)||this.lastSimState.lights.set(s,{position:new Ee,direction:new Ee}),Ho(this.simulation.light_xpos,s,this.lastSimState.lights.get(s).position),Ho(this.simulation.light_xdir,s,this.lastSimState.lights.get(s).direction));if(this.mujocoRoot&&this.mujocoRoot.cylinders){let s=0;const o=this.lastSimState.tendons.matrix;for(let l=0;l<this.model.ntendon;l++){let u=this.simulation.ten_wrapadr[l],c=this.model.tendon_width[l];for(let d=u;d<u+this.simulation.ten_wrapnum[l]-1;d++){let h=Ho(this.simulation.wrap_xpos,d,new Ee),v=Ho(this.simulation.wrap_xpos,d+1,new Ee),x=new Ee().addVectors(h,v).multiplyScalar(.5),_=h.length()>.01,b=v.length()>.01;_&&this.mujocoRoot.spheres.setMatrixAt(s,o.compose(h,new Ai,new Ee(c,c,c))),b&&this.mujocoRoot.spheres.setMatrixAt(s+1,o.compose(v,new Ai,new Ee(c,c,c))),_&&b&&(o.compose(x,new Ai().setFromUnitVectors(new Ee(0,1,0),v.clone().sub(h).normalize()),new Ee(c,h.distanceTo(v),c)),this.mujocoRoot.cylinders.setMatrixAt(s,o),s++)}}this.lastSimState.tendons.numWraps=s}performance.now()}const r=(performance.now()-e)/1e3,i=Math.max(0,this.timestep*this.decimation-r);await new Promise(a=>setTimeout(a,i*1e3))}}async runInference(){if(!this.policy||this.isInferencing){console.log("inference lag");return}performance.now(),this.isInferencing=!0,this.inferenceStepCount+=1;try{const[e,n]=await this.policy.runInference(this.inputDict),r=e.action.data;for(let i=0;i<this.lastActions.length;i++)this.lastActions[i]=this.lastActions[i]*.2+r[i]*.8;for(let i=this.actionBuffer.length-1;i>0;i--)this.actionBuffer[i]=this.actionBuffer[i-1];this.actionBuffer[0]=this.lastActions,this.inputDict=n}finally{this.isInferencing=!1}performance.now()}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}computeObservations(e){for(const[n,r]of Object.entries(this.observations)){let i=[];for(const a of r){const s=a.compute(e);s.some(isNaN)&&console.log("NaN in observation",a.constructor.name),i.push(...s)}this.inputDict[n]=new Bi("float32",i,[1,i.length])}}render(){if(!(!this.model||!this.state||!this.simulation)){performance.now(),this.controls.update();for(const[e,n]of this.lastSimState.bodies)this.bodies[e]&&(this.bodies[e].position.copy(n.position),this.bodies[e].quaternion.copy(n.quaternion),this.bodies[e].updateWorldMatrix());for(const[e,n]of this.lastSimState.lights)this.lights[e]&&(this.lights[e].position.copy(n.position),this.lights[e].lookAt(n.direction.add(this.lights[e].position)));if(this.mujocoRoot&&this.mujocoRoot.cylinders){const{numWraps:e}=this.lastSimState.tendons.numWraps;this.mujocoRoot.cylinders.count=e,this.mujocoRoot.spheres.count=e>0?e+1:0,this.mujocoRoot.cylinders.instanceMatrix.needsUpdate=!0,this.mujocoRoot.spheres.instanceMatrix.needsUpdate=!0}this.renderer.render(this.scene,this.camera),performance.now(),this.simStepCount/this.decimation%50}}}const MV="modulepreload",EV=function(t){return"/facet/"+t},nS={},TV=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let s=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=s(n.map(u=>{if(u=EV(u),u in nS)return;nS[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":MV,c||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),c)return new Promise((v,x)=>{h.addEventListener("load",v),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return i.then(s=>{for(const o of s||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})};var CV=async function(t={}){var e,n=t,r,i,a=new Promise((p,y)=>{r=p,i=y}),s=typeof window=="object",o=typeof WorkerGlobalScope<"u",l=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer",u=!s&&!l&&!o;if(l){const{createRequire:p}=await TV(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);var c=p(import.meta.url)}var d=[],h="./this.program",v=(p,y)=>{throw y},x=import.meta.url,_="";function b(p){return n.locateFile?n.locateFile(p,_):_+p}var S,E;if(l){if(typeof process>"u"||!process.release||process.release.name!=="node")throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");var C=process.versions.node,A=C.split(".").slice(0,3);if(A=A[0]*1e4+A[1]*100+A[2].split("-")[0]*1,A<16e4)throw new Error("This emscripten-generated code requires node v16.0.0 (detected v"+C+")");var D=c("fs"),O=c("path");x.startsWith("file:")&&(_=O.dirname(c("url").fileURLToPath(x))+"/"),E=p=>{p=ne(p)?new URL(p):p;var y=D.readFileSync(p);return G(Buffer.isBuffer(y)),y},S=async(p,y=!0)=>{p=ne(p)?new URL(p):p;var T=D.readFileSync(p,y?void 0:"utf8");return G(y?Buffer.isBuffer(T):typeof T=="string"),T},process.argv.length>1&&(h=process.argv[1].replace(/\\/g,"/")),d=process.argv.slice(2),v=(p,y)=>{throw process.exitCode=p,y}}else if(u){if(typeof process=="object"&&typeof c=="function"||typeof window=="object"||typeof WorkerGlobalScope<"u")throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)")}else if(s||o){try{_=new URL(".",x).href}catch{}if(!(typeof window=="object"||typeof WorkerGlobalScope<"u"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");o&&(E=p=>{var y=new XMLHttpRequest;return y.open("GET",p,!1),y.responseType="arraybuffer",y.send(null),new Uint8Array(y.response)}),S=async p=>{if(ne(p))return new Promise((T,$)=>{var F=new XMLHttpRequest;F.open("GET",p,!0),F.responseType="arraybuffer",F.onload=()=>{if(F.status==200||F.status==0&&F.response){T(F.response);return}$(F.status)},F.onerror=$,F.send(null)});var y=await fetch(p,{credentials:"same-origin"});if(y.ok)return y.arrayBuffer();throw new Error(y.status+" : "+y.url)}}else throw new Error("environment detection error");var V=console.log.bind(console),P=console.error.bind(console);G(!u,"shell environment detected but not enabled at build time.  Add `shell` to `-sENVIRONMENT` to enable.");var U;typeof WebAssembly!="object"&&P("no native wasm support detected");var Y,fe=!1,Q;function G(p,y){p||Ie("Assertion failed"+(y?": "+y:""))}var re,he,ye,$e,_e,de,Oe,ve,ie,Pe,et=!1,ne=p=>p.startsWith("file://");function qe(){var p=hh();G((p&3)==0),p==0&&(p+=4),de[p>>2]=34821223,de[p+4>>2]=2310721022,de[0]=1668509029}function ge(){if(!fe){var p=hh();p==0&&(p+=4);var y=de[p>>2],T=de[p+4>>2];(y!=34821223||T!=2310721022)&&Ie(`Stack overflow! Stack cookie has been overwritten at ${bn(p)}, expected hex dwords 0x89BACDFE and 0x2135467, but received ${bn(T)} ${bn(y)}`),de[0]!=1668509029&&Ie("Runtime error: The application has corrupted its heap memory area (address zero)!")}}class xe extends Error{}class ze extends xe{}class Ge extends xe{constructor(y){super(y),this.excPtr=y;const T=dd(y);this.name=T[0],this.message=T[1]}}(()=>{var p=new Int16Array(1),y=new Int8Array(p.buffer);if(p[0]=25459,y[0]!==115||y[1]!==99)throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)"})();function ut(p){Object.getOwnPropertyDescriptor(n,p)||Object.defineProperty(n,p,{configurable:!0,set(){Ie(`Attempt to set \`Module.${p}\` after it has already been processed.  This can happen, for example, when code is injected via '--post-js' rather than '--pre-js'`)}})}function ce(p){Object.getOwnPropertyDescriptor(n,p)&&Ie(`\`Module.${p}\` was supplied but \`${p}\` not included in INCOMING_MODULE_JS_API`)}function me(p){return p==="FS_createPath"||p==="FS_createDataFile"||p==="FS_createPreloadedFile"||p==="FS_unlink"||p==="addRunDependency"||p==="FS_createLazyFile"||p==="FS_createDevice"||p==="removeRunDependency"}function ke(p,y){typeof globalThis<"u"&&!Object.getOwnPropertyDescriptor(globalThis,p)&&Object.defineProperty(globalThis,p,{configurable:!0,get(){y()}})}function Xe(p,y){ke(p,()=>{sn(`\`${p}\` is not longer defined by emscripten. ${y}`)})}Xe("buffer","Please use HEAP8.buffer or wasmMemory.buffer"),Xe("asm","Please use wasmExports instead");function Ze(p){ke(p,()=>{var y=`\`${p}\` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line`,T=p;T.startsWith("_")||(T="$"+p),y+=` (e.g. -sDEFAULT_LIBRARY_FUNCS_TO_INCLUDE='${T}')`,me(p)&&(y+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),sn(y)}),We(p)}function We(p){Object.getOwnPropertyDescriptor(n,p)||Object.defineProperty(n,p,{configurable:!0,get(){var y=`'${p}' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)`;me(p)&&(y+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),Ie(y)}})}function gt(){var p=Y.buffer;re=new Int8Array(p),ye=new Int16Array(p),he=new Uint8Array(p),$e=new Uint16Array(p),_e=new Int32Array(p),de=new Uint32Array(p),Oe=new Float32Array(p),Pe=new Float64Array(p),ve=new BigInt64Array(p),ie=new BigUint64Array(p)}G(typeof Int32Array<"u"&&typeof Float64Array<"u"&&Int32Array.prototype.subarray!=null&&Int32Array.prototype.set!=null,"JS engine does not provide full typed array support");function ht(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)nr(n.preRun.shift());ut("preRun"),pt($n)}function vt(){G(!et),et=!0,ge(),!n.noFSInit&&!j.initialized&&j.init(),ai.__wasm_call_ctors(),j.ignorePermissions=!1}function ct(){ge()}function se(){if(ge(),n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)Rt(n.postRun.shift());ut("postRun"),pt(Tt)}var K=0,De=null,Je={},tt=null;function nt(p){for(var y=p;;){if(!Je[p])return p;p=y+Math.random()}}function xt(p){var y;K++,(y=n.monitorRunDependencies)==null||y.call(n,K),p?(G(!Je[p]),Je[p]=1,tt===null&&typeof setInterval<"u"&&(tt=setInterval(()=>{if(fe){clearInterval(tt),tt=null;return}var T=!1;for(var $ in Je)T||(T=!0,P("still waiting on run dependencies:")),P(`dependency: ${$}`);T&&P("(end of list)")},1e4))):P("warning: run dependency added without ID")}function be(p){var T;if(K--,(T=n.monitorRunDependencies)==null||T.call(n,K),p?(G(Je[p]),delete Je[p]):P("warning: run dependency removed without ID"),K==0&&(tt!==null&&(clearInterval(tt),tt=null),De)){var y=De;De=null,y()}}function Ie(p){var T;(T=n.onAbort)==null||T.call(n,p),p="Aborted("+p+")",P(p),fe=!0;var y=new WebAssembly.RuntimeError(p);throw i(y),y}function at(p,y){return(...T)=>{G(et,`native function \`${p}\` called before runtime initialization`);var $=ai[p];return G($,`exported native function \`${p}\` not found`),G(T.length<=y,`native function \`${p}\` called with ${T.length} args but expects ${y}`),$(...T)}}var Le;function kt(){return n.locateFile?b("mujoco_wasm.wasm"):new URL("/facet/assets/mujoco_wasm-bSg7qJna.wasm",import.meta.url).href}function Dt(p){if(p==Le&&U)return new Uint8Array(U);if(E)return E(p);throw"both async and sync fetching of the wasm failed"}async function At(p){if(!U)try{var y=await S(p);return new Uint8Array(y)}catch{}return Dt(p)}async function Kt(p,y){try{var T=await At(p),$=await WebAssembly.instantiate(T,y);return $}catch(F){P(`failed to asynchronously prepare wasm: ${F}`),ne(Le)&&P(`warning: Loading from a file URI (${Le}) is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing`),Ie(F)}}async function on(p,y,T){if(!p&&typeof WebAssembly.instantiateStreaming=="function"&&!ne(y)&&!l)try{var $=fetch(y,{credentials:"same-origin"}),F=await WebAssembly.instantiateStreaming($,T);return F}catch(q){P(`wasm streaming compile failed: ${q}`),P("falling back to ArrayBuffer instantiation")}return Kt(y,T)}function Mn(){return{env:fd,wasi_snapshot_preview1:fd}}async function Re(){function p(J,oe){return ai=J.exports,Y=ai.memory,G(Y,"memory not found in wasm exports"),gt(),ns=ai.__indirect_function_table,G(ns,"table not found in wasm exports"),be("wasm-instantiate"),ai}xt("wasm-instantiate");var y=n;function T(J){return G(n===y,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),y=null,p(J.instance)}var $=Mn();if(n.instantiateWasm)return new Promise((J,oe)=>{try{n.instantiateWasm($,(Ce,He)=>{J(p(Ce,He))})}catch(Ce){P(`Module.instantiateWasm callback failed with error: ${Ce}`),oe(Ce)}});Le??(Le=kt());try{var F=await on(U,Le,$),q=T(F);return q}catch(J){return i(J),Promise.reject(J)}}class it{constructor(y){ma(this,"name","ExitStatus");this.message=`Program terminated with exit(${y})`,this.status=y}}var pt=p=>{for(;p.length>0;)p.shift()(n)},Tt=[],Rt=p=>Tt.push(p),$n=[],nr=p=>$n.push(p),mr=!0,bn=p=>(G(typeof p=="number"),p>>>=0,"0x"+p.toString(16).padStart(8,"0")),Yt=p=>Fp(p),ln=()=>pd(),sn=p=>{sn.shown||(sn.shown={}),sn.shown[p]||(sn.shown[p]=1,l&&(p="warning: "+p),P(p))},R=typeof TextDecoder<"u"?new TextDecoder:void 0,B=(p,y=0,T=NaN)=>{for(var $=y+T,F=y;p[F]&&!(F>=$);)++F;if(F-y>16&&p.buffer&&R)return R.decode(p.subarray(y,F));for(var q="";y<F;){var J=p[y++];if(!(J&128)){q+=String.fromCharCode(J);continue}var oe=p[y++]&63;if((J&224)==192){q+=String.fromCharCode((J&31)<<6|oe);continue}var Ce=p[y++]&63;if((J&240)==224?J=(J&15)<<12|oe<<6|Ce:((J&248)!=240&&sn("Invalid UTF-8 leading byte "+bn(J)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),J=(J&7)<<18|oe<<12|Ce<<6|p[y++]&63),J<65536)q+=String.fromCharCode(J);else{var He=J-65536;q+=String.fromCharCode(55296|He>>10,56320|He&1023)}}return q},ft=(p,y)=>(G(typeof p=="number",`UTF8ToString expects a number (got ${typeof p})`),p?B(he,p,y):""),I=(p,y,T,$)=>Ie(`Assertion failed: ${ft(p)}, at: `+[y?ft(y):"unknown filename",T,$?ft($):"unknown function"]),X=[],Ve=0,we=p=>{var y=new yt(p);return y.get_caught()||(y.set_caught(!0),Ve--),y.set_rethrown(!1),X.push(y),mh(p),md(p)},je=0,Vt=()=>{Jn(0,0),G(X.length>0);var p=X.pop();ph(p.excPtr),je=0};class yt{constructor(y){this.excPtr=y,this.ptr=y-24}set_type(y){de[this.ptr+4>>2]=y}get_type(){return de[this.ptr+4>>2]}set_destructor(y){de[this.ptr+8>>2]=y}get_destructor(){return de[this.ptr+8>>2]}set_caught(y){y=y?1:0,re[this.ptr+12]=y}get_caught(){return re[this.ptr+12]!=0}set_rethrown(y){y=y?1:0,re[this.ptr+13]=y}get_rethrown(){return re[this.ptr+13]!=0}init(y,T){this.set_adjusted_ptr(0),this.set_type(y),this.set_destructor(T)}set_adjusted_ptr(y){de[this.ptr+16>>2]=y}get_adjusted_ptr(){return de[this.ptr+16>>2]}}var Ot=p=>Bp(p),Gt=p=>{var y=je==null?void 0:je.excPtr;if(!y)return Ot(0),0;var T=new yt(y);T.set_adjusted_ptr(y);var $=T.get_type();if(!$)return Ot(0),y;for(var F of p){if(F===0||F===$)break;var q=T.ptr+16;if(gh(F,$,q))return Ot(F),y}return Ot($),y},_n=()=>Gt([]),pe=p=>Gt([p]),tn=()=>{var p=X.pop();p||Ie("no exception to throw");var y=p.excPtr;throw p.get_rethrown()||(X.push(p),p.set_rethrown(!0),p.set_caught(!1),Ve++),je=new Ge(y),je},Se=p=>{if(p){var y=new yt(p);X.push(y),y.set_rethrown(!0),tn()}},wr=(p,y,T)=>{var $=new yt(p);throw $.init(y,T),je=new Ge(p),Ve++,je},Fr=()=>Ve,gr=p=>{throw je||(je=new Ge(p)),je},Xt={isAbs:p=>p.charAt(0)==="/",splitPath:p=>{var y=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return y.exec(p).slice(1)},normalizeArray:(p,y)=>{for(var T=0,$=p.length-1;$>=0;$--){var F=p[$];F==="."?p.splice($,1):F===".."?(p.splice($,1),T++):T&&(p.splice($,1),T--)}if(y)for(;T;T--)p.unshift("..");return p},normalize:p=>{var y=Xt.isAbs(p),T=p.slice(-1)==="/";return p=Xt.normalizeArray(p.split("/").filter($=>!!$),!y).join("/"),!p&&!y&&(p="."),p&&T&&(p+="/"),(y?"/":"")+p},dirname:p=>{var y=Xt.splitPath(p),T=y[0],$=y[1];return!T&&!$?".":($&&($=$.slice(0,-1)),T+$)},basename:p=>p&&p.match(/([^\/]+|\/)\/*$/)[1],join:(...p)=>Xt.normalize(p.join("/")),join2:(p,y)=>Xt.normalize(p+"/"+y)},xn=()=>{if(l){var p=c("crypto");return y=>p.randomFillSync(y)}return y=>crypto.getRandomValues(y)},Ir=p=>{(Ir=xn())(p)},jn={resolve:(...p)=>{for(var y="",T=!1,$=p.length-1;$>=-1&&!T;$--){var F=$>=0?p[$]:j.cwd();if(typeof F!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!F)return"";y=F+"/"+y,T=Xt.isAbs(F)}return y=Xt.normalizeArray(y.split("/").filter(q=>!!q),!T).join("/"),(T?"/":"")+y||"."},relative:(p,y)=>{p=jn.resolve(p).slice(1),y=jn.resolve(y).slice(1);function T(He){for(var Ke=0;Ke<He.length&&He[Ke]==="";Ke++);for(var st=He.length-1;st>=0&&He[st]==="";st--);return Ke>st?[]:He.slice(Ke,st-Ke+1)}for(var $=T(p.split("/")),F=T(y.split("/")),q=Math.min($.length,F.length),J=q,oe=0;oe<q;oe++)if($[oe]!==F[oe]){J=oe;break}for(var Ce=[],oe=J;oe<$.length;oe++)Ce.push("..");return Ce=Ce.concat(F.slice(J)),Ce.join("/")}},Er=[],ur=p=>{for(var y=0,T=0;T<p.length;++T){var $=p.charCodeAt(T);$<=127?y++:$<=2047?y+=2:$>=55296&&$<=57343?(y+=4,++T):y+=3}return y},Ur=(p,y,T,$)=>{if(G(typeof p=="string",`stringToUTF8Array expects a string (got ${typeof p})`),!($>0))return 0;for(var F=T,q=T+$-1,J=0;J<p.length;++J){var oe=p.charCodeAt(J);if(oe>=55296&&oe<=57343){var Ce=p.charCodeAt(++J);oe=65536+((oe&1023)<<10)|Ce&1023}if(oe<=127){if(T>=q)break;y[T++]=oe}else if(oe<=2047){if(T+1>=q)break;y[T++]=192|oe>>6,y[T++]=128|oe&63}else if(oe<=65535){if(T+2>=q)break;y[T++]=224|oe>>12,y[T++]=128|oe>>6&63,y[T++]=128|oe&63}else{if(T+3>=q)break;oe>1114111&&sn("Invalid Unicode code point "+bn(oe)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF)."),y[T++]=240|oe>>18,y[T++]=128|oe>>12&63,y[T++]=128|oe>>6&63,y[T++]=128|oe&63}}return y[T]=0,T-F},Nt=(p,y,T)=>{var $=ur(p)+1,F=new Array($),q=Ur(p,F,0,F.length);return F.length=q,F},hn=()=>{if(!Er.length){var p=null;if(l){var y=256,T=Buffer.alloc(y),$=0,F=process.stdin.fd;try{$=D.readSync(F,T,0,y)}catch(q){if(q.toString().includes("EOF"))$=0;else throw q}$>0&&(p=T.slice(0,$).toString("utf-8"))}else typeof window<"u"&&typeof window.prompt=="function"&&(p=window.prompt("Input: "),p!==null&&(p+=`
`));if(!p)return null;Er=Nt(p)}return Er.shift()},wn={ttys:[],init(){},shutdown(){},register(p,y){wn.ttys[p]={input:[],output:[],ops:y},j.registerDevice(p,wn.stream_ops)},stream_ops:{open(p){var y=wn.ttys[p.node.rdev];if(!y)throw new j.ErrnoError(43);p.tty=y,p.seekable=!1},close(p){p.tty.ops.fsync(p.tty)},fsync(p){p.tty.ops.fsync(p.tty)},read(p,y,T,$,F){if(!p.tty||!p.tty.ops.get_char)throw new j.ErrnoError(60);for(var q=0,J=0;J<$;J++){var oe;try{oe=p.tty.ops.get_char(p.tty)}catch{throw new j.ErrnoError(29)}if(oe===void 0&&q===0)throw new j.ErrnoError(6);if(oe==null)break;q++,y[T+J]=oe}return q&&(p.node.atime=Date.now()),q},write(p,y,T,$,F){if(!p.tty||!p.tty.ops.put_char)throw new j.ErrnoError(60);try{for(var q=0;q<$;q++)p.tty.ops.put_char(p.tty,y[T+q])}catch{throw new j.ErrnoError(29)}return $&&(p.node.mtime=p.node.ctime=Date.now()),q}},default_tty_ops:{get_char(p){return hn()},put_char(p,y){y===null||y===10?(V(B(p.output)),p.output=[]):y!=0&&p.output.push(y)},fsync(p){var y;((y=p.output)==null?void 0:y.length)>0&&(V(B(p.output)),p.output=[])},ioctl_tcgets(p){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(p,y,T){return 0},ioctl_tiocgwinsz(p){return[24,80]}},default_tty1_ops:{put_char(p,y){y===null||y===10?(P(B(p.output)),p.output=[]):y!=0&&p.output.push(y)},fsync(p){var y;((y=p.output)==null?void 0:y.length)>0&&(P(B(p.output)),p.output=[])}}},ii=p=>{Ie("internal error: mmapAlloc called but `emscripten_builtin_memalign` native symbol not exported")},zt={ops_table:null,mount(p){return zt.createNode(null,"/",16895,0)},createNode(p,y,T,$){if(j.isBlkdev(T)||j.isFIFO(T))throw new j.ErrnoError(63);zt.ops_table||(zt.ops_table={dir:{node:{getattr:zt.node_ops.getattr,setattr:zt.node_ops.setattr,lookup:zt.node_ops.lookup,mknod:zt.node_ops.mknod,rename:zt.node_ops.rename,unlink:zt.node_ops.unlink,rmdir:zt.node_ops.rmdir,readdir:zt.node_ops.readdir,symlink:zt.node_ops.symlink},stream:{llseek:zt.stream_ops.llseek}},file:{node:{getattr:zt.node_ops.getattr,setattr:zt.node_ops.setattr},stream:{llseek:zt.stream_ops.llseek,read:zt.stream_ops.read,write:zt.stream_ops.write,mmap:zt.stream_ops.mmap,msync:zt.stream_ops.msync}},link:{node:{getattr:zt.node_ops.getattr,setattr:zt.node_ops.setattr,readlink:zt.node_ops.readlink},stream:{}},chrdev:{node:{getattr:zt.node_ops.getattr,setattr:zt.node_ops.setattr},stream:j.chrdev_stream_ops}});var F=j.createNode(p,y,T,$);return j.isDir(F.mode)?(F.node_ops=zt.ops_table.dir.node,F.stream_ops=zt.ops_table.dir.stream,F.contents={}):j.isFile(F.mode)?(F.node_ops=zt.ops_table.file.node,F.stream_ops=zt.ops_table.file.stream,F.usedBytes=0,F.contents=null):j.isLink(F.mode)?(F.node_ops=zt.ops_table.link.node,F.stream_ops=zt.ops_table.link.stream):j.isChrdev(F.mode)&&(F.node_ops=zt.ops_table.chrdev.node,F.stream_ops=zt.ops_table.chrdev.stream),F.atime=F.mtime=F.ctime=Date.now(),p&&(p.contents[y]=F,p.atime=p.mtime=p.ctime=F.atime),F},getFileDataAsTypedArray(p){return p.contents?p.contents.subarray?p.contents.subarray(0,p.usedBytes):new Uint8Array(p.contents):new Uint8Array(0)},expandFileStorage(p,y){var T=p.contents?p.contents.length:0;if(!(T>=y)){var $=1024*1024;y=Math.max(y,T*(T<$?2:1.125)>>>0),T!=0&&(y=Math.max(y,256));var F=p.contents;p.contents=new Uint8Array(y),p.usedBytes>0&&p.contents.set(F.subarray(0,p.usedBytes),0)}},resizeFileStorage(p,y){if(p.usedBytes!=y)if(y==0)p.contents=null,p.usedBytes=0;else{var T=p.contents;p.contents=new Uint8Array(y),T&&p.contents.set(T.subarray(0,Math.min(y,p.usedBytes))),p.usedBytes=y}},node_ops:{getattr(p){var y={};return y.dev=j.isChrdev(p.mode)?p.id:1,y.ino=p.id,y.mode=p.mode,y.nlink=1,y.uid=0,y.gid=0,y.rdev=p.rdev,j.isDir(p.mode)?y.size=4096:j.isFile(p.mode)?y.size=p.usedBytes:j.isLink(p.mode)?y.size=p.link.length:y.size=0,y.atime=new Date(p.atime),y.mtime=new Date(p.mtime),y.ctime=new Date(p.ctime),y.blksize=4096,y.blocks=Math.ceil(y.size/y.blksize),y},setattr(p,y){for(const T of["mode","atime","mtime","ctime"])y[T]!=null&&(p[T]=y[T]);y.size!==void 0&&zt.resizeFileStorage(p,y.size)},lookup(p,y){throw new j.ErrnoError(44)},mknod(p,y,T,$){return zt.createNode(p,y,T,$)},rename(p,y,T){var $;try{$=j.lookupNode(y,T)}catch{}if($){if(j.isDir(p.mode))for(var F in $.contents)throw new j.ErrnoError(55);j.hashRemoveNode($)}delete p.parent.contents[p.name],y.contents[T]=p,p.name=T,y.ctime=y.mtime=p.parent.ctime=p.parent.mtime=Date.now()},unlink(p,y){delete p.contents[y],p.ctime=p.mtime=Date.now()},rmdir(p,y){var T=j.lookupNode(p,y);for(var $ in T.contents)throw new j.ErrnoError(55);delete p.contents[y],p.ctime=p.mtime=Date.now()},readdir(p){return[".","..",...Object.keys(p.contents)]},symlink(p,y,T){var $=zt.createNode(p,y,41471,0);return $.link=T,$},readlink(p){if(!j.isLink(p.mode))throw new j.ErrnoError(28);return p.link}},stream_ops:{read(p,y,T,$,F){var q=p.node.contents;if(F>=p.node.usedBytes)return 0;var J=Math.min(p.node.usedBytes-F,$);if(G(J>=0),J>8&&q.subarray)y.set(q.subarray(F,F+J),T);else for(var oe=0;oe<J;oe++)y[T+oe]=q[F+oe];return J},write(p,y,T,$,F,q){if(G(!(y instanceof ArrayBuffer)),y.buffer===re.buffer&&(q=!1),!$)return 0;var J=p.node;if(J.mtime=J.ctime=Date.now(),y.subarray&&(!J.contents||J.contents.subarray)){if(q)return G(F===0,"canOwn must imply no weird position inside the file"),J.contents=y.subarray(T,T+$),J.usedBytes=$,$;if(J.usedBytes===0&&F===0)return J.contents=y.slice(T,T+$),J.usedBytes=$,$;if(F+$<=J.usedBytes)return J.contents.set(y.subarray(T,T+$),F),$}if(zt.expandFileStorage(J,F+$),J.contents.subarray&&y.subarray)J.contents.set(y.subarray(T,T+$),F);else for(var oe=0;oe<$;oe++)J.contents[F+oe]=y[T+oe];return J.usedBytes=Math.max(J.usedBytes,F+$),$},llseek(p,y,T){var $=y;if(T===1?$+=p.position:T===2&&j.isFile(p.node.mode)&&($+=p.node.usedBytes),$<0)throw new j.ErrnoError(28);return $},mmap(p,y,T,$,F){if(!j.isFile(p.node.mode))throw new j.ErrnoError(43);var q,J,oe=p.node.contents;if(!(F&2)&&oe&&oe.buffer===re.buffer)J=!1,q=oe.byteOffset;else{if(J=!0,q=ii(),!q)throw new j.ErrnoError(48);oe&&((T>0||T+y<oe.length)&&(oe.subarray?oe=oe.subarray(T,T+y):oe=Array.prototype.slice.call(oe,T,T+y)),re.set(oe,q))}return{ptr:q,allocated:J}},msync(p,y,T,$,F){return zt.stream_ops.write(p,y,0,$,T,!1),0}}},Ma=async p=>{var y=await S(p);return G(y,`Loading data file "${p}" failed (no arrayBuffer).`),new Uint8Array(y)},Ya=(...p)=>j.createDataFile(...p),ua=[],fo=(p,y,T,$)=>{typeof Browser<"u"&&Browser.init();var F=!1;return ua.forEach(q=>{F||q.canHandle(y)&&(q.handle(p,y,T,$),F=!0)}),F},hl=(p,y,T,$,F,q,J,oe,Ce,He)=>{var Ke=y?jn.resolve(Xt.join2(p,y)):p,st=nt(`cp ${Ke}`);function wt(ot){function $t(jt){He==null||He(),oe||Ya(p,y,jt,$,F,Ce),q==null||q(),be(st)}fo(ot,Ke,$t,()=>{J==null||J(),be(st)})||$t(ot)}xt(st),typeof T=="string"?Ma(T).then(wt,J):wt(T)},Su=p=>{var y={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},T=y[p];if(typeof T>"u")throw new Error(`Unknown file open mode: ${p}`);return T},Za=(p,y)=>{var T=0;return p&&(T|=365),y&&(T|=146),T},mi=p=>ft(dh(p)),Mu={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135},j={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class extends Error{constructor(y){super(et?mi(y):"");ma(this,"name","ErrnoError");this.errno=y;for(var T in Mu)if(Mu[T]===y){this.code=T;break}}},FSStream:class{constructor(){ma(this,"shared",{})}get object(){return this.node}set object(p){this.node=p}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(p){this.shared.flags=p}get position(){return this.shared.position}set position(p){this.shared.position=p}},FSNode:class{constructor(p,y,T,$){ma(this,"node_ops",{});ma(this,"stream_ops",{});ma(this,"readMode",365);ma(this,"writeMode",146);ma(this,"mounted",null);p||(p=this),this.parent=p,this.mount=p.mount,this.id=j.nextInode++,this.name=y,this.mode=T,this.rdev=$,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(p){p?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(p){p?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return j.isDir(this.mode)}get isDevice(){return j.isChrdev(this.mode)}},lookupPath(p,y={}){if(!p)throw new j.ErrnoError(44);y.follow_mount??(y.follow_mount=!0),Xt.isAbs(p)||(p=j.cwd()+"/"+p);e:for(var T=0;T<40;T++){for(var $=p.split("/").filter(He=>!!He),F=j.root,q="/",J=0;J<$.length;J++){var oe=J===$.length-1;if(oe&&y.parent)break;if($[J]!=="."){if($[J]===".."){if(q=Xt.dirname(q),j.isRoot(F)){p=q+"/"+$.slice(J+1).join("/");continue e}else F=F.parent;continue}q=Xt.join2(q,$[J]);try{F=j.lookupNode(F,$[J])}catch(He){if((He==null?void 0:He.errno)===44&&oe&&y.noent_okay)return{path:q};throw He}if(j.isMountpoint(F)&&(!oe||y.follow_mount)&&(F=F.mounted.root),j.isLink(F.mode)&&(!oe||y.follow)){if(!F.node_ops.readlink)throw new j.ErrnoError(52);var Ce=F.node_ops.readlink(F);Xt.isAbs(Ce)||(Ce=Xt.dirname(q)+"/"+Ce),p=Ce+"/"+$.slice(J+1).join("/");continue e}}}return{path:q,node:F}}throw new j.ErrnoError(32)},getPath(p){for(var y;;){if(j.isRoot(p)){var T=p.mount.mountpoint;return y?T[T.length-1]!=="/"?`${T}/${y}`:T+y:T}y=y?`${p.name}/${y}`:p.name,p=p.parent}},hashName(p,y){for(var T=0,$=0;$<y.length;$++)T=(T<<5)-T+y.charCodeAt($)|0;return(p+T>>>0)%j.nameTable.length},hashAddNode(p){var y=j.hashName(p.parent.id,p.name);p.name_next=j.nameTable[y],j.nameTable[y]=p},hashRemoveNode(p){var y=j.hashName(p.parent.id,p.name);if(j.nameTable[y]===p)j.nameTable[y]=p.name_next;else for(var T=j.nameTable[y];T;){if(T.name_next===p){T.name_next=p.name_next;break}T=T.name_next}},lookupNode(p,y){var T=j.mayLookup(p);if(T)throw new j.ErrnoError(T);for(var $=j.hashName(p.id,y),F=j.nameTable[$];F;F=F.name_next){var q=F.name;if(F.parent.id===p.id&&q===y)return F}return j.lookup(p,y)},createNode(p,y,T,$){G(typeof p=="object");var F=new j.FSNode(p,y,T,$);return j.hashAddNode(F),F},destroyNode(p){j.hashRemoveNode(p)},isRoot(p){return p===p.parent},isMountpoint(p){return!!p.mounted},isFile(p){return(p&61440)===32768},isDir(p){return(p&61440)===16384},isLink(p){return(p&61440)===40960},isChrdev(p){return(p&61440)===8192},isBlkdev(p){return(p&61440)===24576},isFIFO(p){return(p&61440)===4096},isSocket(p){return(p&49152)===49152},flagsToPermissionString(p){var y=["r","w","rw"][p&3];return p&512&&(y+="w"),y},nodePermissions(p,y){return j.ignorePermissions?0:y.includes("r")&&!(p.mode&292)||y.includes("w")&&!(p.mode&146)||y.includes("x")&&!(p.mode&73)?2:0},mayLookup(p){if(!j.isDir(p.mode))return 54;var y=j.nodePermissions(p,"x");return y||(p.node_ops.lookup?0:2)},mayCreate(p,y){if(!j.isDir(p.mode))return 54;try{var T=j.lookupNode(p,y);return 20}catch{}return j.nodePermissions(p,"wx")},mayDelete(p,y,T){var $;try{$=j.lookupNode(p,y)}catch(q){return q.errno}var F=j.nodePermissions(p,"wx");if(F)return F;if(T){if(!j.isDir($.mode))return 54;if(j.isRoot($)||j.getPath($)===j.cwd())return 10}else if(j.isDir($.mode))return 31;return 0},mayOpen(p,y){return p?j.isLink(p.mode)?32:j.isDir(p.mode)&&(j.flagsToPermissionString(y)!=="r"||y&576)?31:j.nodePermissions(p,j.flagsToPermissionString(y)):44},checkOpExists(p,y){if(!p)throw new j.ErrnoError(y);return p},MAX_OPEN_FDS:4096,nextfd(){for(var p=0;p<=j.MAX_OPEN_FDS;p++)if(!j.streams[p])return p;throw new j.ErrnoError(33)},getStreamChecked(p){var y=j.getStream(p);if(!y)throw new j.ErrnoError(8);return y},getStream:p=>j.streams[p],createStream(p,y=-1){return G(y>=-1),p=Object.assign(new j.FSStream,p),y==-1&&(y=j.nextfd()),p.fd=y,j.streams[y]=p,p},closeStream(p){j.streams[p]=null},dupStream(p,y=-1){var $,F;var T=j.createStream(p,y);return(F=($=T.stream_ops)==null?void 0:$.dup)==null||F.call($,T),T},doSetAttr(p,y,T){var $=p==null?void 0:p.stream_ops.setattr,F=$?p:y;$??($=y.node_ops.setattr),j.checkOpExists($,63),$(F,T)},chrdev_stream_ops:{open(p){var T,$;var y=j.getDevice(p.node.rdev);p.stream_ops=y.stream_ops,($=(T=p.stream_ops).open)==null||$.call(T,p)},llseek(){throw new j.ErrnoError(70)}},major:p=>p>>8,minor:p=>p&255,makedev:(p,y)=>p<<8|y,registerDevice(p,y){j.devices[p]={stream_ops:y}},getDevice:p=>j.devices[p],getMounts(p){for(var y=[],T=[p];T.length;){var $=T.pop();y.push($),T.push(...$.mounts)}return y},syncfs(p,y){typeof p=="function"&&(y=p,p=!1),j.syncFSRequests++,j.syncFSRequests>1&&P(`warning: ${j.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var T=j.getMounts(j.root.mount),$=0;function F(J){return G(j.syncFSRequests>0),j.syncFSRequests--,y(J)}function q(J){if(J)return q.errored?void 0:(q.errored=!0,F(J));++$>=T.length&&F(null)}T.forEach(J=>{if(!J.type.syncfs)return q(null);J.type.syncfs(J,p,q)})},mount(p,y,T){if(typeof p=="string")throw p;var $=T==="/",F=!T,q;if($&&j.root)throw new j.ErrnoError(10);if(!$&&!F){var J=j.lookupPath(T,{follow_mount:!1});if(T=J.path,q=J.node,j.isMountpoint(q))throw new j.ErrnoError(10);if(!j.isDir(q.mode))throw new j.ErrnoError(54)}var oe={type:p,opts:y,mountpoint:T,mounts:[]},Ce=p.mount(oe);return Ce.mount=oe,oe.root=Ce,$?j.root=Ce:q&&(q.mounted=oe,q.mount&&q.mount.mounts.push(oe)),Ce},unmount(p){var y=j.lookupPath(p,{follow_mount:!1});if(!j.isMountpoint(y.node))throw new j.ErrnoError(28);var T=y.node,$=T.mounted,F=j.getMounts($);Object.keys(j.nameTable).forEach(J=>{for(var oe=j.nameTable[J];oe;){var Ce=oe.name_next;F.includes(oe.mount)&&j.destroyNode(oe),oe=Ce}}),T.mounted=null;var q=T.mount.mounts.indexOf($);G(q!==-1),T.mount.mounts.splice(q,1)},lookup(p,y){return p.node_ops.lookup(p,y)},mknod(p,y,T){var $=j.lookupPath(p,{parent:!0}),F=$.node,q=Xt.basename(p);if(!q)throw new j.ErrnoError(28);if(q==="."||q==="..")throw new j.ErrnoError(20);var J=j.mayCreate(F,q);if(J)throw new j.ErrnoError(J);if(!F.node_ops.mknod)throw new j.ErrnoError(63);return F.node_ops.mknod(F,q,y,T)},statfs(p){return j.statfsNode(j.lookupPath(p,{follow:!0}).node)},statfsStream(p){return j.statfsNode(p.node)},statfsNode(p){var y={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:j.nextInode,ffree:j.nextInode-1,fsid:42,flags:2,namelen:255};return p.node_ops.statfs&&Object.assign(y,p.node_ops.statfs(p.mount.opts.root)),y},create(p,y=438){return y&=4095,y|=32768,j.mknod(p,y,0)},mkdir(p,y=511){return y&=1023,y|=16384,j.mknod(p,y,0)},mkdirTree(p,y){var T=p.split("/"),$="";for(var F of T)if(F){($||Xt.isAbs(p))&&($+="/"),$+=F;try{j.mkdir($,y)}catch(q){if(q.errno!=20)throw q}}},mkdev(p,y,T){return typeof T>"u"&&(T=y,y=438),y|=8192,j.mknod(p,y,T)},symlink(p,y){if(!jn.resolve(p))throw new j.ErrnoError(44);var T=j.lookupPath(y,{parent:!0}),$=T.node;if(!$)throw new j.ErrnoError(44);var F=Xt.basename(y),q=j.mayCreate($,F);if(q)throw new j.ErrnoError(q);if(!$.node_ops.symlink)throw new j.ErrnoError(63);return $.node_ops.symlink($,F,p)},rename(p,y){var T=Xt.dirname(p),$=Xt.dirname(y),F=Xt.basename(p),q=Xt.basename(y),J,oe,Ce;if(J=j.lookupPath(p,{parent:!0}),oe=J.node,J=j.lookupPath(y,{parent:!0}),Ce=J.node,!oe||!Ce)throw new j.ErrnoError(44);if(oe.mount!==Ce.mount)throw new j.ErrnoError(75);var He=j.lookupNode(oe,F),Ke=jn.relative(p,$);if(Ke.charAt(0)!==".")throw new j.ErrnoError(28);if(Ke=jn.relative(y,T),Ke.charAt(0)!==".")throw new j.ErrnoError(55);var st;try{st=j.lookupNode(Ce,q)}catch{}if(He!==st){var wt=j.isDir(He.mode),ot=j.mayDelete(oe,F,wt);if(ot)throw new j.ErrnoError(ot);if(ot=st?j.mayDelete(Ce,q,wt):j.mayCreate(Ce,q),ot)throw new j.ErrnoError(ot);if(!oe.node_ops.rename)throw new j.ErrnoError(63);if(j.isMountpoint(He)||st&&j.isMountpoint(st))throw new j.ErrnoError(10);if(Ce!==oe&&(ot=j.nodePermissions(oe,"w"),ot))throw new j.ErrnoError(ot);j.hashRemoveNode(He);try{oe.node_ops.rename(He,Ce,q),He.parent=Ce}catch($t){throw $t}finally{j.hashAddNode(He)}}},rmdir(p){var y=j.lookupPath(p,{parent:!0}),T=y.node,$=Xt.basename(p),F=j.lookupNode(T,$),q=j.mayDelete(T,$,!0);if(q)throw new j.ErrnoError(q);if(!T.node_ops.rmdir)throw new j.ErrnoError(63);if(j.isMountpoint(F))throw new j.ErrnoError(10);T.node_ops.rmdir(T,$),j.destroyNode(F)},readdir(p){var y=j.lookupPath(p,{follow:!0}),T=y.node,$=j.checkOpExists(T.node_ops.readdir,54);return $(T)},unlink(p){var y=j.lookupPath(p,{parent:!0}),T=y.node;if(!T)throw new j.ErrnoError(44);var $=Xt.basename(p),F=j.lookupNode(T,$),q=j.mayDelete(T,$,!1);if(q)throw new j.ErrnoError(q);if(!T.node_ops.unlink)throw new j.ErrnoError(63);if(j.isMountpoint(F))throw new j.ErrnoError(10);T.node_ops.unlink(T,$),j.destroyNode(F)},readlink(p){var y=j.lookupPath(p),T=y.node;if(!T)throw new j.ErrnoError(44);if(!T.node_ops.readlink)throw new j.ErrnoError(28);return T.node_ops.readlink(T)},stat(p,y){var T=j.lookupPath(p,{follow:!y}),$=T.node,F=j.checkOpExists($.node_ops.getattr,63);return F($)},fstat(p){var y=j.getStreamChecked(p),T=y.node,$=y.stream_ops.getattr,F=$?y:T;return $??($=T.node_ops.getattr),j.checkOpExists($,63),$(F)},lstat(p){return j.stat(p,!0)},doChmod(p,y,T,$){j.doSetAttr(p,y,{mode:T&4095|y.mode&-4096,ctime:Date.now(),dontFollow:$})},chmod(p,y,T){var $;if(typeof p=="string"){var F=j.lookupPath(p,{follow:!T});$=F.node}else $=p;j.doChmod(null,$,y,T)},lchmod(p,y){j.chmod(p,y,!0)},fchmod(p,y){var T=j.getStreamChecked(p);j.doChmod(T,T.node,y,!1)},doChown(p,y,T){j.doSetAttr(p,y,{timestamp:Date.now(),dontFollow:T})},chown(p,y,T,$){var F;if(typeof p=="string"){var q=j.lookupPath(p,{follow:!$});F=q.node}else F=p;j.doChown(null,F,$)},lchown(p,y,T){j.chown(p,y,T,!0)},fchown(p,y,T){var $=j.getStreamChecked(p);j.doChown($,$.node,!1)},doTruncate(p,y,T){if(j.isDir(y.mode))throw new j.ErrnoError(31);if(!j.isFile(y.mode))throw new j.ErrnoError(28);var $=j.nodePermissions(y,"w");if($)throw new j.ErrnoError($);j.doSetAttr(p,y,{size:T,timestamp:Date.now()})},truncate(p,y){if(y<0)throw new j.ErrnoError(28);var T;if(typeof p=="string"){var $=j.lookupPath(p,{follow:!0});T=$.node}else T=p;j.doTruncate(null,T,y)},ftruncate(p,y){var T=j.getStreamChecked(p);if(y<0||(T.flags&2097155)===0)throw new j.ErrnoError(28);j.doTruncate(T,T.node,y)},utime(p,y,T){var $=j.lookupPath(p,{follow:!0}),F=$.node,q=j.checkOpExists(F.node_ops.setattr,63);q(F,{atime:y,mtime:T})},open(p,y,T=438){if(p==="")throw new j.ErrnoError(44);y=typeof y=="string"?Su(y):y,y&64?T=T&4095|32768:T=0;var $,F;if(typeof p=="object")$=p;else{F=p.endsWith("/");var q=j.lookupPath(p,{follow:!(y&131072),noent_okay:!0});$=q.node,p=q.path}var J=!1;if(y&64)if($){if(y&128)throw new j.ErrnoError(20)}else{if(F)throw new j.ErrnoError(31);$=j.mknod(p,T|511,0),J=!0}if(!$)throw new j.ErrnoError(44);if(j.isChrdev($.mode)&&(y&=-513),y&65536&&!j.isDir($.mode))throw new j.ErrnoError(54);if(!J){var oe=j.mayOpen($,y);if(oe)throw new j.ErrnoError(oe)}y&512&&!J&&j.truncate($,0),y&=-131713;var Ce=j.createStream({node:$,path:j.getPath($),flags:y,seekable:!0,position:0,stream_ops:$.stream_ops,ungotten:[],error:!1});return Ce.stream_ops.open&&Ce.stream_ops.open(Ce),J&&j.chmod($,T&511),n.logReadFiles&&!(y&1)&&(p in j.readFiles||(j.readFiles[p]=1)),Ce},close(p){if(j.isClosed(p))throw new j.ErrnoError(8);p.getdents&&(p.getdents=null);try{p.stream_ops.close&&p.stream_ops.close(p)}catch(y){throw y}finally{j.closeStream(p.fd)}p.fd=null},isClosed(p){return p.fd===null},llseek(p,y,T){if(j.isClosed(p))throw new j.ErrnoError(8);if(!p.seekable||!p.stream_ops.llseek)throw new j.ErrnoError(70);if(T!=0&&T!=1&&T!=2)throw new j.ErrnoError(28);return p.position=p.stream_ops.llseek(p,y,T),p.ungotten=[],p.position},read(p,y,T,$,F){if(G(T>=0),$<0||F<0)throw new j.ErrnoError(28);if(j.isClosed(p))throw new j.ErrnoError(8);if((p.flags&2097155)===1)throw new j.ErrnoError(8);if(j.isDir(p.node.mode))throw new j.ErrnoError(31);if(!p.stream_ops.read)throw new j.ErrnoError(28);var q=typeof F<"u";if(!q)F=p.position;else if(!p.seekable)throw new j.ErrnoError(70);var J=p.stream_ops.read(p,y,T,$,F);return q||(p.position+=J),J},write(p,y,T,$,F,q){if(G(T>=0),$<0||F<0)throw new j.ErrnoError(28);if(j.isClosed(p))throw new j.ErrnoError(8);if((p.flags&2097155)===0)throw new j.ErrnoError(8);if(j.isDir(p.node.mode))throw new j.ErrnoError(31);if(!p.stream_ops.write)throw new j.ErrnoError(28);p.seekable&&p.flags&1024&&j.llseek(p,0,2);var J=typeof F<"u";if(!J)F=p.position;else if(!p.seekable)throw new j.ErrnoError(70);var oe=p.stream_ops.write(p,y,T,$,F,q);return J||(p.position+=oe),oe},mmap(p,y,T,$,F){if(($&2)!==0&&(F&2)===0&&(p.flags&2097155)!==2)throw new j.ErrnoError(2);if((p.flags&2097155)===1)throw new j.ErrnoError(2);if(!p.stream_ops.mmap)throw new j.ErrnoError(43);if(!y)throw new j.ErrnoError(28);return p.stream_ops.mmap(p,y,T,$,F)},msync(p,y,T,$,F){return G(T>=0),p.stream_ops.msync?p.stream_ops.msync(p,y,T,$,F):0},ioctl(p,y,T){if(!p.stream_ops.ioctl)throw new j.ErrnoError(59);return p.stream_ops.ioctl(p,y,T)},readFile(p,y={}){if(y.flags=y.flags||0,y.encoding=y.encoding||"binary",y.encoding!=="utf8"&&y.encoding!=="binary")throw new Error(`Invalid encoding type "${y.encoding}"`);var T,$=j.open(p,y.flags),F=j.stat(p),q=F.size,J=new Uint8Array(q);return j.read($,J,0,q,0),y.encoding==="utf8"?T=B(J):y.encoding==="binary"&&(T=J),j.close($),T},writeFile(p,y,T={}){T.flags=T.flags||577;var $=j.open(p,T.flags,T.mode);if(typeof y=="string"){var F=new Uint8Array(ur(y)+1),q=Ur(y,F,0,F.length);j.write($,F,0,q,void 0,T.canOwn)}else if(ArrayBuffer.isView(y))j.write($,y,0,y.byteLength,void 0,T.canOwn);else throw new Error("Unsupported data type");j.close($)},cwd:()=>j.currentPath,chdir(p){var y=j.lookupPath(p,{follow:!0});if(y.node===null)throw new j.ErrnoError(44);if(!j.isDir(y.node.mode))throw new j.ErrnoError(54);var T=j.nodePermissions(y.node,"x");if(T)throw new j.ErrnoError(T);j.currentPath=y.path},createDefaultDirectories(){j.mkdir("/tmp"),j.mkdir("/home"),j.mkdir("/home/web_user")},createDefaultDevices(){j.mkdir("/dev"),j.registerDevice(j.makedev(1,3),{read:()=>0,write:($,F,q,J,oe)=>J,llseek:()=>0}),j.mkdev("/dev/null",j.makedev(1,3)),wn.register(j.makedev(5,0),wn.default_tty_ops),wn.register(j.makedev(6,0),wn.default_tty1_ops),j.mkdev("/dev/tty",j.makedev(5,0)),j.mkdev("/dev/tty1",j.makedev(6,0));var p=new Uint8Array(1024),y=0,T=()=>(y===0&&(Ir(p),y=p.byteLength),p[--y]);j.createDevice("/dev","random",T),j.createDevice("/dev","urandom",T),j.mkdir("/dev/shm"),j.mkdir("/dev/shm/tmp")},createSpecialDirectories(){j.mkdir("/proc");var p=j.mkdir("/proc/self");j.mkdir("/proc/self/fd"),j.mount({mount(){var y=j.createNode(p,"fd",16895,73);return y.stream_ops={llseek:zt.stream_ops.llseek},y.node_ops={lookup(T,$){var F=+$,q=j.getStreamChecked(F),J={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>q.path},id:F+1};return J.parent=J,J},readdir(){return Array.from(j.streams.entries()).filter(([T,$])=>$).map(([T,$])=>T.toString())}},y}},{},"/proc/self/fd")},createStandardStreams(p,y,T){p?j.createDevice("/dev","stdin",p):j.symlink("/dev/tty","/dev/stdin"),y?j.createDevice("/dev","stdout",null,y):j.symlink("/dev/tty","/dev/stdout"),T?j.createDevice("/dev","stderr",null,T):j.symlink("/dev/tty1","/dev/stderr");var $=j.open("/dev/stdin",0),F=j.open("/dev/stdout",1),q=j.open("/dev/stderr",1);G($.fd===0,`invalid handle for stdin (${$.fd})`),G(F.fd===1,`invalid handle for stdout (${F.fd})`),G(q.fd===2,`invalid handle for stderr (${q.fd})`)},staticInit(){j.nameTable=new Array(4096),j.mount(zt,{},"/"),j.createDefaultDirectories(),j.createDefaultDevices(),j.createSpecialDirectories(),j.filesystems={MEMFS:zt}},init(p,y,T){G(!j.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),j.initialized=!0,p??(p=n.stdin),y??(y=n.stdout),T??(T=n.stderr),j.createStandardStreams(p,y,T)},quit(){j.initialized=!1,fh(0);for(var p of j.streams)p&&j.close(p)},findObject(p,y){var T=j.analyzePath(p,y);return T.exists?T.object:null},analyzePath(p,y){try{var T=j.lookupPath(p,{follow:!y});p=T.path}catch{}var $={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var T=j.lookupPath(p,{parent:!0});$.parentExists=!0,$.parentPath=T.path,$.parentObject=T.node,$.name=Xt.basename(p),T=j.lookupPath(p,{follow:!y}),$.exists=!0,$.path=T.path,$.object=T.node,$.name=T.node.name,$.isRoot=T.path==="/"}catch(F){$.error=F.errno}return $},createPath(p,y,T,$){p=typeof p=="string"?p:j.getPath(p);for(var F=y.split("/").reverse();F.length;){var q=F.pop();if(q){var J=Xt.join2(p,q);try{j.mkdir(J)}catch(oe){if(oe.errno!=20)throw oe}p=J}}return J},createFile(p,y,T,$,F){var q=Xt.join2(typeof p=="string"?p:j.getPath(p),y),J=Za($,F);return j.create(q,J)},createDataFile(p,y,T,$,F,q){var J=y;p&&(p=typeof p=="string"?p:j.getPath(p),J=y?Xt.join2(p,y):p);var oe=Za($,F),Ce=j.create(J,oe);if(T){if(typeof T=="string"){for(var He=new Array(T.length),Ke=0,st=T.length;Ke<st;++Ke)He[Ke]=T.charCodeAt(Ke);T=He}j.chmod(Ce,oe|146);var wt=j.open(Ce,577);j.write(wt,T,0,T.length,0,q),j.close(wt),j.chmod(Ce,oe)}},createDevice(p,y,T,$){var oe;var F=Xt.join2(typeof p=="string"?p:j.getPath(p),y),q=Za(!!T,!!$);(oe=j.createDevice).major??(oe.major=64);var J=j.makedev(j.createDevice.major++,0);return j.registerDevice(J,{open(Ce){Ce.seekable=!1},close(Ce){var He;(He=$==null?void 0:$.buffer)!=null&&He.length&&$(10)},read(Ce,He,Ke,st,wt){for(var ot=0,$t=0;$t<st;$t++){var jt;try{jt=T()}catch{throw new j.ErrnoError(29)}if(jt===void 0&&ot===0)throw new j.ErrnoError(6);if(jt==null)break;ot++,He[Ke+$t]=jt}return ot&&(Ce.node.atime=Date.now()),ot},write(Ce,He,Ke,st,wt){for(var ot=0;ot<st;ot++)try{$(He[Ke+ot])}catch{throw new j.ErrnoError(29)}return st&&(Ce.node.mtime=Ce.node.ctime=Date.now()),ot}}),j.mkdev(F,q,J)},forceLoadFile(p){if(p.isDevice||p.isFolder||p.link||p.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{p.contents=E(p.url),p.usedBytes=p.contents.length}catch{throw new j.ErrnoError(29)}},createLazyFile(p,y,T,$,F){class q{constructor(){ma(this,"lengthKnown",!1);ma(this,"chunks",[])}get(ot){if(!(ot>this.length-1||ot<0)){var $t=ot%this.chunkSize,jt=ot/this.chunkSize|0;return this.getter(jt)[$t]}}setDataGetter(ot){this.getter=ot}cacheLength(){var ot=new XMLHttpRequest;if(ot.open("HEAD",T,!1),ot.send(null),!(ot.status>=200&&ot.status<300||ot.status===304))throw new Error("Couldn't load "+T+". Status: "+ot.status);var $t=Number(ot.getResponseHeader("Content-length")),jt,En=(jt=ot.getResponseHeader("Accept-Ranges"))&&jt==="bytes",mn=(jt=ot.getResponseHeader("Content-Encoding"))&&jt==="gzip",Dn=1024*1024;En||(Dn=$t);var Nn=(Qr,Ia)=>{if(Qr>Ia)throw new Error("invalid range ("+Qr+", "+Ia+") or no bytes requested!");if(Ia>$t-1)throw new Error("only "+$t+" bytes available! programmer error!");var dr=new XMLHttpRequest;if(dr.open("GET",T,!1),$t!==Dn&&dr.setRequestHeader("Range","bytes="+Qr+"-"+Ia),dr.responseType="arraybuffer",dr.overrideMimeType&&dr.overrideMimeType("text/plain; charset=x-user-defined"),dr.send(null),!(dr.status>=200&&dr.status<300||dr.status===304))throw new Error("Couldn't load "+T+". Status: "+dr.status);return dr.response!==void 0?new Uint8Array(dr.response||[]):Nt(dr.responseText||"")},ji=this;ji.setDataGetter(Qr=>{var Ia=Qr*Dn,dr=(Qr+1)*Dn-1;if(dr=Math.min(dr,$t-1),typeof ji.chunks[Qr]>"u"&&(ji.chunks[Qr]=Nn(Ia,dr)),typeof ji.chunks[Qr]>"u")throw new Error("doXHR failed!");return ji.chunks[Qr]}),(mn||!$t)&&(Dn=$t=1,$t=this.getter(0).length,Dn=$t,V("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=$t,this._chunkSize=Dn,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(typeof XMLHttpRequest<"u"){if(!o)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var J=new q,oe={isDevice:!1,contents:J}}else var oe={isDevice:!1,url:T};var Ce=j.createFile(p,y,oe,$,F);oe.contents?Ce.contents=oe.contents:oe.url&&(Ce.contents=null,Ce.url=oe.url),Object.defineProperties(Ce,{usedBytes:{get:function(){return this.contents.length}}});var He={},Ke=Object.keys(Ce.stream_ops);Ke.forEach(wt=>{var ot=Ce.stream_ops[wt];He[wt]=(...$t)=>(j.forceLoadFile(Ce),ot(...$t))});function st(wt,ot,$t,jt,En){var mn=wt.node.contents;if(En>=mn.length)return 0;var Dn=Math.min(mn.length-En,jt);if(G(Dn>=0),mn.slice)for(var Nn=0;Nn<Dn;Nn++)ot[$t+Nn]=mn[En+Nn];else for(var Nn=0;Nn<Dn;Nn++)ot[$t+Nn]=mn.get(En+Nn);return Dn}return He.read=(wt,ot,$t,jt,En)=>(j.forceLoadFile(Ce),st(wt,ot,$t,jt,En)),He.mmap=(wt,ot,$t,jt,En)=>{j.forceLoadFile(Ce);var mn=ii();if(!mn)throw new j.ErrnoError(48);return st(wt,re,mn,ot,$t),{ptr:mn,allocated:!0}},Ce.stream_ops=He,Ce},absolutePath(){Ie("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder(){Ie("FS.createFolder has been removed; use FS.mkdir instead")},createLink(){Ie("FS.createLink has been removed; use FS.symlink instead")},joinPath(){Ie("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc(){Ie("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath(){Ie("FS.standardizePath has been removed; use PATH.normalize instead")}},Zn={DEFAULT_POLLMASK:5,calculateAt(p,y,T){if(Xt.isAbs(y))return y;var $;if(p===-100)$=j.cwd();else{var F=Zn.getStreamFromFD(p);$=F.path}if(y.length==0){if(!T)throw new j.ErrnoError(44);return $}return $+"/"+y},writeStat(p,y){_e[p>>2]=y.dev,_e[p+4>>2]=y.mode,de[p+8>>2]=y.nlink,_e[p+12>>2]=y.uid,_e[p+16>>2]=y.gid,_e[p+20>>2]=y.rdev,ve[p+24>>3]=BigInt(y.size),_e[p+32>>2]=4096,_e[p+36>>2]=y.blocks;var T=y.atime.getTime(),$=y.mtime.getTime(),F=y.ctime.getTime();return ve[p+40>>3]=BigInt(Math.floor(T/1e3)),de[p+48>>2]=T%1e3*1e3*1e3,ve[p+56>>3]=BigInt(Math.floor($/1e3)),de[p+64>>2]=$%1e3*1e3*1e3,ve[p+72>>3]=BigInt(Math.floor(F/1e3)),de[p+80>>2]=F%1e3*1e3*1e3,ve[p+88>>3]=BigInt(y.ino),0},writeStatFs(p,y){_e[p+4>>2]=y.bsize,_e[p+40>>2]=y.bsize,_e[p+8>>2]=y.blocks,_e[p+12>>2]=y.bfree,_e[p+16>>2]=y.bavail,_e[p+20>>2]=y.files,_e[p+24>>2]=y.ffree,_e[p+28>>2]=y.fsid,_e[p+44>>2]=y.flags,_e[p+36>>2]=y.namelen},doMsync(p,y,T,$,F){if(!j.isFile(y.node.mode))throw new j.ErrnoError(43);if($&2)return 0;var q=he.slice(p,p+T);j.msync(y,q,F,T,$)},getStreamFromFD(p){var y=j.getStreamChecked(p);return y},varargs:void 0,getStr(p){var y=ft(p);return y}};function Kc(p,y,T){try{var $=Zn.getStreamFromFD(p);if(G(!T),$.fd===y)return-28;if(y<0||y>=j.MAX_OPEN_FDS)return-8;var F=j.getStream(y);return F&&j.close(F),j.dupStream($,y).fd}catch(q){if(typeof j>"u"||q.name!=="ErrnoError")throw q;return-q.errno}}var ho=()=>{G(Zn.varargs!=null);var p=_e[+Zn.varargs>>2];return Zn.varargs+=4,p},ca=ho;function Vr(p,y,T){Zn.varargs=T;try{var $=Zn.getStreamFromFD(p);switch(y){case 0:{var F=ho();if(F<0)return-28;for(;j.streams[F];)F++;var q;return q=j.dupStream($,F),q.fd}case 1:case 2:return 0;case 3:return $.flags;case 4:{var F=ho();return $.flags|=F,0}case 12:{var F=ca(),J=0;return ye[F+J>>1]=2,0}case 13:case 14:return 0}return-28}catch(oe){if(typeof j>"u"||oe.name!=="ErrnoError")throw oe;return-oe.errno}}function po(p,y){try{return Zn.writeStat(y,j.fstat(p))}catch(T){if(typeof j>"u"||T.name!=="ErrnoError")throw T;return-T.errno}}function pl(p,y,T){Zn.varargs=T;try{var $=Zn.getStreamFromFD(p);switch(y){case 21509:return $.tty?0:-59;case 21505:{if(!$.tty)return-59;if($.tty.ops.ioctl_tcgets){var F=$.tty.ops.ioctl_tcgets($),q=ca();_e[q>>2]=F.c_iflag||0,_e[q+4>>2]=F.c_oflag||0,_e[q+8>>2]=F.c_cflag||0,_e[q+12>>2]=F.c_lflag||0;for(var J=0;J<32;J++)re[q+J+17]=F.c_cc[J]||0;return 0}return 0}case 21510:case 21511:case 21512:return $.tty?0:-59;case 21506:case 21507:case 21508:{if(!$.tty)return-59;if($.tty.ops.ioctl_tcsets){for(var q=ca(),oe=_e[q>>2],Ce=_e[q+4>>2],He=_e[q+8>>2],Ke=_e[q+12>>2],st=[],J=0;J<32;J++)st.push(re[q+J+17]);return $.tty.ops.ioctl_tcsets($.tty,y,{c_iflag:oe,c_oflag:Ce,c_cflag:He,c_lflag:Ke,c_cc:st})}return 0}case 21519:{if(!$.tty)return-59;var q=ca();return _e[q>>2]=0,0}case 21520:return $.tty?-28:-59;case 21531:{var q=ca();return j.ioctl($,y,q)}case 21523:{if(!$.tty)return-59;if($.tty.ops.ioctl_tiocgwinsz){var wt=$.tty.ops.ioctl_tiocgwinsz($.tty),q=ca();ye[q>>1]=wt[0],ye[q+2>>1]=wt[1]}return 0}case 21524:return $.tty?0:-59;case 21515:return $.tty?0:-59;default:return-28}}catch(ot){if(typeof j>"u"||ot.name!=="ErrnoError")throw ot;return-ot.errno}}function mo(p,y){try{return p=Zn.getStr(p),Zn.writeStat(y,j.lstat(p))}catch(T){if(typeof j>"u"||T.name!=="ErrnoError")throw T;return-T.errno}}function Eu(p,y,T,$){try{y=Zn.getStr(y);var F=$&256,q=$&4096;return $=$&-6401,G(!$,`unknown flags in __syscall_newfstatat: ${$}`),y=Zn.calculateAt(p,y,q),Zn.writeStat(T,F?j.lstat(y):j.stat(y))}catch(J){if(typeof j>"u"||J.name!=="ErrnoError")throw J;return-J.errno}}function ml(p,y,T,$){Zn.varargs=$;try{y=Zn.getStr(y),y=Zn.calculateAt(p,y);var F=$?ho():0;return j.open(y,T,F).fd}catch(q){if(typeof j>"u"||q.name!=="ErrnoError")throw q;return-q.errno}}function Yc(p,y){try{return p=Zn.getStr(p),Zn.writeStat(y,j.stat(p))}catch(T){if(typeof j>"u"||T.name!=="ErrnoError")throw T;return-T.errno}}var Zc=()=>Ie("native code called abort()"),go={},Ea=p=>{for(;p.length;){var y=p.pop(),T=p.pop();T(y)}};function Gi(p){return this.fromWireType(de[p>>2])}var da={},Ta={},Fe={},Xn=n.InternalError=class extends Error{constructor(y){super(y),this.name="InternalError"}},Sr=p=>{throw new Xn(p)},Wn=(p,y,T)=>{p.forEach(oe=>Fe[oe]=y);function $(oe){var Ce=T(oe);Ce.length!==p.length&&Sr("Mismatched type converter count");for(var He=0;He<p.length;++He)zn(p[He],Ce[He])}var F=new Array(y.length),q=[],J=0;y.forEach((oe,Ce)=>{Ta.hasOwnProperty(oe)?F[Ce]=Ta[oe]:(q.push(oe),da.hasOwnProperty(oe)||(da[oe]=[]),da[oe].push(()=>{F[Ce]=Ta[oe],++J,J===q.length&&$(F)}))}),q.length===0&&$(F)},Tu=p=>{var y=go[p];delete go[p];var T=y.rawConstructor,$=y.rawDestructor,F=y.fields,q=F.map(J=>J.getterReturnType).concat(F.map(J=>J.setterArgumentType));Wn([p],q,J=>{var oe={};return F.forEach((Ce,He)=>{var Ke=Ce.fieldName,st=J[He],wt=J[He].optional,ot=Ce.getter,$t=Ce.getterContext,jt=J[He+F.length],En=Ce.setter,mn=Ce.setterContext;oe[Ke]={read:Dn=>st.fromWireType(ot($t,Dn)),write:(Dn,Nn)=>{var ji=[];En(mn,Dn,jt.toWireType(ji,Nn)),Ea(ji)},optional:wt}}),[{name:y.name,fromWireType:Ce=>{var He={};for(var Ke in oe)He[Ke]=oe[Ke].read(Ce);return $(Ce),He},toWireType:(Ce,He)=>{for(var Ke in oe)if(!(Ke in He)&&!oe[Ke].optional)throw new TypeError(`Missing field: "${Ke}"`);var st=T();for(Ke in oe)oe[Ke].write(st,He[Ke]);return Ce!==null&&Ce.push($,st),st},argPackAdvance:vi,readValueFromPointer:Gi,destructorFunction:$}]})},gi=p=>{if(p===null)return"null";var y=typeof p;return y==="object"||y==="array"||y==="function"?p.toString():""+p},gl=()=>{for(var p=new Array(256),y=0;y<256;++y)p[y]=String.fromCharCode(y);Ja=p},Ja,rr=p=>{for(var y="",T=p;he[T];)y+=Ja[he[T++]];return y},Ct=n.BindingError=class extends Error{constructor(y){super(y),this.name="BindingError"}},pn=p=>{throw new Ct(p)};function Ps(p,y,T={}){var $=y.name;if(p||pn(`type "${$}" must have a positive integer typeid pointer`),Ta.hasOwnProperty(p)){if(T.ignoreDuplicateRegistrations)return;pn(`Cannot register type '${$}' twice`)}if(Ta[p]=y,delete Fe[p],da.hasOwnProperty(p)){var F=da[p];delete da[p],F.forEach(q=>q())}}function zn(p,y,T={}){if(y.argPackAdvance===void 0)throw new TypeError("registerType registeredInstance requires argPackAdvance");return Ps(p,y,T)}var Yr=(p,y,T)=>{switch(y){case 1:return T?$=>re[$]:$=>he[$];case 2:return T?$=>ye[$>>1]:$=>$e[$>>1];case 4:return T?$=>_e[$>>2]:$=>de[$>>2];case 8:return T?$=>ve[$>>3]:$=>ie[$>>3];default:throw new TypeError(`invalid integer width (${y}): ${p}`)}},Jc=(p,y,T,$,F)=>{y=rr(y);var q=y.indexOf("u")!=-1;q&&(F=(1n<<64n)-1n),zn(p,{name:y,fromWireType:J=>J,toWireType:function(J,oe){if(typeof oe!="bigint"&&typeof oe!="number")throw new TypeError(`Cannot convert "${gi(oe)}" to ${this.name}`);if(typeof oe=="number"&&(oe=BigInt(oe)),oe<$||oe>F)throw new TypeError(`Passing a number "${gi(oe)}" from JS side to C/C++ side to an argument of type "${y}", which is outside the valid range [${$}, ${F}]!`);return oe},argPackAdvance:vi,readValueFromPointer:Yr(y,T,!q),destructorFunction:null})},vi=8,vo=(p,y,T,$)=>{y=rr(y),zn(p,{name:y,fromWireType:function(F){return!!F},toWireType:function(F,q){return q?T:$},argPackAdvance:vi,readValueFromPointer:function(F){return this.fromWireType(he[F])},destructorFunction:null})},Qc=p=>({count:p.count,deleteScheduled:p.deleteScheduled,preservePointerOnDelete:p.preservePointerOnDelete,ptr:p.ptr,ptrType:p.ptrType,smartPtr:p.smartPtr,smartPtrType:p.smartPtrType}),cr=p=>{function y(T){return T.$$.ptrType.registeredClass.name}pn(y(p)+" instance already deleted")},yo=!1,vl=p=>{},ed=p=>{p.smartPtr?p.smartPtrType.rawDestructor(p.smartPtr):p.ptrType.registeredClass.rawDestructor(p.ptr)},Rs=p=>{p.count.value-=1;var y=p.count.value===0;y&&ed(p)},Qa=(p,y,T)=>{if(y===T)return p;if(T.baseClass===void 0)return null;var $=Qa(p,y,T.baseClass);return $===null?null:T.downcast($)},kn={},_o={},yl=(p,y)=>{for(y===void 0&&pn("ptr should not be undefined");p.baseClass;)y=p.upcast(y),p=p.baseClass;return y},Cu=(p,y)=>(y=yl(p,y),_o[y]),$r=(p,y)=>{(!y.ptrType||!y.ptr)&&Sr("makeClassHandle requires ptr and ptrType");var T=!!y.smartPtrType,$=!!y.smartPtr;return T!==$&&Sr("Both smartPtrType and smartPtr must be specified"),y.count={value:1},Ds(Object.create(p,{$$:{value:y,writable:!0}}))};function es(p){var y=this.getPointee(p);if(!y)return this.destructor(p),null;var T=Cu(this.registeredClass,y);if(T!==void 0){if(T.$$.count.value===0)return T.$$.ptr=y,T.$$.smartPtr=p,T.clone();var $=T.clone();return this.destructor(p),$}function F(){return this.isSmartPointer?$r(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:y,smartPtrType:this,smartPtr:p}):$r(this.registeredClass.instancePrototype,{ptrType:this,ptr:p})}var q=this.registeredClass.getActualType(y),J=kn[q];if(!J)return F.call(this);var oe;this.isConst?oe=J.constPointerType:oe=J.pointerType;var Ce=Qa(y,this.registeredClass,oe.registeredClass);return Ce===null?F.call(this):this.isSmartPointer?$r(oe.registeredClass.instancePrototype,{ptrType:oe,ptr:Ce,smartPtrType:this,smartPtr:p}):$r(oe.registeredClass.instancePrototype,{ptrType:oe,ptr:Ce})}var Ds=p=>typeof FinalizationRegistry>"u"?(Ds=y=>y,p):(yo=new FinalizationRegistry(y=>{console.warn(y.leakWarning),Rs(y.$$)}),Ds=y=>{var T=y.$$,$=!!T.smartPtr;if($){var F={$$:T},q=T.ptrType.registeredClass,J=new Error(`Embind found a leaked C++ instance ${q.name} <${bn(T.ptr)}>.
We'll free it automatically in this case, but this functionality is not reliable across various environments.
Make sure to invoke .delete() manually once you're done with the instance instead.
Originally allocated`);"captureStackTrace"in Error&&Error.captureStackTrace(J,es),F.leakWarning=J.stack.replace(/^Error: /,""),yo.register(y,F,y)}return y},vl=y=>yo.unregister(y),Ds(p)),_t=()=>{let p=Pr.prototype;Object.assign(p,{isAliasOf(T){if(!(this instanceof Pr)||!(T instanceof Pr))return!1;var $=this.$$.ptrType.registeredClass,F=this.$$.ptr;T.$$=T.$$;for(var q=T.$$.ptrType.registeredClass,J=T.$$.ptr;$.baseClass;)F=$.upcast(F),$=$.baseClass;for(;q.baseClass;)J=q.upcast(J),q=q.baseClass;return $===q&&F===J},clone(){if(this.$$.ptr||cr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var T=Ds(Object.create(Object.getPrototypeOf(this),{$$:{value:Qc(this.$$)}}));return T.$$.count.value+=1,T.$$.deleteScheduled=!1,T},delete(){this.$$.ptr||cr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&pn("Object already scheduled for deletion"),vl(this),Rs(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||cr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&pn("Object already scheduled for deletion"),this.$$.deleteScheduled=!0,this}});const y=Symbol.dispose;y&&(p[y]=p.delete)};function Pr(){}var Ls=(p,y)=>Object.defineProperty(y,"name",{value:p}),zs=(p,y,T)=>{if(p[y].overloadTable===void 0){var $=p[y];p[y]=function(...F){return p[y].overloadTable.hasOwnProperty(F.length)||pn(`Function '${T}' called with an invalid number of arguments (${F.length}) - expects one of (${p[y].overloadTable})!`),p[y].overloadTable[F.length].apply(this,F)},p[y].overloadTable=[],p[y].overloadTable[$.argCount]=$}},Rr=(p,y,T)=>{n.hasOwnProperty(p)?(pn(`Cannot register public name '${p}' twice`),zs(n,p,p),n[p].overloadTable.hasOwnProperty(T)&&pn(`Cannot register multiple overloads of a function with the same number of arguments (${T})!`),n[p].overloadTable[T]=y):(n[p]=y,n[p].argCount=T)},qi=48,Hn=57,Au=p=>{G(typeof p=="string"),p=p.replace(/[^a-zA-Z0-9_]/g,"$");var y=p.charCodeAt(0);return y>=qi&&y<=Hn?`_${p}`:p};function ku(p,y,T,$,F,q,J,oe){this.name=p,this.constructor=y,this.instancePrototype=T,this.rawDestructor=$,this.baseClass=F,this.getActualType=q,this.upcast=J,this.downcast=oe,this.pureVirtualFunctions=[]}var ts=(p,y,T)=>{for(;y!==T;)y.upcast||pn(`Expected null or instance of ${T.name}, got an instance of ${y.name}`),p=y.upcast(p),y=y.baseClass;return p};function Iu(p,y){if(y===null)return this.isReference&&pn(`null is not a valid ${this.name}`),0;y.$$||pn(`Cannot pass "${gi(y)}" as a ${this.name}`),y.$$.ptr||pn(`Cannot pass deleted object as a pointer of type ${this.name}`);var T=y.$$.ptrType.registeredClass,$=ts(y.$$.ptr,T,this.registeredClass);return $}function Os(p,y){var T;if(y===null)return this.isReference&&pn(`null is not a valid ${this.name}`),this.isSmartPointer?(T=this.rawConstructor(),p!==null&&p.push(this.rawDestructor,T),T):0;(!y||!y.$$)&&pn(`Cannot pass "${gi(y)}" as a ${this.name}`),y.$$.ptr||pn(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&y.$$.ptrType.isConst&&pn(`Cannot convert argument of type ${y.$$.smartPtrType?y.$$.smartPtrType.name:y.$$.ptrType.name} to parameter type ${this.name}`);var $=y.$$.ptrType.registeredClass;if(T=ts(y.$$.ptr,$,this.registeredClass),this.isSmartPointer)switch(y.$$.smartPtr===void 0&&pn("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:y.$$.smartPtrType===this?T=y.$$.smartPtr:pn(`Cannot convert argument of type ${y.$$.smartPtrType?y.$$.smartPtrType.name:y.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:T=y.$$.smartPtr;break;case 2:if(y.$$.smartPtrType===this)T=y.$$.smartPtr;else{var F=y.clone();T=this.rawShare(T,yi.toHandle(()=>F.delete())),p!==null&&p.push(this.rawDestructor,T)}break;default:pn("Unsupporting sharing policy")}return T}function td(p,y){if(y===null)return this.isReference&&pn(`null is not a valid ${this.name}`),0;y.$$||pn(`Cannot pass "${gi(y)}" as a ${this.name}`),y.$$.ptr||pn(`Cannot pass deleted object as a pointer of type ${this.name}`),y.$$.ptrType.isConst&&pn(`Cannot convert argument of type ${y.$$.ptrType.name} to parameter type ${this.name}`);var T=y.$$.ptrType.registeredClass,$=ts(y.$$.ptr,T,this.registeredClass);return $}var $u=()=>{Object.assign(bo.prototype,{getPointee(p){return this.rawGetPointee&&(p=this.rawGetPointee(p)),p},destructor(p){var y;(y=this.rawDestructor)==null||y.call(this,p)},argPackAdvance:vi,readValueFromPointer:Gi,fromWireType:es})};function bo(p,y,T,$,F,q,J,oe,Ce,He,Ke){this.name=p,this.registeredClass=y,this.isReference=T,this.isConst=$,this.isSmartPointer=F,this.pointeeType=q,this.sharingPolicy=J,this.rawGetPointee=oe,this.rawConstructor=Ce,this.rawShare=He,this.rawDestructor=Ke,!F&&y.baseClass===void 0?$?(this.toWireType=Iu,this.destructorFunction=null):(this.toWireType=td,this.destructorFunction=null):this.toWireType=Os}var nd=(p,y,T)=>{n.hasOwnProperty(p)||Sr("Replacing nonexistent public symbol"),n[p].overloadTable!==void 0&&T!==void 0||(n[p]=y,n[p].argCount=T)},Pu=[],ns,Tn=p=>{var y=Pu[p];return y||(Pu[p]=y=ns.get(p)),G(ns.get(p)==y,"JavaScript-side Wasm function table mirror is out of date!"),y},qt=(p,y,T=!1)=>{G(!T,"Async bindings are only supported with JSPI."),p=rr(p);function $(){var q=Tn(y);return q}var F=$();return typeof F!="function"&&pn(`unknown function pointer with signature ${p}: ${y}`),F};class _l extends Error{}var Ns=p=>{var y=Np(p),T=rr(y);return Jr(y),T},fa=(p,y)=>{var T=[],$={};function F(q){if(!$[q]&&!Ta[q]){if(Fe[q]){Fe[q].forEach(F);return}T.push(q),$[q]=!0}}throw y.forEach(F),new _l(`${p}: `+T.map(Ns).join([", "]))},Ru=(p,y,T,$,F,q,J,oe,Ce,He,Ke,st,wt)=>{Ke=rr(Ke),q=qt(F,q),oe&&(oe=qt(J,oe)),He&&(He=qt(Ce,He)),wt=qt(st,wt);var ot=Au(Ke);Rr(ot,function(){fa(`Cannot construct ${Ke} due to unbound types`,[$])}),Wn([p,y,T],$?[$]:[],$t=>{var dr;$t=$t[0];var jt,En;$?(jt=$t.registeredClass,En=jt.instancePrototype):En=Pr.prototype;var mn=Ls(Ke,function(...Xi){if(Object.getPrototypeOf(this)!==Dn)throw new Ct(`Use 'new' to construct ${Ke}`);if(Nn.constructor_body===void 0)throw new Ct(`${Ke} has no accessible constructor`);var bd=Nn.constructor_body[Xi.length];if(bd===void 0)throw new Ct(`Tried to invoke ctor of ${Ke} with invalid number of parameters (${Xi.length}) - expected (${Object.keys(Nn.constructor_body).toString()}) parameters instead!`);return bd.apply(this,Xi)}),Dn=Object.create(En,{constructor:{value:mn}});mn.prototype=Dn;var Nn=new ku(Ke,mn,Dn,wt,jt,q,oe,He);Nn.baseClass&&((dr=Nn.baseClass).__derivedClasses??(dr.__derivedClasses=[]),Nn.baseClass.__derivedClasses.push(Nn));var ji=new bo(Ke,Nn,!0,!1,!1),Qr=new bo(Ke+"*",Nn,!1,!1,!1),Ia=new bo(Ke+" const*",Nn,!1,!0,!1);return kn[p]={pointerType:Qr,constPointerType:Ia},nd(ot,mn),[ji,Qr,Ia]})};function Du(p){for(var y=1;y<p.length;++y)if(p[y]!==null&&p[y].destructorFunction===void 0)return!0;return!1}function xo(p,y,T,$,F){if(p<y||p>T){var q=y==T?y:`${y} to ${T}`;F(`function ${$} called with ${p} arguments, expected ${q}`)}}function rd(p,y,T,$){var F=Du(p),q=p.length-2,J=[],oe=["fn"];y&&oe.push("thisWired");for(var Ce=0;Ce<q;++Ce)J.push(`arg${Ce}`),oe.push(`arg${Ce}Wired`);J=J.join(","),oe=oe.join(",");var He=`return function (${J}) {
`;He+=`checkArgCount(arguments.length, minArgs, maxArgs, humanName, throwBindingError);
`,F&&(He+=`var destructors = [];
`);var Ke=F?"destructors":"null",st=["humanName","throwBindingError","invoker","fn","runDestructors","retType","classParam"];y&&(He+=`var thisWired = classParam['toWireType'](${Ke}, this);
`);for(var Ce=0;Ce<q;++Ce)He+=`var arg${Ce}Wired = argType${Ce}['toWireType'](${Ke}, arg${Ce});
`,st.push(`argType${Ce}`);if(He+=(T||$?"var rv = ":"")+`invoker(${oe});
`,F)He+=`runDestructors(destructors);
`;else for(var Ce=y?1:2;Ce<p.length;++Ce){var wt=Ce===1?"thisWired":"arg"+(Ce-2)+"Wired";p[Ce].destructorFunction!==null&&(He+=`${wt}_dtor(${wt});
`,st.push(`${wt}_dtor`))}return T&&(He+=`var ret = retType['fromWireType'](rv);
return ret;
`),He+=`}
`,st.push("checkArgCount","minArgs","maxArgs"),He=`if (arguments.length !== ${st.length}){ throw new Error(humanName + "Expected ${st.length} closure arguments " + arguments.length + " given."); }
${He}`,[st,He]}function Lu(p){for(var y=p.length-2,T=p.length-1;T>=2&&p[T].optional;--T)y--;return y}function Ca(p,y,T,$,F,q){var J=y.length;J<2&&pn("argTypes array size mismatch! Must at least get return value and 'this' types!"),G(!q,"Async bindings are only supported with JSPI.");for(var oe=y[1]!==null&&T!==null,Ce=Du(y),He=y[0].name!=="void",Ke=J-2,st=Lu(y),wt=[p,pn,$,F,Ea,y[0],y[1]],ot=0;ot<J-2;++ot)wt.push(y[ot+2]);if(!Ce)for(var ot=oe?1:2;ot<y.length;++ot)y[ot].destructorFunction!==null&&wt.push(y[ot].destructorFunction);wt.push(xo,st,Ke);let[$t,jt]=rd(y,oe,He,q);var En=new Function(...$t,jt)(...wt);return Ls(p,En)}var Aa=(p,y)=>{for(var T=[],$=0;$<p;$++)T.push(de[y+$*4>>2]);return T},bl=p=>{p=p.trim();const y=p.indexOf("(");return y===-1?p:(G(p.endsWith(")"),"Parentheses for argument names should match."),p.slice(0,y))},id=(p,y,T,$,F,q,J,oe,Ce)=>{var He=Aa(T,$);y=rr(y),y=bl(y),q=qt(F,q,oe),Wn([],[p],Ke=>{Ke=Ke[0];var st=`${Ke.name}.${y}`;function wt(){fa(`Cannot call ${st} due to unbound types`,He)}y.startsWith("@@")&&(y=Symbol[y.substring(2)]);var ot=Ke.registeredClass.constructor;return ot[y]===void 0?(wt.argCount=T-1,ot[y]=wt):(zs(ot,y,st),ot[y].overloadTable[T-1]=wt),Wn([],He,$t=>{var jt=[$t[0],null].concat($t.slice(1)),En=Ca(st,jt,null,q,J,oe);if(ot[y].overloadTable===void 0?(En.argCount=T-1,ot[y]=En):ot[y].overloadTable[T-1]=En,Ke.registeredClass.__derivedClasses)for(const mn of Ke.registeredClass.__derivedClasses)mn.constructor.hasOwnProperty(y)||(mn.constructor[y]=En);return[]}),[]})},zu=(p,y,T,$,F,q)=>{G(y>0);var J=Aa(y,T);F=qt($,F),Wn([],[p],oe=>{oe=oe[0];var Ce=`constructor ${oe.name}`;if(oe.registeredClass.constructor_body===void 0&&(oe.registeredClass.constructor_body=[]),oe.registeredClass.constructor_body[y-1]!==void 0)throw new Ct(`Cannot register multiple constructors with identical number of parameters (${y-1}) for class '${oe.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return oe.registeredClass.constructor_body[y-1]=()=>{fa(`Cannot construct ${oe.name} due to unbound types`,J)},Wn([],J,He=>(He.splice(1,0,null),oe.registeredClass.constructor_body[y-1]=Ca(Ce,He,null,F,q),[])),[]})},wo=(p,y,T,$,F,q,J,oe,Ce,He)=>{var Ke=Aa(T,$);y=rr(y),y=bl(y),q=qt(F,q,Ce),Wn([],[p],st=>{st=st[0];var wt=`${st.name}.${y}`;y.startsWith("@@")&&(y=Symbol[y.substring(2)]),oe&&st.registeredClass.pureVirtualFunctions.push(y);function ot(){fa(`Cannot call ${wt} due to unbound types`,Ke)}var $t=st.registeredClass.instancePrototype,jt=$t[y];return jt===void 0||jt.overloadTable===void 0&&jt.className!==st.name&&jt.argCount===T-2?(ot.argCount=T-2,ot.className=st.name,$t[y]=ot):(zs($t,y,wt),$t[y].overloadTable[T-2]=ot),Wn([],Ke,En=>{var mn=Ca(wt,En,st,q,J,Ce);return $t[y].overloadTable===void 0?(mn.argCount=T-2,$t[y]=mn):$t[y].overloadTable[T-2]=mn,[]}),[]})},rs=(p,y,T)=>(p instanceof Object||pn(`${T} with invalid "this": ${p}`),p instanceof y.registeredClass.constructor||pn(`${T} incompatible with "this" of type ${p.constructor.name}`),p.$$.ptr||pn(`cannot call emscripten binding method ${T} on deleted object`),ts(p.$$.ptr,p.$$.ptrType.registeredClass,y.registeredClass)),xl=(p,y,T,$,F,q,J,oe,Ce,He)=>{y=rr(y),F=qt($,F),Wn([],[p],Ke=>{Ke=Ke[0];var st=`${Ke.name}.${y}`,wt={get(){fa(`Cannot access ${st} due to unbound types`,[T,J])},enumerable:!0,configurable:!0};return Ce?wt.set=()=>fa(`Cannot access ${st} due to unbound types`,[T,J]):wt.set=ot=>pn(st+" is a read-only property"),Object.defineProperty(Ke.registeredClass.instancePrototype,y,wt),Wn([],Ce?[T,J]:[T],ot=>{var $t=ot[0],jt={get(){var mn=rs(this,Ke,st+" getter");return $t.fromWireType(F(q,mn))},enumerable:!0};if(Ce){Ce=qt(oe,Ce);var En=ot[1];jt.set=function(mn){var Dn=rs(this,Ke,st+" setter"),Nn=[];Ce(He,Dn,En.toWireType(Nn,mn)),Ea(Nn)}}return Object.defineProperty(Ke.registeredClass.instancePrototype,y,jt),[]}),[]})},So=[],Zr=[],ha=p=>{p>9&&--Zr[p+1]===0&&(G(Zr[p]!==void 0,"Decref for unallocated handle."),Zr[p]=void 0,So.push(p))},Mo=()=>Zr.length/2-5-So.length,wl=()=>{Zr.push(0,1,void 0,1,null,1,!0,1,!1,1),G(Zr.length===10),n.count_emval_handles=Mo},yi={toValue:p=>(p||pn(`Cannot use deleted val. handle = ${p}`),G(p===2||Zr[p]!==void 0&&p%2===0,`invalid handle: ${p}`),Zr[p]),toHandle:p=>{switch(p){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const y=So.pop()||Zr.length;return Zr[y]=p,Zr[y+1]=1,y}}}},Sl={name:"emscripten::val",fromWireType:p=>{var y=yi.toValue(p);return ha(p),y},toWireType:(p,y)=>yi.toHandle(y),argPackAdvance:vi,readValueFromPointer:Gi,destructorFunction:null},Ml=p=>zn(p,Sl),is=(p,y,T)=>{switch(y){case 1:return T?function($){return this.fromWireType(re[$])}:function($){return this.fromWireType(he[$])};case 2:return T?function($){return this.fromWireType(ye[$>>1])}:function($){return this.fromWireType($e[$>>1])};case 4:return T?function($){return this.fromWireType(_e[$>>2])}:function($){return this.fromWireType(de[$>>2])};default:throw new TypeError(`invalid integer width (${y}): ${p}`)}},Ft=(p,y,T,$)=>{y=rr(y);function F(){}F.values={},zn(p,{name:y,constructor:F,fromWireType:function(q){return this.constructor.values[q]},toWireType:(q,J)=>J.value,argPackAdvance:vi,readValueFromPointer:is(y,T,$),destructorFunction:null}),Rr(y,F)},Bs=(p,y)=>{var T=Ta[p];return T===void 0&&pn(`${y} has unknown type ${Ns(p)}`),T},Fs=(p,y,T)=>{var $=Bs(p,"enum");y=rr(y);var F=$.constructor,q=Object.create($.constructor.prototype,{value:{value:T},constructor:{value:Ls(`${$.name}_${y}`,function(){})}});F.values[T]=q,F[y]=q},Ou=(p,y)=>{switch(y){case 4:return function(T){return this.fromWireType(Oe[T>>2])};case 8:return function(T){return this.fromWireType(Pe[T>>3])};default:throw new TypeError(`invalid float width (${y}): ${p}`)}},Eo=(p,y,T)=>{y=rr(y),zn(p,{name:y,fromWireType:$=>$,toWireType:($,F)=>{if(typeof F!="number"&&typeof F!="boolean")throw new TypeError(`Cannot convert ${gi(F)} to ${this.name}`);return F},argPackAdvance:vi,readValueFromPointer:Ou(y,T),destructorFunction:null})},_i=(p,y,T,$,F)=>{y=rr(y),F===-1&&(F=4294967295);var q=Ke=>Ke;if($===0){var J=32-8*T;q=Ke=>Ke<<J>>>J}var oe=y.includes("unsigned"),Ce=(Ke,st)=>{if(typeof Ke!="number"&&typeof Ke!="boolean")throw new TypeError(`Cannot convert "${gi(Ke)}" to ${st}`);if(Ke<$||Ke>F)throw new TypeError(`Passing a number "${gi(Ke)}" from JS side to C/C++ side to an argument of type "${y}", which is outside the valid range [${$}, ${F}]!`)},He;oe?He=function(Ke,st){return Ce(st,this.name),st>>>0}:He=function(Ke,st){return Ce(st,this.name),st},zn(p,{name:y,fromWireType:q,toWireType:He,argPackAdvance:vi,readValueFromPointer:Yr(y,T,$!==0),destructorFunction:null})},as=(p,y,T)=>{var $=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array],F=$[y];function q(J){var oe=de[J>>2],Ce=de[J+4>>2];return new F(re.buffer,Ce,oe)}T=rr(T),zn(p,{name:T,fromWireType:q,argPackAdvance:vi,readValueFromPointer:q},{ignoreDuplicateRegistrations:!0})},Us=Object.assign({optional:!0},Sl),To=(p,y)=>{zn(p,Us)},pa=(p,y,T)=>(G(typeof T=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),Ur(p,he,y,T)),El=(p,y)=>{y=rr(y),zn(p,{name:y,fromWireType(T){for(var $=de[T>>2],F=T+4,q,J,oe=F,J=0;J<=$;++J){var Ce=F+J;if(J==$||he[Ce]==0){var He=Ce-oe,Ke=ft(oe,He);q===void 0?q=Ke:(q+="\0",q+=Ke),oe=Ce+1}}return Jr(T),q},toWireType(T,$){$ instanceof ArrayBuffer&&($=new Uint8Array($));var F,q=typeof $=="string";q||ArrayBuffer.isView($)&&$.BYTES_PER_ELEMENT==1||pn("Cannot pass non-string to std::string"),q?F=ur($):F=$.length;var J=Li(4+F+1),oe=J+4;return de[J>>2]=F,q?pa($,oe,F+1):he.set($,oe),T!==null&&T.push(Jr,J),J},argPackAdvance:vi,readValueFromPointer:Gi,destructorFunction(T){Jr(T)}})},Co=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Tl=(p,y)=>{G(p%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");for(var T=p,$=T>>1,F=$+y/2;!($>=F)&&$e[$];)++$;if(T=$<<1,T-p>32&&Co)return Co.decode(he.subarray(p,T));for(var q="",J=0;!(J>=y/2);++J){var oe=ye[p+J*2>>1];if(oe==0)break;q+=String.fromCharCode(oe)}return q},ss=(p,y,T)=>{if(G(y%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!"),G(typeof T=="number","stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),T??(T=2147483647),T<2)return 0;T-=2;for(var $=y,F=T<p.length*2?T/2:p.length,q=0;q<F;++q){var J=p.charCodeAt(q);ye[y>>1]=J,y+=2}return ye[y>>1]=0,y-$},Nu=p=>p.length*2,Ao=(p,y)=>{G(p%4==0,"Pointer passed to UTF32ToString must be aligned to four bytes!");for(var T=0,$="";!(T>=y/4);){var F=_e[p+T*4>>2];if(F==0)break;if(++T,F>=65536){var q=F-65536;$+=String.fromCharCode(55296|q>>10,56320|q&1023)}else $+=String.fromCharCode(F)}return $},Cl=(p,y,T)=>{if(G(y%4==0,"Pointer passed to stringToUTF32 must be aligned to four bytes!"),G(typeof T=="number","stringToUTF32(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),T??(T=2147483647),T<4)return 0;for(var $=y,F=$+T-4,q=0;q<p.length;++q){var J=p.charCodeAt(q);if(J>=55296&&J<=57343){var oe=p.charCodeAt(++q);J=65536+((J&1023)<<10)|oe&1023}if(_e[y>>2]=J,y+=4,y+4>F)break}return _e[y>>2]=0,y-$},ko=p=>{for(var y=0,T=0;T<p.length;++T){var $=p.charCodeAt(T);$>=55296&&$<=57343&&++T,y+=4}return y},Bu=(p,y,T)=>{T=rr(T);var $,F,q,J;y===2?($=Tl,F=ss,J=Nu,q=oe=>$e[oe>>1]):y===4&&($=Ao,F=Cl,J=ko,q=oe=>de[oe>>2]),zn(p,{name:T,fromWireType:oe=>{for(var Ce=de[oe>>2],He,Ke=oe+4,st=0;st<=Ce;++st){var wt=oe+4+st*y;if(st==Ce||q(wt)==0){var ot=wt-Ke,$t=$(Ke,ot);He===void 0?He=$t:(He+="\0",He+=$t),Ke=wt+y}}return Jr(oe),He},toWireType:(oe,Ce)=>{typeof Ce!="string"&&pn(`Cannot pass non-string to C++ string type ${T}`);var He=J(Ce),Ke=Li(4+He+y);return de[Ke>>2]=He/y,F(Ce,Ke+4,He+y),oe!==null&&oe.push(Jr,Ke),Ke},argPackAdvance:vi,readValueFromPointer:Gi,destructorFunction(oe){Jr(oe)}})},Al=(p,y,T,$,F,q)=>{go[p]={name:rr(y),rawConstructor:qt(T,$),rawDestructor:qt(F,q),fields:[]}},kl=(p,y,T,$,F,q,J,oe,Ce,He)=>{go[p].fields.push({fieldName:rr(y),getterReturnType:T,getter:qt($,F),getterContext:q,setterArgumentType:J,setter:qt(oe,Ce),setterContext:He})},Fu=(p,y)=>{y=rr(y),zn(p,{isVoid:!0,name:y,argPackAdvance:0,fromWireType:()=>{},toWireType:(T,$)=>{}})},Di=()=>{throw new ze},Il=(p,y,T)=>{var $=[],F=p.toWireType($,T);return $.length&&(de[y>>2]=yi.toHandle($)),F},M=(p,y,T)=>(p=yi.toValue(p),y=Bs(y,"emval::as"),Il(y,T,p)),L=(p,y)=>(p=yi.toValue(p),y=yi.toValue(y),yi.toHandle(p[y])),H={},Z=p=>{var y=H[p];return y===void 0?rr(p):y},ae=p=>yi.toHandle(Z(p)),Ae=p=>{var y=yi.toValue(p);Ea(y),ha(p)},Qe=(p,y)=>{p=Bs(p,"_emval_take_value");var T=p.readValueFromPointer(y);return yi.toHandle(T)},mt=p=>p%4===0&&(p%100!==0||p%400===0),St=[0,31,60,91,121,152,182,213,244,274,305,335],It=[0,31,59,90,120,151,181,212,243,273,304,334],Zt=p=>{var y=mt(p.getFullYear()),T=y?St:It,$=T[p.getMonth()]+p.getDate()-1;return $},un=9007199254740992,Un=-9007199254740992,Gn=p=>p<Un||p>un?NaN:Number(p);function ka(p,y){p=Gn(p);var T=new Date(p*1e3);_e[y>>2]=T.getSeconds(),_e[y+4>>2]=T.getMinutes(),_e[y+8>>2]=T.getHours(),_e[y+12>>2]=T.getDate(),_e[y+16>>2]=T.getMonth(),_e[y+20>>2]=T.getFullYear()-1900,_e[y+24>>2]=T.getDay();var $=Zt(T)|0;_e[y+28>>2]=$,_e[y+36>>2]=-(T.getTimezoneOffset()*60);var F=new Date(T.getFullYear(),0,1),q=new Date(T.getFullYear(),6,1).getTimezoneOffset(),J=F.getTimezoneOffset(),oe=(q!=J&&T.getTimezoneOffset()==Math.min(J,q))|0;_e[y+32>>2]=oe}var ad=(p,y,T,$)=>{var F=new Date().getFullYear(),q=new Date(F,0,1),J=new Date(F,6,1),oe=q.getTimezoneOffset(),Ce=J.getTimezoneOffset(),He=Math.max(oe,Ce);de[p>>2]=He*60,_e[y>>2]=+(oe!=Ce);var Ke=ot=>{var $t=ot>=0?"-":"+",jt=Math.abs(ot),En=String(Math.floor(jt/60)).padStart(2,"0"),mn=String(jt%60).padStart(2,"0");return`UTC${$t}${En}${mn}`},st=Ke(oe),wt=Ke(Ce);G(st),G(wt),G(ur(st)<=16,`timezone name truncated to fit in TZNAME_MAX (${st})`),G(ur(wt)<=16,`timezone name truncated to fit in TZNAME_MAX (${wt})`),Ce<oe?(pa(st,T,17),pa(wt,$,17)):(pa(st,$,17),pa(wt,T,17))},sd=()=>performance.now(),Gf=()=>Date.now(),qf=p=>p>=0&&p<=3;function jf(p,y,T){if(!qf(p))return 28;var $;p===0?$=Gf():$=sd();var F=Math.round($*1e3*1e3);return ve[T>>3]=BigInt(F),0}var Uu=()=>2147483648,Xf=()=>Uu(),Kf=(p,y)=>(G(y,"alignment argument is required"),Math.ceil(p/y)*y),Yf=p=>{var y=Y.buffer,T=(p-y.byteLength+65535)/65536|0;try{return Y.grow(T),gt(),1}catch($){P(`growMemory: Attempted to grow heap from ${y.byteLength} bytes to ${p} bytes, but got error: ${$}`)}},Zf=p=>{var y=he.length;p>>>=0,G(p>y);var T=Uu();if(p>T)return P(`Cannot enlarge memory, requested ${p} bytes, but the limit is ${T} bytes!`),!1;for(var $=1;$<=4;$*=2){var F=y*(1+.2/$);F=Math.min(F,p+100663296);var q=Math.min(T,Kf(Math.max(p,F),65536)),J=Yf(q);if(J)return!0}return P(`Failed to grow the heap from ${y} bytes to ${q} bytes, not enough memory!`),!1},$l={},od=()=>h||"./this.program",Io=()=>{if(!Io.strings){var p=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",y={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:p,_:od()};for(var T in $l)$l[T]===void 0?delete y[T]:y[T]=$l[T];var $=[];for(var T in y)$.push(`${T}=${y[T]}`);Io.strings=$}return Io.strings},Jf=(p,y)=>{var T=0,$=0;for(var F of Io()){var q=y+T;de[p+$>>2]=q,T+=pa(F,q,1/0)+1,$+=4}return 0},Qf=(p,y)=>{var T=Io();de[p>>2]=T.length;var $=0;for(var F of T)$+=ur(F)+1;return de[y>>2]=$,0},eh=0,Vu=()=>mr||eh>0,th=p=>{var y;Q=p,Vu()||((y=n.onExit)==null||y.call(n,p),fe=!0),v(p,new it(p))},ld=(p,y)=>{if(Q=p,Ue(),Vu()&&!y){var T=`program exited (with status: ${p}), but keepRuntimeAlive() is set (counter=${eh}) due to an async operation, so halting execution but not exiting the runtime or preventing further async execution (you can use emscripten_force_exit, if you want to force a true shutdown)`;i(T),P(T)}th(p)},nh=ld;function $o(p){try{var y=Zn.getStreamFromFD(p);return j.close(y),0}catch(T){if(typeof j>"u"||T.name!=="ErrnoError")throw T;return T.errno}}var Pl=(p,y,T,$)=>{for(var F=0,q=0;q<T;q++){var J=de[y>>2],oe=de[y+4>>2];y+=8;var Ce=j.read(p,re,J,oe,$);if(Ce<0)return-1;if(F+=Ce,Ce<oe)break}return F};function Rp(p,y,T,$){try{var F=Zn.getStreamFromFD(p),q=Pl(F,y,T);return de[$>>2]=q,0}catch(J){if(typeof j>"u"||J.name!=="ErrnoError")throw J;return J.errno}}function Dp(p,y,T,$){y=Gn(y);try{if(isNaN(y))return 61;var F=Zn.getStreamFromFD(p);return j.llseek(F,y,T),ve[$>>3]=BigInt(F.position),F.getdents&&y===0&&T===0&&(F.getdents=null),0}catch(q){if(typeof j>"u"||q.name!=="ErrnoError")throw q;return q.errno}}var rh=(p,y,T,$)=>{for(var F=0,q=0;q<T;q++){var J=de[y>>2],oe=de[y+4>>2];y+=8;var Ce=j.write(p,re,J,oe,$);if(Ce<0)return-1;if(F+=Ce,Ce<oe)break}return F};function te(p,y,T,$){try{var F=Zn.getStreamFromFD(p),q=rh(F,y,T);return de[$>>2]=q,0}catch(J){if(typeof j>"u"||J.name!=="ErrnoError")throw J;return J.errno}}var ih=p=>{if(p instanceof it||p=="unwind")return Q;ge(),p instanceof WebAssembly.RuntimeError&&pd()<=0&&P("Stack overflow detected.  You can try increasing -sSTACK_SIZE (currently set to 65536)"),v(1,p)},Hu=p=>Up(p),ah=p=>{var y=ur(p)+1,T=Hu(y);return pa(p,T,y),T},sh=(...p)=>j.createPath(...p),Lp=(...p)=>j.unlink(...p),oh=(...p)=>j.createLazyFile(...p),zp=(...p)=>j.createDevice(...p),lh=p=>mh(p),ud=p=>ph(p),cd=p=>{var y=ln(),T=Hu(4),$=Hu(4);Vp(p,T,$);var F=de[T>>2],q=de[$>>2],J=ft(F);Jr(F);var oe;return q&&(oe=ft(q),Jr(q)),Yt(y),[J,oe]},dd=p=>cd(p);j.createPreloadedFile=hl,j.staticInit(),gl(),_t(),$u(),wl(),n.noExitRuntime&&(mr=n.noExitRuntime),n.preloadPlugins&&(ua=n.preloadPlugins),n.print&&(V=n.print),n.printErr&&(P=n.printErr),n.wasmBinary&&(U=n.wasmBinary),Op(),n.arguments&&(d=n.arguments),n.thisProgram&&(h=n.thisProgram),G(typeof n.memoryInitializerPrefixURL>"u","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),G(typeof n.pthreadMainPrefixURL>"u","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),G(typeof n.cdInitializerPrefixURL>"u","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),G(typeof n.filePackagePrefixURL>"u","Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),G(typeof n.read>"u","Module.read option was removed"),G(typeof n.readAsync>"u","Module.readAsync option was removed (modify readAsync in JS)"),G(typeof n.readBinary>"u","Module.readBinary option was removed (modify readBinary in JS)"),G(typeof n.setWindowTitle>"u","Module.setWindowTitle option was removed (modify emscripten_set_window_title in JS)"),G(typeof n.TOTAL_MEMORY>"u","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),G(typeof n.ENVIRONMENT>"u","Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)"),G(typeof n.STACK_SIZE>"u","STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time"),G(typeof n.wasmMemory>"u","Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally"),G(typeof n.INITIAL_MEMORY>"u","Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically"),n.addRunDependency=xt,n.removeRunDependency=be,n.FS_createPreloadedFile=hl,n.FS_unlink=Lp,n.FS_createPath=sh,n.FS_createDevice=zp,n.FS=j,n.FS_createDataFile=Ya,n.FS_createLazyFile=oh,n.MEMFS=zt;var uh=["writeI53ToI64","writeI53ToI64Clamped","writeI53ToI64Signaling","writeI53ToU64Clamped","writeI53ToU64Signaling","readI53FromI64","readI53FromU64","convertI32PairToI53","convertI32PairToI53Checked","convertU32PairToI53","getTempRet0","zeroMemory","inetPton4","inetNtop4","inetPton6","inetNtop6","readSockaddr","writeSockaddr","emscriptenLog","readEmAsmArgs","jstoi_q","listenOnce","autoResumeAudioContext","getDynCaller","dynCall","runtimeKeepalivePush","runtimeKeepalivePop","callUserCallback","maybeExit","asmjsMangle","HandleAllocator","getNativeTypeSize","addOnInit","addOnPostCtor","addOnPreMain","addOnExit","STACK_SIZE","STACK_ALIGN","POINTER_SIZE","ASSERTIONS","getCFunc","ccall","cwrap","uleb128Encode","sigToWasmTypes","generateFuncType","convertJsFunctionToWasm","getEmptyTableSlot","updateTableMap","getFunctionAddress","addFunction","removeFunction","reallyNegative","unSign","strLen","reSign","formatString","intArrayToString","AsciiToString","stringToAscii","stringToNewUTF8","writeArrayToMemory","registerKeyEventCallback","maybeCStringToJsString","findEventTarget","getBoundingClientRect","fillMouseEventData","registerMouseEventCallback","registerWheelEventCallback","registerUiEventCallback","registerFocusEventCallback","fillDeviceOrientationEventData","registerDeviceOrientationEventCallback","fillDeviceMotionEventData","registerDeviceMotionEventCallback","screenOrientation","fillOrientationChangeEventData","registerOrientationChangeEventCallback","fillFullscreenChangeEventData","registerFullscreenChangeEventCallback","JSEvents_requestFullscreen","JSEvents_resizeCanvasForFullscreen","registerRestoreOldStyle","hideEverythingExceptGivenElement","restoreHiddenElements","setLetterbox","softFullscreenResizeWebGLRenderTarget","doRequestFullscreen","fillPointerlockChangeEventData","registerPointerlockChangeEventCallback","registerPointerlockErrorEventCallback","requestPointerLock","fillVisibilityChangeEventData","registerVisibilityChangeEventCallback","registerTouchEventCallback","fillGamepadEventData","registerGamepadEventCallback","registerBeforeUnloadEventCallback","fillBatteryEventData","battery","registerBatteryEventCallback","setCanvasElementSize","getCanvasElementSize","jsStackTrace","getCallstack","convertPCtoSourceLocation","wasiRightsToMuslOFlags","wasiOFlagsToMuslOFlags","safeSetTimeout","setImmediateWrapped","safeRequestAnimationFrame","clearImmediateWrapped","registerPostMainLoop","registerPreMainLoop","getPromise","makePromise","idsToPromises","makePromiseCallback","Browser_asyncPrepareDataCounter","arraySum","addDays","getSocketFromFD","getSocketAddress","FS_mkdirTree","_setNetworkCallback","heapObjectForWebGLType","toTypedArrayIndex","webgl_enable_ANGLE_instanced_arrays","webgl_enable_OES_vertex_array_object","webgl_enable_WEBGL_draw_buffers","webgl_enable_WEBGL_multi_draw","webgl_enable_EXT_polygon_offset_clamp","webgl_enable_EXT_clip_control","webgl_enable_WEBGL_polygon_mode","emscriptenWebGLGet","computeUnpackAlignedImageSize","colorChannelsInGlTextureFormat","emscriptenWebGLGetTexPixelData","emscriptenWebGLGetUniform","webglGetUniformLocation","webglPrepareUniformLocationsBeforeFirstUse","webglGetLeftBracePos","emscriptenWebGLGetVertexAttrib","__glGetActiveAttribOrUniform","writeGLArray","registerWebGlEventCallback","runAndAbortIfError","ALLOC_NORMAL","ALLOC_STACK","allocate","writeStringToMemory","writeAsciiToMemory","demangle","stackTrace","getFunctionArgsName","createJsInvokerSignature","PureVirtualError","registerInheritedInstance","unregisterInheritedInstance","getInheritedInstanceCount","getLiveInheritedInstances","setDelayFunction","emval_get_global","emval_lookupTypes","emval_addMethodCaller"];uh.forEach(Ze);var ch=["run","out","err","callMain","abort","wasmMemory","wasmExports","HEAPF32","HEAPF64","HEAP8","HEAPU8","HEAP16","HEAPU16","HEAP32","HEAPU32","HEAP64","HEAPU64","writeStackCookie","checkStackCookie","INT53_MAX","INT53_MIN","bigintToI53Checked","stackSave","stackRestore","stackAlloc","setTempRet0","ptrToString","exitJS","getHeapMax","growMemory","ENV","ERRNO_CODES","strError","DNS","Protocols","Sockets","timers","warnOnce","readEmAsmArgsArray","getExecutableName","handleException","keepRuntimeAlive","asyncLoad","alignMemory","mmapAlloc","wasmTable","noExitRuntime","addOnPreRun","addOnPostRun","freeTableIndexes","functionsInTableMap","setValue","getValue","PATH","PATH_FS","UTF8Decoder","UTF8ArrayToString","UTF8ToString","stringToUTF8Array","stringToUTF8","lengthBytesUTF8","intArrayFromString","UTF16Decoder","UTF16ToString","stringToUTF16","lengthBytesUTF16","UTF32ToString","stringToUTF32","lengthBytesUTF32","stringToUTF8OnStack","JSEvents","specialHTMLTargets","findCanvasEventTarget","currentFullscreenStrategy","restoreOldWindowedStyle","UNWIND_CACHE","ExitStatus","getEnvStrings","checkWasiClock","doReadv","doWritev","initRandomFill","randomFill","emSetImmediate","emClearImmediate_deps","emClearImmediate","promiseMap","uncaughtExceptionCount","exceptionLast","exceptionCaught","ExceptionInfo","findMatchingCatch","getExceptionMessageCommon","Browser","getPreloadedImageData__data","wget","MONTH_DAYS_REGULAR","MONTH_DAYS_LEAP","MONTH_DAYS_REGULAR_CUMULATIVE","MONTH_DAYS_LEAP_CUMULATIVE","isLeapYear","ydayFromDate","SYSCALLS","preloadPlugins","FS_modeStringToFlags","FS_getMode","FS_stdin_getChar_buffer","FS_stdin_getChar","FS_readFile","FS_root","FS_mounts","FS_devices","FS_streams","FS_nextInode","FS_nameTable","FS_currentPath","FS_initialized","FS_ignorePermissions","FS_filesystems","FS_syncFSRequests","FS_readFiles","FS_lookupPath","FS_getPath","FS_hashName","FS_hashAddNode","FS_hashRemoveNode","FS_lookupNode","FS_createNode","FS_destroyNode","FS_isRoot","FS_isMountpoint","FS_isFile","FS_isDir","FS_isLink","FS_isChrdev","FS_isBlkdev","FS_isFIFO","FS_isSocket","FS_flagsToPermissionString","FS_nodePermissions","FS_mayLookup","FS_mayCreate","FS_mayDelete","FS_mayOpen","FS_checkOpExists","FS_nextfd","FS_getStreamChecked","FS_getStream","FS_createStream","FS_closeStream","FS_dupStream","FS_doSetAttr","FS_chrdev_stream_ops","FS_major","FS_minor","FS_makedev","FS_registerDevice","FS_getDevice","FS_getMounts","FS_syncfs","FS_mount","FS_unmount","FS_lookup","FS_mknod","FS_statfs","FS_statfsStream","FS_statfsNode","FS_create","FS_mkdir","FS_mkdev","FS_symlink","FS_rename","FS_rmdir","FS_readdir","FS_readlink","FS_stat","FS_fstat","FS_lstat","FS_doChmod","FS_chmod","FS_lchmod","FS_fchmod","FS_doChown","FS_chown","FS_lchown","FS_fchown","FS_doTruncate","FS_truncate","FS_ftruncate","FS_utime","FS_open","FS_close","FS_isClosed","FS_llseek","FS_read","FS_write","FS_mmap","FS_msync","FS_ioctl","FS_writeFile","FS_cwd","FS_chdir","FS_createDefaultDirectories","FS_createDefaultDevices","FS_createSpecialDirectories","FS_createStandardStreams","FS_staticInit","FS_init","FS_quit","FS_findObject","FS_analyzePath","FS_createFile","FS_forceLoadFile","FS_absolutePath","FS_createFolder","FS_createLink","FS_joinPath","FS_mmapAlloc","FS_standardizePath","TTY","PIPEFS","SOCKFS","tempFixedLengthArray","miniTempWebGLFloatBuffers","miniTempWebGLIntBuffers","GL","AL","GLUT","EGL","GLEW","IDBStore","SDL","SDL_gfx","allocateUTF8","allocateUTF8OnStack","print","printErr","jstoi_s","InternalError","BindingError","throwInternalError","throwBindingError","registeredTypes","awaitingDependencies","typeDependencies","tupleRegistrations","structRegistrations","sharedRegisterType","whenDependentTypesAreResolved","embind_charCodes","embind_init_charCodes","readLatin1String","getTypeName","getFunctionName","heap32VectorToArray","requireRegisteredType","usesDestructorStack","checkArgCount","getRequiredArgCount","createJsInvoker","UnboundTypeError","GenericWireTypeSize","EmValType","EmValOptionalType","throwUnboundTypeError","ensureOverloadTable","exposePublicSymbol","replacePublicSymbol","createNamedFunction","embindRepr","registeredInstances","getBasestPointer","getInheritedInstance","registeredPointers","registerType","integerReadValueFromPointer","enumReadValueFromPointer","floatReadValueFromPointer","readPointer","runDestructors","craftInvokerFunction","embind__requireFunction","genericPointerToWireType","constNoSmartPtrRawPointerToWireType","nonConstNoSmartPtrRawPointerToWireType","init_RegisteredPointer","RegisteredPointer","RegisteredPointer_fromWireType","runDestructor","releaseClassHandle","finalizationRegistry","detachFinalizer_deps","detachFinalizer","attachFinalizer","makeClassHandle","init_ClassHandle","ClassHandle","throwInstanceAlreadyDeleted","deletionQueue","flushPendingDeletes","delayFunction","RegisteredClass","shallowCopyInternalPointer","downcastPointer","upcastPointer","validateThis","char_0","char_9","makeLegalFunctionName","emval_freelist","emval_handles","emval_symbols","init_emval","count_emval_handles","getStringOrSymbol","Emval","emval_returnValue","emval_methodCallers","reflectConstruct"];ch.forEach(We),n.incrementExceptionRefcount=lh,n.decrementExceptionRefcount=ud,n.getExceptionMessage=dd;function Op(){ce("fetchSettings")}var fd={__assert_fail:I,__cxa_begin_catch:we,__cxa_end_catch:Vt,__cxa_find_matching_catch_2:_n,__cxa_find_matching_catch_3:pe,__cxa_rethrow:tn,__cxa_rethrow_primary_exception:Se,__cxa_throw:wr,__cxa_uncaught_exceptions:Fr,__resumeException:gr,__syscall_dup3:Kc,__syscall_fcntl64:Vr,__syscall_fstat64:po,__syscall_ioctl:pl,__syscall_lstat64:mo,__syscall_newfstatat:Eu,__syscall_openat:ml,__syscall_stat64:Yc,_abort_js:Zc,_embind_finalize_value_object:Tu,_embind_register_bigint:Jc,_embind_register_bool:vo,_embind_register_class:Ru,_embind_register_class_class_function:id,_embind_register_class_constructor:zu,_embind_register_class_function:wo,_embind_register_class_property:xl,_embind_register_emval:Ml,_embind_register_enum:Ft,_embind_register_enum_value:Fs,_embind_register_float:Eo,_embind_register_integer:_i,_embind_register_memory_view:as,_embind_register_optional:To,_embind_register_std_string:El,_embind_register_std_wstring:Bu,_embind_register_value_object:Al,_embind_register_value_object_field:kl,_embind_register_void:Fu,_emscripten_throw_longjmp:Di,_emval_as:M,_emval_decref:ha,_emval_get_property:L,_emval_new_cstring:ae,_emval_run_destructors:Ae,_emval_take_value:Qe,_localtime_js:ka,_tzset_js:ad,clock_time_get:jf,emscripten_date_now:Gf,emscripten_get_heap_max:Xf,emscripten_get_now:sd,emscripten_resize_heap:Zf,environ_get:Jf,environ_sizes_get:Qf,exit:nh,fd_close:$o,fd_read:Rp,fd_seek:Dp,fd_write:te,invoke_diii:Kp,invoke_fiii:Xp,invoke_i:N,invoke_ii:yh,invoke_iii:gd,invoke_iiii:bh,invoke_iiiii:Sh,invoke_iiiiii:yd,invoke_iiiiiii:vd,invoke_iiiiiiii:Gp,invoke_iiiiiiiiiii:qp,invoke_iiiiiiiiiiii:m,invoke_iiiiiiiiiiiii:jp,invoke_jiiii:_d,invoke_v:Hp,invoke_vi:vh,invoke_vii:_h,invoke_viid:k,invoke_viii:wh,invoke_viiii:Wp,invoke_viiiii:z,invoke_viiiiiii:f,invoke_viiiiiiiiii:g,invoke_viiiiiiiiiiiiiii:w,invoke_viijii:xh},ai=await Re(),Np=at("__getTypeName",1),os=n._main=at("__main_argc_argv",2),Li=at("malloc",1),Jr=at("free",1),dh=at("strerror",1),fh=at("fflush",1),hh=ai.emscripten_stack_get_end;ai.emscripten_stack_get_base;var Jn=at("setThrew",2),Bp=at("_emscripten_tempret_set",1),hd=ai.emscripten_stack_init;ai.emscripten_stack_get_free;var Fp=ai._emscripten_stack_restore,Up=ai._emscripten_stack_alloc,pd=ai.emscripten_stack_get_current,ph=at("__cxa_decrement_exception_refcount",1),mh=at("__cxa_increment_exception_refcount",1),Vp=at("__get_exception_message",3),gh=at("__cxa_can_catch",3),md=at("__cxa_get_exception_ptr",1);function vh(p,y){var T=ln();try{Tn(p)(y)}catch($){if(Yt(T),!($ instanceof xe))throw $;Jn(1,0)}}function gd(p,y,T){var $=ln();try{return Tn(p)(y,T)}catch(F){if(Yt($),!(F instanceof xe))throw F;Jn(1,0)}}function yh(p,y){var T=ln();try{return Tn(p)(y)}catch($){if(Yt(T),!($ instanceof xe))throw $;Jn(1,0)}}function _h(p,y,T){var $=ln();try{Tn(p)(y,T)}catch(F){if(Yt($),!(F instanceof xe))throw F;Jn(1,0)}}function Hp(p){var y=ln();try{Tn(p)()}catch(T){if(Yt(y),!(T instanceof xe))throw T;Jn(1,0)}}function vd(p,y,T,$,F,q,J){var oe=ln();try{return Tn(p)(y,T,$,F,q,J)}catch(Ce){if(Yt(oe),!(Ce instanceof xe))throw Ce;Jn(1,0)}}function bh(p,y,T,$){var F=ln();try{return Tn(p)(y,T,$)}catch(q){if(Yt(F),!(q instanceof xe))throw q;Jn(1,0)}}function xh(p,y,T,$,F,q){var J=ln();try{Tn(p)(y,T,$,F,q)}catch(oe){if(Yt(J),!(oe instanceof xe))throw oe;Jn(1,0)}}function Wp(p,y,T,$,F){var q=ln();try{Tn(p)(y,T,$,F)}catch(J){if(Yt(q),!(J instanceof xe))throw J;Jn(1,0)}}function yd(p,y,T,$,F,q){var J=ln();try{return Tn(p)(y,T,$,F,q)}catch(oe){if(Yt(J),!(oe instanceof xe))throw oe;Jn(1,0)}}function wh(p,y,T,$){var F=ln();try{Tn(p)(y,T,$)}catch(q){if(Yt(F),!(q instanceof xe))throw q;Jn(1,0)}}function Gp(p,y,T,$,F,q,J,oe){var Ce=ln();try{return Tn(p)(y,T,$,F,q,J,oe)}catch(He){if(Yt(Ce),!(He instanceof xe))throw He;Jn(1,0)}}function qp(p,y,T,$,F,q,J,oe,Ce,He,Ke){var st=ln();try{return Tn(p)(y,T,$,F,q,J,oe,Ce,He,Ke)}catch(wt){if(Yt(st),!(wt instanceof xe))throw wt;Jn(1,0)}}function Sh(p,y,T,$,F){var q=ln();try{return Tn(p)(y,T,$,F)}catch(J){if(Yt(q),!(J instanceof xe))throw J;Jn(1,0)}}function _d(p,y,T,$,F){var q=ln();try{return Tn(p)(y,T,$,F)}catch(J){if(Yt(q),!(J instanceof xe))throw J;return Jn(1,0),0n}}function jp(p,y,T,$,F,q,J,oe,Ce,He,Ke,st,wt){var ot=ln();try{return Tn(p)(y,T,$,F,q,J,oe,Ce,He,Ke,st,wt)}catch($t){if(Yt(ot),!($t instanceof xe))throw $t;Jn(1,0)}}function Xp(p,y,T,$){var F=ln();try{return Tn(p)(y,T,$)}catch(q){if(Yt(F),!(q instanceof xe))throw q;Jn(1,0)}}function Kp(p,y,T,$){var F=ln();try{return Tn(p)(y,T,$)}catch(q){if(Yt(F),!(q instanceof xe))throw q;Jn(1,0)}}function N(p){var y=ln();try{return Tn(p)()}catch(T){if(Yt(y),!(T instanceof xe))throw T;Jn(1,0)}}function f(p,y,T,$,F,q,J,oe){var Ce=ln();try{Tn(p)(y,T,$,F,q,J,oe)}catch(He){if(Yt(Ce),!(He instanceof xe))throw He;Jn(1,0)}}function m(p,y,T,$,F,q,J,oe,Ce,He,Ke,st){var wt=ln();try{return Tn(p)(y,T,$,F,q,J,oe,Ce,He,Ke,st)}catch(ot){if(Yt(wt),!(ot instanceof xe))throw ot;Jn(1,0)}}function g(p,y,T,$,F,q,J,oe,Ce,He,Ke){var st=ln();try{Tn(p)(y,T,$,F,q,J,oe,Ce,He,Ke)}catch(wt){if(Yt(st),!(wt instanceof xe))throw wt;Jn(1,0)}}function w(p,y,T,$,F,q,J,oe,Ce,He,Ke,st,wt,ot,$t,jt){var En=ln();try{Tn(p)(y,T,$,F,q,J,oe,Ce,He,Ke,st,wt,ot,$t,jt)}catch(mn){if(Yt(En),!(mn instanceof xe))throw mn;Jn(1,0)}}function k(p,y,T,$){var F=ln();try{Tn(p)(y,T,$)}catch(q){if(Yt(F),!(q instanceof xe))throw q;Jn(1,0)}}function z(p,y,T,$,F,q){var J=ln();try{Tn(p)(y,T,$,F,q)}catch(oe){if(Yt(J),!(oe instanceof xe))throw oe;Jn(1,0)}}var W;function ee(p=[]){G(K==0,'cannot call main when async dependencies remain! (listen on Module["onRuntimeInitialized"])'),G(typeof $n>"u"||$n.length==0,"cannot call main when preRun functions remain to be called");var y=os;p.unshift(h);var T=p.length,$=Hu((T+1)*4),F=$;p.forEach(J=>{de[F>>2]=ah(J),F+=4}),de[F>>2]=0;try{var q=y(T,$);return ld(q,!0),q}catch(J){return ih(J)}}function ue(){hd(),qe()}function Me(p=d){if(K>0){De=Me;return}if(ue(),ht(),K>0){De=Me;return}function y(){var $;if(G(!W),W=!0,n.calledRun=!0,!fe){vt(),ct(),r(n),($=n.onRuntimeInitialized)==null||$.call(n),ut("onRuntimeInitialized");var T=n.noInitialRun||!1;T||ee(p),se()}}n.setStatus?(n.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>n.setStatus(""),1),y()},1)):y(),ge()}function Ue(){var p=V,y=P,T=!1;V=P=$=>{T=!0};try{fh(0),["stdout","stderr"].forEach($=>{var Ce;var F=j.analyzePath("/dev/"+$);if(F){var q=F.object,J=q.rdev,oe=wn.ttys[J];(Ce=oe==null?void 0:oe.output)!=null&&Ce.length&&(T=!0)}})}catch{}V=p,P=y,T&&sn("stdio streams had content in them that was not flushed. you should set EXIT_RUNTIME to 1 (see the Emscripten FAQ), or make sure to emit a newline when you printf etc.")}function lt(){if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.shift()();ut("preInit")}lt(),Me(),e=a;for(const p of Object.keys(n))p in t||Object.defineProperty(t,p,{configurable:!0,get(){Ie(`Access to module property ('${p}') is no longer possible via the module constructor argument; Instead, use the result of the module constructor.`)}});return e};const AV=Et({text:String,onClick:to(),...In(),...Kr()},"VLabel"),HT=Jt()({name:"VLabel",props:AV(),setup(t,e){let{slots:n}=e;return vn(()=>{var r;return Te("label",{class:Wt(["v-label",{"v-label--clickable":!!t.onClick},t.class]),style:yn(t.style),onClick:t.onClick},[t.text,(r=n.default)==null?void 0:r.call(n)])}),{}}}),WT=Symbol.for("vuetify:selection-control-group"),GT=Et({color:String,disabled:{type:Boolean,default:null},defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:pr,trueIcon:pr,ripple:{type:[Boolean,Object],default:!0},multiple:{type:Boolean,default:null},name:String,readonly:{type:Boolean,default:null},modelValue:null,type:String,valueComparator:{type:Function,default:iu},...In(),...As(),...Kr()},"SelectionControlGroup"),kV=Et({...GT({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup");Jt()({name:"VSelectionControlGroup",props:kV(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:n}=e;const r=jr(t,"modelValue"),i=vu(),a=dt(()=>t.id||`v-selection-control-group-${i}`),s=dt(()=>t.name||a.value),o=new Set;return Lr(WT,{modelValue:r,forceUpdate:()=>{o.forEach(l=>l())},onForceUpdate:l=>{o.add(l),Pi(()=>{o.delete(l)})}}),Wc({[t.defaultsTarget]:{color:dt(()=>t.color),disabled:dt(()=>t.disabled),density:dt(()=>t.density),error:dt(()=>t.error),inline:dt(()=>t.inline),modelValue:r,multiple:dt(()=>!!t.multiple||t.multiple==null&&Array.isArray(r.value)),name:s,falseIcon:dt(()=>t.falseIcon),trueIcon:dt(()=>t.trueIcon),readonly:dt(()=>t.readonly),ripple:dt(()=>t.ripple),type:dt(()=>t.type),valueComparator:dt(()=>t.valueComparator)}}),vn(()=>{var l;return Te("div",{class:Wt(["v-selection-control-group",{"v-selection-control-group--inline":t.inline},t.class]),style:yn(t.style),role:t.type==="radio"?"radiogroup":void 0},[(l=n.default)==null?void 0:l.call(n)])}),{}}});const qT=Et({label:String,baseColor:String,trueValue:null,falseValue:null,value:null,...In(),...GT()},"VSelectionControl");function IV(t){const e=Fn(WT,void 0),{densityClasses:n}=uo(t),r=jr(t,"modelValue"),i=Be(()=>t.trueValue!==void 0?t.trueValue:t.value!==void 0?t.value:!0),a=Be(()=>t.falseValue!==void 0?t.falseValue:!1),s=Be(()=>!!t.multiple||t.multiple==null&&Array.isArray(r.value)),o=Be({get(){const v=e?e.modelValue.value:r.value;return s.value?xs(v).some(x=>t.valueComparator(x,i.value)):t.valueComparator(v,i.value)},set(v){if(t.readonly)return;const x=v?i.value:a.value;let _=x;s.value&&(_=v?[...xs(r.value),x]:xs(r.value).filter(b=>!t.valueComparator(b,i.value))),e?e.modelValue.value=_:r.value=_}}),{textColorClasses:l,textColorStyles:u}=Es(()=>{if(!(t.error||t.disabled))return o.value?t.color:t.baseColor}),{backgroundColorClasses:c,backgroundColorStyles:d}=ra(()=>o.value&&!t.error&&!t.disabled?t.color:t.baseColor),h=Be(()=>o.value?t.trueIcon:t.falseIcon);return{group:e,densityClasses:n,trueValue:i,falseValue:a,model:o,textColorClasses:l,textColorStyles:u,backgroundColorClasses:c,backgroundColorStyles:d,icon:h}}const rS=Jt()({name:"VSelectionControl",directives:{vRipple:io},inheritAttrs:!1,props:qT(),emits:{"update:modelValue":t=>!0},setup(t,e){let{attrs:n,slots:r}=e;const{group:i,densityClasses:a,icon:s,model:o,textColorClasses:l,textColorStyles:u,backgroundColorClasses:c,backgroundColorStyles:d,trueValue:h}=IV(t),v=vu(),x=rn(!1),_=rn(!1),b=cn(),S=dt(()=>t.id||`input-${v}`),E=dt(()=>!t.disabled&&!t.readonly);i==null||i.onForceUpdate(()=>{b.value&&(b.value.checked=o.value)});function C(V){E.value&&(x.value=!0,e6(V.target,":focus-visible")!==!1&&(_.value=!0))}function A(){x.value=!1,_.value=!1}function D(V){V.stopPropagation()}function O(V){if(!E.value){b.value&&(b.value.checked=o.value);return}t.readonly&&i&&Wi(()=>i.forceUpdate()),o.value=V.target.checked}return vn(()=>{var fe,Q;const V=r.label?r.label({label:t.label,props:{for:S.value}}):t.label,[P,U]=Y5(n),Y=Te("input",Rn({ref:b,checked:o.value,disabled:!!t.disabled,id:S.value,onBlur:A,onFocus:C,onInput:O,"aria-disabled":!!t.disabled,"aria-label":t.label,type:t.type,value:h.value,name:t.name,"aria-checked":t.type==="checkbox"?o.value:void 0},U),null);return Te("div",Rn({class:["v-selection-control",{"v-selection-control--dirty":o.value,"v-selection-control--disabled":t.disabled,"v-selection-control--error":t.error,"v-selection-control--focused":x.value,"v-selection-control--focus-visible":_.value,"v-selection-control--inline":t.inline},a.value,t.class]},P,{style:t.style}),[Te("div",{class:Wt(["v-selection-control__wrapper",l.value]),style:yn(u.value)},[(fe=r.default)==null?void 0:fe.call(r,{backgroundColorClasses:c,backgroundColorStyles:d}),Hi(Te("div",{class:Wt(["v-selection-control__input"])},[((Q=r.input)==null?void 0:Q.call(r,{model:o,textColorClasses:l,textColorStyles:u,backgroundColorClasses:c,backgroundColorStyles:d,inputNode:Y,icon:s.value,props:{onFocus:C,onBlur:A,id:S.value}}))??Te(On,null,[s.value&&le(yr,{key:"icon",icon:s.value},null),Y])]),[[io,!t.disabled&&!t.readonly&&t.ripple,null,{center:!0,circle:!0}]])]),V&&le(HT,{for:S.value,onClick:D},{default:()=>[V]})])}),{isFocused:x,input:b}}}),jT=Et({indeterminate:Boolean,indeterminateIcon:{type:pr,default:"$checkboxIndeterminate"},...qT({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),iS=Jt()({name:"VCheckboxBtn",props:jT(),emits:{"update:modelValue":t=>!0,"update:indeterminate":t=>!0},setup(t,e){let{slots:n}=e;const r=jr(t,"indeterminate"),i=jr(t,"modelValue");function a(l){r.value&&(r.value=!1)}const s=dt(()=>r.value?t.indeterminateIcon:t.falseIcon),o=dt(()=>r.value?t.indeterminateIcon:t.trueIcon);return vn(()=>{const l=Hc(rS.filterProps(t),["modelValue"]);return le(rS,Rn(l,{modelValue:i.value,"onUpdate:modelValue":[u=>i.value=u,a],class:["v-checkbox-btn",t.class],style:t.style,type:"checkbox",falseIcon:s.value,trueIcon:o.value,"aria-checked":r.value?"mixed":void 0}),n)}),{}}});function $V(t){const{t:e}=p6();function n(r){let{name:i,color:a,...s}=r;const o={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[i],l=t[`onClick:${i}`];function u(d){d.key!=="Enter"&&d.key!==" "||(d.preventDefault(),d.stopPropagation(),jk(l,new PointerEvent("click",d)))}const c=l&&o?e(`$vuetify.input.${o}`,t.label??""):void 0;return le(yr,Rn({icon:t[`${i}Icon`],"aria-label":c,onClick:l,onKeydown:u,color:a},s),null)}return{InputIcon:n}}const PV=Et({active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...In(),...G1({transition:{component:XP,leaveAbsolute:!0,group:!0}})},"VMessages"),RV=Jt()({name:"VMessages",props:PV(),setup(t,e){let{slots:n}=e;const r=Be(()=>xs(t.messages)),{textColorClasses:i,textColorStyles:a}=Es(()=>t.color);return vn(()=>le(Ko,{transition:t.transition,tag:"div",class:Wt(["v-messages",i.value,t.class]),style:yn([a.value,t.style])},{default:()=>[t.active&&r.value.map((s,o)=>Te("div",{class:"v-messages__message",key:`${o}-${r.value}`},[n.message?n.message({message:s}):s]))]})),{}}}),XT=Et({focused:Boolean,"onUpdate:focused":to()},"focus");function KT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs();const n=jr(t,"focused"),r=dt(()=>({[`${e}--focused`]:n.value}));function i(){n.value=!0}function a(){n.value=!1}return{focusClasses:r,isFocused:n,focus:i,blur:a}}const DV=Symbol.for("vuetify:form");function LV(t){const e=Fn(DV,null);return{...e,isReadonly:Be(()=>!!((t==null?void 0:t.readonly)??(e==null?void 0:e.isReadonly.value))),isDisabled:Be(()=>!!((t==null?void 0:t.disabled)??(e==null?void 0:e.isDisabled.value)))}}const zV=Symbol.for("vuetify:rules");function OV(t){const e=Fn(zV,null);return e?e(t):dt(t)}const NV=Et({disabled:{type:Boolean,default:null},error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:{type:Boolean,default:null},rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...XT()},"validation");function BV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cs(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vu();const r=jr(t,"modelValue"),i=Be(()=>t.validationValue===void 0?r.value:t.validationValue),a=LV(t),s=OV(()=>t.rules),o=cn([]),l=rn(!0),u=Be(()=>!!(xs(r.value===""?null:r.value).length||xs(i.value===""?null:i.value).length)),c=Be(()=>{var A;return(A=t.errorMessages)!=null&&A.length?xs(t.errorMessages).concat(o.value).slice(0,Math.max(0,Number(t.maxErrors))):o.value}),d=Be(()=>{var O;let A=(t.validateOn??((O=a.validateOn)==null?void 0:O.value))||"input";A==="lazy"&&(A="input lazy"),A==="eager"&&(A="input eager");const D=new Set((A==null?void 0:A.split(" "))??[]);return{input:D.has("input"),blur:D.has("blur")||D.has("input")||D.has("invalid-input"),invalidInput:D.has("invalid-input"),lazy:D.has("lazy"),eager:D.has("eager")}}),h=Be(()=>{var A;return t.error||(A=t.errorMessages)!=null&&A.length?!1:t.rules.length?l.value?o.value.length||d.value.lazy?null:!0:!o.value.length:!0}),v=rn(!1),x=Be(()=>({[`${e}--error`]:h.value===!1,[`${e}--dirty`]:u.value,[`${e}--disabled`]:a.isDisabled.value,[`${e}--readonly`]:a.isReadonly.value})),_=kr("validation"),b=Be(()=>t.name??ki(n));Of(()=>{var A;(A=a.register)==null||A.call(a,{id:b.value,vm:_,validate:C,reset:S,resetValidation:E})}),sa(()=>{var A;(A=a.unregister)==null||A.call(a,b.value)}),ol(async()=>{var A;d.value.lazy||await C(!d.value.eager),(A=a.update)==null||A.call(a,b.value,h.value,c.value)}),du(()=>d.value.input||d.value.invalidInput&&h.value===!1,()=>{An(i,()=>{if(i.value!=null)C();else if(t.focused){const A=An(()=>t.focused,D=>{D||C(),A()})}})}),du(()=>d.value.blur,()=>{An(()=>t.focused,A=>{A||C()})}),An([h,c],()=>{var A;(A=a.update)==null||A.call(a,b.value,h.value,c.value)});async function S(){r.value=null,await Wi(),await E()}async function E(){l.value=!0,d.value.lazy?o.value=[]:await C(!d.value.eager)}async function C(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const D=[];v.value=!0;for(const O of s.value){if(D.length>=Number(t.maxErrors??1))break;const P=await(typeof O=="function"?O:()=>O)(i.value);if(P!==!0){if(P!==!1&&typeof P!="string"){console.warn(`${P} is not a valid value. Rule functions must return boolean true or a string.`);continue}D.push(P||"")}}return o.value=D,v.value=!1,l.value=A,o.value}return{errorMessages:c,isDirty:u,isDisabled:a.isDisabled,isReadonly:a.isReadonly,isPristine:l,isValid:h,isValidating:v,reset:S,resetValidation:E,validate:C,validationClasses:x}}const Wy=Et({id:String,appendIcon:pr,baseColor:String,centerAffix:{type:Boolean,default:!0},color:String,glow:Boolean,iconColor:[Boolean,String],prependIcon:pr,hideDetails:[Boolean,String],hideSpinButtons:Boolean,hint:String,persistentHint:Boolean,messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:t=>["horizontal","vertical"].includes(t)},"onClick:prepend":to(),"onClick:append":to(),...In(),...As(),...j5(ks(),["maxWidth","minWidth","width"]),...Kr(),...NV()},"VInput"),ap=Jt()({name:"VInput",props:{...Wy()},emits:{"update:modelValue":t=>!0},setup(t,e){let{attrs:n,slots:r,emit:i}=e;const{densityClasses:a}=uo(t),{dimensionStyles:s}=Is(t),{themeClasses:o}=Ri(t),{rtlClasses:l}=Sa(),{InputIcon:u}=$V(t),c=vu(),d=Be(()=>t.id||`input-${c}`),{errorMessages:h,isDirty:v,isDisabled:x,isReadonly:_,isPristine:b,isValid:S,isValidating:E,reset:C,resetValidation:A,validate:D,validationClasses:O}=BV(t,"v-input",d),V=Be(()=>{var re;return(re=t.errorMessages)!=null&&re.length||!b.value&&h.value.length?h.value:t.hint&&(t.persistentHint||t.focused)?t.hint:t.messages}),P=dt(()=>V.value.length>0),U=dt(()=>!t.hideDetails||t.hideDetails==="auto"&&(P.value||!!r.details)),Y=Be(()=>U.value?`${d.value}-messages`:void 0),fe=Be(()=>({id:d,messagesId:Y,isDirty:v,isDisabled:x,isReadonly:_,isPristine:b,isValid:S,isValidating:E,hasDetails:U,reset:C,resetValidation:A,validate:D})),Q=dt(()=>t.error||t.disabled?void 0:t.focused?t.color:t.baseColor),G=dt(()=>{if(t.iconColor)return t.iconColor===!0?Q.value:t.iconColor});return vn(()=>{var ye,$e,_e,de;const re=!!(r.prepend||t.prependIcon),he=!!(r.append||t.appendIcon);return Te("div",{class:Wt(["v-input",`v-input--${t.direction}`,{"v-input--center-affix":t.centerAffix,"v-input--focused":t.focused,"v-input--glow":t.glow,"v-input--hide-spin-buttons":t.hideSpinButtons},a.value,o.value,l.value,O.value,t.class]),style:yn([s.value,t.style])},[re&&Te("div",{key:"prepend",class:"v-input__prepend"},[(ye=r.prepend)==null?void 0:ye.call(r,fe.value),t.prependIcon&&le(u,{key:"prepend-icon",name:"prepend",color:G.value},null)]),r.default&&Te("div",{class:"v-input__control"},[($e=r.default)==null?void 0:$e.call(r,fe.value)]),he&&Te("div",{key:"append",class:"v-input__append"},[t.appendIcon&&le(u,{key:"append-icon",name:"append",color:G.value},null),(_e=r.append)==null?void 0:_e.call(r,fe.value)]),U.value&&Te("div",{id:Y.value,class:"v-input__details",role:"alert","aria-live":"polite"},[le(RV,{active:P.value,messages:V.value},{message:r.message}),(de=r.details)==null?void 0:de.call(r,fe.value)])])}),{reset:C,resetValidation:A,validate:D,isValid:S,errorMessages:h}}}),nv=Symbol("Forwarded refs");function rv(t,e){let n=t;for(;n;){const r=Reflect.getOwnPropertyDescriptor(n,e);if(r)return r;n=Object.getPrototypeOf(n)}}function Pp(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t[nv]=n,new Proxy(t,{get(i,a){if(Reflect.has(i,a))return Reflect.get(i,a);if(!(typeof a=="symbol"||a.startsWith("$")||a.startsWith("__"))){for(const s of n)if(s.value&&Reflect.has(s.value,a)){const o=Reflect.get(s.value,a);return typeof o=="function"?o.bind(s.value):o}}},has(i,a){if(Reflect.has(i,a))return!0;if(typeof a=="symbol"||a.startsWith("$")||a.startsWith("__"))return!1;for(const s of n)if(s.value&&Reflect.has(s.value,a))return!0;return!1},set(i,a,s){if(Reflect.has(i,a))return Reflect.set(i,a,s);if(typeof a=="symbol"||a.startsWith("$")||a.startsWith("__"))return!1;for(const o of n)if(o.value&&Reflect.has(o.value,a))return Reflect.set(o.value,a,s);return!1},getOwnPropertyDescriptor(i,a){var o;const s=Reflect.getOwnPropertyDescriptor(i,a);if(s)return s;if(!(typeof a=="symbol"||a.startsWith("$")||a.startsWith("__"))){for(const l of n){if(!l.value)continue;const u=rv(l.value,a)??("_"in l.value?rv((o=l.value._)==null?void 0:o.setupState,a):void 0);if(u)return u}for(const l of n){const u=l.value&&l.value[nv];if(!u)continue;const c=u.slice();for(;c.length;){const d=c.shift(),h=rv(d.value,a);if(h)return h;const v=d.value&&d.value[nv];v&&c.push(...v)}}}}})}const FV=Et({...Wy(),...Hc(jT(),["inline"])},"VCheckbox"),aS=Jt()({name:"VCheckbox",inheritAttrs:!1,props:FV(),emits:{"update:modelValue":t=>!0,"update:focused":t=>!0},setup(t,e){let{attrs:n,slots:r}=e;const i=jr(t,"modelValue"),{isFocused:a,focus:s,blur:o}=KT(t),l=cn(),u=vu();return vn(()=>{const[c,d]=Y5(n),h=ap.filterProps(t),v=iS.filterProps(t);return le(ap,Rn({ref:l,class:["v-checkbox",t.class]},c,h,{modelValue:i.value,"onUpdate:modelValue":x=>i.value=x,id:t.id||`checkbox-${u}`,focused:a.value,style:t.style}),{...r,default:x=>{let{id:_,messagesId:b,isDisabled:S,isReadonly:E,isValid:C}=x;return le(iS,Rn(v,{id:_.value,"aria-describedby":b.value,disabled:S.value,readonly:E.value},d,{error:C.value===!1,modelValue:i.value,"onUpdate:modelValue":A=>i.value=A,onFocus:s,onBlur:o}),r)}})}),Pp({},l)}});function iv(t,e){return{x:t.x+e.x,y:t.y+e.y}}function UV(t,e){return{x:t.x-e.x,y:t.y-e.y}}function sS(t,e){if(t.side==="top"||t.side==="bottom"){const{side:n,align:r}=t,i=r==="left"?0:r==="center"?e.width/2:r==="right"?e.width:r,a=n==="top"?0:n==="bottom"?e.height:n;return iv({x:i,y:a},e)}else if(t.side==="left"||t.side==="right"){const{side:n,align:r}=t,i=n==="left"?0:n==="right"?e.width:n,a=r==="top"?0:r==="center"?e.height/2:r==="bottom"?e.height:r;return iv({x:i,y:a},e)}return iv({x:e.width/2,y:e.height/2},e)}const YT={static:WV,connected:qV},VV=Et({locationStrategy:{type:[String,Function],default:"static",validator:t=>typeof t=="function"||t in YT},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function HV(t,e){const n=cn({}),r=cn();er&&du(()=>!!(e.isActive.value&&t.locationStrategy),o=>{var l,u;An(()=>t.locationStrategy,o),Pi(()=>{window.removeEventListener("resize",i),visualViewport==null||visualViewport.removeEventListener("resize",a),visualViewport==null||visualViewport.removeEventListener("scroll",s),r.value=void 0}),window.addEventListener("resize",i,{passive:!0}),visualViewport==null||visualViewport.addEventListener("resize",a,{passive:!0}),visualViewport==null||visualViewport.addEventListener("scroll",s,{passive:!0}),typeof t.locationStrategy=="function"?r.value=(l=t.locationStrategy(e,t,n))==null?void 0:l.updateLocation:r.value=(u=YT[t.locationStrategy](e,t,n))==null?void 0:u.updateLocation});function i(o){var l;(l=r.value)==null||l.call(r,o)}function a(o){var l;(l=r.value)==null||l.call(r,o)}function s(o){var l;(l=r.value)==null||l.call(r,o)}return{contentStyles:n,updateLocation:r}}function WV(){}function GV(t,e){const n=r6(t);return e?n.x+=parseFloat(t.style.right||0):n.x-=parseFloat(t.style.left||0),n.y-=parseFloat(t.style.top||0),n}function qV(t,e,n){(Array.isArray(t.target.value)||$9(t.target.value))&&Object.assign(n.value,{position:"fixed",top:0,[t.isRtl.value?"right":"left"]:0});const{preferredAnchor:i,preferredOrigin:a}=k1(()=>{const S=xv(e.location,t.isRtl.value),E=e.origin==="overlap"?S:e.origin==="auto"?fm(S):xv(e.origin,t.isRtl.value);return S.side===E.side&&S.align===hm(E).align?{preferredAnchor:G2(S),preferredOrigin:G2(E)}:{preferredAnchor:S,preferredOrigin:E}}),[s,o,l,u]=["minWidth","minHeight","maxWidth","maxHeight"].map(S=>Be(()=>{const E=parseFloat(e[S]);return isNaN(E)?1/0:E})),c=Be(()=>{if(Array.isArray(e.offset))return e.offset;if(typeof e.offset=="string"){const S=e.offset.split(" ").map(parseFloat);return S.length<2&&S.push(0),S}return typeof e.offset=="number"?[e.offset,0]:[0,0]});let d=!1,h=-1;const v=new qk(4),x=new ResizeObserver(()=>{if(!d)return;if(requestAnimationFrame(E=>{E!==h&&v.clear(),requestAnimationFrame(C=>{h=C})}),v.isFull){const E=v.values();if(iu(E.at(-1),E.at(-3))&&!iu(E.at(-1),E.at(-2)))return}const S=b();S&&v.push(S.flipped)});let _=new ws({x:0,y:0,width:0,height:0});An(t.target,(S,E)=>{E&&!Array.isArray(E)&&x.unobserve(E),Array.isArray(S)?iu(S,E)||b():S&&x.observe(S)},{immediate:!0}),An(t.contentEl,(S,E)=>{E&&x.unobserve(E),S&&x.observe(S)},{immediate:!0}),Pi(()=>{x.disconnect()});function b(){if(d=!1,requestAnimationFrame(()=>d=!0),!t.target.value||!t.contentEl.value)return;(Array.isArray(t.target.value)||t.target.value.offsetParent||t.target.value.getClientRects().length)&&(_=n6(t.target.value));const S=GV(t.contentEl.value,t.isRtl.value),E=H0(t.contentEl.value),C=12;E.length||(E.push(document.documentElement),t.contentEl.value.style.top&&t.contentEl.value.style.left||(S.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),S.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const A=E.reduce((G,re)=>{const he=Jk(re);return G?new ws({x:Math.max(G.left,he.left),y:Math.max(G.top,he.top),width:Math.min(G.right,he.right)-Math.max(G.left,he.left),height:Math.min(G.bottom,he.bottom)-Math.max(G.top,he.top)}):he},void 0);A.x+=C,A.y+=C,A.width-=C*2,A.height-=C*2;let D={anchor:i.value,origin:a.value};function O(G){const re=new ws(S),he=sS(G.anchor,_),ye=sS(G.origin,re);let{x:$e,y:_e}=UV(he,ye);switch(G.anchor.side){case"top":_e-=c.value[0];break;case"bottom":_e+=c.value[0];break;case"left":$e-=c.value[0];break;case"right":$e+=c.value[0];break}switch(G.anchor.align){case"top":_e-=c.value[1];break;case"bottom":_e+=c.value[1];break;case"left":$e-=c.value[1];break;case"right":$e+=c.value[1];break}return re.x+=$e,re.y+=_e,re.width=Math.min(re.width,l.value),re.height=Math.min(re.height,u.value),{overflows:j2(re,A),x:$e,y:_e}}let V=0,P=0;const U={x:0,y:0},Y={x:!1,y:!1};let fe=-1;for(;!(fe++>10);){const{x:G,y:re,overflows:he}=O(D);V+=G,P+=re,S.x+=G,S.y+=re;{const ye=q2(D.anchor),$e=he.x.before||he.x.after,_e=he.y.before||he.y.after;let de=!1;if(["x","y"].forEach(Oe=>{if(Oe==="x"&&$e&&!Y.x||Oe==="y"&&_e&&!Y.y){const ve={anchor:{...D.anchor},origin:{...D.origin}},ie=Oe==="x"?ye==="y"?hm:fm:ye==="y"?fm:hm;ve.anchor=ie(ve.anchor),ve.origin=ie(ve.origin);const{overflows:Pe}=O(ve);(Pe[Oe].before<=he[Oe].before&&Pe[Oe].after<=he[Oe].after||Pe[Oe].before+Pe[Oe].after<(he[Oe].before+he[Oe].after)/2)&&(D=ve,de=Y[Oe]=!0)}}),de)continue}he.x.before&&(V+=he.x.before,S.x+=he.x.before),he.x.after&&(V-=he.x.after,S.x-=he.x.after),he.y.before&&(P+=he.y.before,S.y+=he.y.before),he.y.after&&(P-=he.y.after,S.y-=he.y.after);{const ye=j2(S,A);U.x=A.width-ye.x.before-ye.x.after,U.y=A.height-ye.y.before-ye.y.after,V+=ye.x.before,S.x+=ye.x.before,P+=ye.y.before,S.y+=ye.y.before}break}const Q=q2(D.anchor);return Object.assign(n.value,{"--v-overlay-anchor-origin":`${D.anchor.side} ${D.anchor.align}`,transformOrigin:`${D.origin.side} ${D.origin.align}`,top:nn(av(P)),left:t.isRtl.value?void 0:nn(av(V)),right:t.isRtl.value?nn(av(-V)):void 0,minWidth:nn(Q==="y"?Math.min(s.value,_.width):s.value),maxWidth:nn(oS(Wa(U.x,s.value===1/0?0:s.value,l.value))),maxHeight:nn(oS(Wa(U.y,o.value===1/0?0:o.value,u.value)))}),{available:U,contentBox:S,flipped:Y}}return An(()=>[i.value,a.value,e.offset,e.minWidth,e.minHeight,e.maxWidth,e.maxHeight],()=>b()),Wi(()=>{const S=b();if(!S)return;const{available:E,contentBox:C}=S;C.height>E.y&&requestAnimationFrame(()=>{b(),requestAnimationFrame(()=>{b()})})}),{updateLocation:b}}function av(t){return Math.round(t*devicePixelRatio)/devicePixelRatio}function oS(t){return Math.ceil(t*devicePixelRatio)/devicePixelRatio}let i1=!0;const sp=[];function jV(t){!i1||sp.length?(sp.push(t),a1()):(i1=!1,t(),a1())}let lS=-1;function a1(){cancelAnimationFrame(lS),lS=requestAnimationFrame(()=>{const t=sp.shift();t&&t(),sp.length?a1():i1=!0})}const A0={none:null,close:YV,block:ZV,reposition:JV},XV=Et({scrollStrategy:{type:[String,Function],default:"block",validator:t=>typeof t=="function"||t in A0}},"VOverlay-scroll-strategies");function KV(t,e){if(!er)return;let n;lo(async()=>{n==null||n.stop(),e.isActive.value&&t.scrollStrategy&&(n=hf(),await new Promise(r=>setTimeout(r)),n.active&&n.run(()=>{var r;typeof t.scrollStrategy=="function"?t.scrollStrategy(e,t,n):(r=A0[t.scrollStrategy])==null||r.call(A0,e,t,n)}))}),Pi(()=>{n==null||n.stop()})}function YV(t){function e(n){t.isActive.value=!1}ZT(t.target.value??t.contentEl.value,e)}function ZV(t,e){var o;const n=(o=t.root.value)==null?void 0:o.offsetParent,r=Array.isArray(t.target.value)?document.elementFromPoint(...t.target.value):t.target.value,i=[...new Set([...H0(r,e.contained?n:void 0),...H0(t.contentEl.value,e.contained?n:void 0)])].filter(l=>!l.classList.contains("v-overlay-scroll-blocked")),a=window.innerWidth-document.documentElement.offsetWidth,s=(l=>D1(l)&&l)(n||document.documentElement);s&&t.root.value.classList.add("v-overlay--scroll-blocked"),i.forEach((l,u)=>{l.style.setProperty("--v-body-scroll-x",nn(-l.scrollLeft)),l.style.setProperty("--v-body-scroll-y",nn(-l.scrollTop)),l!==document.documentElement&&l.style.setProperty("--v-scrollbar-offset",nn(a)),l.classList.add("v-overlay-scroll-blocked")}),Pi(()=>{i.forEach((l,u)=>{const c=parseFloat(l.style.getPropertyValue("--v-body-scroll-x")),d=parseFloat(l.style.getPropertyValue("--v-body-scroll-y")),h=l.style.scrollBehavior;l.style.scrollBehavior="auto",l.style.removeProperty("--v-body-scroll-x"),l.style.removeProperty("--v-body-scroll-y"),l.style.removeProperty("--v-scrollbar-offset"),l.classList.remove("v-overlay-scroll-blocked"),l.scrollLeft=-c,l.scrollTop=-d,l.style.scrollBehavior=h}),s&&t.root.value.classList.remove("v-overlay--scroll-blocked")})}function JV(t,e,n){let r=!1,i=-1,a=-1;function s(o){jV(()=>{var c,d;const l=performance.now();(d=(c=t.updateLocation).value)==null||d.call(c,o),r=(performance.now()-l)/(1e3/60)>2})}a=(typeof requestIdleCallback>"u"?o=>o():requestIdleCallback)(()=>{n.run(()=>{ZT(t.target.value??t.contentEl.value,o=>{r?(cancelAnimationFrame(i),i=requestAnimationFrame(()=>{i=requestAnimationFrame(()=>{s(o)})})):s(o)})})}),Pi(()=>{typeof cancelIdleCallback<"u"&&cancelIdleCallback(a),cancelAnimationFrame(i)})}function ZT(t,e){const n=Array.isArray(t)?document.elementFromPoint(...t):t,r=[document,...H0(n)];r.forEach(i=>{i.addEventListener("scroll",e,{passive:!0})}),Pi(()=>{r.forEach(i=>{i.removeEventListener("scroll",e)})})}const QV=Symbol.for("vuetify:v-menu"),eH=Et({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function tH(t,e){let n=()=>{};function r(s){n==null||n();const o=Number(s?t.openDelay:t.closeDelay);return new Promise(l=>{n=Kk(o,()=>{e==null||e(s),l(s)})})}function i(){return r(!0)}function a(){return r(!1)}return{clearDelay:n,runOpenDelay:i,runCloseDelay:a}}const nH=Et({target:[String,Object],activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...eH()},"VOverlay-activator");function rH(t,e){let{isActive:n,isTop:r,contentEl:i}=e;const a=kr("useActivator"),s=cn();let o=!1,l=!1,u=!0;const c=Be(()=>t.openOnFocus||t.openOnFocus==null&&t.openOnHover),d=Be(()=>t.openOnClick||t.openOnClick==null&&!t.openOnHover&&!c.value),{runOpenDelay:h,runCloseDelay:v}=tH(t,P=>{P===(t.openOnHover&&o||c.value&&l)&&!(t.openOnHover&&n.value&&!r.value)&&(n.value!==P&&(u=!0),n.value=P)}),x=cn(),_={onClick:P=>{P.stopPropagation(),s.value=P.currentTarget||P.target,n.value||(x.value=[P.clientX,P.clientY]),n.value=!n.value},onMouseenter:P=>{var U;(U=P.sourceCapabilities)!=null&&U.firesTouchEvents||(o=!0,s.value=P.currentTarget||P.target,h())},onMouseleave:P=>{o=!1,v()},onFocus:P=>{e6(P.target,":focus-visible")!==!1&&(l=!0,P.stopPropagation(),s.value=P.currentTarget||P.target,h())},onBlur:P=>{l=!1,P.stopPropagation(),v()}},b=Be(()=>{const P={};return d.value&&(P.onClick=_.onClick),t.openOnHover&&(P.onMouseenter=_.onMouseenter,P.onMouseleave=_.onMouseleave),c.value&&(P.onFocus=_.onFocus,P.onBlur=_.onBlur),P}),S=Be(()=>{const P={};if(t.openOnHover&&(P.onMouseenter=()=>{o=!0,h()},P.onMouseleave=()=>{o=!1,v()}),c.value&&(P.onFocusin=()=>{l=!0,h()},P.onFocusout=()=>{l=!1,v()}),t.closeOnContentClick){const U=Fn(QV,null);P.onClick=()=>{n.value=!1,U==null||U.closeParents()}}return P}),E=Be(()=>{const P={};return t.openOnHover&&(P.onMouseenter=()=>{u&&(o=!0,u=!1,h())},P.onMouseleave=()=>{o=!1,v()}),P});An(r,P=>{var U;P&&(t.openOnHover&&!o&&(!c.value||!l)||c.value&&!l&&(!t.openOnHover||!o))&&!((U=i.value)!=null&&U.contains(document.activeElement))&&(n.value=!1)}),An(n,P=>{P||setTimeout(()=>{x.value=void 0})},{flush:"post"});const C=bv();lo(()=>{C.value&&Wi(()=>{s.value=C.el})});const A=bv(),D=Be(()=>t.target==="cursor"&&x.value?x.value:A.value?A.el:JT(t.target,a)||s.value),O=Be(()=>Array.isArray(D.value)?void 0:D.value);let V;return An(()=>!!t.activator,P=>{P&&er?(V=hf(),V.run(()=>{iH(t,a,{activatorEl:s,activatorEvents:b})})):V&&V.stop()},{flush:"post",immediate:!0}),Pi(()=>{V==null||V.stop()}),{activatorEl:s,activatorRef:C,target:D,targetEl:O,targetRef:A,activatorEvents:b,contentEvents:S,scrimEvents:E}}function iH(t,e,n){let{activatorEl:r,activatorEvents:i}=n;An(()=>t.activator,(l,u)=>{if(u&&l!==u){const c=o(u);c&&s(c)}l&&Wi(()=>a())},{immediate:!0}),An(()=>t.activatorProps,()=>{a()}),Pi(()=>{s()});function a(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.activatorProps;l&&Qk(l,Rn(i.value,u))}function s(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.activatorProps;l&&e9(l,Rn(i.value,u))}function o(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.activator;const u=JT(l,e);return r.value=(u==null?void 0:u.nodeType)===Node.ELEMENT_NODE?u:void 0,r.value}}function JT(t,e){var r,i;if(!t)return;let n;if(t==="parent"){let a=(i=(r=e==null?void 0:e.proxy)==null?void 0:r.$el)==null?void 0:i.parentNode;for(;a!=null&&a.hasAttribute("data-no-activator");)a=a.parentNode;n=a}else typeof t=="string"?n=document.querySelector(t):"$el"in t?n=t.$el:n=t;return n}function aH(){if(!er)return rn(!1);const{ssr:t}=_6();if(t){const e=rn(!1);return ol(()=>{e.value=!0}),e}else return rn(!0)}const QT=Et({eager:Boolean},"lazy");function eC(t,e){const n=rn(!1),r=dt(()=>n.value||t.eager||e.value);An(e,()=>n.value=!0);function i(){t.eager||(n.value=!1)}return{isBooted:n,hasContent:r,onAfterLeave:i}}function Gy(){const e=kr("useScopeId").vnode.scopeId;return{scopeId:e?{[e]:""}:void 0}}const uS=Symbol.for("vuetify:stack"),Hd=qr([]);function sH(t,e,n){const r=kr("useStack"),i=!n,a=Fn(uS,void 0),s=qr({activeChildren:new Set});Lr(uS,s);const o=rn(Number(Ms(e)));du(t,()=>{var d;const c=(d=Hd.at(-1))==null?void 0:d[1];o.value=c?c+10:Number(Ms(e)),i&&Hd.push([r.uid,o.value]),a==null||a.activeChildren.add(r.uid),Pi(()=>{if(i){const h=en(Hd).findIndex(v=>v[0]===r.uid);Hd.splice(h,1)}a==null||a.activeChildren.delete(r.uid)})});const l=rn(!0);i&&lo(()=>{var d;const c=((d=Hd.at(-1))==null?void 0:d[0])===r.uid;setTimeout(()=>l.value=c)});const u=dt(()=>!s.activeChildren.size);return{globalTop:Lf(l),localTop:u,stackStyles:dt(()=>({zIndex:o.value}))}}function oH(t){return{teleportTarget:Be(()=>{const n=t();if(n===!0||!er)return;const r=n===!1?document.body:typeof n=="string"?document.querySelector(n):n;if(r==null)return;let i=[...r.children].find(a=>a.matches(".v-overlay-container"));return i||(i=document.createElement("div"),i.className="v-overlay-container",r.appendChild(i)),i})}}function lH(){return!0}function tC(t,e,n){if(!t||nC(t,n)===!1)return!1;const r=c6(e);if(typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&r.host===t.target)return!1;const i=(typeof n.value=="object"&&n.value.include||(()=>[]))();return i.push(e),!i.some(a=>a==null?void 0:a.contains(t.target))}function nC(t,e){return(typeof e.value=="object"&&e.value.closeConditional||lH)(t)}function uH(t,e,n){const r=typeof n.value=="function"?n.value:n.value.handler;t.shadowTarget=t.target,e._clickOutside.lastMousedownWasOutside&&tC(t,e,n)&&setTimeout(()=>{nC(t,n)&&r&&r(t)},0)}function cS(t,e){const n=c6(t);e(document),typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&e(n)}const dS={mounted(t,e){const n=i=>uH(i,t,e),r=i=>{t._clickOutside.lastMousedownWasOutside=tC(i,t,e)};cS(t,i=>{i.addEventListener("click",n,!0),i.addEventListener("mousedown",r,!0)}),t._clickOutside||(t._clickOutside={lastMousedownWasOutside:!1}),t._clickOutside[e.instance.$.uid]={onClick:n,onMousedown:r}},beforeUnmount(t,e){t._clickOutside&&(cS(t,n=>{var a;if(!n||!((a=t._clickOutside)!=null&&a[e.instance.$.uid]))return;const{onClick:r,onMousedown:i}=t._clickOutside[e.instance.$.uid];n.removeEventListener("click",r,!0),n.removeEventListener("mousedown",i,!0)}),delete t._clickOutside[e.instance.$.uid])}};function cH(t){const{modelValue:e,color:n,...r}=t;return le(cu,{name:"fade-transition",appear:!0},{default:()=>[t.modelValue&&Te("div",Rn({class:["v-overlay__scrim",t.color.backgroundColorClasses.value],style:t.color.backgroundColorStyles.value},r),null)]})}const rC=Et({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,opacity:[Number,String],noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[Boolean,String],default:!0},zIndex:{type:[Number,String],default:2e3},...nH(),...In(),...ks(),...QT(),...VV(),...XV(),...Kr(),...G1()},"VOverlay"),fS=Jt()({name:"VOverlay",directives:{vClickOutside:dS},inheritAttrs:!1,props:{_disableGlobalStack:Boolean,...rC()},emits:{"click:outside":t=>!0,"update:modelValue":t=>!0,keydown:t=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(t,e){let{slots:n,attrs:r,emit:i}=e;const a=kr("VOverlay"),s=cn(),o=cn(),l=cn(),u=jr(t,"modelValue"),c=Be({get:()=>u.value,set:ge=>{ge&&t.disabled||(u.value=ge)}}),{themeClasses:d}=Ri(t),{rtlClasses:h,isRtl:v}=Sa(),{hasContent:x,onAfterLeave:_}=eC(t,c),b=ra(()=>typeof t.scrim=="string"?t.scrim:null),{globalTop:S,localTop:E,stackStyles:C}=sH(c,()=>t.zIndex,t._disableGlobalStack),{activatorEl:A,activatorRef:D,target:O,targetEl:V,targetRef:P,activatorEvents:U,contentEvents:Y,scrimEvents:fe}=rH(t,{isActive:c,isTop:E,contentEl:l}),{teleportTarget:Q}=oH(()=>{var ze,Ge,ut;const ge=t.attach||t.contained;if(ge)return ge;const xe=((ze=A==null?void 0:A.value)==null?void 0:ze.getRootNode())||((ut=(Ge=a.proxy)==null?void 0:Ge.$el)==null?void 0:ut.getRootNode());return xe instanceof ShadowRoot?xe:!1}),{dimensionStyles:G}=Is(t),re=aH(),{scopeId:he}=Gy();An(()=>t.disabled,ge=>{ge&&(c.value=!1)});const{contentStyles:ye,updateLocation:$e}=HV(t,{isRtl:v,contentEl:l,target:O,isActive:c});KV(t,{root:s,contentEl:l,targetEl:V,target:O,isActive:c,updateLocation:$e});function _e(ge){i("click:outside",ge),t.persistent?et():c.value=!1}function de(ge){return c.value&&S.value&&(!t.scrim||ge.target===o.value||ge instanceof MouseEvent&&ge.shadowTarget===o.value)}er&&An(c,ge=>{ge?window.addEventListener("keydown",Oe):window.removeEventListener("keydown",Oe)},{immediate:!0}),sa(()=>{er&&window.removeEventListener("keydown",Oe)});function Oe(ge){var xe,ze,Ge;ge.key==="Escape"&&S.value&&((xe=l.value)!=null&&xe.contains(document.activeElement)||i("keydown",ge),t.persistent?et():(c.value=!1,(ze=l.value)!=null&&ze.contains(document.activeElement)&&((Ge=A.value)==null||Ge.focus())))}function ve(ge){ge.key==="Escape"&&!S.value||i("keydown",ge)}const ie=pP();du(()=>t.closeOnBack,()=>{mP(ie,ge=>{S.value&&c.value?(ge(!1),t.persistent?et():c.value=!1):ge()})});const Pe=cn();An(()=>c.value&&(t.absolute||t.contained)&&Q.value==null,ge=>{if(ge){const xe=k9(s.value);xe&&xe!==document.scrollingElement&&(Pe.value=xe.scrollTop)}});function et(){t.noClickAnimation||l.value&&_c(l.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:V0})}function ne(){i("afterEnter")}function qe(){_(),i("afterLeave")}return vn(()=>{var ge;return Te(On,null,[(ge=n.activator)==null?void 0:ge.call(n,{isActive:c.value,targetRef:P,props:Rn({ref:D},U.value,t.activatorProps)}),re.value&&x.value&&le(cA,{disabled:!Q.value,to:Q.value},{default:()=>[Te("div",Rn({class:["v-overlay",{"v-overlay--absolute":t.absolute||t.contained,"v-overlay--active":c.value,"v-overlay--contained":t.contained},d.value,h.value,t.class],style:[C.value,{"--v-overlay-opacity":t.opacity,top:nn(Pe.value)},t.style],ref:s,onKeydown:ve},he,r),[le(cH,Rn({color:b,modelValue:c.value&&!!t.scrim,ref:o},fe.value),null),le(Ko,{appear:!0,persisted:!0,transition:t.transition,target:O.value,onAfterEnter:ne,onAfterLeave:qe},{default:()=>{var xe;return[Hi(Te("div",Rn({ref:l,class:["v-overlay__content",t.contentClass],style:[G.value,ye.value]},Y.value,t.contentProps),[(xe=n.default)==null?void 0:xe.call(n,{isActive:c})]),[[yu,c.value],[dS,{handler:_e,closeConditional:de,include:()=>[A.value]}]])]}})])]})])}),{activatorEl:A,scrimEl:o,target:O,animateClick:et,contentEl:l,globalTop:S,localTop:E,updateLocation:$e}}}),dH=Et({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...rC({origin:"center center",scrollStrategy:"block",transition:{component:qP},zIndex:2400})},"VDialog"),hS=Jt()({name:"VDialog",props:dH(),emits:{"update:modelValue":t=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(t,e){let{emit:n,slots:r}=e;const i=jr(t,"modelValue"),{scopeId:a}=Gy(),s=cn();function o(c){var v,x;const d=c.relatedTarget,h=c.target;if(d!==h&&((v=s.value)!=null&&v.contentEl)&&((x=s.value)!=null&&x.globalTop)&&![document,s.value.contentEl].includes(h)&&!s.value.contentEl.contains(h)){const _=I1(s.value.contentEl);if(!_.length)return;const b=_[0],S=_[_.length-1];d===b?S.focus():b.focus()}}sa(()=>{document.removeEventListener("focusin",o)}),er&&An(()=>i.value&&t.retainFocus,c=>{c?document.addEventListener("focusin",o):document.removeEventListener("focusin",o)},{immediate:!0});function l(){var c;n("afterEnter"),(t.scrim||t.retainFocus)&&((c=s.value)!=null&&c.contentEl)&&!s.value.contentEl.contains(document.activeElement)&&s.value.contentEl.focus({preventScroll:!0})}function u(){n("afterLeave")}return An(i,async c=>{var d;c||(await Wi(),(d=s.value.activatorEl)==null||d.focus({preventScroll:!0}))}),vn(()=>{const c=fS.filterProps(t),d=Rn({"aria-haspopup":"dialog"},t.activatorProps),h=Rn({tabindex:-1},t.contentProps);return le(fS,Rn({ref:s,class:["v-dialog",{"v-dialog--fullscreen":t.fullscreen,"v-dialog--scrollable":t.scrollable},t.class],style:t.style},c,{modelValue:i.value,"onUpdate:modelValue":v=>i.value=v,"aria-modal":"true",activatorProps:d,contentProps:h,height:t.fullscreen?void 0:t.height,width:t.fullscreen?void 0:t.width,maxHeight:t.fullscreen?void 0:t.maxHeight,maxWidth:t.fullscreen?void 0:t.maxWidth,role:"dialog",onAfterEnter:l,onAfterLeave:u},a),{activator:r.activator,default:function(){for(var v=arguments.length,x=new Array(v),_=0;_<v;_++)x[_]=arguments[_];return le(Ua,{root:"VDialog"},{default:()=>{var b;return[(b=r.default)==null?void 0:b.call(r,...x)]}})}})}),Pp({},s)}}),qy=Symbol.for("vuetify:v-slider");function fH(t,e,n){const r=n==="vertical",i=e.getBoundingClientRect(),a="touches"in t?t.touches[0]:t;return r?a.clientY-(i.top+i.height/2):a.clientX-(i.left+i.width/2)}function hH(t,e){return"touches"in t&&t.touches.length?t.touches[0][e]:"changedTouches"in t&&t.changedTouches.length?t.changedTouches[0][e]:t[e]}const pH=Et({disabled:{type:Boolean,default:null},error:Boolean,readonly:{type:Boolean,default:null},max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:t=>typeof t=="boolean"||t==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:t=>typeof t=="boolean"||t==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:t=>["vertical","horizontal"].includes(t)},reverse:Boolean,noKeyboard:Boolean,...ja(),...cl({elevation:2}),ripple:{type:Boolean,default:!0}},"Slider"),mH=t=>{const e=Be(()=>parseFloat(t.min)),n=Be(()=>parseFloat(t.max)),r=Be(()=>Number(t.step)>0?parseFloat(t.step):0),i=Be(()=>Math.max(B2(r.value),B2(e.value)));function a(s){if(s=parseFloat(s),r.value<=0)return s;const o=Wa(s,e.value,n.value),l=e.value%r.value;let u=Math.round((o-l)/r.value)*r.value+l;return o>u&&u+r.value>n.value&&(u=n.value),parseFloat(Math.min(u,n.value).toFixed(i.value))}return{min:e,max:n,step:r,decimals:i,roundValue:a}},gH=t=>{let{props:e,steps:n,onSliderStart:r,onSliderMove:i,onSliderEnd:a,getActiveThumb:s}=t;const{isRtl:o}=Sa(),l=dt(()=>e.reverse),u=Be(()=>e.direction==="vertical"),c=Be(()=>u.value!==l.value),{min:d,max:h,step:v,decimals:x,roundValue:_}=n,b=Be(()=>parseInt(e.thumbSize,10)),S=Be(()=>parseInt(e.tickSize,10)),E=Be(()=>parseInt(e.trackSize,10)),C=Be(()=>(h.value-d.value)/v.value),A=dt(()=>e.disabled),D=Be(()=>e.error||e.disabled?void 0:e.thumbColor??e.color),O=Be(()=>e.error||e.disabled?void 0:e.thumbColor),V=Be(()=>e.error||e.disabled?void 0:e.trackColor??e.color),P=Be(()=>e.error||e.disabled?void 0:e.trackFillColor??e.color),U=rn(!1),Y=rn(0),fe=cn(),Q=cn();function G(ge){var We;const xe=(We=fe.value)==null?void 0:We.$el;if(!xe)return;const ze=e.direction==="vertical",Ge=ze?"top":"left",ut=ze?"height":"width",ce=ze?"clientY":"clientX",{[Ge]:me,[ut]:ke}=xe.getBoundingClientRect(),Xe=hH(ge,ce);let Ze=Wa((Xe-me-Y.value)/ke)||0;return(ze?c.value:c.value!==o.value)&&(Ze=1-Ze),_(d.value+Ze*(h.value-d.value))}const re=ge=>{const xe=G(ge);xe!=null&&a({value:xe}),U.value=!1,Y.value=0},he=ge=>{const xe=G(ge);Q.value=s(ge),Q.value&&(U.value=!0,Q.value.contains(ge.target)?Y.value=fH(ge,Q.value,e.direction):(Y.value=0,xe!=null&&i({value:xe})),xe!=null&&r({value:xe}),Wi(()=>{var ze;return(ze=Q.value)==null?void 0:ze.focus()}))},ye={passive:!0,capture:!0};function $e(ge){const xe=G(ge);xe!=null&&i({value:xe})}function _e(ge){ge.stopPropagation(),ge.preventDefault(),re(ge),window.removeEventListener("mousemove",$e,ye),window.removeEventListener("mouseup",_e)}function de(ge){var xe;re(ge),window.removeEventListener("touchmove",$e,ye),(xe=ge.target)==null||xe.removeEventListener("touchend",de)}function Oe(ge){var xe;he(ge),window.addEventListener("touchmove",$e,ye),(xe=ge.target)==null||xe.addEventListener("touchend",de,{passive:!1})}function ve(ge){ge.button===0&&(ge.preventDefault(),he(ge),window.addEventListener("mousemove",$e,ye),window.addEventListener("mouseup",_e,{passive:!1}))}const ie=ge=>{const xe=(ge-d.value)/(h.value-d.value)*100;return Wa(isNaN(xe)?0:xe,0,100)},Pe=dt(()=>e.showTicks),et=Be(()=>Pe.value?e.ticks?Array.isArray(e.ticks)?e.ticks.map(ge=>({value:ge,position:ie(ge),label:ge.toString()})):Object.keys(e.ticks).map(ge=>({value:parseFloat(ge),position:ie(parseFloat(ge)),label:e.ticks[ge]})):C.value!==1/0?A1(C.value+1).map(ge=>{const xe=d.value+ge*v.value;return{value:xe,position:ie(xe)}}):[]:[]),ne=Be(()=>et.value.some(ge=>{let{label:xe}=ge;return!!xe})),qe={activeThumbRef:Q,color:dt(()=>e.color),decimals:x,disabled:A,direction:dt(()=>e.direction),elevation:dt(()=>e.elevation),hasLabels:ne,isReversed:l,indexFromEnd:c,min:d,max:h,mousePressed:U,noKeyboard:dt(()=>e.noKeyboard),numTicks:C,onSliderMousedown:ve,onSliderTouchstart:Oe,parsedTicks:et,parseMouseMove:G,position:ie,readonly:dt(()=>e.readonly),rounded:dt(()=>e.rounded),roundValue:_,showTicks:Pe,startOffset:Y,step:v,thumbSize:b,thumbColor:D,thumbLabelColor:O,thumbLabel:dt(()=>e.thumbLabel),ticks:dt(()=>e.ticks),tickSize:S,trackColor:V,trackContainerRef:fe,trackFillColor:P,trackSize:E,vertical:u};return Lr(qy,qe),qe},vH=Et({focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0},ripple:{type:[Boolean,Object],default:!0},name:String,noKeyboard:Boolean,...In()},"VSliderThumb"),yH=Jt()({name:"VSliderThumb",directives:{vRipple:io},props:vH(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:n,emit:r}=e;const i=Fn(qy),{isRtl:a,rtlClasses:s}=Sa();if(!i)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{min:o,max:l,thumbColor:u,thumbLabelColor:c,step:d,disabled:h,thumbSize:v,thumbLabel:x,direction:_,isReversed:b,vertical:S,readonly:E,elevation:C,mousePressed:A,decimals:D,indexFromEnd:O}=i,V=Be(()=>h.value?void 0:C.value),{elevationClasses:P}=dl(V),{textColorClasses:U,textColorStyles:Y}=Es(u),{backgroundColorClasses:fe,backgroundColorStyles:Q}=ra(c),{pageup:G,pagedown:re,end:he,home:ye,left:$e,right:_e,down:de,up:Oe}=Hk,ve=[G,re,he,ye,$e,_e,de,Oe],ie=Be(()=>d.value?[1,2,3]:[1,5,10]);function Pe(ne,qe){if(t.noKeyboard||!ve.includes(ne.key))return;ne.preventDefault();const ge=d.value||.1,xe=(l.value-o.value)/ge;if([$e,_e,de,Oe].includes(ne.key)){const Ge=(S.value?[a.value?$e:_e,b.value?de:Oe]:O.value!==a.value?[$e,Oe]:[_e,Oe]).includes(ne.key)?1:-1,ut=ne.shiftKey?2:ne.ctrlKey?1:0;Ge===-1&&qe===l.value&&!ut&&!Number.isInteger(xe)?qe=qe-xe%1*ge:qe=qe+Ge*ge*ie.value[ut]}else if(ne.key===ye)qe=o.value;else if(ne.key===he)qe=l.value;else{const ze=ne.key===re?1:-1;qe=qe-ze*ge*(xe>100?xe/10:10)}return Math.max(t.min,Math.min(t.max,qe))}function et(ne){const qe=Pe(ne,t.modelValue);qe!=null&&r("update:modelValue",qe)}return vn(()=>{const ne=nn(O.value?100-t.position:t.position,"%");return Te("div",{class:Wt(["v-slider-thumb",{"v-slider-thumb--focused":t.focused,"v-slider-thumb--pressed":t.focused&&A.value},t.class,s.value]),style:yn([{"--v-slider-thumb-position":ne,"--v-slider-thumb-size":nn(v.value)},t.style]),role:"slider",tabindex:h.value?-1:0,"aria-label":t.name,"aria-valuemin":o.value,"aria-valuemax":l.value,"aria-valuenow":t.modelValue,"aria-readonly":!!E.value,"aria-orientation":_.value,onKeydown:E.value?void 0:et},[Te("div",{class:Wt(["v-slider-thumb__surface",U.value,P.value]),style:yn(Y.value)},null),Hi(Te("div",{class:Wt(["v-slider-thumb__ripple",U.value]),style:yn(Y.value)},null),[[io,t.ripple,null,{circle:!0,center:!0}]]),le(jP,{origin:"bottom center"},{default:()=>{var qe;return[Hi(Te("div",{class:"v-slider-thumb__label-container"},[Te("div",{class:Wt(["v-slider-thumb__label",fe.value]),style:yn(Q.value)},[Te("div",null,[((qe=n["thumb-label"])==null?void 0:qe.call(n,{modelValue:t.modelValue}))??t.modelValue.toFixed(d.value?D.value:1)]),Te("div",{class:"v-slider-thumb__label-wedge"},null)])]),[[yu,x.value&&t.focused||x.value==="always"]])]}})])}),{}}}),_H=Et({start:{type:Number,required:!0},stop:{type:Number,required:!0},...In()},"VSliderTrack"),bH=Jt()({name:"VSliderTrack",props:_H(),emits:{},setup(t,e){let{slots:n}=e;const r=Fn(qy);if(!r)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:i,parsedTicks:a,rounded:s,showTicks:o,tickSize:l,trackColor:u,trackFillColor:c,trackSize:d,vertical:h,min:v,max:x,indexFromEnd:_}=r,{roundedClasses:b}=Xa(s),{backgroundColorClasses:S,backgroundColorStyles:E}=ra(c),{backgroundColorClasses:C,backgroundColorStyles:A}=ra(u),D=Be(()=>`inset-${h.value?"block":"inline"}-${_.value?"end":"start"}`),O=Be(()=>h.value?"height":"width"),V=Be(()=>({[D.value]:"0%",[O.value]:"100%"})),P=Be(()=>t.stop-t.start),U=Be(()=>({[D.value]:nn(t.start,"%"),[O.value]:nn(P.value,"%")})),Y=Be(()=>o.value?(h.value?a.value.slice().reverse():a.value).map((Q,G)=>{var he;const re=Q.value!==v.value&&Q.value!==x.value?nn(Q.position,"%"):void 0;return Te("div",{key:Q.value,class:Wt(["v-slider-track__tick",{"v-slider-track__tick--filled":Q.position>=t.start&&Q.position<=t.stop,"v-slider-track__tick--first":Q.value===v.value,"v-slider-track__tick--last":Q.value===x.value}]),style:{[D.value]:re}},[(Q.label||n["tick-label"])&&Te("div",{class:"v-slider-track__tick-label"},[((he=n["tick-label"])==null?void 0:he.call(n,{tick:Q,index:G}))??Q.label])])}):[]);return vn(()=>Te("div",{class:Wt(["v-slider-track",b.value,t.class]),style:yn([{"--v-slider-track-size":nn(d.value),"--v-slider-tick-size":nn(l.value)},t.style])},[Te("div",{class:Wt(["v-slider-track__background",C.value,{"v-slider-track__background--opacity":!!i.value||!c.value}]),style:{...V.value,...A.value}},null),Te("div",{class:Wt(["v-slider-track__fill",S.value]),style:{...U.value,...E.value}},null),o.value&&Te("div",{class:Wt(["v-slider-track__ticks",{"v-slider-track__ticks--always-show":o.value==="always"}])},[Y.value])])),{}}}),xH=Et({...XT(),...pH(),...Wy(),modelValue:{type:[Number,String],default:0}},"VSlider"),hc=Jt()({name:"VSlider",props:xH(),emits:{"update:focused":t=>!0,"update:modelValue":t=>!0,start:t=>!0,end:t=>!0},setup(t,e){let{slots:n,emit:r}=e;const i=cn(),a=cn(),{rtlClasses:s}=Sa(),o=mH(t),l=jr(t,"modelValue",void 0,P=>o.roundValue(P??o.min.value)),{min:u,max:c,mousePressed:d,roundValue:h,onSliderMousedown:v,onSliderTouchstart:x,trackContainerRef:_,position:b,hasLabels:S,readonly:E,noKeyboard:C}=gH({props:t,steps:o,onSliderStart:()=>{r("start",l.value)},onSliderEnd:P=>{let{value:U}=P;const Y=h(U);l.value=Y,r("end",Y)},onSliderMove:P=>{let{value:U}=P;return l.value=h(U)},getActiveThumb:()=>{var P;return(P=i.value)==null?void 0:P.$el}}),{isFocused:A,focus:D,blur:O}=KT(t),V=Be(()=>b(l.value));return vn(()=>{const P=ap.filterProps(t),U=!!(t.label||n.label||n.prepend);return le(ap,Rn({ref:a,class:["v-slider",{"v-slider--has-labels":!!n["tick-label"]||S.value,"v-slider--focused":A.value,"v-slider--pressed":d.value,"v-slider--disabled":t.disabled},s.value,t.class],style:t.style},P,{focused:A.value}),{...n,prepend:U?Y=>{var fe,Q;return Te(On,null,[((fe=n.label)==null?void 0:fe.call(n,Y))??(t.label?le(HT,{id:Y.id.value,class:"v-slider__label",text:t.label},null):void 0),(Q=n.prepend)==null?void 0:Q.call(n,Y)])}:void 0,default:Y=>{let{id:fe,messagesId:Q}=Y;return Te("div",{class:"v-slider__container",onMousedown:E.value?void 0:v,onTouchstartPassive:E.value?void 0:x},[Te("input",{id:fe.value,name:t.name||fe.value,disabled:!!t.disabled,readonly:!!t.readonly,tabindex:"-1",value:l.value},null),le(bH,{ref:_,start:0,stop:V.value},{"tick-label":n["tick-label"]}),le(yH,{ref:i,"aria-describedby":Q.value,focused:A.value,noKeyboard:C.value,min:u.value,max:c.value,modelValue:l.value,"onUpdate:modelValue":G=>l.value=G,position:V.value,elevation:t.elevation,onFocus:D,onBlur:O,ripple:t.ripple,name:t.name},{"thumb-label":n["thumb-label"]})])}})}),Pp({focus:()=>{var P;return(P=i.value)==null?void 0:P.$el.focus()}},a)}}),jy=Symbol.for("vuetify:v-tabs"),wH=Et({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Hc(r8({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),hs=Jt()({name:"VTab",props:wH(),setup(t,e){let{slots:n,attrs:r}=e;const{textColorClasses:i,textColorStyles:a}=Es(()=>t.sliderColor),s=cn(),o=cn(),l=Be(()=>t.direction==="horizontal"),u=Be(()=>{var d,h;return((h=(d=s.value)==null?void 0:d.group)==null?void 0:h.isSelected.value)??!1});function c(d){var v,x;let{value:h}=d;if(h){const _=(x=(v=s.value)==null?void 0:v.$el.parentElement)==null?void 0:x.querySelector(".v-tab--selected .v-tab__slider"),b=o.value;if(!_||!b)return;const S=getComputedStyle(_).color,E=_.getBoundingClientRect(),C=b.getBoundingClientRect(),A=l.value?"x":"y",D=l.value?"X":"Y",O=l.value?"right":"bottom",V=l.value?"width":"height",P=E[A],U=C[A],Y=P>U?E[O]-C[O]:E[A]-C[A],fe=Math.sign(Y)>0?l.value?"right":"bottom":Math.sign(Y)<0?l.value?"left":"top":"center",G=(Math.abs(Y)+(Math.sign(Y)<0?E[V]:C[V]))/Math.max(E[V],C[V])||0,re=E[V]/C[V]||0,he=1.5;_c(b,{backgroundColor:[S,"currentcolor"],transform:[`translate${D}(${Y}px) scale${D}(${re})`,`translate${D}(${Y/he}px) scale${D}(${(G-1)/he+1})`,"none"],transformOrigin:Array(3).fill(fe)},{duration:225,easing:V0})}}return vn(()=>{const d=Ci.filterProps(t);return le(Ci,Rn({symbol:jy,ref:s,class:["v-tab",t.class],style:t.style,tabindex:u.value?0:-1,role:"tab","aria-selected":String(u.value),active:!1},d,r,{block:t.fixed,maxWidth:t.fixed?300:void 0,"onGroup:selected":c}),{...n,default:()=>{var h;return Te(On,null,[((h=n.default)==null?void 0:h.call(n))??t.text,!t.hideSlider&&Te("div",{ref:o,class:Wt(["v-tab__slider",i.value]),style:yn(a.value)},null)])}})}),Pp({},s)}}),SH=t=>{const{touchstartX:e,touchendX:n,touchstartY:r,touchendY:i}=t,a=.5,s=16;t.offsetX=n-e,t.offsetY=i-r,Math.abs(t.offsetY)<a*Math.abs(t.offsetX)&&(t.left&&n<e-s&&t.left(t),t.right&&n>e+s&&t.right(t)),Math.abs(t.offsetX)<a*Math.abs(t.offsetY)&&(t.up&&i<r-s&&t.up(t),t.down&&i>r+s&&t.down(t))};function MH(t,e){var r;const n=t.changedTouches[0];e.touchstartX=n.clientX,e.touchstartY=n.clientY,(r=e.start)==null||r.call(e,{originalEvent:t,...e})}function EH(t,e){var r;const n=t.changedTouches[0];e.touchendX=n.clientX,e.touchendY=n.clientY,(r=e.end)==null||r.call(e,{originalEvent:t,...e}),SH(e)}function TH(t,e){var r;const n=t.changedTouches[0];e.touchmoveX=n.clientX,e.touchmoveY=n.clientY,(r=e.move)==null||r.call(e,{originalEvent:t,...e})}function CH(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:t.left,right:t.right,up:t.up,down:t.down,start:t.start,move:t.move,end:t.end};return{touchstart:n=>MH(n,e),touchend:n=>EH(n,e),touchmove:n=>TH(n,e)}}function AH(t,e){var o;const n=e.value,r=n!=null&&n.parent?t.parentElement:t,i=(n==null?void 0:n.options)??{passive:!0},a=(o=e.instance)==null?void 0:o.$.uid;if(!r||!a)return;const s=CH(e.value);r._touchHandlers=r._touchHandlers??Object.create(null),r._touchHandlers[a]=s,q5(s).forEach(l=>{r.addEventListener(l,s[l],i)})}function kH(t,e){var a,s;const n=(a=e.value)!=null&&a.parent?t.parentElement:t,r=(s=e.instance)==null?void 0:s.$.uid;if(!(n!=null&&n._touchHandlers)||!r)return;const i=n._touchHandlers[r];q5(i).forEach(o=>{n.removeEventListener(o,i[o])}),delete n._touchHandlers[r]}const s1={mounted:AH,unmounted:kH},iC=Symbol.for("vuetify:v-window"),aC=Symbol.for("vuetify:v-window-group"),sC=Et({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:t=>typeof t=="boolean"||t==="hover"},verticalArrows:[Boolean,String],touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...In(),...br(),...Kr()},"VWindow"),pS=Jt()({name:"VWindow",directives:{vTouch:s1},props:sC(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:n}=e;const{themeClasses:r}=Ri(t),{isRtl:i}=Sa(),{t:a}=p6(),s=F1(t,aC),o=cn(),l=Be(()=>i.value?!t.reverse:t.reverse),u=rn(!1),c=Be(()=>{const A=t.direction==="vertical"?"y":"x",O=(l.value?!u.value:u.value)?"-reverse":"";return`v-window-${A}${O}-transition`}),d=rn(0),h=cn(void 0),v=Be(()=>s.items.value.findIndex(A=>s.selected.value.includes(A.id)));An(v,(A,D)=>{const O=s.items.value.length,V=O-1;O<=2?u.value=A<D:A===V&&D===0?u.value=!0:A===0&&D===V?u.value=!1:u.value=A<D}),Lr(iC,{transition:c,isReversed:u,transitionCount:d,transitionHeight:h,rootRef:o});const x=dt(()=>t.continuous||v.value!==0),_=dt(()=>t.continuous||v.value!==s.items.value.length-1);function b(){x.value&&s.prev()}function S(){_.value&&s.next()}const E=Be(()=>{const A=[],D={icon:i.value?t.nextIcon:t.prevIcon,class:`v-window__${l.value?"right":"left"}`,onClick:s.prev,"aria-label":a("$vuetify.carousel.prev")};A.push(x.value?n.prev?n.prev({props:D}):le(Ci,D,null):Te("div",null,null));const O={icon:i.value?t.prevIcon:t.nextIcon,class:`v-window__${l.value?"left":"right"}`,onClick:s.next,"aria-label":a("$vuetify.carousel.next")};return A.push(_.value?n.next?n.next({props:O}):le(Ci,O,null):Te("div",null,null)),A}),C=Be(()=>t.touch===!1?t.touch:{...{left:()=>{l.value?b():S()},right:()=>{l.value?S():b()},start:D=>{let{originalEvent:O}=D;O.stopPropagation()}},...t.touch===!0?{}:t.touch});return vn(()=>Hi(le(t.tag,{ref:o,class:Wt(["v-window",{"v-window--show-arrows-on-hover":t.showArrows==="hover","v-window--vertical-arrows":!!t.verticalArrows},r.value,t.class]),style:yn(t.style)},{default:()=>{var A,D;return[Te("div",{class:"v-window__container",style:{height:h.value}},[(A=n.default)==null?void 0:A.call(n,{group:s}),t.showArrows!==!1&&Te("div",{class:Wt(["v-window__controls",{"v-window__controls--left":t.verticalArrows==="left"||t.verticalArrows===!0},{"v-window__controls--right":t.verticalArrows==="right"}])},[E.value])]),(D=n.additional)==null?void 0:D.call(n,{group:s})]}}),[[s1,C.value]])),{group:s}}}),IH=Et({...Hc(sC(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),k0=Jt()({name:"VTabsWindow",props:IH(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:n}=e;const r=Fn(jy,null),i=jr(t,"modelValue"),a=Be({get(){var s;return i.value!=null||!r?i.value:(s=r.items.value.find(o=>r.selected.value.includes(o.id)))==null?void 0:s.value},set(s){i.value=s}});return vn(()=>{const s=pS.filterProps(t);return le(pS,Rn({_as:"VTabsWindow"},s,{modelValue:a.value,"onUpdate:modelValue":o=>a.value=o,class:["v-tabs-window",t.class],style:t.style,mandatory:!1,touch:!1}),n)}),{}}}),oC=Et({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...In(),...U6(),...QT()},"VWindowItem"),mS=Jt()({name:"VWindowItem",directives:{vTouch:s1},props:oC(),emits:{"group:selected":t=>!0},setup(t,e){let{slots:n}=e;const r=Fn(iC),i=V6(t,aC),{isBooted:a}=Y1();if(!r||!i)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const s=rn(!1),o=Be(()=>a.value&&(r.isReversed.value?t.reverseTransition!==!1:t.transition!==!1));function l(){!s.value||!r||(s.value=!1,r.transitionCount.value>0&&(r.transitionCount.value-=1,r.transitionCount.value===0&&(r.transitionHeight.value=void 0)))}function u(){var x;s.value||!r||(s.value=!0,r.transitionCount.value===0&&(r.transitionHeight.value=nn((x=r.rootRef.value)==null?void 0:x.clientHeight)),r.transitionCount.value+=1)}function c(){l()}function d(x){s.value&&Wi(()=>{!o.value||!s.value||!r||(r.transitionHeight.value=nn(x.clientHeight))})}const h=Be(()=>{const x=r.isReversed.value?t.reverseTransition:t.transition;return o.value?{name:typeof x!="string"?r.transition.value:x,onBeforeEnter:u,onAfterEnter:l,onEnterCancelled:c,onBeforeLeave:u,onAfterLeave:l,onLeaveCancelled:c,onEnter:d}:!1}),{hasContent:v}=eC(t,i.isSelected);return vn(()=>le(Ko,{transition:h.value,disabled:!a.value},{default:()=>{var x;return[Hi(Te("div",{class:Wt(["v-window-item",i.selectedClass.value,t.class]),style:yn(t.style)},[v.value&&((x=n.default)==null?void 0:x.call(n))]),[[yu,i.isSelected.value]])]}})),{groupItem:i}}}),$H=Et({...oC()},"VTabsWindowItem"),ps=Jt()({name:"VTabsWindowItem",props:$H(),setup(t,e){let{slots:n}=e;return vn(()=>{const r=mS.filterProps(t);return le(mS,Rn({_as:"VTabsWindowItem"},r,{class:["v-tabs-window-item",t.class],style:t.style}),n)}),{}}});function PH(t){let{selectedElement:e,containerElement:n,isRtl:r,isHorizontal:i}=t;const a=Df(i,n),s=lC(i,r,n),o=Df(i,e),l=uC(i,e),u=o*.4;return s>l?l-u:s+a<l+o?l-a+o+u:s}function RH(t){let{selectedElement:e,containerElement:n,isHorizontal:r}=t;const i=Df(r,n),a=uC(r,e),s=Df(r,e);return a-i/2+s/2}function gS(t,e){const n=t?"scrollWidth":"scrollHeight";return(e==null?void 0:e[n])||0}function DH(t,e){const n=t?"clientWidth":"clientHeight";return(e==null?void 0:e[n])||0}function lC(t,e,n){if(!n)return 0;const{scrollLeft:r,offsetWidth:i,scrollWidth:a}=n;return t?e?a-i+r:r:n.scrollTop}function Df(t,e){const n=t?"offsetWidth":"offsetHeight";return(e==null?void 0:e[n])||0}function uC(t,e){const n=t?"offsetLeft":"offsetTop";return(e==null?void 0:e[n])||0}const LH=Symbol.for("vuetify:v-slide-group"),cC=Et({centerActive:Boolean,contentClass:null,direction:{type:String,default:"horizontal"},symbol:{type:null,default:LH},nextIcon:{type:pr,default:"$next"},prevIcon:{type:pr,default:"$prev"},showArrows:{type:[Boolean,String],validator:t=>typeof t=="boolean"||["always","desktop","mobile"].includes(t)},...In(),...SI({mobile:null}),...br(),...F6({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),vS=Jt()({name:"VSlideGroup",props:cC(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:n}=e;const{isRtl:r}=Sa(),{displayClasses:i,mobile:a}=_6(t),s=F1(t,t.symbol),o=rn(!1),l=rn(0),u=rn(0),c=rn(0),d=Be(()=>t.direction==="horizontal"),{resizeRef:h,contentRect:v}=Sf(),{resizeRef:x,contentRect:_}=Sf(),b=TI(),S=Be(()=>({container:h.el,duration:200,easing:"easeOutQuart"})),E=Be(()=>s.selected.value.length?s.items.value.findIndex(ve=>ve.id===s.selected.value[0]):-1),C=Be(()=>s.selected.value.length?s.items.value.findIndex(ve=>ve.id===s.selected.value[s.selected.value.length-1]):-1);if(er){let ve=-1;An(()=>[s.selected.value,v.value,_.value,d.value],()=>{cancelAnimationFrame(ve),ve=requestAnimationFrame(()=>{if(v.value&&_.value){const ie=d.value?"width":"height";u.value=v.value[ie],c.value=_.value[ie],o.value=u.value+1<c.value}if(E.value>=0&&x.el){const ie=x.el.children[C.value];D(ie,t.centerActive)}})})}const A=rn(!1);function D(ve,ie){let Pe=0;ie?Pe=RH({containerElement:h.el,isHorizontal:d.value,selectedElement:ve}):Pe=PH({containerElement:h.el,isHorizontal:d.value,isRtl:r.value,selectedElement:ve}),O(Pe)}function O(ve){if(!er||!h.el)return;const ie=Df(d.value,h.el),Pe=lC(d.value,r.value,h.el);if(!(gS(d.value,h.el)<=ie||Math.abs(ve-Pe)<16)){if(d.value&&r.value&&h.el){const{scrollWidth:ne,offsetWidth:qe}=h.el;ve=ne-qe-ve}d.value?b.horizontal(ve,S.value):b(ve,S.value)}}function V(ve){const{scrollTop:ie,scrollLeft:Pe}=ve.target;l.value=d.value?Pe:ie}function P(ve){if(A.value=!0,!(!o.value||!x.el)){for(const ie of ve.composedPath())for(const Pe of x.el.children)if(Pe===ie){D(Pe);return}}}function U(ve){A.value=!1}let Y=!1;function fe(ve){var ie;!Y&&!A.value&&!(ve.relatedTarget&&((ie=x.el)!=null&&ie.contains(ve.relatedTarget)))&&he(),Y=!1}function Q(){Y=!0}function G(ve){if(!x.el)return;function ie(Pe){ve.preventDefault(),he(Pe)}d.value?ve.key==="ArrowRight"?ie(r.value?"prev":"next"):ve.key==="ArrowLeft"&&ie(r.value?"next":"prev"):ve.key==="ArrowDown"?ie("next"):ve.key==="ArrowUp"&&ie("prev"),ve.key==="Home"?ie("first"):ve.key==="End"&&ie("last")}function re(ve,ie){if(!ve)return;let Pe=ve;do Pe=Pe==null?void 0:Pe[ie==="next"?"nextElementSibling":"previousElementSibling"];while(Pe!=null&&Pe.hasAttribute("disabled"));return Pe}function he(ve){if(!x.el)return;let ie;if(!ve)ie=I1(x.el)[0];else if(ve==="next"){if(ie=re(x.el.querySelector(":focus"),ve),!ie)return he("first")}else if(ve==="prev"){if(ie=re(x.el.querySelector(":focus"),ve),!ie)return he("last")}else ve==="first"?(ie=x.el.firstElementChild,ie!=null&&ie.hasAttribute("disabled")&&(ie=re(ie,"next"))):ve==="last"&&(ie=x.el.lastElementChild,ie!=null&&ie.hasAttribute("disabled")&&(ie=re(ie,"prev")));ie&&ie.focus({preventScroll:!0})}function ye(ve){const ie=d.value&&r.value?-1:1,Pe=(ve==="prev"?-ie:ie)*u.value;let et=l.value+Pe;if(d.value&&r.value&&h.el){const{scrollWidth:ne,offsetWidth:qe}=h.el;et+=ne-qe}O(et)}const $e=Be(()=>({next:s.next,prev:s.prev,select:s.select,isSelected:s.isSelected})),_e=Be(()=>{switch(t.showArrows){case"always":return!0;case"desktop":return!a.value;case!0:return o.value||Math.abs(l.value)>0;case"mobile":return a.value||o.value||Math.abs(l.value)>0;default:return!a.value&&(o.value||Math.abs(l.value)>0)}}),de=Be(()=>Math.abs(l.value)>1),Oe=Be(()=>{if(!h.value)return!1;const ve=gS(d.value,h.el),ie=DH(d.value,h.el);return ve-ie-Math.abs(l.value)>1});return vn(()=>le(t.tag,{class:Wt(["v-slide-group",{"v-slide-group--vertical":!d.value,"v-slide-group--has-affixes":_e.value,"v-slide-group--is-overflowing":o.value},i.value,t.class]),style:yn(t.style),tabindex:A.value||s.selected.value.length?-1:0,onFocus:fe},{default:()=>{var ve,ie,Pe;return[_e.value&&Te("div",{key:"prev",class:Wt(["v-slide-group__prev",{"v-slide-group__prev--disabled":!de.value}]),onMousedown:Q,onClick:()=>de.value&&ye("prev")},[((ve=n.prev)==null?void 0:ve.call(n,$e.value))??le(K0,null,{default:()=>[le(yr,{icon:r.value?t.nextIcon:t.prevIcon},null)]})]),Te("div",{key:"container",ref:h,class:Wt(["v-slide-group__container",t.contentClass]),onScroll:V},[Te("div",{ref:x,class:"v-slide-group__content",onFocusin:P,onFocusout:U,onKeydown:G},[(ie=n.default)==null?void 0:ie.call(n,$e.value)])]),_e.value&&Te("div",{key:"next",class:Wt(["v-slide-group__next",{"v-slide-group__next--disabled":!Oe.value}]),onMousedown:Q,onClick:()=>Oe.value&&ye("next")},[((Pe=n.next)==null?void 0:Pe.call(n,$e.value))??le(K0,null,{default:()=>[le(yr,{icon:r.value?t.prevIcon:t.nextIcon},null)]})])]}})),{selected:s.selected,scrollTo:ye,scrollOffset:l,focus:he,hasPrev:de,hasNext:Oe}}});function zH(t){return t?t.map(e=>B0(e)?e:{text:e,value:e}):[]}const OH=Et({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...cC({mandatory:"force",selectedClass:"v-tab-item--selected"}),...As(),...br()},"VTabs"),sv=Jt()({name:"VTabs",props:OH(),emits:{"update:modelValue":t=>!0},setup(t,e){let{attrs:n,slots:r}=e;const i=jr(t,"modelValue"),a=Be(()=>zH(t.items)),{densityClasses:s}=uo(t),{backgroundColorClasses:o,backgroundColorStyles:l}=ra(()=>t.bgColor),{scopeId:u}=Gy();return Wc({VTab:{color:dt(()=>t.color),direction:dt(()=>t.direction),stacked:dt(()=>t.stacked),fixed:dt(()=>t.fixedTabs),sliderColor:dt(()=>t.sliderColor),hideSlider:dt(()=>t.hideSlider)}}),vn(()=>{const c=vS.filterProps(t),d=!!(r.window||t.items.length>0);return Te(On,null,[le(vS,Rn(c,{modelValue:i.value,"onUpdate:modelValue":h=>i.value=h,class:["v-tabs",`v-tabs--${t.direction}`,`v-tabs--align-tabs-${t.alignTabs}`,{"v-tabs--fixed-tabs":t.fixedTabs,"v-tabs--grow":t.grow,"v-tabs--stacked":t.stacked},s.value,o.value,t.class],style:[{"--v-tabs-height":nn(t.height)},l.value,t.style],role:"tablist",symbol:jy},u,n),{default:()=>{var h;return[((h=r.default)==null?void 0:h.call(r))??a.value.map(v=>{var x;return((x=r.tab)==null?void 0:x.call(r,{item:v}))??le(hs,Rn(v,{key:v.text,value:v.value}),{default:r[`tab.${v.value}`]?()=>{var _;return(_=r[`tab.${v.value}`])==null?void 0:_.call(r,{item:v})}:void 0})})]}}),d&&le(k0,Rn({modelValue:i.value,"onUpdate:modelValue":h=>i.value=h,key:"tabs-window"},u),{default:()=>{var h;return[a.value.map(v=>{var x;return((x=r.item)==null?void 0:x.call(r,{item:v}))??le(ps,{value:v.value},{default:()=>{var _;return(_=r[`item.${v.value}`])==null?void 0:_.call(r,{item:v})}})}),(h=r.window)==null?void 0:h.call(r)]}})])}),{}}}),yS={1:["unitree_go2/scene.xml","./examples/checkpoints/go2/asset_meta.json"],2:["unitree_go1/go1.xml","./examples/checkpoints/go1/asset_meta.json"]},NH={1:"facet",2:"him"},BH={facet:"./examples/checkpoints/policy-05-03_21-31.json",robust:"./examples/checkpoints/robust.json",vanilla:"./examples/checkpoints/vanilla.json",him:"./examples/checkpoints/go1/go1_him.json",decap:"./examples/checkpoints/go1/go1_decap.json"},FH={name:"DemoPage",data:()=>({task:"1",policy:"facet",facet_kp:24,command_vel_x:0,use_setpoint:!0,compliant_mode:!1,state:0,extra_error_message:"",keydown_listener:null}),methods:{async init(){if(typeof WebAssembly!="object"||typeof WebAssembly.instantiate!="function"){this.state=-2;return}try{const t=await CV();this.demo=new SV(t),await this.demo.init(),this.demo.main_loop(),this.demo.params.paused=!1,this.state=1}catch(t){this.state=-1,this.extra_error_message=t.toString(),console.error(t)}},async updateTaskCallback(){if(this.task==="3"||this.task==="4")return;console.log(this.task),this.demo.alive=!1;const t=yS[this.task][0],e=yS[this.task][1];this.policy=NH[this.task],await this.demo.reloadScene(t,e),this.updatePolicyCallback()},async updatePolicyCallback(){console.log(this.policy),this.demo.alive=!1,await this.demo.reloadPolicy(BH[this.policy]),this.policy==="facet"?(this.demo.ball.visible=!0,this.demo.ball.position.set(0,.5,0)):this.demo.ball.visible=!1,this.demo.alive=!0,this.demo.main_loop()},reset(){this.demo.params.paused=!0,this.demo.simulation.resetData(),this.demo.simulation.forward(),this.demo.ball.position.set(0,.5,0),this.demo.params.paused=!1},updateFacetKpCallback(){this.facet_kp=Math.max(this.facet_kp,12),this.facet_kp=Math.min(this.facet_kp,24),this.demo.params.impedance_kp=this.facet_kp},updateUseSetpointCallback(){console.log("use stepoint",this.use_setpoint),this.demo.params.use_setpoint=this.use_setpoint,this.use_setpoint&&(this.command_vel_x=0,this.updateCommandVelXCallback())},updateCommandVelXCallback(){console.log("set command vel x",this.command_vel_x),this.demo.params.command_vel_x=this.command_vel_x},updateCompliantModeCallback(){this.demo.params.compliant_mode=this.compliant_mode,this.compliant_mode?(this.facet_kp=0,this.command_vel_x=0,this.demo.params.impedance_kp=this.facet_kp):(this.facet_kp=24,this.demo.params.impedance_kp=this.facet_kp)},StartImpulse(){console.log("start impulse"),this.demo.params.impulse_remain_time=.1},goHome(){this.$router.push({path:"/"})}},mounted(){this.init(),this.keydown_listener=document.addEventListener("keydown",t=>{t.code==="Backspace"&&this.reset()})},beforeUnmount(){document.removeEventListener("keydown",this.keydown_listener)}},UH={style:{position:"fixed",top:"20px",right:"20px","z-index":"1000",width:"400px"}},VH={style:{"line-height":"1.0"}},HH={key:0,class:"text-caption text-grey",style:{"line-height":"1.0"}},WH={key:1,class:"text-caption text-grey",style:{"line-height":"1.0"}},GH={class:"text-caption"},qH={style:{"line-height":"1.0"}},jH={key:0,class:"text-caption text-grey",style:{"line-height":"1.0"}},XH={key:1,class:"text-caption text-grey",style:{"line-height":"1.0"}},KH={class:"text-caption"},YH={class:"text-caption"},ZH={class:"text-caption"},JH={class:"text-caption"},QH={class:"text-caption"},eW={style:{position:"fixed",top:"20px",left:"20px","z-index":"1000"}},tW={key:0},nW={key:1};function rW(t,e,n,r,i,a){return Pn(),vr(On,null,[e[60]||(e[60]=Te("div",{id:"mujoco-container"},null,-1)),Te("div",UH,[le(su,null,{default:Ne(()=>[le(sv,{modelValue:t.task,"onUpdate:modelValue":[e[0]||(e[0]=s=>t.task=s),e[1]||(e[1]=s=>a.updateTaskCallback())],"bg-color":"primary"},{default:Ne(()=>[le(hs,{value:"1"},{default:Ne(()=>e[25]||(e[25]=[Mt("Go2",-1)])),_:1,__:[25]}),le(hs,{value:"2"},{default:Ne(()=>e[26]||(e[26]=[Mt("Go1",-1)])),_:1,__:[26]}),le(hs,{value:"3"},{default:Ne(()=>e[27]||(e[27]=[Mt("B1+Z1",-1)])),_:1,__:[27]}),le(hs,{value:"4"},{default:Ne(()=>e[28]||(e[28]=[Mt("G1",-1)])),_:1,__:[28]})]),_:1},8,["modelValue"]),le(k0,{modelValue:t.task,"onUpdate:modelValue":e[24]||(e[24]=s=>t.task=s)},{default:Ne(()=>[le(ps,{value:"1"},{default:Ne(()=>[le(sv,{modelValue:t.policy,"onUpdate:modelValue":[e[2]||(e[2]=s=>t.policy=s),e[3]||(e[3]=s=>a.updatePolicyCallback())],"bg-color":"primary"},{default:Ne(()=>[le(hs,{value:"facet"},{default:Ne(()=>e[29]||(e[29]=[Mt("Facet",-1)])),_:1,__:[29]}),le(hs,{value:"robust"},{default:Ne(()=>e[30]||(e[30]=[Mt("Robust",-1)])),_:1,__:[30]}),le(hs,{value:"vanilla"},{default:Ne(()=>e[31]||(e[31]=[Mt("Vanilla",-1)])),_:1,__:[31]})]),_:1},8,["modelValue"]),le(k0,{modelValue:t.policy,"onUpdate:modelValue":e[16]||(e[16]=s=>t.policy=s)},{default:Ne(()=>[le(ps,{value:"facet"},{default:Ne(()=>[le(Mi,null,{default:Ne(()=>[e[34]||(e[34]=Te("div",{class:"text-subtitle-2 mb-2"},"Target Controls",-1)),le(aS,{disabled:t.compliant_mode,modelValue:t.use_setpoint,"onUpdate:modelValue":[e[4]||(e[4]=s=>t.use_setpoint=s),e[5]||(e[5]=s=>a.updateUseSetpointCallback())],density:"compact","hide-details":""},{label:Ne(()=>[Te("p",VH,[e[32]||(e[32]=Mt(" Use Setpoint ",-1)),e[33]||(e[33]=Te("br",null,null,-1)),t.use_setpoint?(Pn(),vr("span",HH," Drag the red sphere to command target positions ")):Qi("",!0),t.use_setpoint?Qi("",!0):(Pn(),vr("span",WH," Slide to command target velocities "))])]),_:1},8,["disabled","modelValue"]),le(hc,{disabled:t.use_setpoint||t.compliant_mode,modelValue:t.command_vel_x,"onUpdate:modelValue":[e[6]||(e[6]=s=>t.command_vel_x=s),e[7]||(e[7]=s=>a.updateCommandVelXCallback())],min:-.5,max:1.5,step:.1,label:"velocity","hide-details":""},{append:Ne(()=>[Te("div",GH,fr(t.command_vel_x),1)]),_:1},8,["disabled","modelValue"])]),_:1,__:[34]}),le(lf),le(Mi,null,{default:Ne(()=>[e[37]||(e[37]=Te("div",{class:"text-subtitle-2 mb-2"},"Stiffness Controls",-1)),le(aS,{modelValue:t.compliant_mode,"onUpdate:modelValue":[e[8]||(e[8]=s=>t.compliant_mode=s),e[9]||(e[9]=s=>a.updateCompliantModeCallback())],density:"compact","hide-details":""},{label:Ne(()=>[Te("p",qH,[e[35]||(e[35]=Mt(" Compliant Mode ",-1)),e[36]||(e[36]=Te("br",null,null,-1)),t.compliant_mode?(Pn(),vr("span",jH," Stiffness is set to 0 ")):Qi("",!0),t.compliant_mode?Qi("",!0):(Pn(),vr("span",XH," Slide to set stiffness "))])]),_:1},8,["modelValue"]),le(hc,{disabled:t.compliant_mode,modelValue:t.facet_kp,"onUpdate:modelValue":[e[10]||(e[10]=s=>t.facet_kp=s),e[11]||(e[11]=s=>a.updateFacetKpCallback())],min:0,max:24,step:1,label:"stiffness","hide-details":""},{append:Ne(()=>[Te("div",KH,fr(t.facet_kp),1)]),_:1},8,["disabled","modelValue"])]),_:1,__:[37]})]),_:1}),le(ps,{value:"robust"},{default:Ne(()=>[le(Mi,null,{default:Ne(()=>[e[38]||(e[38]=Te("div",{class:"text-caption text-grey mb-2"}," Slide to set command velocity ",-1)),le(hc,{modelValue:t.command_vel_x,"onUpdate:modelValue":[e[12]||(e[12]=s=>t.command_vel_x=s),e[13]||(e[13]=s=>a.updateCommandVelXCallback())],min:-.5,max:1.5,step:.1,label:"velocity","hide-details":""},{append:Ne(()=>[Te("div",YH,fr(t.command_vel_x),1)]),_:1},8,["modelValue"])]),_:1,__:[38]})]),_:1}),le(ps,{value:"vanilla"},{default:Ne(()=>[le(Mi,null,{default:Ne(()=>[e[39]||(e[39]=Te("div",{class:"text-caption text-grey mb-2"}," Slide to set command velocity ",-1)),le(hc,{modelValue:t.command_vel_x,"onUpdate:modelValue":[e[14]||(e[14]=s=>t.command_vel_x=s),e[15]||(e[15]=s=>a.updateCommandVelXCallback())],min:-.5,max:1.5,step:.1,label:"velocity","hide-details":""},{append:Ne(()=>[Te("div",ZH,fr(t.command_vel_x),1)]),_:1},8,["modelValue"])]),_:1,__:[39]})]),_:1})]),_:1},8,["modelValue"]),le(lf),le(Mi,{class:"pb-2"},{default:Ne(()=>[e[41]||(e[41]=Te("div",{class:"text-subtitle-2 mb-2"},"Force Controls",-1)),e[42]||(e[42]=Te("div",{class:"text-caption text-grey mb-2"}," Drag on the robot to apply force ",-1)),le(Ci,{onClick:a.StartImpulse,color:"primary",block:""},{default:Ne(()=>e[40]||(e[40]=[Mt("Impulse",-1)])),_:1,__:[40]},8,["onClick"]),e[43]||(e[43]=Te("div",{class:"text-caption text-grey mb-2"}," Click the button to apply an impulse ",-1))]),_:1,__:[41,42,43]})]),_:1}),le(ps,{value:"2"},{default:Ne(()=>[le(sv,{modelValue:t.policy,"onUpdate:modelValue":[e[17]||(e[17]=s=>t.policy=s),e[18]||(e[18]=s=>a.updatePolicyCallback())],"bg-color":"primary"},{default:Ne(()=>[le(hs,{value:"him"},{default:Ne(()=>e[44]||(e[44]=[Mt("HIMLoco",-1)])),_:1,__:[44]}),le(hs,{value:"decap"},{default:Ne(()=>e[45]||(e[45]=[Mt("Decap",-1)])),_:1,__:[45]})]),_:1},8,["modelValue"]),le(k0,{modelValue:t.policy,"onUpdate:modelValue":e[23]||(e[23]=s=>t.policy=s)},{default:Ne(()=>[le(ps,{value:"him"},{default:Ne(()=>[le(Mi,null,{default:Ne(()=>[e[46]||(e[46]=Te("div",{class:"text-caption text-grey mb-2"}," Slide to set command velocity ",-1)),le(hc,{modelValue:t.command_vel_x,"onUpdate:modelValue":[e[19]||(e[19]=s=>t.command_vel_x=s),e[20]||(e[20]=s=>a.updateCommandVelXCallback())],min:-.5,max:1.5,step:.1,label:"velocity","hide-details":""},{append:Ne(()=>[Te("div",JH,fr(t.command_vel_x),1)]),_:1},8,["modelValue"])]),_:1,__:[46]})]),_:1}),le(ps,{value:"decap"},{default:Ne(()=>[le(Mi,null,{default:Ne(()=>[e[47]||(e[47]=Te("div",{class:"text-caption text-grey mb-2"}," Slide to set command velocity ",-1)),le(hc,{modelValue:t.command_vel_x,"onUpdate:modelValue":[e[21]||(e[21]=s=>t.command_vel_x=s),e[22]||(e[22]=s=>a.updateCommandVelXCallback())],min:-.5,max:1.5,step:.1,label:"velocity","hide-details":""},{append:Ne(()=>[Te("div",QH,fr(t.command_vel_x),1)]),_:1},8,["modelValue"])]),_:1,__:[47]})]),_:1})]),_:1},8,["modelValue"]),le(lf),le(Mi,{class:"pb-2"},{default:Ne(()=>[e[49]||(e[49]=Te("div",{class:"text-subtitle-2 mb-2"},"Force Controls",-1)),e[50]||(e[50]=Te("div",{class:"text-caption text-grey mb-2"}," Drag on the robot to apply force ",-1)),le(Ci,{onClick:a.StartImpulse,color:"primary",block:""},{default:Ne(()=>e[48]||(e[48]=[Mt("Impulse",-1)])),_:1,__:[48]},8,["onClick"]),e[51]||(e[51]=Te("div",{class:"text-caption text-grey mb-2"}," Click the button to apply an impulse ",-1))]),_:1,__:[49,50,51]})]),_:1}),le(ps,{value:"3"},{default:Ne(()=>[le(Mi,null,{default:Ne(()=>e[52]||(e[52]=[Mt(" Release soon ",-1)])),_:1,__:[52]})]),_:1}),le(ps,{value:"4"},{default:Ne(()=>[le(Mi,null,{default:Ne(()=>e[53]||(e[53]=[Mt(" Release soon ",-1)])),_:1,__:[53]})]),_:1})]),_:1},8,["modelValue"]),le(Ci,{onClick:a.reset,block:"",text:"",tile:""},{default:Ne(()=>e[54]||(e[54]=[Mt("Reset",-1)])),_:1,__:[54]},8,["onClick"])]),_:1})]),Te("div",eW,[le(Ci,{color:"primary",onClick:a.goHome,elevation:"2"},{default:Ne(()=>[le(yr,null,{default:Ne(()=>e[55]||(e[55]=[Mt("mdi-arrow-left",-1)])),_:1,__:[55]}),e[56]||(e[56]=Mt("Go back ",-1))]),_:1,__:[56]},8,["onClick"])]),le(hS,{"model-value":t.state===0,persistent:"","max-width":"600px",scrollable:""},{default:Ne(()=>[le(su,{title:"Loading Simulation Environment"},{default:Ne(()=>[le(Mi,null,{default:Ne(()=>[le(j6,{indeterminate:"",color:"primary"}),e[57]||(e[57]=Mt(" Loading MuJoCo and ONNX, please wait ",-1))]),_:1,__:[57]})]),_:1})]),_:1},8,["model-value"]),le(hS,{"model-value":t.state<0,persistent:"","max-width":"600px",scrollable:""},{default:Ne(()=>[le(su,{title:"Simulation Environment Loading Error"},{default:Ne(()=>[le(Mi,null,{default:Ne(()=>[t.state==-1?(Pn(),vr("span",tW,[e[58]||(e[58]=Mt(" Unexpected JS error, please refresh the page ",-1)),e[59]||(e[59]=Te("br",null,null,-1)),Mt(" "+fr(t.extra_error_message),1)])):Qi("",!0),t.state==-2?(Pn(),vr("span",nW," Your browser does not support WebAssembly, please use latest Chrome/Edge/Firefox ")):Qi("",!0)]),_:1})]),_:1})]),_:1},8,["model-value"])],64)}const iW=Cp(FH,[["render",rW],["__scopeId","data-v-6b56592b"]]),aW=[{path:"/",name:"Home",component:fD},{path:"/demo",name:"Demo",component:iW}],dC=J$({history:C$("/"),routes:aW});dC.beforeEach((t,e,n)=>{e.name&&t.fullPath!==e.fullPath?(window.location.hash="#"+t.fullPath,window.location.reload()):n()});function sW(t){t.use(KI).use(dC)}const oW=Et({scrollable:Boolean,...In(),...ks(),...br({tag:"main"})},"VMain"),lW=Jt()({name:"VMain",props:oW(),setup(t,e){let{slots:n}=e;const{dimensionStyles:r}=Is(t),{mainStyles:i}=WI(),{ssrBootStyles:a}=Y1();return vn(()=>le(t.tag,{class:Wt(["v-main",{"v-main--scrollable":t.scrollable},t.class]),style:yn([i.value,a.value,r.value,t.style])},{default:()=>{var s,o;return[t.scrollable?Te("div",{class:"v-main__scroller"},[(s=n.default)==null?void 0:s.call(n)]):(o=n.default)==null?void 0:o.call(n)]}})),{}}}),uW={name:"App"};function cW(t,e,n,r,i,a){const s=h5("router-view");return Pn(),Oi(w8,null,{default:Ne(()=>[le(lW,null,{default:Ne(()=>[le(s)]),_:1})]),_:1})}const dW=Cp(uW,[["render",cW]]),fC=Ok(dW);sW(fC);fC.mount("#app");
